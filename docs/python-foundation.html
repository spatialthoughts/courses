<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Ujaval Gandhi" />


<title>Python Foundation for Spatial Analysis (Full Course)</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<style>
.copy-btn {
  position: absolute;
  top: 5px;
  right: 5px;
  padding: 4px 8px;
  font-size: 18px;
  background: #969696;
  color: white;
  border: none;
  border-radius: 3px;
  cursor: pointer;
  opacity: 0.7;
  transition: opacity 0.3s;
}

.copy-btn:hover {
  opacity: 1;
}

.copy-btn.copied {
  background: #636363;
}

pre {
  position: relative;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Find all code blocks
  const codeBlocks = document.querySelectorAll('pre code');
  
  codeBlocks.forEach(function(codeBlock) {
    const pre = codeBlock.parentElement;
    
    // Create copy button
    const button = document.createElement('button');
    button.className = 'copy-btn';
    button.textContent = '⎘';
    
    // Add button to pre element
    pre.appendChild(button);
    
    // Add click event
    button.addEventListener('click', function() {
      // Create temporary textarea to copy text
      const textarea = document.createElement('textarea');
      textarea.value = codeBlock.textContent;
      document.body.appendChild(textarea);
      textarea.select();
      document.execCommand('copy');
      document.body.removeChild(textarea);
      
      // Update button text
      button.textContent = 'Copied!';
      button.classList.add('copied');
      
      // Reset button after 2 seconds
      setTimeout(function() {
        button.textContent = '⎘';
        button.classList.remove('copied');
      }, 2000);
    });
  });
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Courses</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="http://spatialthoughts.com">Back to Main Site</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="#">Back to Top</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Python Foundation for Spatial Analysis
(Full Course)</h1>
<h3 class="subtitle">A gentle introduction to Python programming with a
focus on spatial data.</h3>
<h4 class="author">Ujaval Gandhi</h4>

</div>

<div id="TOC">
<ul>
<li><a href="#introduction" id="toc-introduction">Introduction</a></li>
<li><a href="#get-the-data-package" id="toc-get-the-data-package">Get
the Data Package</a></li>
<li><a href="#get-the-course-videos" id="toc-get-the-course-videos">Get
the Course Videos</a></li>
<li><a href="#installation-and-setting-up-the-environment"
id="toc-installation-and-setting-up-the-environment">Installation and
Setting up the Environment</a>
<ul>
<li><a href="#debugging-python-installation-errors"
id="toc-debugging-python-installation-errors">Debugging Python
Installation Errors</a></li>
</ul></li>
<li><a href="#using-jupyter-notebooks"
id="toc-using-jupyter-notebooks">Using Jupyter Notebooks</a></li>
<li><a href="#variables" id="toc-variables">Variables</a>
<ul>
<li><a href="#strings" id="toc-strings">Strings</a></li>
<li><a href="#numbers" id="toc-numbers">Numbers</a></li>
<li><a href="#exercise" id="toc-exercise">Exercise</a></li>
</ul></li>
<li><a href="#data-structures" id="toc-data-structures">Data
Structures</a>
<ul>
<li><a href="#tuples" id="toc-tuples">Tuples</a></li>
<li><a href="#lists" id="toc-lists">Lists</a></li>
<li><a href="#sets" id="toc-sets">Sets</a></li>
<li><a href="#dictionaries" id="toc-dictionaries">Dictionaries</a></li>
<li><a href="#exercise-1" id="toc-exercise-1">Exercise</a></li>
</ul></li>
<li><a href="#string-operations" id="toc-string-operations">String
Operations</a>
<ul>
<li><a href="#escaping-characters" id="toc-escaping-characters">Escaping
characters</a></li>
<li><a href="#printing-strings" id="toc-printing-strings">Printing
Strings</a></li>
<li><a href="#exercise-2" id="toc-exercise-2">Exercise</a></li>
</ul></li>
<li><a href="#loops-and-conditionals"
id="toc-loops-and-conditionals">Loops and Conditionals</a>
<ul>
<li><a href="#for-loops" id="toc-for-loops">For Loops</a></li>
<li><a href="#conditionals" id="toc-conditionals">Conditionals</a></li>
<li><a href="#control-statements" id="toc-control-statements">Control
Statements</a></li>
<li><a href="#exercise-3" id="toc-exercise-3">Exercise</a></li>
</ul></li>
<li><a href="#functions" id="toc-functions">Functions</a>
<ul>
<li><a href="#exercise-4" id="toc-exercise-4">Exercise</a></li>
</ul></li>
<li><a href="#the-python-standard-library"
id="toc-the-python-standard-library">The Python Standard Library</a>
<ul>
<li><a href="#calculating-distance"
id="toc-calculating-distance">Calculating Distance</a></li>
<li><a href="#discover-python-easter-eggs"
id="toc-discover-python-easter-eggs">Discover Python Easter
Eggs</a></li>
<li><a href="#exercise-5" id="toc-exercise-5">Exercise</a></li>
</ul></li>
<li><a href="#third-party-modules"
id="toc-third-party-modules">Third-party Modules</a>
<ul>
<li><a href="#installing-third-party-libraries"
id="toc-installing-third-party-libraries">Installing third-party
libraries</a></li>
<li><a href="#calculating-distance-1"
id="toc-calculating-distance-1">Calculating Distance</a></li>
<li><a href="#exercise-6" id="toc-exercise-6">Exercise</a></li>
</ul></li>
<li><a href="#using-web-apis" id="toc-using-web-apis">Using Web APIs</a>
<ul>
<li><a href="#understanding-json-and-geojson"
id="toc-understanding-json-and-geojson">Understanding JSON and
GeoJSON</a></li>
<li><a href="#the-requests-module" id="toc-the-requests-module">The
<code>requests</code> module</a></li>
<li><a href="#calculating-distance-using-openrouteservice-api"
id="toc-calculating-distance-using-openrouteservice-api">Calculating
Distance using OpenRouteService API</a></li>
<li><a href="#exercise-1-1" id="toc-exercise-1-1">Exercise 1</a></li>
<li><a href="#api-rate-limiting" id="toc-api-rate-limiting">API Rate
Limiting</a></li>
<li><a href="#exercise-2-1" id="toc-exercise-2-1">Exercise 2</a></li>
</ul></li>
<li><a href="#assignment" id="toc-assignment">Assignment</a>
<ul>
<li><a href="#part-1" id="toc-part-1">Part 1</a></li>
<li><a href="#part-2" id="toc-part-2">Part 2</a></li>
<li><a href="#part-3" id="toc-part-3">Part 3</a></li>
</ul></li>
<li><a href="#review-of-common-python-errors"
id="toc-review-of-common-python-errors">Review of Common Python
Errors</a></li>
<li><a href="#reading-files" id="toc-reading-files">Reading Files</a>
<ul>
<li><a href="#exercise-7" id="toc-exercise-7">Exercise</a></li>
</ul></li>
<li><a href="#reading-csv-files" id="toc-reading-csv-files">Reading CSV
Files</a>
<ul>
<li><a href="#using-enumerate-function"
id="toc-using-enumerate-function">Using <code>enumerate()</code>
function</a></li>
<li><a href="#using-with-statement" id="toc-using-with-statement">Using
<code>with</code> statement</a></li>
<li><a href="#filtering-rows" id="toc-filtering-rows">Filtering
rows</a></li>
<li><a href="#calculating-distance-2"
id="toc-calculating-distance-2">Calculating distance</a></li>
<li><a href="#writing-files" id="toc-writing-files">Writing
files</a></li>
<li><a href="#exercise-8" id="toc-exercise-8">Exercise</a></li>
</ul></li>
<li><a href="#working-with-pandas" id="toc-working-with-pandas">Working
with Pandas</a>
<ul>
<li><a href="#reading-files-1" id="toc-reading-files-1">Reading
Files</a></li>
<li><a href="#filtering-data" id="toc-filtering-data">Filtering
Data</a></li>
<li><a href="#performing-calculations"
id="toc-performing-calculations">Performing calculations</a></li>
<li><a href="#exercise-9" id="toc-exercise-9">Exercise</a></li>
</ul></li>
<li><a href="#working-with-geopandas"
id="toc-working-with-geopandas">Working with Geopandas</a>
<ul>
<li><a href="#reading-spatial-data"
id="toc-reading-spatial-data">Reading Spatial Data</a></li>
<li><a href="#filtering-data-1" id="toc-filtering-data-1">Filtering
Data</a></li>
<li><a href="#working-with-projections"
id="toc-working-with-projections">Working with Projections</a></li>
<li><a href="#performing-spatial-joins"
id="toc-performing-spatial-joins">Performing Spatial joins</a></li>
<li><a href="#group-statistics" id="toc-group-statistics">Group
Statistics</a></li>
<li><a href="#exercise-10" id="toc-exercise-10">Exercise</a></li>
</ul></li>
<li><a href="#creating-spatial-data"
id="toc-creating-spatial-data">Creating Spatial Data</a>
<ul>
<li><a href="#reading-tab-delimited-files"
id="toc-reading-tab-delimited-files">Reading Tab-Delimited
Files</a></li>
<li><a href="#filtering-data-2" id="toc-filtering-data-2">Filtering
Data</a></li>
<li><a href="#creating-geometries" id="toc-creating-geometries">Creating
Geometries</a></li>
<li><a href="#writing-files-1" id="toc-writing-files-1">Writing
Files</a></li>
<li><a href="#exercise-11" id="toc-exercise-11">Exercise</a></li>
</ul></li>
<li><a href="#introduction-to-numpy"
id="toc-introduction-to-numpy">Introduction to NumPy</a>
<ul>
<li><a href="#arrays" id="toc-arrays">Arrays</a></li>
<li><a href="#array-operations" id="toc-array-operations">Array
Operations</a></li>
<li><a href="#exercise-12" id="toc-exercise-12">Exercise</a></li>
</ul></li>
<li><a href="#working-with-rasterio"
id="toc-working-with-rasterio">Working with RasterIO</a>
<ul>
<li><a href="#reading-raster-data" id="toc-reading-raster-data">Reading
Raster Data</a></li>
<li><a href="#merging-datasets" id="toc-merging-datasets">Merging
Datasets</a></li>
<li><a href="#writing-raster-data" id="toc-writing-raster-data">Writing
Raster Data</a></li>
<li><a href="#exercise-13" id="toc-exercise-13">Exercise</a></li>
</ul></li>
<li><a href="#writing-standalone-python-scripts"
id="toc-writing-standalone-python-scripts">Writing Standalone Python
Scripts</a>
<ul>
<li><a href="#get-a-text-editor" id="toc-get-a-text-editor">Get a Text
Editor</a></li>
<li><a href="#writing-a-script" id="toc-writing-a-script">Writing a
Script</a></li>
<li><a href="#executing-a-script" id="toc-executing-a-script">Executing
a Script</a></li>
</ul></li>
<li><a href="#what-next" id="toc-what-next">What next?</a>
<ul>
<li><a href="#do-a-project" id="toc-do-a-project">Do a Project</a></li>
<li><a href="#keep-learning" id="toc-keep-learning">Keep
Learning</a></li>
</ul></li>
<li><a href="#data-credits" id="toc-data-credits">Data Credits</a></li>
<li><a href="#license" id="toc-license">License</a></li>
</ul>
</div>

<div style="page-break-after: always;"></div>
<hr />
<p><img src="images/spatial_thoughts_logo.png" width="250pt" style="display: block; margin: auto;" /></p>
<hr />
<div style="page-break-after: always;"></div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>This class covers Python from the very basics. Suitable for GIS
practitioners with no programming background or python knowledge. The
course will introduce participants to basic programming concepts,
libraries for spatial analysis, geospatial APIs and techniques for
building spatial data processing pipelines.</p>
<p><a
href="https://www.youtube.com/watch?v=rHgsslH-_y0&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=1"
target="_blank"><img
src="https://img.youtube.com/vi/rHgsslH-_y0/mqdefault.jpg"
alt="Watch the video" /></a></p>
<p><a
href="https://www.youtube.com/watch?v=rHgsslH-_y0&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=1"
target="_blank">Watch the Video ↗</a></p>
<p><a
href="https://docs.google.com/presentation/d/125LV0qR47S_OGaZZr5Zv-7lbWfdZ5pNo3iFm6IOX7uI/edit?usp=sharing"
target="_blank">Access the Presentation ↗</a></p>
</div>
<div id="get-the-data-package" class="section level1">
<h1>Get the Data Package</h1>
<p>The code examples in this class use a variety of datasets. All the
required datasets and Jupyter notebooks are supplied to you in the
<code>python_foundation.zip</code> file. Unzip this file to a directory
- preferably to the
<code>&lt;home folder&gt;/Downloads/python_foundation/</code>
folder.</p>
<p>Download <a
href="https://github.com/spatialthoughts/courses/releases/download/data/python_foundation.zip">python_foundation.zip</a>.</p>
<blockquote>
<p>Note: Certification and Support are only available for participants
in our paid instructor-led classes.</p>
</blockquote>
</div>
<div id="get-the-course-videos" class="section level1">
<h1>Get the Course Videos</h1>
<p>The course is accompanied by a set of videos covering the all the
modules. These videos are recorded from our live instructor-led classes
and are edited to make them easier to consume for self-study. We have 2
versions of the videos:</p>
<div id="youtube" class="section level3">
<h3>YouTube</h3>
<p>We have created a YouTube Playlist with separate videos for each
notebook and exercise to enable effective online-learning. <a
href="https://www.youtube.com/playlist?list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT"
target="_blank">Access the YouTube Playlist ↗</a></p>
</div>
<div id="vimeo" class="section level3">
<h3>Vimeo</h3>
<p>We are also making combined full-length video for each module
available on Vimeo. These videos can be downloaded for offline learning.
<a href="https://vimeo.com/showcase/11034058" target="_blank">Access the
Vimeo Playlist ↗</a></p>
</div>
</div>
<div id="installation-and-setting-up-the-environment"
class="section level1">
<h1>Installation and Setting up the Environment</h1>
<p>There are many ways to install Python on your system. Many operating
systems comes with a Python distribution built-in too. If you use
software such as QGIS - it comes with its own version of Python. Working
on Python projects typically require installing third-party packages
(i.e. tools). As these packages have different dependencies - they often
cause conflicts and errors due to different versions of Python on your
system.</p>
<p>An easy and reliable way to get a Python installation on your system
is via <a href="https://www.anaconda.com/">Anaconda</a>. For this
course, we will use the Anaconda3 Individual Edition to install Python
and required spatial analysis packages.</p>
<blockquote>
<p>Many Python tool names have references to the reptile world. The
default Python package manager is called <a
href="https://pypi.org/project/pip/">Pip</a> which references the
process of hatching eggs. Interestingly, the naming of the Python
language itself had <a
href="https://en.wikipedia.org/wiki/Guido_van_Rossum#Python">nothing to
do with reptiles</a>.</p>
</blockquote>
<p>Anaconda provides the <code>conda</code> command that can be run from
the <em>Command Prompt</em> on Windows or the <em>Terminal</em> on
Mac/Linux. This is the preferred method to install the required
packages.</p>
<ol style="list-style-type: decimal">
<li><a href="https://www.anaconda.com/download/success">Download the
Anaconda Installer</a> for Python 3.12 (or a higher version) for your
operating system. Once downloaded, double click the installer and
install it into the default suggested directory. Select an install for
<em>Just Me</em> and <strong>use default settings</strong>.</li>
</ol>
<blockquote>
<p>Note: If your username has spaces, or non-English characters, it
causes problems. In that case, you can install it to a path such as
<code>C:\anaconda</code>.</p>
</blockquote>
<p><img src="images/python_foundation/condacli1.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="2" style="list-style-type: decimal">
<li>(<em>Windows users</em>) Once installed, search for <em>Anaconda
Prompt</em> launch it. (<em>Mac/Linux users</em>): Launch a
<em>Terminal</em> window.</li>
</ol>
<p><img src="images/python_foundation/condacli2.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="3" style="list-style-type: decimal">
<li>It is a good practice to create a new <em>environment</em> for each
of your Python projects. An environment is a space where you will
install required packages. Many packages may contain conflicting
requirements, preventing them from all being installed into a single
environment. Having a separate environment isolates your project from
such problems. We will now type commands in a terminal to create a new
environment. <em>(Windows users)</em> Search for Anaconda Prompt in the
Start Menu and launch it. <em>(Mac/Linux users)</em>: Open a Terminal
window. Enter the command below and press <em>Enter</em> to create your
new environment.</li>
</ol>
<pre><code>conda create --name python_foundation</code></pre>
<p><img src="images/python_foundation/condacli3.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="4" style="list-style-type: decimal">
<li>Now you will be asked for confirmation; press <em>y + Enter</em> to
proceed and complete your environment creation.</li>
</ol>
<p><img src="images/python_foundation/condacli4.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="5" style="list-style-type: decimal">
<li>Now that the environment is created, you need to activate it. Type
the command below and press <em>Enter</em>. Once the environment
activates, the <code>(base)</code> will change to
<code>(python_foundation)</code>.</li>
</ol>
<pre><code>conda activate python_foundation</code></pre>
<p><img src="images/python_foundation/condacli5.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="6" style="list-style-type: decimal">
<li>Now we are ready to install the required packages using the
<code>conda install</code> command. First we will install
<code>geopandas</code>. This is a module that allows you to work with
vector geospatial data in Python. We will use the
<code>conda-forge</code> channel to install the package. The
<code>-y</code> option will skip the confirmation dialog. Enter the
command below and press <em>Enter</em>.</li>
</ol>
<pre><code>conda install --channel conda-forge geopandas -y</code></pre>
<blockquote>
<p>Learn more about <a
href="https://conda-forge.org/docs/user/introduction.html">conda-forge</a></p>
</blockquote>
<p><img src="images/python_foundation/condacli6.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="7" style="list-style-type: decimal">
<li>If the installation is successful, you should see a message as shown
here.</li>
</ol>
<p><img src="images/python_foundation/condacli7.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="8" style="list-style-type: decimal">
<li><code>geopandas</code> installation is a bit tricky and can
sometimes fail. So it is a good idea to check if it can be imported
without errors. We will use the <code>python</code> command with the
<code>-c</code> option which will execute a python statement. Enter the
below command and press Enter.</li>
</ol>
<pre><code>python -c &quot;import geopandas&quot;</code></pre>
<p><img src="images/python_foundation/condacli8.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="9" style="list-style-type: decimal">
<li>If your geopandas installation was successful, the command will run
without any output. <strong>If nothing happens - it means your
installation was successful!</strong>. If you see any errors, please
follow the <a href="#debugging-python-installation-errors">debugging
guide</a>.</li>
</ol>
<p><img src="images/python_foundation/condacli9.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="10" style="list-style-type: decimal">
<li>We can now install other required packages for this class. Run the
command below to install <code>geopy</code>, <code>rasterio</code>,
<code>matplotlib</code> and <code>jupyterlab</code> packages.</li>
</ol>
<pre><code>conda install --channel conda-forge geopy rasterio matplotlib jupyterlab -y</code></pre>
<p><img src="images/python_foundation/condacli10.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="11" style="list-style-type: decimal">
<li>Once the command finishes, you should see a screen such as
below.</li>
</ol>
<p><img src="images/python_foundation/condacli11.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="12" style="list-style-type: decimal">
<li>Your Python environment is now ready. Launch the <em>JupyterLab</em>
application using the command below. This will initiate and run a local
server in your system and opens in your default browser.</li>
</ol>
<blockquote>
<p>Note: Do not close your anaconda prompt after <em>JupyterLab</em>
opens up. You need to keep it running as long as you want to use
JupyterLab.</p>
</blockquote>
<pre><code>jupyter-lab</code></pre>
<p><img src="images/python_foundation/condacli12.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Note that JupyterLab application can browse the files only on the
Drive from where it was launched from. If your data is stored on a
different drive, you will need an additional step to switch to that
drive before launching Jupyterlab.</p>
<p><em>Windows</em></p>
<p>On the command prompt, type the drive letter followed by
<code>:</code> and press <em>Enter</em> to switch to the drive.</p>
<pre><code>D:</code></pre>
<pre><code>jupyter-lab</code></pre>
<p><img src="images/python_foundation/condacli12a.png" width="75%" style="display: block; margin: auto;" /></p>
<p><em>Mac/Linux</em></p>
<p>Check the drives mounted on your system by entering
<code>ls /Volumes</code>. After that use <code>cd</code> command to
switch to the drive.</p>
<pre><code>cd /Volumes/&lt;NameofYourDrive&gt;</code></pre>
<pre><code>jupyter-lab</code></pre>
<ol start="13" style="list-style-type: decimal">
<li>A new browser tab will open with an instance of JupyterLab. Click
the <em>Python 3</em> button under <em>Notebook</em>.</li>
</ol>
<p><img src="images/python_foundation/condacli13.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="14" style="list-style-type: decimal">
<li>Enter the following statements in the first cell and click the
<em>Run</em> button. <strong>If nothing happens - it means your
installation was successful!</strong>. Your environment is now ready for
the course. If you get an <em>ImportError</em>, repeat the installation
steps carefully again.</li>
</ol>
<pre><code>import geopandas
import geopy
import rasterio</code></pre>
<p><img src="images/python_foundation/condacli14.png" width="75%" style="display: block; margin: auto;" /></p>
<div id="debugging-python-installation-errors" class="section level2">
<h2>Debugging Python Installation Errors</h2>
<p>The following section describes common installation errors with
suggested fixes.</p>
<div id="openssl-error" class="section level4">
<h4>OpenSSL Error</h4>
<p>On many Windows systems, you may get an error such
<strong>CondaSSLError: OpenSSL appears to be unavailable on this
machine. OpenSSL is required to download and install packages</strong>.
This means the OpenSSL module is missing. Please download and install
the <a
href="https://slproweb.com/products/Win32OpenSSL.html">Win32/Win64
OpenSSL packages</a> and try again.</p>
<p>If the error persists, you can manually fix the issue by copying the
required DLL files in the correct place as <a
href="https://github.com/conda/conda/issues/11982#issuecomment-1285538983">described
in this issue</a>.</p>
</div>
<div id="rtree-spatialindex-error" class="section level4">
<h4>RTree spatialindex Error</h4>
<p>When importing GeoPandas, you may see an error <strong>Could not find
or load spatialindex_c-64.dll</strong>. This error is likely caused by a
corrupted installation. This error is easily fixed by deleting the conda
environment and reinstalling geopandas. Run the following sequence of
commands to delete the environment.</p>
<pre><code>conda deactivate
conda env remove -n python_foundation</code></pre>
<p>Follow the installation steps and reinstall geopandas.</p>
</div>
</div>
</div>
<div id="using-jupyter-notebooks" class="section level1">
<h1>Using Jupyter Notebooks</h1>
<p><a
href="https://www.youtube.com/watch?v=xsId8Yt-S-Y&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=3"
target="_blank"><img
src="https://img.youtube.com/vi/xsId8Yt-S-Y/mqdefault.jpg"
alt="Watch the Video" /></a></p>
<p><a
href="https://www.youtube.com/watch?v=xsId8Yt-S-Y&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=3"
target="_blank">Watch the Video ↗</a></p>
<p>Your class data package contain multiple Jupyter notebooks containing
code and exercises for this class.</p>
<ol style="list-style-type: decimal">
<li>Launch the <em>JupyterLab</em> application. It will open your Web
Browser and load the application in a new tab. From the left-hand panel,
navigate to the directory where you extracted the data package.</li>
</ol>
<p><img src="images/python_foundation/setup1.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="2" style="list-style-type: decimal">
<li>Jupyter notebooks have a <code>.ipynb</code> extensions.
Double-click on a notebook file to open it. Code in the notebook is
executed cell-by-cell. You can select a cell and click the <em>Run</em>
button to execute the code and see the output.</li>
</ol>
<p><img src="images/python_foundation/setup2.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="3" style="list-style-type: decimal">
<li>At the end of each notebook, you will find an exercise. Before
adding a new cell and attempting to complete the exercise, make sure you
go to <strong>Run → Run All Cells</strong> to execute all the code in
the notebook. Doing this will ensure all the required variables are
avalable to you to use in the exervise.</li>
</ol>
<p><img src="images/python_foundation/setup3.png" width="75%" style="display: block; margin: auto;" /></p>
<div style="page-break-after: always;"></div>
<hr />
<p>Open the notebook named <code>01_variables.ipynb</code>.</p>
<p><a
href="https://www.youtube.com/watch?v=JPZOxlOLTKU&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=4"
target="_blank"><img
src="https://img.youtube.com/vi/JPZOxlOLTKU/mqdefault.jpg"
alt="Watch the Video" /></a></p>
<p><a
href="https://www.youtube.com/watch?v=JPZOxlOLTKU&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=4"
target="_blank">Watch the Video ↗</a></p>
<hr />
</div>
<div id="variables" class="section level1">
<h1>Variables</h1>
<div id="strings" class="section level2">
<h2>Strings</h2>
<p>A string is a sequence of letters, numbers, and punctuation marks -
or commonly known as <strong>text</strong></p>
<p>In Python you can create a string by typing letters between single or
double quotation marks.</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>city <span class="op">=</span> <span class="st">&#39;San Francisco&#39;</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>state <span class="op">=</span> <span class="st">&#39;California&#39;</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="bu">print</span>(city, state)</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="bu">print</span>(city <span class="op">+</span> state)</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="bu">print</span>(city <span class="op">+</span> <span class="st">&#39;,&#39;</span> <span class="op">+</span> state)</span></code></pre></div>
</div>
<div id="numbers" class="section level2">
<h2>Numbers</h2>
<p>Python can handle several types of numbers, but the two most common
are:</p>
<ul>
<li><strong>int</strong>, which represents integer values like 100,
and</li>
<li><strong>float</strong>, which represents numbers that have a
fraction part, like 0.5</li>
</ul>
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>population <span class="op">=</span> <span class="dv">881549</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>latitude <span class="op">=</span> <span class="fl">37.7739</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>longitude <span class="op">=</span> <span class="op">-</span><span class="fl">121.5687</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(population))</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(latitude))</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>elevation_feet <span class="op">=</span> <span class="dv">934</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>elevation_meters <span class="op">=</span> elevation_feet <span class="op">*</span> <span class="fl">0.3048</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="bu">print</span>(elevation_meters)</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>area_sqmi <span class="op">=</span> <span class="fl">46.89</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>density <span class="op">=</span> population <span class="op">/</span> area_sqmi</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="bu">print</span>(density)</span></code></pre></div>
</div>
<div id="exercise" class="section level2">
<h2>Exercise</h2>
<p>We have a variable named <code>distance_km</code> below with the
value <code>4135</code> - indicating the straight-line distance between
San Francisco and New York in Kilometers. Create another variable called
<code>distance_mi</code> and store the distance value in miles.</p>
<ul>
<li>Hint1: 1 mile = 1.60934 kilometers</li>
</ul>
<p>Add the code in the cell below and run it. The output should be
2569.37</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>distance_km <span class="op">=</span> <span class="dv">4135</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="co"># Remove this line and add code here</span></span></code></pre></div>
<hr />
<div style="page-break-after: always;"></div>
<p>Open the notebook named <code>02_data_structures.ipynb</code>.</p>
<p><a
href="https://www.youtube.com/watch?v=BxKrHhGAodY&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=6"
target="_blank"><img
src="https://img.youtube.com/vi/BxKrHhGAodY/mqdefault.jpg"
alt="Watch the Video" /></a></p>
<p><a
href="https://www.youtube.com/watch?v=BxKrHhGAodY&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=6"
target="_blank">Watch the Video ↗</a></p>
<hr />
</div>
</div>
<div id="data-structures" class="section level1">
<h1>Data Structures</h1>
<div id="tuples" class="section level2">
<h2>Tuples</h2>
<p>A <em>tuple</em> is a sequence of objects. It can have any number of
objects inside. In Python tuples are written with round brackets
<strong>()</strong>.</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>latitude <span class="op">=</span> <span class="fl">37.7739</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>longitude <span class="op">=</span> <span class="op">-</span><span class="fl">121.5687</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>coordinates <span class="op">=</span> (latitude, longitude)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a><span class="bu">print</span>(coordinates)</span></code></pre></div>
<p>You can access each item by its position, i.e. <em>index</em>. In
programming, the counting starts from 0. So the first item has an index
of 0, the second item an index of 1 and so now. The index has to be put
inside square brackets <strong>[]</strong>.</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>y <span class="op">=</span> coordinates[<span class="dv">0</span>]</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>x <span class="op">=</span> coordinates[<span class="dv">1</span>]</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="bu">print</span>(x, y)</span></code></pre></div>
</div>
<div id="lists" class="section level2">
<h2>Lists</h2>
<p>A <strong>list</strong> is similar to a tuple - but with a key
difference. With tuples, once created, they cannot be changed, i.e. they
are immutable. But lists are mutable. You can add, delete or change
elements within a list. In Python, lists are written with square
brackets <strong>[]</strong></p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>cities <span class="op">=</span> [<span class="st">&#39;San Francisco&#39;</span>, <span class="st">&#39;Los Angeles&#39;</span>, <span class="st">&#39;New York&#39;</span>, <span class="st">&#39;Atlanta&#39;</span>]</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="bu">print</span>(cities)</span></code></pre></div>
<p>You can access the elements from a list using index the same way as
tuples.</p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="bu">print</span>(cities[<span class="dv">0</span>])</span></code></pre></div>
<p>You can call <code>len()</code> function with any Python object and
it will calculates the size of the object.</p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(cities))</span></code></pre></div>
<p>We can add items to the list using the <code>append()</code>
method</p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>cities.append(<span class="st">&#39;Boston&#39;</span>)</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a><span class="bu">print</span>(cities)</span></code></pre></div>
<p>As lists are <em>mutable</em>, you will see that the size of the list
has now changed</p>
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(cities))</span></code></pre></div>
<p>Another useful method for lists is <code>sort()</code> - which can
sort the elements in a list.</p>
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>cities.sort()</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a><span class="bu">print</span>(cities)</span></code></pre></div>
<p>The default sorting is in <em>ascending</em> order. If we wanted to
sort the list in a <em>decending</em> order, we can call the function
with <code>reverse=True</code></p>
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>cities.sort(reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a><span class="bu">print</span>(cities)</span></code></pre></div>
</div>
<div id="sets" class="section level2">
<h2>Sets</h2>
<p>Sets are like lists, but with some interesting properties. Mainly
that they contain only unique values. It also allows for <em>set
operations</em> - such as <em>intersection</em>, <em>union</em> and
<em>difference</em>. In practice, the sets are typically created from
lists.</p>
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>capitals <span class="op">=</span> [<span class="st">&#39;Sacramento&#39;</span>, <span class="st">&#39;Boston&#39;</span>, <span class="st">&#39;Austin&#39;</span>, <span class="st">&#39;Atlanta&#39;</span>]</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>capitals_set <span class="op">=</span> <span class="bu">set</span>(capitals)</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>cities_set <span class="op">=</span> <span class="bu">set</span>(cities)</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>capital_cities <span class="op">=</span> capitals_set.intersection(cities_set)</span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a><span class="bu">print</span>(capital_cities)</span></code></pre></div>
<p>Sets are also useful in finding unique elements in a list. Let’s
merge the two lists using the <code>extend()</code> method. The
resulting list will have duplicate elements. Creating a set from the
list removes the duplicate elements.</p>
<div class="sourceCode" id="cb32"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>cities.extend(capitals)</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a><span class="bu">print</span>(cities)</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">set</span>(cities))</span></code></pre></div>
</div>
<div id="dictionaries" class="section level2">
<h2>Dictionaries</h2>
<p>In Python dictionaries are written with curly brackets
<strong>{}</strong>. Dictionaries have <em>keys</em> and
<em>values</em>. With lists, we can access each element by its index.
But a dictionary makes it easy to access the element by name. Keys and
values are separated by a colon <strong>:</strong>.</p>
<div class="sourceCode" id="cb33"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>data <span class="op">=</span> {<span class="st">&#39;city&#39;</span>: <span class="st">&#39;San Francisco&#39;</span>, <span class="st">&#39;population&#39;</span>: <span class="dv">881549</span>, <span class="st">&#39;coordinates&#39;</span>: (<span class="op">-</span><span class="fl">122.4194</span>, <span class="fl">37.7749</span>) }</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a><span class="bu">print</span>(data)</span></code></pre></div>
<p>You can access an item of a dictionary by referring to its key name,
inside square brackets.</p>
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="bu">print</span>(data[<span class="st">&#39;city&#39;</span>])</span></code></pre></div>
</div>
<div id="exercise-1" class="section level2">
<h2>Exercise</h2>
<p>From the dictionary below, how do you access the latitude and
longitude values? print the latitude and longitude of new york city by
extracting it from the dictionary below.</p>
<p>The expected output should look like below.</p>
<pre><code>40.661
-73.944</code></pre>
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>nyc_data <span class="op">=</span> {<span class="st">&#39;city&#39;</span>: <span class="st">&#39;New York&#39;</span>, <span class="st">&#39;population&#39;</span>: <span class="dv">8175133</span>, <span class="st">&#39;coordinates&#39;</span>: (<span class="fl">40.661</span>, <span class="op">-</span><span class="fl">73.944</span>) }</span></code></pre></div>
<hr />
<div style="page-break-after: always;"></div>
<p>Open the notebook named <code>03_string_operations.ipynb</code>.</p>
<p><a
href="https://www.youtube.com/watch?v=RNp5sF-ZEkM&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=8"
target="_blank"><img
src="https://img.youtube.com/vi/RNp5sF-ZEkM/mqdefault.jpg"
alt="Watch the Video" /></a></p>
<p><a
href="https://www.youtube.com/watch?v=RNp5sF-ZEkM&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=8"
target="_blank">Watch the Video ↗</a></p>
<hr />
</div>
</div>
<div id="string-operations" class="section level1">
<h1>String Operations</h1>
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a>city <span class="op">=</span> <span class="st">&#39;San Francisco&#39;</span></span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(city))</span></code></pre></div>
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="bu">print</span>(city.split())</span></code></pre></div>
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="bu">print</span>(city.upper())</span></code></pre></div>
<div class="sourceCode" id="cb40"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a>city[<span class="dv">0</span>]</span></code></pre></div>
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a>city[<span class="op">-</span><span class="dv">1</span>]</span></code></pre></div>
<div class="sourceCode" id="cb42"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a>city[<span class="dv">0</span>:<span class="dv">3</span>]</span></code></pre></div>
<div class="sourceCode" id="cb43"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a>city[<span class="dv">4</span>:]</span></code></pre></div>
<div id="escaping-characters" class="section level2">
<h2>Escaping characters</h2>
<p>Certain characters are special since they are by Python language
itself. For example, the quote character <strong>’</strong> is used to
define a string. What do you do if your string contains a quote
character?</p>
<p>In Python strings, the backslash <strong>\</strong> is a special
character, also called the <strong>escape</strong> character. Prefixing
any character with a backslash makes it an ordinary character. (Hint:
Prefixing a backslash with a backshalsh makes it ordinary too!)</p>
<p>It is also used for representing certain whitespace characters, \n is
a newline, \t is a tab etc.</p>
<p>Remove the # from the cell below and run it.</p>
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="co"># my_string = &#39;It&#39;s a beautiful day!&#39;</span></span></code></pre></div>
<p>We can fix the error by espacing the single quote within the
string.</p>
<div class="sourceCode" id="cb45"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a>my_string <span class="op">=</span> <span class="st">&#39;It</span><span class="ch">\&#39;</span><span class="st">s a beautiful day!&#39;</span></span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a><span class="bu">print</span>(my_string)</span></code></pre></div>
<p>Alternatively, you can also use double-quotes if your string contains
a single-quote.</p>
<div class="sourceCode" id="cb46"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a>my_string <span class="op">=</span> <span class="st">&quot;It&#39;s a beautiful day!&quot;</span></span></code></pre></div>
<p>What if our string contains both single and double quotes?</p>
<p>We can use triple-quotes! Enclosing the string in triple quotes
ensures both single and double quotes are treated correctly.</p>
<div class="sourceCode" id="cb47"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a>latitude <span class="op">=</span> <span class="st">&#39;&#39;&#39;37° 46&#39; 26.2992&quot; N&#39;&#39;&#39;</span></span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a>longitude <span class="op">=</span> <span class="st">&#39;&#39;&#39;122° 25&#39; 52.6692&quot; W&#39;&#39;&#39;</span></span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a><span class="bu">print</span>(latitude, longitude)</span></code></pre></div>
<p>Backslashes pose another problem when dealing with Windows paths</p>
<div class="sourceCode" id="cb48"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a><span class="co">#path = &#39;C:\Users\ujaval&#39;</span></span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a><span class="co">#print(path)</span></span></code></pre></div>
<p>Prefixing a string with <strong>r</strong> makes is a <em>Raw
string</em>. Which doesn’t interpret backslash as a special
character</p>
<div class="sourceCode" id="cb49"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a>path <span class="op">=</span> <span class="vs">r&#39;C:\Users\ujaval&#39;</span></span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a><span class="bu">print</span>(path)</span></code></pre></div>
</div>
<div id="printing-strings" class="section level2">
<h2>Printing Strings</h2>
<p>Python provides a few different ways to create strings from
variables. Let’s learn about the two preferred methods.</p>
<div id="string-format-method" class="section level3">
<h3>String <code>format()</code> Method</h3>
<p>We can use the string <code>format()</code> method to create a string
with curly-braces and specify the values to fill in each field.</p>
<div class="sourceCode" id="cb50"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a>city <span class="op">=</span> <span class="st">&#39;San Francisco&#39;</span></span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a>population <span class="op">=</span> <span class="dv">881549</span></span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a>output <span class="op">=</span> <span class="st">&#39;Population of </span><span class="sc">{}</span><span class="st"> is </span><span class="sc">{}</span><span class="st">.&#39;</span>.<span class="bu">format</span>(city, population)</span>
<span id="cb50-4"><a href="#cb50-4" tabindex="-1"></a><span class="bu">print</span>(output)</span></code></pre></div>
<p>You can also use the format method to control the precision of the
numbers</p>
<div class="sourceCode" id="cb51"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a>latitude <span class="op">=</span> <span class="fl">37.7749</span></span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a>longitude <span class="op">=</span> <span class="op">-</span><span class="fl">122.4194</span></span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a>coordinates <span class="op">=</span> <span class="st">&#39;</span><span class="sc">{:.2f}</span><span class="st">,</span><span class="sc">{:.2f}</span><span class="st">&#39;</span>.<span class="bu">format</span>(latitude, longitude)</span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a><span class="bu">print</span>(coordinates)</span></code></pre></div>
</div>
<div id="f-strings" class="section level3">
<h3>F-Strings</h3>
<p>Since Python 3.6, we have an improved way for string formatting
called <em>f-strings</em> - which stands for <em>formatted string
literals</em>. It works similarly to the <code>format()</code> function
but provides a more concise syntax. We create an f-string by adding a
prefix <code>f</code> to any string. The variables within curly-braces
inside a f-string are replaced with their values.</p>
<div class="sourceCode" id="cb52"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a>city <span class="op">=</span> <span class="st">&#39;San Francisco&#39;</span></span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a>population <span class="op">=</span> <span class="dv">881549</span></span>
<span id="cb52-3"><a href="#cb52-3" tabindex="-1"></a>output <span class="op">=</span> <span class="ss">f&#39;Population of </span><span class="sc">{</span>city<span class="sc">}</span><span class="ss"> is </span><span class="sc">{</span>population<span class="sc">}</span><span class="ss">.&#39;</span></span>
<span id="cb52-4"><a href="#cb52-4" tabindex="-1"></a><span class="bu">print</span>(output)</span></code></pre></div>
<p>The same formatting operators we saw earlier works with
f-strings.</p>
<div class="sourceCode" id="cb53"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a>latitude <span class="op">=</span> <span class="fl">37.7749</span></span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a>longitude <span class="op">=</span> <span class="op">-</span><span class="fl">122.4194</span></span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a>coordinates <span class="op">=</span> <span class="ss">f&#39;</span><span class="sc">{</span>latitude<span class="sc">:.2f}</span><span class="ss">,</span><span class="sc">{</span>longitude<span class="sc">:.2f}</span><span class="ss">&#39;</span></span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a><span class="bu">print</span>(coordinates)</span></code></pre></div>
<p>We find that while f-strings are modern and concise - beginners find
it more intuitive to use the <code>format()</code> method, so we will
prefer <code>format()</code> over f-strings in this course. But you are
free to use any method of your choice.</p>
<hr />
</div>
</div>
<div id="exercise-2" class="section level2">
<h2>Exercise</h2>
<p>Use the string slicing to extract and print the degrees, minutes and
second parts of the string below. The output should be as follows</p>
<pre><code>37
46
26.2992</code></pre>
<div class="sourceCode" id="cb55"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a>latitude <span class="op">=</span> <span class="st">&#39;&#39;&#39;37° 46&#39; 26.2992&quot;&#39;&#39;&#39;</span></span></code></pre></div>
<div style="page-break-after: always;"></div>
<p>Open the notebook named
<code>04_loops_and_conditionals.ipynb</code>.</p>
<p><a
href="https://www.youtube.com/watch?v=NkKuzVkYOzk&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=10"
target="_blank"><img
src="https://img.youtube.com/vi/NkKuzVkYOzk/mqdefault.jpg"
alt="Watch the Video" /></a></p>
<p><a
href="https://www.youtube.com/watch?v=NkKuzVkYOzk&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=10"
target="_blank">Watch the Video ↗</a></p>
<hr />
</div>
</div>
<div id="loops-and-conditionals" class="section level1">
<h1>Loops and Conditionals</h1>
<div id="for-loops" class="section level2">
<h2>For Loops</h2>
<p>A for loop is used for iterating over a sequence. The sequence can be
a list, a tuple, a dictionary, a set, or a string.</p>
<div class="sourceCode" id="cb56"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a>cities <span class="op">=</span> [<span class="st">&#39;San Francisco&#39;</span>, <span class="st">&#39;Los Angeles&#39;</span>, <span class="st">&#39;New York&#39;</span>, <span class="st">&#39;Atlanta&#39;</span>]</span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a><span class="cf">for</span> city <span class="kw">in</span> cities:</span>
<span id="cb56-4"><a href="#cb56-4" tabindex="-1"></a>    <span class="bu">print</span>(city)</span></code></pre></div>
<p>To iterate over a dictionary, you can call the <code>items()</code>
method on it which returns a tuple of key and value for each item.</p>
<div class="sourceCode" id="cb57"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a>data <span class="op">=</span> {<span class="st">&#39;city&#39;</span>: <span class="st">&#39;San Francisco&#39;</span>, <span class="st">&#39;population&#39;</span>: <span class="dv">881549</span>, <span class="st">&#39;coordinates&#39;</span>: (<span class="op">-</span><span class="fl">122.4194</span>, <span class="fl">37.7749</span>) }</span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" tabindex="-1"></a><span class="cf">for</span> x, y <span class="kw">in</span> data.items():</span>
<span id="cb57-4"><a href="#cb57-4" tabindex="-1"></a>    <span class="bu">print</span>(x, y)</span></code></pre></div>
<p>The built-in <code>range()</code> function allows you to create
sequence of numbers that you can iterate over</p>
<div class="sourceCode" id="cb58"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>):</span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a>    <span class="bu">print</span>(x)</span></code></pre></div>
<p>The range function can also take a start and an end number</p>
<div class="sourceCode" id="cb59"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">2</span>):</span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a>    <span class="bu">print</span>(x)</span></code></pre></div>
</div>
<div id="conditionals" class="section level2">
<h2>Conditionals</h2>
<p>Python supports logical conditions such as equals, not equals,
greater than etc. These conditions can be used in several ways, most
commonly in <em>if statements</em> and loops.</p>
<p>An <em>if statement</em> is written by using the <code>if</code>
keyword.</p>
<p>Note: A very common error that programmers make is to use <em>=</em>
to evaluate a <em>equals to</em> condition. The <em>=</em> in Python
means assignment, not equals to. Always ensure that you use the
<em>==</em> for an equals to condition.</p>
<div class="sourceCode" id="cb60"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a><span class="cf">for</span> city <span class="kw">in</span> cities:</span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a>    <span class="cf">if</span> city <span class="op">==</span> <span class="st">&#39;Atlanta&#39;</span>:</span>
<span id="cb60-3"><a href="#cb60-3" tabindex="-1"></a>        <span class="bu">print</span>(city)</span></code></pre></div>
<p>You can use <code>else</code> keywords along with <code>if</code> to
match elements that do not meet the condition</p>
<div class="sourceCode" id="cb61"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a><span class="cf">for</span> city <span class="kw">in</span> cities:</span>
<span id="cb61-2"><a href="#cb61-2" tabindex="-1"></a>    <span class="cf">if</span> city <span class="op">==</span> <span class="st">&#39;Atlanta&#39;</span>:</span>
<span id="cb61-3"><a href="#cb61-3" tabindex="-1"></a>        <span class="bu">print</span>(city)</span>
<span id="cb61-4"><a href="#cb61-4" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb61-5"><a href="#cb61-5" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&#39;This is not Atlanta&#39;</span>)</span></code></pre></div>
<p>Python relies on indentation (whitespace at the beginning of a line)
to define scope in the for loop and if statements. So make sure your
code is properly indented.</p>
<p>You can evaluate a series of conditions using the <code>elif</code>
keyword.</p>
<p>Multiple criteria can be combined using the <code>and</code> and
<code>or</code> keywords.</p>
<div class="sourceCode" id="cb62"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a>cities_population <span class="op">=</span> {</span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a>    <span class="st">&#39;San Francisco&#39;</span>: <span class="dv">881549</span>,</span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a>    <span class="st">&#39;Los Angeles&#39;</span>: <span class="dv">3792621</span>,</span>
<span id="cb62-4"><a href="#cb62-4" tabindex="-1"></a>    <span class="st">&#39;New York&#39;</span>: <span class="dv">8175133</span>,</span>
<span id="cb62-5"><a href="#cb62-5" tabindex="-1"></a>    <span class="st">&#39;Atlanta&#39;</span>:<span class="dv">498044</span></span>
<span id="cb62-6"><a href="#cb62-6" tabindex="-1"></a>}</span>
<span id="cb62-7"><a href="#cb62-7" tabindex="-1"></a></span>
<span id="cb62-8"><a href="#cb62-8" tabindex="-1"></a><span class="cf">for</span> city, population <span class="kw">in</span> cities_population.items():</span>
<span id="cb62-9"><a href="#cb62-9" tabindex="-1"></a>    <span class="cf">if</span> population <span class="op">&lt;</span> <span class="dv">1000000</span>:</span>
<span id="cb62-10"><a href="#cb62-10" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&#39;</span><span class="sc">{}</span><span class="st"> is a small city&#39;</span>.<span class="bu">format</span>(city))</span>
<span id="cb62-11"><a href="#cb62-11" tabindex="-1"></a>    <span class="cf">elif</span> population <span class="op">&gt;</span> <span class="dv">1000000</span> <span class="kw">and</span> population <span class="op">&lt;</span> <span class="dv">5000000</span>:</span>
<span id="cb62-12"><a href="#cb62-12" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&#39;</span><span class="sc">{}</span><span class="st"> is a big city&#39;</span>.<span class="bu">format</span>(city))</span>
<span id="cb62-13"><a href="#cb62-13" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb62-14"><a href="#cb62-14" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&#39;</span><span class="sc">{}</span><span class="st"> is a mega city&#39;</span>.<span class="bu">format</span>(city))</span></code></pre></div>
</div>
<div id="control-statements" class="section level2">
<h2>Control Statements</h2>
<p>A for-loop iterates over each item in the sequence. Sometimes is
desirable to stop the execution, or skip certain parts of the for-loops.
Python has special statements, <code>break</code>, <code>continue</code>
and <code>pass</code>.</p>
<p>A <code>break</code> statement will stop the loop and exit out of
it</p>
<div class="sourceCode" id="cb63"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a><span class="cf">for</span> city <span class="kw">in</span> cities:</span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a>    <span class="bu">print</span>(city)</span>
<span id="cb63-3"><a href="#cb63-3" tabindex="-1"></a>    <span class="cf">if</span> city <span class="op">==</span> <span class="st">&#39;Los Angeles&#39;</span>:</span>
<span id="cb63-4"><a href="#cb63-4" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&#39;I found Los Angeles&#39;</span>)</span>
<span id="cb63-5"><a href="#cb63-5" tabindex="-1"></a>        <span class="cf">break</span></span></code></pre></div>
<p>A <code>continue</code> statement will skip the remaining part of the
loop and go to the next iteration</p>
<div class="sourceCode" id="cb64"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a><span class="cf">for</span> city <span class="kw">in</span> cities:</span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a>    <span class="cf">if</span> city <span class="op">==</span> <span class="st">&#39;Los Angeles&#39;</span>:</span>
<span id="cb64-3"><a href="#cb64-3" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb64-4"><a href="#cb64-4" tabindex="-1"></a>    <span class="bu">print</span>(city)</span></code></pre></div>
<p>A <code>pass</code> statement doesn’t do anything. It is useful when
some code is required to complete the syntax, but you do not want any
code to execute. It is typically used as a placeholder when a function
is not complete.</p>
<div class="sourceCode" id="cb65"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a><span class="cf">for</span> city <span class="kw">in</span> cities:</span>
<span id="cb65-2"><a href="#cb65-2" tabindex="-1"></a>    <span class="cf">if</span> city <span class="op">==</span> <span class="st">&#39;Los Angeles&#39;</span>:</span>
<span id="cb65-3"><a href="#cb65-3" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb65-4"><a href="#cb65-4" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb65-5"><a href="#cb65-5" tabindex="-1"></a>        <span class="bu">print</span>(city)</span></code></pre></div>
</div>
<div id="exercise-3" class="section level2">
<h2>Exercise</h2>
<p>The Fizz Buzz challenge.</p>
<p>Write a program that prints the numbers from 1 to 100 and for
multiples of 3 print <strong>Fizz</strong> instead of the number and for
the multiples of 5 print <strong>Buzz</strong>. If it is divisible by
both, print <strong>FizzBuzz</strong>.</p>
<p>So the output should be something like below</p>
<p><code>1, 2, Fizz, 4, Buzz, Fizz ... 13, 14, FizzBuzz, ...</code></p>
<p>Breaking down the problem further, we need to create for-loop with
following conditions</p>
<ul>
<li>If the number is a multiple of both 3 and 5 (i.e. 15), print
FizzBuzz</li>
<li>If the number is multiple of 3, print Fizz</li>
<li>If the number is multiple of 5, print Buzz</li>
<li>Otherwise print the number</li>
</ul>
<p>Hint: See the code cell below. Use the modulus operator
<strong>%</strong> to check if a number is divisible by another.
<code>10 % 5</code> equals 0, meaning it is divisible by 5.</p>
<div class="sourceCode" id="cb66"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">10</span>):</span>
<span id="cb66-2"><a href="#cb66-2" tabindex="-1"></a>    <span class="cf">if</span> x<span class="op">%</span><span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb66-3"><a href="#cb66-3" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&#39;</span><span class="sc">{}</span><span class="st"> is divisible by 2&#39;</span>.<span class="bu">format</span>(x))</span>
<span id="cb66-4"><a href="#cb66-4" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb66-5"><a href="#cb66-5" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&#39;</span><span class="sc">{}</span><span class="st"> is not divisible by 2&#39;</span>.<span class="bu">format</span>(x))</span></code></pre></div>
<hr />
<div style="page-break-after: always;"></div>
<p>Open the notebook named <code>05_functions.ipynb</code>.</p>
<p><a
href="https://www.youtube.com/watch?v=rcO29Q5Nd3Y&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=12"
target="_blank"><img
src="https://img.youtube.com/vi/rcO29Q5Nd3Y/mqdefault.jpg"
alt="Watch the Video" /></a></p>
<p><a
href="https://www.youtube.com/watch?v=rcO29Q5Nd3Y&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=12"
target="_blank">Watch the Video ↗</a></p>
<p><a
href="https://docs.google.com/presentation/d/1fFCOHSEPnGamcymzTZGE3Sc9lMJGo4tQ063leEyZMU8/edit?usp=sharing"
target="_blank">Access the Presentation ↗</a></p>
<hr />
</div>
</div>
<div id="functions" class="section level1">
<h1>Functions</h1>
<p>A function is a block of code that takes one or more <em>inputs</em>,
does some processing on them and returns one or more <em>outputs</em>.
The code within the function runs only when it is called.</p>
<p>A funtion is defined using the <code>def</code> keyword</p>
<pre><code>def my_function():
    ....
    ....
    return something</code></pre>
<p>Functions are useful because they allow us to capture the logic of
our code and we can run it with differnt inputs without having to write
the same code again and again.</p>
<div class="sourceCode" id="cb68"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a><span class="kw">def</span> greet(name):</span>
<span id="cb68-2"><a href="#cb68-2" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">&#39;Hello &#39;</span> <span class="op">+</span> name</span>
<span id="cb68-3"><a href="#cb68-3" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" tabindex="-1"></a><span class="bu">print</span>(greet(<span class="st">&#39;World&#39;</span>))</span></code></pre></div>
<p>Functions can take multiple arguments. Let’s write a function to
convert coordinates from degrees, minutes, seconds to decimal degrees.
This conversion is needed quite often when working with data collected
from GPS devices.</p>
<ul>
<li>1 degree is equal to 60 minutes</li>
<li>1 minute is equal to 60 seconds (3600 seconds)</li>
</ul>
<p>To calculate decimal degrees, we can use the formula below:</p>
<p>If degrees are positive:</p>
<p><code>Decimal Degrees = degrees + (minutes/60) + (seconds/3600)</code></p>
<p>If degrees are negative</p>
<p><code>Decimal Degrees = degrees - (minutes/60) - (seconds/3600)</code></p>
<div class="sourceCode" id="cb69"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a><span class="kw">def</span> dms_to_decimal(degrees, minutes, seconds):</span>
<span id="cb69-2"><a href="#cb69-2" tabindex="-1"></a>    <span class="cf">if</span> degrees <span class="op">&lt;</span> <span class="dv">0</span>:</span>
<span id="cb69-3"><a href="#cb69-3" tabindex="-1"></a>        result <span class="op">=</span> degrees <span class="op">-</span> minutes<span class="op">/</span><span class="dv">60</span> <span class="op">-</span> seconds<span class="op">/</span><span class="dv">3600</span></span>
<span id="cb69-4"><a href="#cb69-4" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb69-5"><a href="#cb69-5" tabindex="-1"></a>        result <span class="op">=</span> degrees <span class="op">+</span> minutes<span class="op">/</span><span class="dv">60</span> <span class="op">+</span> seconds<span class="op">/</span><span class="dv">3600</span></span>
<span id="cb69-6"><a href="#cb69-6" tabindex="-1"></a>    <span class="cf">return</span> result</span></code></pre></div>
<div class="sourceCode" id="cb70"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a>output <span class="op">=</span> dms_to_decimal(<span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">10</span>)</span>
<span id="cb70-2"><a href="#cb70-2" tabindex="-1"></a><span class="bu">print</span>(output)</span></code></pre></div>
<div id="exercise-4" class="section level2">
<h2>Exercise</h2>
<p>Given a coordinate string with value in degree, minutes and seconds,
convert it to decimal degrees by calling the <code>dms_to_decimal</code>
function.</p>
<div class="sourceCode" id="cb71"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a><span class="kw">def</span> dms_to_decimal(degrees, minutes, seconds):</span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a>    <span class="cf">if</span> degrees <span class="op">&lt;</span> <span class="dv">0</span>:</span>
<span id="cb71-3"><a href="#cb71-3" tabindex="-1"></a>        result <span class="op">=</span> degrees <span class="op">-</span> minutes<span class="op">/</span><span class="dv">60</span> <span class="op">-</span> seconds<span class="op">/</span><span class="dv">3600</span></span>
<span id="cb71-4"><a href="#cb71-4" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb71-5"><a href="#cb71-5" tabindex="-1"></a>        result <span class="op">=</span> degrees <span class="op">+</span> minutes<span class="op">/</span><span class="dv">60</span> <span class="op">+</span> seconds<span class="op">/</span><span class="dv">3600</span></span>
<span id="cb71-6"><a href="#cb71-6" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb71-7"><a href="#cb71-7" tabindex="-1"></a></span>
<span id="cb71-8"><a href="#cb71-8" tabindex="-1"></a>coordinate <span class="op">=</span> <span class="st">&#39;&#39;&#39;37° 46&#39; 26.2992&quot;&#39;&#39;&#39;</span></span>
<span id="cb71-9"><a href="#cb71-9" tabindex="-1"></a></span>
<span id="cb71-10"><a href="#cb71-10" tabindex="-1"></a><span class="co"># Add the code below to extract the parts from the coordinate string,</span></span>
<span id="cb71-11"><a href="#cb71-11" tabindex="-1"></a><span class="co"># call the function to convert to decimal degrees and print the result</span></span>
<span id="cb71-12"><a href="#cb71-12" tabindex="-1"></a><span class="co"># The expected answer is 37.773972</span></span></code></pre></div>
<div class="sourceCode" id="cb72"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a><span class="co"># Hint: Converting strings to numbers</span></span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a><span class="co"># When you extract the parts from the coordinate string, they are strings</span></span>
<span id="cb72-3"><a href="#cb72-3" tabindex="-1"></a><span class="co"># You will need to use the built-in int() / float() functions to</span></span>
<span id="cb72-4"><a href="#cb72-4" tabindex="-1"></a><span class="co"># convert them to numbers</span></span>
<span id="cb72-5"><a href="#cb72-5" tabindex="-1"></a>x <span class="op">=</span> <span class="st">&#39;25&#39;</span></span>
<span id="cb72-6"><a href="#cb72-6" tabindex="-1"></a><span class="bu">print</span>(x, <span class="bu">type</span>(x))</span>
<span id="cb72-7"><a href="#cb72-7" tabindex="-1"></a>y <span class="op">=</span> <span class="bu">int</span>(x)</span>
<span id="cb72-8"><a href="#cb72-8" tabindex="-1"></a><span class="bu">print</span>(y, <span class="bu">type</span>(y))</span></code></pre></div>
<p><em>Challenge</em>: Once you are done with the exercise, you can
attempt this challenge. Can you implement a function
<code>decimal_to_dms()</code> which does the reverse operation?
i.e. convert decimal degrees to degrees,minutes and seconds?</p>
<hr />
<div style="page-break-after: always;"></div>
<p>Open the notebook named <code>06_standard_library.ipynb</code>.</p>
<p><a
href="https://www.youtube.com/watch?v=kgY2npOQFM8&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=14"
target="_blank"><img
src="https://img.youtube.com/vi/kgY2npOQFM8/mqdefault.jpg"
alt="Watch the Video" /></a></p>
<p><a
href="https://www.youtube.com/watch?v=kgY2npOQFM8&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=14"
target="_blank">Watch the Video ↗</a></p>
<hr />
</div>
</div>
<div id="the-python-standard-library" class="section level1">
<h1>The Python Standard Library</h1>
<p>Python comes with many built-in modules that offer ready-to-use
solutions to common programming problems. To use these modules, you must
use the <code>import</code> keyword. Once imported in your Python
script, you can use the functions provided by the module in your
script.</p>
<p>We will use the built-in <code>math</code> module that allows us to
use advanced mathematical functions.</p>
<div class="sourceCode" id="cb73"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a><span class="im">import</span> math</span></code></pre></div>
<p>You can also import specific functions or constants from the module
like below</p>
<div class="sourceCode" id="cb74"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> pi</span>
<span id="cb74-2"><a href="#cb74-2" tabindex="-1"></a><span class="bu">print</span>(pi)</span></code></pre></div>
<div id="calculating-distance" class="section level2">
<h2>Calculating Distance</h2>
<p>Given 2 points with their Latitude and Longitude coordinates, the
Haversine Formula calculates the straight-line distance in meters,
assuming that Earth is a sphere.</p>
<p>The formula is simple enough to be implemented in a spreadsheet too.
If you are curious, see <a
href="https://spatialthoughts.com/2013/07/06/calculate-distance-spreadsheet/">my
post</a> about using this formula for calculating distances in a
spreadsheet.</p>
<p>We can write a function that accepts a pair of origin and destination
coordinates and computes the distance.</p>
<div class="sourceCode" id="cb75"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a>san_francisco <span class="op">=</span> (<span class="fl">37.7749</span>, <span class="op">-</span><span class="fl">122.4194</span>)</span>
<span id="cb75-2"><a href="#cb75-2" tabindex="-1"></a>new_york <span class="op">=</span> (<span class="fl">40.661</span>, <span class="op">-</span><span class="fl">73.944</span>)</span></code></pre></div>
<div class="sourceCode" id="cb76"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a><span class="kw">def</span> haversine_distance(origin, destination):</span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a>  lat1, lon1 <span class="op">=</span> origin</span>
<span id="cb76-3"><a href="#cb76-3" tabindex="-1"></a>  lat2, lon2 <span class="op">=</span> destination</span>
<span id="cb76-4"><a href="#cb76-4" tabindex="-1"></a>  radius <span class="op">=</span> <span class="dv">6371000</span></span>
<span id="cb76-5"><a href="#cb76-5" tabindex="-1"></a>  dlat <span class="op">=</span> math.radians(lat2<span class="op">-</span>lat1)</span>
<span id="cb76-6"><a href="#cb76-6" tabindex="-1"></a>  dlon <span class="op">=</span> math.radians(lon2<span class="op">-</span>lon1)</span>
<span id="cb76-7"><a href="#cb76-7" tabindex="-1"></a>  a <span class="op">=</span> math.sin(dlat<span class="op">/</span><span class="dv">2</span>) <span class="op">*</span> math.sin(dlat<span class="op">/</span><span class="dv">2</span>) <span class="op">+</span> math.cos(math.radians(lat1)) <span class="op">\</span></span>
<span id="cb76-8"><a href="#cb76-8" tabindex="-1"></a>    <span class="op">*</span> math.cos(math.radians(lat2)) <span class="op">*</span> math.sin(dlon<span class="op">/</span><span class="dv">2</span>) <span class="op">*</span> math.sin(dlon<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb76-9"><a href="#cb76-9" tabindex="-1"></a>  c <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> math.atan2(math.sqrt(a), math.sqrt(<span class="dv">1</span><span class="op">-</span>a))</span>
<span id="cb76-10"><a href="#cb76-10" tabindex="-1"></a>  distance <span class="op">=</span> radius <span class="op">*</span> c</span>
<span id="cb76-11"><a href="#cb76-11" tabindex="-1"></a>  <span class="cf">return</span> distance</span></code></pre></div>
<div class="sourceCode" id="cb77"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a>distance <span class="op">=</span> haversine_distance(san_francisco, new_york)</span>
<span id="cb77-2"><a href="#cb77-2" tabindex="-1"></a><span class="bu">print</span>(distance<span class="op">/</span><span class="dv">1000</span>, <span class="st">&#39;km&#39;</span>)</span></code></pre></div>
</div>
<div id="discover-python-easter-eggs" class="section level2">
<h2>Discover Python Easter Eggs</h2>
<p>Programmers love to hide secret jokes in their programs for gun.
These are known as <em>Easter Eggs</em>. Python has an easter egg that
you can see when you try to import the module named <code>this</code>.
Try writing the command <code>import this</code> below.</p>
<div class="sourceCode" id="cb78"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a><span class="im">import</span> this</span></code></pre></div>
<p>Let’s try one more. Try importing the <code>antigravity</code>
module.</p>
<p>Here’s a complete list of <a
href="https://towardsdatascience.com/7-easter-eggs-in-python-7765dc15a203">easter
eggs in Python</a>.</p>
</div>
<div id="exercise-5" class="section level2">
<h2>Exercise</h2>
<p>Find the coordinates of 2 cities near you and calculate the distance
between them by calling the <code>haversine_distance</code> function
below.</p>
<div class="sourceCode" id="cb79"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb79-2"><a href="#cb79-2" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" tabindex="-1"></a><span class="kw">def</span> haversine_distance(origin, destination):</span>
<span id="cb79-4"><a href="#cb79-4" tabindex="-1"></a>  lat1, lon1 <span class="op">=</span> origin</span>
<span id="cb79-5"><a href="#cb79-5" tabindex="-1"></a>  lat2, lon2 <span class="op">=</span> destination</span>
<span id="cb79-6"><a href="#cb79-6" tabindex="-1"></a>  radius <span class="op">=</span> <span class="dv">6371000</span></span>
<span id="cb79-7"><a href="#cb79-7" tabindex="-1"></a>  dlat <span class="op">=</span> math.radians(lat2<span class="op">-</span>lat1)</span>
<span id="cb79-8"><a href="#cb79-8" tabindex="-1"></a>  dlon <span class="op">=</span> math.radians(lon2<span class="op">-</span>lon1)</span>
<span id="cb79-9"><a href="#cb79-9" tabindex="-1"></a>  a <span class="op">=</span> math.sin(dlat<span class="op">/</span><span class="dv">2</span>) <span class="op">*</span> math.sin(dlat<span class="op">/</span><span class="dv">2</span>) <span class="op">+</span> math.cos(math.radians(lat1)) <span class="op">\</span></span>
<span id="cb79-10"><a href="#cb79-10" tabindex="-1"></a>    <span class="op">*</span> math.cos(math.radians(lat2)) <span class="op">*</span> math.sin(dlon<span class="op">/</span><span class="dv">2</span>) <span class="op">*</span> math.sin(dlon<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb79-11"><a href="#cb79-11" tabindex="-1"></a>  c <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> math.atan2(math.sqrt(a), math.sqrt(<span class="dv">1</span><span class="op">-</span>a))</span>
<span id="cb79-12"><a href="#cb79-12" tabindex="-1"></a>  distance <span class="op">=</span> radius <span class="op">*</span> c</span>
<span id="cb79-13"><a href="#cb79-13" tabindex="-1"></a>  <span class="cf">return</span> distance</span>
<span id="cb79-14"><a href="#cb79-14" tabindex="-1"></a></span>
<span id="cb79-15"><a href="#cb79-15" tabindex="-1"></a><span class="co"># city1 = (lat1, lng1)</span></span>
<span id="cb79-16"><a href="#cb79-16" tabindex="-1"></a><span class="co"># city2 = (lat2, lng2)</span></span>
<span id="cb79-17"><a href="#cb79-17" tabindex="-1"></a><span class="co"># call the function and print the result</span></span></code></pre></div>
<hr />
<div style="page-break-after: always;"></div>
<p>Open the notebook named
<code>07_third_party_modules.ipynb</code>.</p>
<p><a
href="https://www.youtube.com/watch?v=BqBPWQt9PL0&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=16"
target="_blank"><img
src="https://img.youtube.com/vi/BqBPWQt9PL0/mqdefault.jpg"
alt="Watch the Video" /></a></p>
<p><a
href="https://www.youtube.com/watch?v=BqBPWQt9PL0&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=16"
target="_blank">Watch the Video ↗</a></p>
<hr />
</div>
</div>
<div id="third-party-modules" class="section level1">
<h1>Third-party Modules</h1>
<p>Python has a thriving ecosystem of third-party modules
(i.e. libraries or packages) available for you to install. There are
hundreds of thousands of such modules available for you to install and
use.</p>
<div id="installing-third-party-libraries" class="section level2">
<h2>Installing third-party libraries</h2>
<p>Python comes with a package manager called <code>pip</code>. It can
install all the packages listed at <a href="https://pypi.org/">PyPI
(Python Package Index)</a>. To install a package using pip, you need to
run a command like following in a Terminal or CMD prompt.</p>
<p><code>pip install &lt;package name&gt;</code></p>
<p>For this course, we are using Anancoda platform - which comes with
its own package manager called <code>conda</code>. You can use Anaconda
Navigator to search and install packages. Or run the command like
following in a Terminal or CMD Prompt.</p>
<p><code>conda install &lt;package name&gt;</code></p>
<p>See this <a
href="https://www.anaconda.com/blog/understanding-conda-and-pip">comparison
of pip and conda</a> to understand the differences.</p>
<p>You may also use <a
href="https://mamba.readthedocs.io/en/latest/index.html">Mamba</a> as an
alternate open-source package manager that is fully compatible with
conda.</p>
</div>
<div id="calculating-distance-1" class="section level2">
<h2>Calculating Distance</h2>
<p>We have already installed the <code>geopy</code> package in our
environment. <code>geopy</code> comes with functions that have already
implemented many distance calculation formulae.</p>
<ul>
<li><code>distance.great_circle()</code>: Calculates the distance on a
great circle using haversine formula</li>
<li><code>distance.geodesic()</code>: Calculates the distance using a
chosen ellipsoid using vincenty’s formula</li>
</ul>
<div class="sourceCode" id="cb80"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a><span class="im">from</span> geopy <span class="im">import</span> distance</span>
<span id="cb80-2"><a href="#cb80-2" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" tabindex="-1"></a>san_francisco <span class="op">=</span> (<span class="fl">37.7749</span>, <span class="op">-</span><span class="fl">122.4194</span>)</span>
<span id="cb80-4"><a href="#cb80-4" tabindex="-1"></a>new_york <span class="op">=</span> (<span class="fl">40.661</span>, <span class="op">-</span><span class="fl">73.944</span>)</span>
<span id="cb80-5"><a href="#cb80-5" tabindex="-1"></a></span>
<span id="cb80-6"><a href="#cb80-6" tabindex="-1"></a>straight_line_distance <span class="op">=</span> distance.great_circle(san_francisco, new_york)</span>
<span id="cb80-7"><a href="#cb80-7" tabindex="-1"></a>ellipsoid_distance <span class="op">=</span> distance.geodesic(san_francisco, new_york, ellipsoid<span class="op">=</span><span class="st">&#39;WGS-84&#39;</span>)</span>
<span id="cb80-8"><a href="#cb80-8" tabindex="-1"></a></span>
<span id="cb80-9"><a href="#cb80-9" tabindex="-1"></a><span class="bu">print</span>(straight_line_distance, ellipsoid_distance)</span></code></pre></div>
</div>
<div id="exercise-6" class="section level2">
<h2>Exercise</h2>
<p>Repeat the distance calculation exercise from the previous module but
perform the calculation using the geopy library.</p>
<div class="sourceCode" id="cb81"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a><span class="im">from</span> geopy <span class="im">import</span> distance</span>
<span id="cb81-2"><a href="#cb81-2" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" tabindex="-1"></a><span class="co"># city1 = (lat1, lng1)</span></span>
<span id="cb81-4"><a href="#cb81-4" tabindex="-1"></a><span class="co"># city2 = (lat2, lng2)</span></span>
<span id="cb81-5"><a href="#cb81-5" tabindex="-1"></a><span class="co"># call the geopy distance function and print the great circle and ellipsoid distance</span></span></code></pre></div>
<hr />
<div style="page-break-after: always;"></div>
<p>Open the notebook named <code>08_using_web_apis.ipynb</code>.</p>
<p><a
href="https://www.youtube.com/watch?v=WBip-hbQYnM&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=18"
target="_blank"><img
src="https://img.youtube.com/vi/WBip-hbQYnM/mqdefault.jpg"
alt="Watch the Video" /></a></p>
<p><a
href="https://www.youtube.com/watch?v=WBip-hbQYnM&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=18"
target="_blank">Watch the Video ↗</a></p>
<hr />
</div>
</div>
<div id="using-web-apis" class="section level1">
<h1>Using Web APIs</h1>
<p>An API, or Application Program Interface, allows one program to
<em>talk</em> to another program. Many websites or services provide an
API so you can query for information in an automated way.</p>
<p>For mapping and spatial analysis, being able to use APIs is critical.
For the longest time, Google Maps API was the most popular API on the
web. APIs allow you to query web servers and get results without
downloading data or running computation on your machine.</p>
<p>Common use cases for using APIs for spatial analysis are</p>
<ul>
<li>Getting directions / routing</li>
<li>Route optimization</li>
<li>Geocoding</li>
<li>Downloading data</li>
<li>Getting real-time weather data</li>
<li>…</li>
</ul>
<p>The provide of such APIs have many ways to implement an API. There
are standards such as REST, SOAP, GraphQL etc. <em>REST</em> is the most
populat standard for web APIs, and for geospatial APIs. REST APIs are
used over HTTP and thus called web APIs.</p>
<div id="understanding-json-and-geojson" class="section level2">
<h2>Understanding JSON and GeoJSON</h2>
<p>JSON stands for <strong>J</strong>ava<strong>S</strong>cript
<strong>O</strong>bject <strong>N</strong>otation. It is a format for
storing and transporting data, and is the de-facto standard for data
exchanged by APIs. GeoJSON is an extension of the JSON format that is
commonly used to represent spatial data.</p>
<p>Python has a built-in <code>json</code> module that has methods for
reading json data and converting it to Python objects, and vice-versa.
In this example, we are using the <code>requests</code> module for
querying the API which conveniently does the conversion for us. But it
is useful to learn the basics of working with JSON in Python.</p>
<p>The GeoJSON data contains <em>features</em>, where each feature has
some <em>properties</em> and a <em>geometry</em>.</p>
<div class="sourceCode" id="cb82"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a>geojson_string <span class="op">=</span> <span class="st">&#39;&#39;&#39;</span></span>
<span id="cb82-2"><a href="#cb82-2" tabindex="-1"></a><span class="st">{</span></span>
<span id="cb82-3"><a href="#cb82-3" tabindex="-1"></a><span class="st">  &quot;type&quot;: &quot;FeatureCollection&quot;,</span></span>
<span id="cb82-4"><a href="#cb82-4" tabindex="-1"></a><span class="st">  &quot;features&quot;: [</span></span>
<span id="cb82-5"><a href="#cb82-5" tabindex="-1"></a><span class="st">    {&quot;type&quot;: &quot;Feature&quot;,</span></span>
<span id="cb82-6"><a href="#cb82-6" tabindex="-1"></a><span class="st">      &quot;properties&quot;: {&quot;name&quot;: &quot;San Francisco&quot;},</span></span>
<span id="cb82-7"><a href="#cb82-7" tabindex="-1"></a><span class="st">      &quot;geometry&quot;: {&quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [-121.5687, 37.7739]}</span></span>
<span id="cb82-8"><a href="#cb82-8" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb82-9"><a href="#cb82-9" tabindex="-1"></a><span class="st">  ]</span></span>
<span id="cb82-10"><a href="#cb82-10" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb82-11"><a href="#cb82-11" tabindex="-1"></a><span class="st">&#39;&#39;&#39;</span></span>
<span id="cb82-12"><a href="#cb82-12" tabindex="-1"></a><span class="bu">print</span>(geojson_string)</span></code></pre></div>
<p>To convert a JSON string to a Python object (i.e. parsing JSON), we
can use the <code>json.loads()</code> method.</p>
<div class="sourceCode" id="cb83"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb83-2"><a href="#cb83-2" tabindex="-1"></a></span>
<span id="cb83-3"><a href="#cb83-3" tabindex="-1"></a>data <span class="op">=</span> json.loads(geojson_string)</span>
<span id="cb83-4"><a href="#cb83-4" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(data))</span>
<span id="cb83-5"><a href="#cb83-5" tabindex="-1"></a><span class="bu">print</span>(data)</span></code></pre></div>
<p>Now that we have <em>parsed</em> the GeoJSON string and have a Python
object, we can extract infromation from it. The data is stored in a
<em>FeatureCollection</em> - which is a list of <em>features</em>. In
our example, we have just 1 feature inside the feature collection, so we
can access it by using index <strong>0</strong>.</p>
<div class="sourceCode" id="cb84"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a>city_data <span class="op">=</span> data[<span class="st">&#39;features&#39;</span>][<span class="dv">0</span>]</span>
<span id="cb84-2"><a href="#cb84-2" tabindex="-1"></a><span class="bu">print</span>(city_data)</span></code></pre></div>
<p>The feature representation is a dictionary, and individual items can
be accesses using the <em>keys</em></p>
<div class="sourceCode" id="cb85"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a>city_name <span class="op">=</span> city_data[<span class="st">&#39;properties&#39;</span>][<span class="st">&#39;name&#39;</span>]</span>
<span id="cb85-2"><a href="#cb85-2" tabindex="-1"></a>city_coordinates <span class="op">=</span> city_data[<span class="st">&#39;geometry&#39;</span>][<span class="st">&#39;coordinates&#39;</span>]</span>
<span id="cb85-3"><a href="#cb85-3" tabindex="-1"></a><span class="bu">print</span>(city_name, city_coordinates)</span></code></pre></div>
</div>
<div id="the-requests-module" class="section level2">
<h2>The <code>requests</code> module</h2>
<p>To query a server, we send a <strong>GET</strong> request with some
parameters and the server sends a response back. The
<code>requests</code> module allows you to send HTTP requests and parse
the responses using Python.</p>
<p>The response contains the data received from the server. It contains
the HTTP <em>status_code</em> which tells us if the request was
successful. HTTP code 200 stands for <em>Sucess OK</em>.</p>
<div class="sourceCode" id="cb86"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb86-2"><a href="#cb86-2" tabindex="-1"></a></span>
<span id="cb86-3"><a href="#cb86-3" tabindex="-1"></a>response <span class="op">=</span> requests.get(<span class="st">&#39;https://www.spatialthoughts.com&#39;</span>)</span>
<span id="cb86-4"><a href="#cb86-4" tabindex="-1"></a></span>
<span id="cb86-5"><a href="#cb86-5" tabindex="-1"></a><span class="bu">print</span>(response.status_code)</span></code></pre></div>
</div>
<div id="calculating-distance-using-openrouteservice-api"
class="section level2">
<h2>Calculating Distance using OpenRouteService API</h2>
<p><img
src="https://github.com/spatialthoughts/python-foundation-web/blob/master/images/python_foundation/ors_direction.png?raw=1" /></p>
<p><a href="https://openrouteservice.org/">OpenRouteService (ORS)</a>
provides a free API for routing, distance matrix, geocoding, route
optimization etc. using OpenStreetMap data. We will learn how to use
this API through Python and get real-world distance between cities.</p>
<p>Almost all APIs require you to sign-up and obtain a <em>key</em>. The
<em>key</em> is used to identify you and enforce usage limits so that
you do not overwhelm the servers. We will obtain a key from
OpenRouteService so we can use their API.</p>
<p>The API is maintained by HeiGIT (Heidelberg Institute for
Geoinformation Technology). Visit <a
href="https://account.heigit.org/signup">HeiGIT Sign Up page</a> and
create an account. Once your account is activated, visit your Dashboard
and copy the long string displayed under <em>Basic Key</em> and enter
below.</p>
<div class="sourceCode" id="cb87"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a>ORS_API_KEY <span class="op">=</span> <span class="st">&#39;replace this with your key&#39;</span></span></code></pre></div>
<p>We will use the OpenRouteServices’s <a
href="https://openrouteservice.org/dev/#/api-docs/v2/directions/%7Bprofile%7D/get">Directions
Service</a>. This service returns the driving, biking or walking
directions between the given origin and destination points.</p>
<div class="sourceCode" id="cb88"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb88-2"><a href="#cb88-2" tabindex="-1"></a></span>
<span id="cb88-3"><a href="#cb88-3" tabindex="-1"></a>san_francisco <span class="op">=</span> (<span class="fl">37.7749</span>, <span class="op">-</span><span class="fl">122.4194</span>)</span>
<span id="cb88-4"><a href="#cb88-4" tabindex="-1"></a>new_york <span class="op">=</span> (<span class="fl">40.661</span>, <span class="op">-</span><span class="fl">73.944</span>)</span>
<span id="cb88-5"><a href="#cb88-5" tabindex="-1"></a></span>
<span id="cb88-6"><a href="#cb88-6" tabindex="-1"></a>parameters <span class="op">=</span> {</span>
<span id="cb88-7"><a href="#cb88-7" tabindex="-1"></a>    <span class="st">&#39;api_key&#39;</span>: ORS_API_KEY,</span>
<span id="cb88-8"><a href="#cb88-8" tabindex="-1"></a>    <span class="st">&#39;start&#39;</span> : <span class="st">&#39;</span><span class="sc">{}</span><span class="st">,</span><span class="sc">{}</span><span class="st">&#39;</span>.<span class="bu">format</span>(san_francisco[<span class="dv">1</span>], san_francisco[<span class="dv">0</span>]),</span>
<span id="cb88-9"><a href="#cb88-9" tabindex="-1"></a>    <span class="st">&#39;end&#39;</span> : <span class="st">&#39;</span><span class="sc">{}</span><span class="st">,</span><span class="sc">{}</span><span class="st">&#39;</span>.<span class="bu">format</span>(new_york[<span class="dv">1</span>], new_york[<span class="dv">0</span>])</span>
<span id="cb88-10"><a href="#cb88-10" tabindex="-1"></a>}</span>
<span id="cb88-11"><a href="#cb88-11" tabindex="-1"></a></span>
<span id="cb88-12"><a href="#cb88-12" tabindex="-1"></a>response <span class="op">=</span> requests.get(</span>
<span id="cb88-13"><a href="#cb88-13" tabindex="-1"></a>    <span class="st">&#39;https://api.openrouteservice.org/v2/directions/driving-car&#39;</span>, params<span class="op">=</span>parameters)</span>
<span id="cb88-14"><a href="#cb88-14" tabindex="-1"></a></span>
<span id="cb88-15"><a href="#cb88-15" tabindex="-1"></a><span class="cf">if</span> response.status_code <span class="op">==</span> <span class="dv">200</span>:</span>
<span id="cb88-16"><a href="#cb88-16" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&#39;Request successful.&#39;</span>)</span>
<span id="cb88-17"><a href="#cb88-17" tabindex="-1"></a>    data <span class="op">=</span> response.json()</span>
<span id="cb88-18"><a href="#cb88-18" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb88-19"><a href="#cb88-19" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&#39;Request failed.&#39;</span>)</span></code></pre></div>
<p>We can read the <code>response</code> in JSON format by calling
<code>json()</code> method on it.</p>
<div class="sourceCode" id="cb89"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a>data <span class="op">=</span> response.json()</span></code></pre></div>
<p>The response is a GeoJSON object representing the driving direction
between the 2 points. The object is a feature collection with just 1
feature. We can access it using the index <strong>0</strong>. The
feature’s property contains <code>summary</code> information which has
the data we need.</p>
<div class="sourceCode" id="cb90"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a>summary <span class="op">=</span> data[<span class="st">&#39;features&#39;</span>][<span class="dv">0</span>][<span class="st">&#39;properties&#39;</span>][<span class="st">&#39;summary&#39;</span>]</span>
<span id="cb90-2"><a href="#cb90-2" tabindex="-1"></a><span class="bu">print</span>(summary)</span></code></pre></div>
<p>We can extract the <code>distance</code> and convert it to
kilometers.</p>
<div class="sourceCode" id="cb91"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a>distance <span class="op">=</span> summary[<span class="st">&#39;distance&#39;</span>]</span>
<span id="cb91-2"><a href="#cb91-2" tabindex="-1"></a><span class="bu">print</span>(distance<span class="op">/</span><span class="dv">1000</span>)</span></code></pre></div>
<p>You can compare this distance to the straight-line distance and see
the difference.</p>
</div>
<div id="exercise-1-1" class="section level2">
<h2>Exercise 1</h2>
<p>Replace the <code>ORS_API_KEY</code> with your own key in the code
below. Change the cities with your chosen cities and run the cell to see
the summary of driving directions. Extract the values for
<code>distance</code> (meters) and <code>duration</code> (seconds).
Convert and print the driving distance in km and driving time in
minutes.</p>
<div class="sourceCode" id="cb92"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb92-2"><a href="#cb92-2" tabindex="-1"></a></span>
<span id="cb92-3"><a href="#cb92-3" tabindex="-1"></a>ORS_API_KEY <span class="op">=</span> <span class="st">&#39;replace this with your key&#39;</span></span>
<span id="cb92-4"><a href="#cb92-4" tabindex="-1"></a></span>
<span id="cb92-5"><a href="#cb92-5" tabindex="-1"></a>san_francisco <span class="op">=</span> (<span class="fl">37.7749</span>, <span class="op">-</span><span class="fl">122.4194</span>)</span>
<span id="cb92-6"><a href="#cb92-6" tabindex="-1"></a>new_york <span class="op">=</span> (<span class="fl">40.661</span>, <span class="op">-</span><span class="fl">73.944</span>)</span>
<span id="cb92-7"><a href="#cb92-7" tabindex="-1"></a></span>
<span id="cb92-8"><a href="#cb92-8" tabindex="-1"></a>parameters <span class="op">=</span> {</span>
<span id="cb92-9"><a href="#cb92-9" tabindex="-1"></a>    <span class="st">&#39;api_key&#39;</span>: ORS_API_KEY,</span>
<span id="cb92-10"><a href="#cb92-10" tabindex="-1"></a>    <span class="st">&#39;start&#39;</span> : <span class="st">&#39;</span><span class="sc">{}</span><span class="st">,</span><span class="sc">{}</span><span class="st">&#39;</span>.<span class="bu">format</span>(san_francisco[<span class="dv">1</span>], san_francisco[<span class="dv">0</span>]),</span>
<span id="cb92-11"><a href="#cb92-11" tabindex="-1"></a>    <span class="st">&#39;end&#39;</span> : <span class="st">&#39;</span><span class="sc">{}</span><span class="st">,</span><span class="sc">{}</span><span class="st">&#39;</span>.<span class="bu">format</span>(new_york[<span class="dv">1</span>], new_york[<span class="dv">0</span>])</span>
<span id="cb92-12"><a href="#cb92-12" tabindex="-1"></a>}</span>
<span id="cb92-13"><a href="#cb92-13" tabindex="-1"></a></span>
<span id="cb92-14"><a href="#cb92-14" tabindex="-1"></a>response <span class="op">=</span> requests.get(</span>
<span id="cb92-15"><a href="#cb92-15" tabindex="-1"></a>    <span class="st">&#39;https://api.openrouteservice.org/v2/directions/driving-car&#39;</span>, params<span class="op">=</span>parameters)</span>
<span id="cb92-16"><a href="#cb92-16" tabindex="-1"></a></span>
<span id="cb92-17"><a href="#cb92-17" tabindex="-1"></a><span class="cf">if</span> response.status_code <span class="op">==</span> <span class="dv">200</span>:</span>
<span id="cb92-18"><a href="#cb92-18" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&#39;Request successful.&#39;</span>)</span>
<span id="cb92-19"><a href="#cb92-19" tabindex="-1"></a>    data <span class="op">=</span> response.json()</span>
<span id="cb92-20"><a href="#cb92-20" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb92-21"><a href="#cb92-21" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&#39;Request failed.&#39;</span>)</span>
<span id="cb92-22"><a href="#cb92-22" tabindex="-1"></a></span>
<span id="cb92-23"><a href="#cb92-23" tabindex="-1"></a>data <span class="op">=</span> response.json()</span>
<span id="cb92-24"><a href="#cb92-24" tabindex="-1"></a></span>
<span id="cb92-25"><a href="#cb92-25" tabindex="-1"></a>summary <span class="op">=</span> data[<span class="st">&#39;features&#39;</span>][<span class="dv">0</span>][<span class="st">&#39;properties&#39;</span>][<span class="st">&#39;summary&#39;</span>]</span>
<span id="cb92-26"><a href="#cb92-26" tabindex="-1"></a><span class="bu">print</span>(summary)</span></code></pre></div>
</div>
<div id="api-rate-limiting" class="section level2">
<h2>API Rate Limiting</h2>
<p>Many web APIs enforce <em>rate limiting</em> - allowing a limited
number of requests over time. With computers it is easy to write a for
loop, or have multiple programs send hundrends or thousands of queries
per second. The server may not be configured to handle such volume. So
the providers specify the limits on how many and how fast the queries
can be sent.</p>
<p>OpenRouteService lists several <a
href="https://openrouteservice.org/plans/">API Restrictions</a>. The
free plan allows for upto 40 direction requests/minute.</p>
<p>There are many libraries available to implement various strategies
for rate limiting. But we can use the built-in <code>time</code> module
to implement a very simple rate limiting method.</p>
<div id="the-time-module" class="section level3">
<h3>The <code>time</code> module</h3>
<p>Python Standard Library has a <code>time</code> module that allows
for time related operation. It contains a method
<code>time.sleep()</code> which delays the execution of the program for
the specified number of seconds.</p>
<div class="sourceCode" id="cb93"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb93-2"><a href="#cb93-2" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>):</span>
<span id="cb93-3"><a href="#cb93-3" tabindex="-1"></a>    <span class="bu">print</span>(x)</span>
<span id="cb93-4"><a href="#cb93-4" tabindex="-1"></a>    time.sleep(<span class="dv">1</span>)</span></code></pre></div>
</div>
</div>
<div id="exercise-2-1" class="section level2">
<h2>Exercise 2</h2>
<p>Below cell contains a dictionary with 3 destination cities and their
coordinates. Write a <code>for</code> loop to iterate over the
<code>destination_cities</code> dictionary and call
<code>get_driving_distance()</code> function to print real driving
distance between San Fransico and each city. Rate limit your queries by
adding <code>time.sleep(2)</code> between successive function calls.
Make sure to replace the <code>ORS_API_KEY</code> value with your own
key.</p>
<div class="sourceCode" id="cb94"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb94-2"><a href="#cb94-2" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb94-3"><a href="#cb94-3" tabindex="-1"></a></span>
<span id="cb94-4"><a href="#cb94-4" tabindex="-1"></a>ORS_API_KEY <span class="op">=</span> <span class="st">&#39;replace this with your key&#39;</span></span>
<span id="cb94-5"><a href="#cb94-5" tabindex="-1"></a></span>
<span id="cb94-6"><a href="#cb94-6" tabindex="-1"></a><span class="kw">def</span> get_driving_distance(source_coordinates, dest_coordinates):</span>
<span id="cb94-7"><a href="#cb94-7" tabindex="-1"></a>    parameters <span class="op">=</span> {</span>
<span id="cb94-8"><a href="#cb94-8" tabindex="-1"></a>    <span class="st">&#39;api_key&#39;</span>: ORS_API_KEY,</span>
<span id="cb94-9"><a href="#cb94-9" tabindex="-1"></a>    <span class="st">&#39;start&#39;</span> : <span class="st">&#39;</span><span class="sc">{}</span><span class="st">,</span><span class="sc">{}</span><span class="st">&#39;</span>.<span class="bu">format</span>(source_coordinates[<span class="dv">1</span>], source_coordinates[<span class="dv">0</span>]),</span>
<span id="cb94-10"><a href="#cb94-10" tabindex="-1"></a>    <span class="st">&#39;end&#39;</span> : <span class="st">&#39;</span><span class="sc">{}</span><span class="st">,</span><span class="sc">{}</span><span class="st">&#39;</span>.<span class="bu">format</span>(dest_coordinates[<span class="dv">1</span>], dest_coordinates[<span class="dv">0</span>])</span>
<span id="cb94-11"><a href="#cb94-11" tabindex="-1"></a>    }</span>
<span id="cb94-12"><a href="#cb94-12" tabindex="-1"></a></span>
<span id="cb94-13"><a href="#cb94-13" tabindex="-1"></a>    response <span class="op">=</span> requests.get(</span>
<span id="cb94-14"><a href="#cb94-14" tabindex="-1"></a>        <span class="st">&#39;https://api.openrouteservice.org/v2/directions/driving-car&#39;</span>, params<span class="op">=</span>parameters)</span>
<span id="cb94-15"><a href="#cb94-15" tabindex="-1"></a></span>
<span id="cb94-16"><a href="#cb94-16" tabindex="-1"></a>    <span class="cf">if</span> response.status_code <span class="op">==</span> <span class="dv">200</span>:</span>
<span id="cb94-17"><a href="#cb94-17" tabindex="-1"></a>        data <span class="op">=</span> response.json()</span>
<span id="cb94-18"><a href="#cb94-18" tabindex="-1"></a>        summary <span class="op">=</span> data[<span class="st">&#39;features&#39;</span>][<span class="dv">0</span>][<span class="st">&#39;properties&#39;</span>][<span class="st">&#39;summary&#39;</span>]</span>
<span id="cb94-19"><a href="#cb94-19" tabindex="-1"></a>        distance <span class="op">=</span> summary[<span class="st">&#39;distance&#39;</span>]</span>
<span id="cb94-20"><a href="#cb94-20" tabindex="-1"></a>        <span class="cf">return</span> distance<span class="op">/</span><span class="dv">1000</span></span>
<span id="cb94-21"><a href="#cb94-21" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb94-22"><a href="#cb94-22" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&#39;Request failed.&#39;</span>)</span>
<span id="cb94-23"><a href="#cb94-23" tabindex="-1"></a>        <span class="cf">return</span> <span class="op">-</span><span class="dv">9999</span></span>
<span id="cb94-24"><a href="#cb94-24" tabindex="-1"></a></span>
<span id="cb94-25"><a href="#cb94-25" tabindex="-1"></a>san_francisco <span class="op">=</span> (<span class="fl">37.7749</span>, <span class="op">-</span><span class="fl">122.4194</span>)</span>
<span id="cb94-26"><a href="#cb94-26" tabindex="-1"></a></span>
<span id="cb94-27"><a href="#cb94-27" tabindex="-1"></a>destination_cities <span class="op">=</span> {</span>
<span id="cb94-28"><a href="#cb94-28" tabindex="-1"></a>    <span class="st">&#39;Los Angeles&#39;</span>: (<span class="fl">34.0522</span>, <span class="op">-</span><span class="fl">118.2437</span>),</span>
<span id="cb94-29"><a href="#cb94-29" tabindex="-1"></a>    <span class="st">&#39;Boston&#39;</span>: (<span class="fl">42.3601</span>, <span class="op">-</span><span class="fl">71.0589</span>),</span>
<span id="cb94-30"><a href="#cb94-30" tabindex="-1"></a>    <span class="st">&#39;Atlanta&#39;</span>: (<span class="fl">33.7490</span>, <span class="op">-</span><span class="fl">84.3880</span>)</span>
<span id="cb94-31"><a href="#cb94-31" tabindex="-1"></a>}</span></code></pre></div>
<hr />
<div style="page-break-after: always;"></div>
<p>Open the notebook named <code>assignment.ipynb</code>.</p>
<p><a
href="https://www.youtube.com/watch?v=HaC3-y7c_F8&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=20"
target="_blank"><img
src="https://img.youtube.com/vi/HaC3-y7c_F8/mqdefault.jpg"
alt="Watch the Video" /></a></p>
<p><a
href="https://www.youtube.com/watch?v=HaC3-y7c_F8&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=20"
target="_blank">Watch the Video ↗</a></p>
<hr />
</div>
</div>
<div id="assignment" class="section level1">
<h1>Assignment</h1>
<p>Your assignment is to geocode the addresses given below using <a
href="https://geopy.readthedocs.io/en/stable/">GeoPy</a>. This
assignment is designed to help you practice your coding skills learnt in
the course so far.</p>
<div id="part-1" class="section level2">
<h2>Part 1</h2>
<p>You have been given a list containing 5 tuples of place names along
with their address. You need to use the <a
href="https://geopy.readthedocs.io/en/stable/#module-geopy.geocoders">Nominatim</a>
geocoder and obtain the latitude and longitude of each address.</p>
<div class="sourceCode" id="cb95"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a><span class="co"># List of Hurricane Evacuation Centers in New York City with Addresses</span></span>
<span id="cb95-2"><a href="#cb95-2" tabindex="-1"></a><span class="co"># Each item is a tuple with the name of the center and its address</span></span>
<span id="cb95-3"><a href="#cb95-3" tabindex="-1"></a>locations <span class="op">=</span> [</span>
<span id="cb95-4"><a href="#cb95-4" tabindex="-1"></a>    (<span class="st">&#39;Norman Thomas HS (ECF)&#39;</span>, <span class="st">&#39;111 E 33rd St, NYC, New York&#39;</span>),</span>
<span id="cb95-5"><a href="#cb95-5" tabindex="-1"></a>    (<span class="st">&#39;Midtown East Campus&#39;</span>, <span class="st">&#39;233 E 56th St, NYC, New York&#39;</span>),</span>
<span id="cb95-6"><a href="#cb95-6" tabindex="-1"></a>    (<span class="st">&#39;Louis D. Brandeis HS&#39;</span>, <span class="st">&#39;145 W 84th St, NYC, New York&#39;</span>),</span>
<span id="cb95-7"><a href="#cb95-7" tabindex="-1"></a>    (<span class="st">&#39;Martin Luther King, Jr. HS&#39;</span>, <span class="st">&#39;122 Amsterdam Avenue, NYC, New York&#39;</span>),</span>
<span id="cb95-8"><a href="#cb95-8" tabindex="-1"></a>    (<span class="st">&#39;P.S. 48&#39;</span>, <span class="st">&#39;4360 Broadway, NYC, New York&#39;</span>)</span>
<span id="cb95-9"><a href="#cb95-9" tabindex="-1"></a>]</span></code></pre></div>
<p>The expected output should be as follows</p>
<pre><code>[(&#39;Norman Thomas HS (ECF)&#39;, 40.7462177, -73.9809816),
 (&#39;Midtown East Campus&#39;, 40.65132465, -73.92421646290632),
 (&#39;Louis D. Brandeis HS&#39;, 40.7857432, -73.9742029),
 (&#39;Martin Luther King, Jr. HS&#39;, 40.7747751, -73.9853689),
 (&#39;P.S. 48&#39;, 40.8532731, -73.9338592)]</code></pre>
</div>
<div id="part-2" class="section level2">
<h2>Part 2</h2>
<p>Get a list of 5 addresses in your city and geocode them.</p>
<p>You can use Nominatim geocoder. Nominatim is based on OpenStreetMap
and the it’s geocoding quality varies from country to country. You can
visit <a href="https://openstreetmap.org/"
class="uri">https://openstreetmap.org/</a> and search for your address.
It uses Nominatim geocoder so you can check if your address is suitable
for this service.</p>
<p>Many countries of the world do not have structured addresses and use
informal or landmark based addresses. There are usually very difficult
to geocode accurately. If you are trying to geocode such addresses, your
best bet is to truncate the address at the street or locality level.</p>
<p>For example, an address like following will fail to geocode using
Nominatim</p>
<pre><code>Spatial Thoughts LLP,
FF 105, Aaradhya Complex,
Gala Gymkhana Road, Bopal,
Ahmedabad, India</code></pre>
<p>Instead, you may try to geocode the following</p>
<pre><code>Gala Gymkhana Road, Bopal, Ahmedabad, India</code></pre>
</div>
<div id="part-3" class="section level2">
<h2>Part 3</h2>
<p>Bonus Assignment (This part is optional)</p>
<p>Use an alternative geocoding service such as HERE/Bing/Google or a
country-specific service such as DataBC. Note that most commercial
geocoding services will require signing-up for an API key and may also
require setting up a billing account.</p>
<hr />
<div style="page-break-after: always;"></div>
<hr />
<p>Open the notebook named <code>common_errors.ipynb</code>.</p>
<p><a
href="https://www.youtube.com/watch?v=nMS_al2za3U&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=21"
target="_blank"><img
src="https://img.youtube.com/vi/nMS_al2za3U/mqdefault.jpg"
alt="Watch the Video" /></a></p>
<p><a
href="https://www.youtube.com/watch?v=nMS_al2za3U&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=21"
target="_blank">Watch the Video ↗</a></p>
<hr />
</div>
</div>
<div id="review-of-common-python-errors" class="section level1">
<h1>Review of Common Python Errors</h1>
<div class="sourceCode" id="cb99"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a><span class="bu">print</span>(Hello World)</span></code></pre></div>
<details>
Here, we are getting syntax error because we have missed quotes (’’) -
which is required to define any string(text).
</details>
<div class="sourceCode" id="cb100"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a>city <span class="op">=</span> <span class="st">&#39;San Francisco&#39;</span></span>
<span id="cb100-2"><a href="#cb100-2" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;city&#39;</span>)</span></code></pre></div>
<details>
The code above will not give any error but see what is it printing! So,
quotes should’t be there in case of printing a variable.
</details>
<div class="sourceCode" id="cb101"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a>elevation_feet <span class="op">=</span> <span class="st">&#39;934&#39;</span></span>
<span id="cb101-2"><a href="#cb101-2" tabindex="-1"></a>elevation_meters <span class="op">=</span> elevation_feet <span class="op">*</span> <span class="fl">0.3048</span></span>
<span id="cb101-3"><a href="#cb101-3" tabindex="-1"></a><span class="bu">print</span>(elevation_meters)</span></code></pre></div>
<details>
If we want to do mathematical operations, it is important to have
appropreate data type. In the above code we have stired ‘elevation_feet’
as a string(having quotes) and we want to multiply it with float(a
number with decimal) which is not possible.
</details>
<div class="sourceCode" id="cb102"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a>latitude <span class="op">=</span> <span class="fl">37.7739</span></span>
<span id="cb102-2"><a href="#cb102-2" tabindex="-1"></a>longitude <span class="op">=</span> <span class="op">-</span><span class="fl">121.5687</span></span>
<span id="cb102-3"><a href="#cb102-3" tabindex="-1"></a>coordinates <span class="op">=</span> (latitude, longitude)</span>
<span id="cb102-4"><a href="#cb102-4" tabindex="-1"></a><span class="bu">long</span> <span class="op">=</span> (coordinates[<span class="st">&#39;1&#39;</span>])</span></code></pre></div>
<details>
Index of the element in a list or a tupal should be of the type
‘integer’. Putting quotes or any floating number will give TypeError.
</details>
<div class="sourceCode" id="cb103"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" tabindex="-1"></a>data <span class="op">=</span> {place : <span class="st">&#39;San Francisco&#39;</span>, <span class="st">&#39;population&#39;</span>: <span class="dv">881549</span>, <span class="st">&#39;coordinates&#39;</span>: (<span class="op">-</span><span class="fl">122.4194</span>, <span class="fl">37.7749</span>) }</span>
<span id="cb103-2"><a href="#cb103-2" tabindex="-1"></a><span class="bu">print</span>(data)</span></code></pre></div>
<details>
We have not put the quotes around a key(place) in the dictionary. So it
is searching for a variable named ‘place’ which is not defined hence the
nameError.
</details>
<div class="sourceCode" id="cb104"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" tabindex="-1"></a>data <span class="op">=</span> {<span class="st">&#39;place&#39;</span> : <span class="st">&#39;San Francisco&#39;</span>, <span class="st">&#39;population&#39;</span>: <span class="dv">881549</span>, <span class="st">&#39;coordinates&#39;</span>: (<span class="op">-</span><span class="fl">122.4194</span>, <span class="fl">37.7749</span>) }</span>
<span id="cb104-2"><a href="#cb104-2" tabindex="-1"></a><span class="bu">print</span>(data[<span class="st">&#39;Place&#39;</span>])</span></code></pre></div>
<details>
In the print statement written above, We have wrongly written the
key(place). We are getting KeyError which means that there is no such
key.
</details>
<div class="sourceCode" id="cb105"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" tabindex="-1"></a>cities <span class="op">=</span> [<span class="st">&#39;San Francisco&#39;</span>, <span class="st">&#39;Los Angeles&#39;</span>, <span class="st">&#39;New York&#39;</span>, <span class="st">&#39;Atlanta&#39;</span>]</span>
<span id="cb105-2"><a href="#cb105-2" tabindex="-1"></a><span class="bu">print</span>(cities[<span class="dv">4</span>])</span></code></pre></div>
<details>
<p>Here, we are trying to extract 5th element of the list - which
doesn’t exist. (Remember counting starts from 0!)</p>
<div class="sourceCode" id="cb106"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" tabindex="-1"></a>cities.sort(reverse<span class="op">=</span>true)</span>
<span id="cb106-2"><a href="#cb106-2" tabindex="-1"></a><span class="bu">print</span>(cities)</span></code></pre></div>
<details>
Python Booleans take one of two values: True or False and are case
sensitive.
</details>
<div class="sourceCode" id="cb107"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" tabindex="-1"></a>cities <span class="op">=</span> [<span class="st">&#39;San Francisco&#39;</span>, <span class="st">&#39;Los Angeles&#39;</span>, <span class="st">&#39;New York&#39;</span>, <span class="st">&#39;Atlanta&#39;</span>]</span>
<span id="cb107-2"><a href="#cb107-2" tabindex="-1"></a>capitals <span class="op">=</span> [<span class="st">&#39;Sacramento&#39;</span>, <span class="st">&#39;Boston&#39;</span>, <span class="st">&#39;Austin&#39;</span>, <span class="st">&#39;Atlanta&#39;</span>]</span>
<span id="cb107-3"><a href="#cb107-3" tabindex="-1"></a>capitals_set <span class="op">=</span> <span class="bu">set</span>(capitals)</span>
<span id="cb107-4"><a href="#cb107-4" tabindex="-1"></a>cities_set <span class="op">=</span> <span class="bu">set</span>(cities)</span>
<span id="cb107-5"><a href="#cb107-5" tabindex="-1"></a>capital_cities <span class="op">=</span> capitals_set.Difference(cities_set)</span>
<span id="cb107-6"><a href="#cb107-6" tabindex="-1"></a><span class="bu">print</span>(capital_cities)</span></code></pre></div>
<details>
In the above code, variable ‘capitals_set’ is the object of type set.
Now, there there are few attributes of a set which doesn’t include
‘Intersection’. So we might have spelt it wrong or we are performing
some wrong operation here.
</details>
<div class="sourceCode" id="cb108"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a>path <span class="op">=</span> <span class="st">&#39;C:\Users</span><span class="ch">\v</span><span class="st">igna&#39;</span></span>
<span id="cb108-2"><a href="#cb108-2" tabindex="-1"></a><span class="bu">print</span>(path)</span></code></pre></div>
<details>
The ‘\’ is a special character and must be escaped.
</details>
<div class="sourceCode" id="cb109"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" tabindex="-1"></a>city <span class="op">=</span> <span class="st">&#39;San Fransico&#39;</span></span>
<span id="cb109-2"><a href="#cb109-2" tabindex="-1"></a>population <span class="op">=</span> <span class="dv">881549</span></span>
<span id="cb109-3"><a href="#cb109-3" tabindex="-1"></a>output <span class="op">=</span> <span class="st">&#39;Population of </span><span class="sc">{}</span><span class="st"> is </span><span class="sc">{}</span><span class="st">.&#39;</span>.<span class="bu">format</span>(city)</span>
<span id="cb109-4"><a href="#cb109-4" tabindex="-1"></a><span class="bu">print</span>(output)</span></code></pre></div>
<details>
This error is arising because there are no enough arguments provided
inside the format. So there is nothing to fill for second {} hence the
error for index 1.
</details>
<div class="sourceCode" id="cb110"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a>cities <span class="op">=</span> [<span class="st">&#39;San Francisco&#39;</span>, <span class="st">&#39;Los Angeles&#39;</span>, <span class="st">&#39;New York&#39;</span>, <span class="st">&#39;Atlanta&#39;</span>]</span>
<span id="cb110-2"><a href="#cb110-2" tabindex="-1"></a></span>
<span id="cb110-3"><a href="#cb110-3" tabindex="-1"></a><span class="cf">for</span> city <span class="kw">in</span> cities:</span>
<span id="cb110-4"><a href="#cb110-4" tabindex="-1"></a><span class="bu">print</span>(city)</span></code></pre></div>
<details>
If tabs/spaces are not proper anywhere in the code block, Python raises
the IndentationError error.
</details>
<div class="sourceCode" id="cb111"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" tabindex="-1"></a>cities <span class="op">=</span> [<span class="st">&#39;San Francisco&#39;</span>, <span class="st">&#39;Los Angeles&#39;</span>, <span class="st">&#39;New York&#39;</span>, <span class="st">&#39;Atlanta&#39;</span>]</span>
<span id="cb111-2"><a href="#cb111-2" tabindex="-1"></a><span class="cf">for</span> city <span class="kw">in</span> cities:</span>
<span id="cb111-3"><a href="#cb111-3" tabindex="-1"></a>    <span class="cf">if</span> city <span class="op">=</span> <span class="st">&#39;Atlanta&#39;</span>:</span>
<span id="cb111-4"><a href="#cb111-4" tabindex="-1"></a>        <span class="bu">print</span>(city)</span></code></pre></div>
<details>
If you want to select the city named ‘Atlanta’ by comparision, using ‘=’
instead of ‘==’ will give you syntax error. Code expects a condition in
the If statement but you are assigning a variable.
</details>
<div class="sourceCode" id="cb112"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" tabindex="-1"></a>cities <span class="op">=</span> [<span class="st">&#39;San Francisco&#39;</span>, <span class="st">&#39;Los Angeles&#39;</span>, <span class="st">&#39;New York&#39;</span>, <span class="st">&#39;Atlanta&#39;</span>]</span>
<span id="cb112-2"><a href="#cb112-2" tabindex="-1"></a></span>
<span id="cb112-3"><a href="#cb112-3" tabindex="-1"></a><span class="cf">for</span> city <span class="kw">in</span> cities:</span>
<span id="cb112-4"><a href="#cb112-4" tabindex="-1"></a>    <span class="cf">if</span> city <span class="op">==</span> <span class="st">&#39;Los Angeles&#39;</span>:</span>
<span id="cb112-5"><a href="#cb112-5" tabindex="-1"></a>        state <span class="op">==</span> <span class="st">&#39;California&#39;</span></span>
<span id="cb112-6"><a href="#cb112-6" tabindex="-1"></a></span>
<span id="cb112-7"><a href="#cb112-7" tabindex="-1"></a><span class="bu">print</span>(state)</span></code></pre></div>
<details>
Here the == operator is comparing the value of the variable
<code>state</code> with the text ‘California’. As we want to assign the
value to a new variable, the correct syntax is to use the = operator.
</details>
<div class="sourceCode" id="cb113"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb113-2"><a href="#cb113-2" tabindex="-1"></a><span class="im">import</span> pi</span></code></pre></div>
<details>
Importing the module and importing a function from the module are
different in python. Here, Pi is a function inside math so it can’t be
called using ‘import’. This error also arises because of spelling error
or incorrect letter case while importing a module.
</details>
<div class="sourceCode" id="cb114"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" tabindex="-1"></a><span class="kw">def</span> haversine_distance(origin, destination):</span>
<span id="cb114-2"><a href="#cb114-2" tabindex="-1"></a>  lat1, lon1 <span class="op">=</span> origin</span>
<span id="cb114-3"><a href="#cb114-3" tabindex="-1"></a>  lat2, lon2 <span class="op">=</span> destination</span>
<span id="cb114-4"><a href="#cb114-4" tabindex="-1"></a>  radius <span class="op">=</span> <span class="dv">6371000</span></span>
<span id="cb114-5"><a href="#cb114-5" tabindex="-1"></a>  dlat <span class="op">=</span> math.radians(lat2<span class="op">-</span>lat1)</span>
<span id="cb114-6"><a href="#cb114-6" tabindex="-1"></a>  dlon <span class="op">=</span> math.radians(lon2<span class="op">-</span>lon1)</span>
<span id="cb114-7"><a href="#cb114-7" tabindex="-1"></a>  a <span class="op">=</span> math.sin(dlat<span class="op">/</span><span class="dv">2</span>) <span class="op">*</span> math.sin(dlat<span class="op">/</span><span class="dv">2</span>) <span class="op">+</span> math.cos(math.radians(lat1)) <span class="op">\</span></span>
<span id="cb114-8"><a href="#cb114-8" tabindex="-1"></a>    <span class="op">*</span> math.cos(math.radians(lat2)) <span class="op">*</span> math.sin(dlon<span class="op">/</span><span class="dv">2</span>) <span class="op">*</span> math.sin(dlon<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb114-9"><a href="#cb114-9" tabindex="-1"></a>  c <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> math.atan2(math.sqrt(a), math.sqrt(<span class="dv">1</span><span class="op">-</span>a))</span>
<span id="cb114-10"><a href="#cb114-10" tabindex="-1"></a>  distance <span class="op">=</span> radius <span class="op">*</span> c</span>
<span id="cb114-11"><a href="#cb114-11" tabindex="-1"></a>  <span class="cf">return</span> distance</span>
<span id="cb114-12"><a href="#cb114-12" tabindex="-1"></a></span>
<span id="cb114-13"><a href="#cb114-13" tabindex="-1"></a>city1 <span class="op">=</span> (<span class="fl">22.47</span>, <span class="fl">70.05</span>)</span>
<span id="cb114-14"><a href="#cb114-14" tabindex="-1"></a>city2 <span class="op">=</span>  (<span class="fl">28.45</span> , <span class="fl">77.02</span>)</span>
<span id="cb114-15"><a href="#cb114-15" tabindex="-1"></a>haversine_distance(city1)</span></code></pre></div>
<details>
The function <code>haversine_distance()</code> is defined to take 2
arguments, but we called it with only 1 argiment.
</details>
<hr />
<div style="page-break-after: always;"></div>
<p>Open the notebook named <code>09_reading_files.ipynb</code>.</p>
<p><a
href="https://www.youtube.com/watch?v=v1dbrcIKL_E&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=22"
target="_blank"><img
src="https://img.youtube.com/vi/v1dbrcIKL_E/mqdefault.jpg"
alt="Watch the Video" /></a></p>
<p><a
href="https://www.youtube.com/watch?v=v1dbrcIKL_E&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=22"
target="_blank">Watch the Video ↗</a></p>
<hr />
</div>
<div id="reading-files" class="section level1">
<h1>Reading Files</h1>
<p>Python provides built-in functions for reading and writing files.</p>
<p>To read a file, we must know the path of the file on the disk. Python
has a module called <code>os</code> that has helper functions that helps
dealing with the the operating system. Advantage of using the
<code>os</code> module is that the code you write will work without
change on any suppored operating systems.</p>
<div class="sourceCode" id="cb115"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" tabindex="-1"></a><span class="im">import</span> os</span></code></pre></div>
<p>To open a file, we need to know the path to the file. We will now
open and read the file <code>worldcities.csv</code> located in your data
package. In your data package the data folder is in the
<code>data/</code> directory. We can construct the relative path to the
file using the <code>os.path.join()</code> method.</p>
<div class="sourceCode" id="cb116"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" tabindex="-1"></a>data_pkg_path <span class="op">=</span> <span class="st">&#39;data&#39;</span></span>
<span id="cb116-2"><a href="#cb116-2" tabindex="-1"></a>filename <span class="op">=</span> <span class="st">&#39;worldcities.csv&#39;</span></span>
<span id="cb116-3"><a href="#cb116-3" tabindex="-1"></a>path <span class="op">=</span> os.path.join(data_pkg_path, filename)</span>
<span id="cb116-4"><a href="#cb116-4" tabindex="-1"></a><span class="bu">print</span>(path)</span></code></pre></div>
<p>To open the file, use the built-in <code>open()</code> function. We
specify the <em>mode</em> as <code>r</code> which means read-only. If we
wanted to change the file contents or write a new file, we would open it
with <code>w</code> mode.</p>
<p>Our input file also contains Unicode characters, so we specify
<code>UTF-8</code> as the encoding.</p>
<p>It is a good practice to always close the file when you are done with
it. To close the file, we must call the <code>close()</code> method on
the file object after processing it.</p>
<div class="sourceCode" id="cb117"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" tabindex="-1"></a>f <span class="op">=</span> <span class="bu">open</span>(path, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>)</span>
<span id="cb117-2"><a href="#cb117-2" tabindex="-1"></a><span class="co"># Do something</span></span>
<span id="cb117-3"><a href="#cb117-3" tabindex="-1"></a>f.close()</span></code></pre></div>
<p>The easiest way to read the content of the file is to loop through it
line by line. If we just wanted to read the first few lines of the file,
we create a variable <code>count</code> and increase it by 1 for each
iteration of the loop. When the <code>count</code> value reaches the
desired number of lines, we use the <code>break</code> statement to exit
the loop.</p>
<div class="sourceCode" id="cb118"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" tabindex="-1"></a>f <span class="op">=</span> <span class="bu">open</span>(path, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>)</span>
<span id="cb118-2"><a href="#cb118-2" tabindex="-1"></a></span>
<span id="cb118-3"><a href="#cb118-3" tabindex="-1"></a>count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb118-4"><a href="#cb118-4" tabindex="-1"></a><span class="cf">for</span> line <span class="kw">in</span> f:</span>
<span id="cb118-5"><a href="#cb118-5" tabindex="-1"></a>    <span class="bu">print</span>(line)</span>
<span id="cb118-6"><a href="#cb118-6" tabindex="-1"></a>    count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb118-7"><a href="#cb118-7" tabindex="-1"></a>    <span class="cf">if</span> count <span class="op">==</span> <span class="dv">5</span>:</span>
<span id="cb118-8"><a href="#cb118-8" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb118-9"><a href="#cb118-9" tabindex="-1"></a>f.close()</span></code></pre></div>
<div id="exercise-7" class="section level2">
<h2>Exercise</h2>
<p>Count the number of lines in the file and print the total count. You
can adapt the for-loop above to count the total number lines in the
file.</p>
<div class="sourceCode" id="cb119"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb119-2"><a href="#cb119-2" tabindex="-1"></a>data_pkg_path <span class="op">=</span> <span class="st">&#39;data&#39;</span></span>
<span id="cb119-3"><a href="#cb119-3" tabindex="-1"></a>filename <span class="op">=</span> <span class="st">&#39;worldcities.csv&#39;</span></span>
<span id="cb119-4"><a href="#cb119-4" tabindex="-1"></a>path <span class="op">=</span> os.path.join(data_pkg_path, filename)</span>
<span id="cb119-5"><a href="#cb119-5" tabindex="-1"></a></span>
<span id="cb119-6"><a href="#cb119-6" tabindex="-1"></a><span class="co"># Add code to open the file and print the total number of lines</span></span>
<span id="cb119-7"><a href="#cb119-7" tabindex="-1"></a><span class="co"># Hint: You do not need to print the line, just increment the count </span></span>
<span id="cb119-8"><a href="#cb119-8" tabindex="-1"></a><span class="co">#       and print the value of the variable once the loop is finished.</span></span></code></pre></div>
<div style="page-break-after: always;"></div>
<p>Open the notebook named <code>10_reading_csv_files.ipynb</code>.</p>
<p><a
href="https://www.youtube.com/watch?v=rgALt7FzOMY&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=24"
target="_blank"><img
src="https://img.youtube.com/vi/rgALt7FzOMY/mqdefault.jpg"
alt="Watch the Video" /></a></p>
<p><a
href="https://www.youtube.com/watch?v=rgALt7FzOMY&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=24"
target="_blank">Watch the Video ↗</a></p>
<hr />
</div>
</div>
<div id="reading-csv-files" class="section level1">
<h1>Reading CSV Files</h1>
<p>Comma-separated Values (CSV) are the most common text-based file
format for sharing geospatial data. The structure of the file is 1 data
record per line, with individual <em>columns</em> separated by a
comma.</p>
<p>In general, the separator character is called a delimiter. Other
popular delimiters include the tab (\t), colon (:) and semi-colon (;)
characters.</p>
<p>Reading CSV file properly requires us to know which delimiter is
being used, along with quote character to surround the field values that
contain space of the delimiter character. Since reading delimited text
file is a very common operation, and can be tricky to handle all the
corner cases, Python comes with its own library called <code>csv</code>
for easy reading and writing of CSV files. To use it, you just have to
import it.</p>
<div class="sourceCode" id="cb120"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" tabindex="-1"></a><span class="im">import</span> csv</span></code></pre></div>
<p>The preferred way to read CSV files is using the
<code>DictReader()</code> method. Which directly reads each row and
creates a dictionary from it - with column names as <em>key</em> and
column values as <em>value</em>. Let’s see how to read a file using the
<code>csv.DictReader()</code> method.</p>
<div class="sourceCode" id="cb121"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb121-2"><a href="#cb121-2" tabindex="-1"></a>data_pkg_path <span class="op">=</span> <span class="st">&#39;data&#39;</span></span>
<span id="cb121-3"><a href="#cb121-3" tabindex="-1"></a>filename <span class="op">=</span> <span class="st">&#39;worldcities.csv&#39;</span></span>
<span id="cb121-4"><a href="#cb121-4" tabindex="-1"></a>path <span class="op">=</span> os.path.join(data_pkg_path, filename)</span></code></pre></div>
<div class="sourceCode" id="cb122"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" tabindex="-1"></a>f <span class="op">=</span> <span class="bu">open</span>(path, <span class="st">&#39;r&#39;</span>)</span>
<span id="cb122-2"><a href="#cb122-2" tabindex="-1"></a>csv_reader <span class="op">=</span> csv.DictReader(f, delimiter<span class="op">=</span><span class="st">&#39;,&#39;</span>, quotechar<span class="op">=</span><span class="st">&#39;&quot;&#39;</span>)</span>
<span id="cb122-3"><a href="#cb122-3" tabindex="-1"></a><span class="bu">print</span>(csv_reader)</span>
<span id="cb122-4"><a href="#cb122-4" tabindex="-1"></a>f.close()</span></code></pre></div>
<div id="using-enumerate-function" class="section level2">
<h2>Using <code>enumerate()</code> function</h2>
<p>When iterating over an object, many times we need a counter. We saw
in the previous example, how to use a variable like <code>count</code>
and increase it with every iteration. There is an easy way to do this
using the built-in <code>enumerate()</code> function.</p>
<div class="sourceCode" id="cb123"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" tabindex="-1"></a>cities <span class="op">=</span> [<span class="st">&#39;San Francisco&#39;</span>, <span class="st">&#39;Los Angeles&#39;</span>, <span class="st">&#39;New York&#39;</span>, <span class="st">&#39;Atlanta&#39;</span>]</span>
<span id="cb123-2"><a href="#cb123-2" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> <span class="bu">enumerate</span>(cities):</span>
<span id="cb123-3"><a href="#cb123-3" tabindex="-1"></a>    <span class="bu">print</span>(x)</span></code></pre></div>
<p>We can use enumerate() on any iterable object and get a tuple with an
index and the iterable value with each iteration. Let’s use it to print
the first 5 lines from the DictReader object.</p>
<div class="sourceCode" id="cb124"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" tabindex="-1"></a>f <span class="op">=</span> <span class="bu">open</span>(path, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>)</span>
<span id="cb124-2"><a href="#cb124-2" tabindex="-1"></a>csv_reader <span class="op">=</span> csv.DictReader(f, delimiter<span class="op">=</span><span class="st">&#39;,&#39;</span>, quotechar<span class="op">=</span><span class="st">&#39;&quot;&#39;</span>)</span>
<span id="cb124-3"><a href="#cb124-3" tabindex="-1"></a><span class="cf">for</span> index, row <span class="kw">in</span> <span class="bu">enumerate</span>(csv_reader):</span>
<span id="cb124-4"><a href="#cb124-4" tabindex="-1"></a>    <span class="bu">print</span>(row)</span>
<span id="cb124-5"><a href="#cb124-5" tabindex="-1"></a>    <span class="cf">if</span> index <span class="op">==</span> <span class="dv">4</span>:</span>
<span id="cb124-6"><a href="#cb124-6" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb124-7"><a href="#cb124-7" tabindex="-1"></a>f.close()</span></code></pre></div>
</div>
<div id="using-with-statement" class="section level2">
<h2>Using <code>with</code> statement</h2>
<p>The code for file handling requires we open a file, do something with
the file object and then close the file. That is tedious and it is
possible that you may forget to call <code>close()</code> on the file.
If the code for processing encounters an error the file is not closed
property, it may result in bugs - especially when writing files.</p>
<p>The preferred way to work with file objects is using the
<code>with</code> statement. It results in simpler and cleaer code -
which also ensures file objects are closed properly in case of
errors.</p>
<p>As you see below, we open the file and use the file object
<code>f</code> in a <code>with</code> statement. Python takes care of
closing the file when the execution of code within the statement is
complete.</p>
<div class="sourceCode" id="cb125"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(path, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb125-2"><a href="#cb125-2" tabindex="-1"></a>    csv_reader <span class="op">=</span> csv.DictReader(f)</span></code></pre></div>
</div>
<div id="filtering-rows" class="section level2">
<h2>Filtering rows</h2>
<p>We can use conditional statement while iterating over the rows, to
select and process rows that meet certain criterial. Let’s count how
many cities from a particular country are present in the file.</p>
<p>Replace the <code>home_country</code> variable with your home country
below.</p>
<div class="sourceCode" id="cb126"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" tabindex="-1"></a>home_country <span class="op">=</span> <span class="st">&#39;India&#39;</span></span>
<span id="cb126-2"><a href="#cb126-2" tabindex="-1"></a>num_cities <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb126-3"><a href="#cb126-3" tabindex="-1"></a></span>
<span id="cb126-4"><a href="#cb126-4" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(path, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb126-5"><a href="#cb126-5" tabindex="-1"></a>    csv_reader <span class="op">=</span> csv.DictReader(f)</span>
<span id="cb126-6"><a href="#cb126-6" tabindex="-1"></a></span>
<span id="cb126-7"><a href="#cb126-7" tabindex="-1"></a>    <span class="cf">for</span> row <span class="kw">in</span> csv_reader:</span>
<span id="cb126-8"><a href="#cb126-8" tabindex="-1"></a>        <span class="cf">if</span> row[<span class="st">&#39;country&#39;</span>] <span class="op">==</span> home_country:</span>
<span id="cb126-9"><a href="#cb126-9" tabindex="-1"></a>            num_cities <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb126-10"><a href="#cb126-10" tabindex="-1"></a>            </span>
<span id="cb126-11"><a href="#cb126-11" tabindex="-1"></a><span class="bu">print</span>(num_cities)</span></code></pre></div>
</div>
<div id="calculating-distance-2" class="section level2">
<h2>Calculating distance</h2>
<p>Let’s apply the skills we have learnt so far to solve a complete
problem. We want to read the <code>worldcities.csv</code> file, find all
cities within a home country, calculate the distance to each cities from
a home city and write the results to a new CSV file.</p>
<p>First we find the coordinates of the out selected
<code>home_city</code> from the file. Replace the <code>home_city</code>
below with your hometown or a large city within your country. Note that
we are using the <code>city_ascii</code> field for city name comparison,
so make sure the <code>home_city</code> variable contains the ASCII
version of the city name.</p>
<div class="sourceCode" id="cb127"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" tabindex="-1"></a>home_city <span class="op">=</span> <span class="st">&#39;Bengaluru&#39;</span></span>
<span id="cb127-2"><a href="#cb127-2" tabindex="-1"></a></span>
<span id="cb127-3"><a href="#cb127-3" tabindex="-1"></a>home_city_coordinates <span class="op">=</span> ()</span>
<span id="cb127-4"><a href="#cb127-4" tabindex="-1"></a></span>
<span id="cb127-5"><a href="#cb127-5" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(path, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb127-6"><a href="#cb127-6" tabindex="-1"></a>    csv_reader <span class="op">=</span> csv.DictReader(f)</span>
<span id="cb127-7"><a href="#cb127-7" tabindex="-1"></a>    <span class="cf">for</span> row <span class="kw">in</span> csv_reader:</span>
<span id="cb127-8"><a href="#cb127-8" tabindex="-1"></a>        <span class="cf">if</span> row[<span class="st">&#39;city_ascii&#39;</span>] <span class="op">==</span> home_city:</span>
<span id="cb127-9"><a href="#cb127-9" tabindex="-1"></a>            lat <span class="op">=</span> row[<span class="st">&#39;lat&#39;</span>]</span>
<span id="cb127-10"><a href="#cb127-10" tabindex="-1"></a>            lng <span class="op">=</span> row[<span class="st">&#39;lng&#39;</span>]</span>
<span id="cb127-11"><a href="#cb127-11" tabindex="-1"></a>            home_city_coordinates <span class="op">=</span> (lat, lng)</span>
<span id="cb127-12"><a href="#cb127-12" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb127-13"><a href="#cb127-13" tabindex="-1"></a>        </span>
<span id="cb127-14"><a href="#cb127-14" tabindex="-1"></a><span class="bu">print</span>(home_city_coordinates)</span></code></pre></div>
<p>Now we can loop through the file, find a city in the chosen home
country and call the <code>geopy.distance.geodesic()</code> function to
calculate the distance. In the code below, we are just computing first 5
matches.</p>
<div class="sourceCode" id="cb128"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" tabindex="-1"></a><span class="im">from</span> geopy <span class="im">import</span> distance</span>
<span id="cb128-2"><a href="#cb128-2" tabindex="-1"></a></span>
<span id="cb128-3"><a href="#cb128-3" tabindex="-1"></a>counter <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb128-4"><a href="#cb128-4" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(path, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb128-5"><a href="#cb128-5" tabindex="-1"></a>    csv_reader <span class="op">=</span> csv.DictReader(f)</span>
<span id="cb128-6"><a href="#cb128-6" tabindex="-1"></a>    <span class="cf">for</span> row <span class="kw">in</span> csv_reader:</span>
<span id="cb128-7"><a href="#cb128-7" tabindex="-1"></a>        <span class="cf">if</span> (row[<span class="st">&#39;country&#39;</span>] <span class="op">==</span> home_country <span class="kw">and</span></span>
<span id="cb128-8"><a href="#cb128-8" tabindex="-1"></a>            row[<span class="st">&#39;city_ascii&#39;</span>] <span class="op">!=</span> home_city):</span>
<span id="cb128-9"><a href="#cb128-9" tabindex="-1"></a>            city_coordinates <span class="op">=</span> (row[<span class="st">&#39;lat&#39;</span>], row[<span class="st">&#39;lng&#39;</span>])</span>
<span id="cb128-10"><a href="#cb128-10" tabindex="-1"></a>            city_distance <span class="op">=</span> distance.geodesic(</span>
<span id="cb128-11"><a href="#cb128-11" tabindex="-1"></a>                city_coordinates, home_city_coordinates).km</span>
<span id="cb128-12"><a href="#cb128-12" tabindex="-1"></a>            <span class="bu">print</span>(row[<span class="st">&#39;city_ascii&#39;</span>], city_distance)</span>
<span id="cb128-13"><a href="#cb128-13" tabindex="-1"></a>            counter <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb128-14"><a href="#cb128-14" tabindex="-1"></a>            </span>
<span id="cb128-15"><a href="#cb128-15" tabindex="-1"></a>        <span class="cf">if</span> counter <span class="op">==</span> <span class="dv">5</span>:</span>
<span id="cb128-16"><a href="#cb128-16" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb128-17"><a href="#cb128-17" tabindex="-1"></a>            </span></code></pre></div>
</div>
<div id="writing-files" class="section level2">
<h2>Writing files</h2>
<p>Instead of printing the results, let’s write the results to a new
file. Similar to csv.DictReader(), there is a companion
<code>csv.DictWriter()</code> method to write files. We create a
<code>csv_writer</code> object and then write rows to it using the
<code>writerow()</code> method.</p>
<p>First we create an <code>output</code> folder to save the results. We
can first check if the folder exists and if it doesn’t exist, we can
create it.</p>
<div class="sourceCode" id="cb129"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" tabindex="-1"></a>output_dir <span class="op">=</span> <span class="st">&#39;output&#39;</span></span>
<span id="cb129-2"><a href="#cb129-2" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> os.path.exists(output_dir):</span>
<span id="cb129-3"><a href="#cb129-3" tabindex="-1"></a>    os.mkdir(output_dir)</span></code></pre></div>
<div class="sourceCode" id="cb130"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" tabindex="-1"></a>output_filename <span class="op">=</span> <span class="st">&#39;cities_distance.csv&#39;</span></span>
<span id="cb130-2"><a href="#cb130-2" tabindex="-1"></a>output_path <span class="op">=</span> os.path.join(output_dir, output_filename)</span>
<span id="cb130-3"><a href="#cb130-3" tabindex="-1"></a></span>
<span id="cb130-4"><a href="#cb130-4" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(output_path, mode<span class="op">=</span><span class="st">&#39;w&#39;</span>, newline<span class="op">=</span><span class="st">&#39;&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> output_file:</span>
<span id="cb130-5"><a href="#cb130-5" tabindex="-1"></a>    fieldnames <span class="op">=</span> [<span class="st">&#39;city&#39;</span>, <span class="st">&#39;distance_from_home&#39;</span>]</span>
<span id="cb130-6"><a href="#cb130-6" tabindex="-1"></a>    csv_writer <span class="op">=</span> csv.DictWriter(output_file, fieldnames<span class="op">=</span>fieldnames)</span>
<span id="cb130-7"><a href="#cb130-7" tabindex="-1"></a>    csv_writer.writeheader()</span>
<span id="cb130-8"><a href="#cb130-8" tabindex="-1"></a>    </span>
<span id="cb130-9"><a href="#cb130-9" tabindex="-1"></a>    <span class="co"># Now we read the input file, calculate distance and</span></span>
<span id="cb130-10"><a href="#cb130-10" tabindex="-1"></a>    <span class="co"># write a row to the output </span></span>
<span id="cb130-11"><a href="#cb130-11" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(path, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb130-12"><a href="#cb130-12" tabindex="-1"></a>        csv_reader <span class="op">=</span> csv.DictReader(f)</span>
<span id="cb130-13"><a href="#cb130-13" tabindex="-1"></a>        <span class="cf">for</span> row <span class="kw">in</span> csv_reader:</span>
<span id="cb130-14"><a href="#cb130-14" tabindex="-1"></a>            <span class="cf">if</span> (row[<span class="st">&#39;country&#39;</span>] <span class="op">==</span> home_country <span class="kw">and</span></span>
<span id="cb130-15"><a href="#cb130-15" tabindex="-1"></a>                row[<span class="st">&#39;city_ascii&#39;</span>] <span class="op">!=</span> home_city):</span>
<span id="cb130-16"><a href="#cb130-16" tabindex="-1"></a>                city_coordinates <span class="op">=</span> (row[<span class="st">&#39;lat&#39;</span>], row[<span class="st">&#39;lng&#39;</span>])</span>
<span id="cb130-17"><a href="#cb130-17" tabindex="-1"></a>                city_distance <span class="op">=</span> distance.geodesic(</span>
<span id="cb130-18"><a href="#cb130-18" tabindex="-1"></a>                    city_coordinates, home_city_coordinates).km</span>
<span id="cb130-19"><a href="#cb130-19" tabindex="-1"></a>                csv_writer.writerow(</span>
<span id="cb130-20"><a href="#cb130-20" tabindex="-1"></a>                    {<span class="st">&#39;city&#39;</span>: row[<span class="st">&#39;city_ascii&#39;</span>],</span>
<span id="cb130-21"><a href="#cb130-21" tabindex="-1"></a>                     <span class="st">&#39;distance_from_home&#39;</span>: city_distance}</span>
<span id="cb130-22"><a href="#cb130-22" tabindex="-1"></a>                )</span></code></pre></div>
<p>Below is the complete code for our task of reading a file, filtering
it, calculating distance and writing the results to a file.</p>
<div class="sourceCode" id="cb131"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" tabindex="-1"></a><span class="im">import</span> csv</span>
<span id="cb131-2"><a href="#cb131-2" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb131-3"><a href="#cb131-3" tabindex="-1"></a><span class="im">from</span> geopy <span class="im">import</span> distance</span>
<span id="cb131-4"><a href="#cb131-4" tabindex="-1"></a></span>
<span id="cb131-5"><a href="#cb131-5" tabindex="-1"></a>data_pkg_path <span class="op">=</span> <span class="st">&#39;data&#39;</span></span>
<span id="cb131-6"><a href="#cb131-6" tabindex="-1"></a>input_filename <span class="op">=</span> <span class="st">&#39;worldcities.csv&#39;</span></span>
<span id="cb131-7"><a href="#cb131-7" tabindex="-1"></a>input_path <span class="op">=</span> os.path.join(data_pkg_path, input_filename)</span>
<span id="cb131-8"><a href="#cb131-8" tabindex="-1"></a>output_filename <span class="op">=</span> <span class="st">&#39;cities_distance.csv&#39;</span></span>
<span id="cb131-9"><a href="#cb131-9" tabindex="-1"></a>output_dir <span class="op">=</span> <span class="st">&#39;output&#39;</span></span>
<span id="cb131-10"><a href="#cb131-10" tabindex="-1"></a>output_path <span class="op">=</span> os.path.join(output_dir, output_filename)</span>
<span id="cb131-11"><a href="#cb131-11" tabindex="-1"></a></span>
<span id="cb131-12"><a href="#cb131-12" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> os.path.exists(output_dir):</span>
<span id="cb131-13"><a href="#cb131-13" tabindex="-1"></a>    os.mkdir(output_dir)</span>
<span id="cb131-14"><a href="#cb131-14" tabindex="-1"></a>    </span>
<span id="cb131-15"><a href="#cb131-15" tabindex="-1"></a>home_city <span class="op">=</span> <span class="st">&#39;Bengaluru&#39;</span></span>
<span id="cb131-16"><a href="#cb131-16" tabindex="-1"></a>home_country <span class="op">=</span> <span class="st">&#39;India&#39;</span></span>
<span id="cb131-17"><a href="#cb131-17" tabindex="-1"></a></span>
<span id="cb131-18"><a href="#cb131-18" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(input_path, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> input_file:</span>
<span id="cb131-19"><a href="#cb131-19" tabindex="-1"></a>    csv_reader <span class="op">=</span> csv.DictReader(input_file)</span>
<span id="cb131-20"><a href="#cb131-20" tabindex="-1"></a>    <span class="cf">for</span> row <span class="kw">in</span> csv_reader:</span>
<span id="cb131-21"><a href="#cb131-21" tabindex="-1"></a>        <span class="cf">if</span> row[<span class="st">&#39;city_ascii&#39;</span>] <span class="op">==</span> home_city:</span>
<span id="cb131-22"><a href="#cb131-22" tabindex="-1"></a>            home_city_coordinates <span class="op">=</span> (row[<span class="st">&#39;lat&#39;</span>], row[<span class="st">&#39;lng&#39;</span>])</span>
<span id="cb131-23"><a href="#cb131-23" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb131-24"><a href="#cb131-24" tabindex="-1"></a></span>
<span id="cb131-25"><a href="#cb131-25" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(output_path, mode<span class="op">=</span><span class="st">&#39;w&#39;</span>, newline<span class="op">=</span><span class="st">&#39;&#39;</span>) <span class="im">as</span> output_file:</span>
<span id="cb131-26"><a href="#cb131-26" tabindex="-1"></a>    fieldnames <span class="op">=</span> [<span class="st">&#39;city&#39;</span>, <span class="st">&#39;distance_from_home&#39;</span>]</span>
<span id="cb131-27"><a href="#cb131-27" tabindex="-1"></a>    csv_writer <span class="op">=</span> csv.DictWriter(output_file, fieldnames<span class="op">=</span>fieldnames)</span>
<span id="cb131-28"><a href="#cb131-28" tabindex="-1"></a>    csv_writer.writeheader()</span>
<span id="cb131-29"><a href="#cb131-29" tabindex="-1"></a></span>
<span id="cb131-30"><a href="#cb131-30" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(input_path, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> input_file:</span>
<span id="cb131-31"><a href="#cb131-31" tabindex="-1"></a>        csv_reader <span class="op">=</span> csv.DictReader(input_file)</span>
<span id="cb131-32"><a href="#cb131-32" tabindex="-1"></a>        <span class="cf">for</span> row <span class="kw">in</span> csv_reader:</span>
<span id="cb131-33"><a href="#cb131-33" tabindex="-1"></a>            <span class="cf">if</span> (row[<span class="st">&#39;country&#39;</span>] <span class="op">==</span> home_country <span class="kw">and</span></span>
<span id="cb131-34"><a href="#cb131-34" tabindex="-1"></a>                row[<span class="st">&#39;city_ascii&#39;</span>] <span class="op">!=</span> home_city):</span>
<span id="cb131-35"><a href="#cb131-35" tabindex="-1"></a>                city_coordinates <span class="op">=</span> (row[<span class="st">&#39;lat&#39;</span>], row[<span class="st">&#39;lng&#39;</span>])</span>
<span id="cb131-36"><a href="#cb131-36" tabindex="-1"></a>                city_distance <span class="op">=</span> distance.geodesic(</span>
<span id="cb131-37"><a href="#cb131-37" tabindex="-1"></a>                    city_coordinates, home_city_coordinates).km</span>
<span id="cb131-38"><a href="#cb131-38" tabindex="-1"></a>                csv_writer.writerow(</span>
<span id="cb131-39"><a href="#cb131-39" tabindex="-1"></a>                    {<span class="st">&#39;city&#39;</span>: row[<span class="st">&#39;city_ascii&#39;</span>],</span>
<span id="cb131-40"><a href="#cb131-40" tabindex="-1"></a>                     <span class="st">&#39;distance_from_home&#39;</span>: city_distance}</span>
<span id="cb131-41"><a href="#cb131-41" tabindex="-1"></a>                )</span>
<span id="cb131-42"><a href="#cb131-42" tabindex="-1"></a></span>
<span id="cb131-43"><a href="#cb131-43" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Successfully written output file at </span><span class="sc">{}</span><span class="st">&#39;</span>.<span class="bu">format</span>(output_path))</span></code></pre></div>
</div>
<div id="exercise-8" class="section level2">
<h2>Exercise</h2>
<p>Replace the <code>home_city</code> and <code>home_country</code>
variables with your own home city and home country and create a CSV file
containing distance from your home city to every other city in your
country.</p>
<hr />
<div style="page-break-after: always;"></div>
<p>Open the notebook named
<code>11_working_with_pandas.ipynb</code>.</p>
<p><a
href="https://www.youtube.com/watch?v=lYqoohizNNw&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=26"
target="_blank"><img
src="https://img.youtube.com/vi/rgALt7FzOMY/mqdefault.jpg"
alt="Watch the Video" /></a></p>
<p><a
href="https://www.youtube.com/watch?v=lYqoohizNNw&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=26"
target="_blank">Watch the Video ↗</a></p>
<p><a
href="https://docs.google.com/presentation/d/1fyNe15yhbMq_435yaHRZefKzos4Vpyf54mqNfhC_flQ/edit?usp=sharing"
target="_blank">Access the Presentation ↗</a></p>
<hr />
</div>
</div>
<div id="working-with-pandas" class="section level1">
<h1>Working with Pandas</h1>
<p><img
src="https://github.com/spatialthoughts/python-foundation-web/blob/master/images/python_foundation/pandas-logo.png?raw=1" /></p>
<p>Pandas is a powerful library for working with data. Pandas provides
fast and easy functions for reading data from files, and analyzing
it.</p>
<p>Pandas is based on another library called <code>numpy</code> - which
is widely used in scientific computing. Pandas extends
<code>numpy</code> and provides new data types such as
<strong>Index</strong>, <strong>Series</strong> and
<strong>DataFrames</strong>.</p>
<p>Pandas implementation is very fast and efficient - so compared to
other methods of data processing - using <code>pandas</code> results is
simpler code and quick processing. We will now re-implement our code for
reading a file and computing distance using Pandas.</p>
<p>By convention, <code>pandas</code> is commonly imported as
<code>pd</code></p>
<div class="sourceCode" id="cb132"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code></pre></div>
<div id="reading-files-1" class="section level2">
<h2>Reading Files</h2>
<div class="sourceCode" id="cb133"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb133-2"><a href="#cb133-2" tabindex="-1"></a>data_pkg_path <span class="op">=</span> <span class="st">&#39;data&#39;</span></span>
<span id="cb133-3"><a href="#cb133-3" tabindex="-1"></a>filename <span class="op">=</span> <span class="st">&#39;worldcities.csv&#39;</span></span>
<span id="cb133-4"><a href="#cb133-4" tabindex="-1"></a>path <span class="op">=</span> os.path.join(data_pkg_path, filename)</span></code></pre></div>
<p>A <strong>DataFrame</strong> is the most used Pandas object. You can
think of a DataFrame being equivalent to a Spreadsheet or an Attribute
Table of a GIS layer.</p>
<p>Pandas provide easy methods to directly read files into a DataFrame.
You can use methods such as <code>read_csv()</code>,
<code>read_excel()</code>, <code>read_hdf()</code> and so forth to read
a variety of formats. Here we will read the
<code>worldcitites.csv</code> file using <code>read_csv()</code>
method.</p>
<div class="sourceCode" id="cb134"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(path)</span></code></pre></div>
<div class="sourceCode" id="cb135"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" tabindex="-1"></a>df</span></code></pre></div>
<p>Once the file is read and a DataFrame object is created, we can
inspect it using the <code>head()</code> method.</p>
<div class="sourceCode" id="cb136"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" tabindex="-1"></a>df.head()</span></code></pre></div>
<p>There is also a <code>info()</code> method that shows basic
information about the dataframe, such as number of rows/columns and data
types of each column.</p>
<div class="sourceCode" id="cb137"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" tabindex="-1"></a>df.info()</span></code></pre></div>
</div>
<div id="filtering-data" class="section level2">
<h2>Filtering Data</h2>
<p>Pandas have many ways of selecting and filtered data from a
dataframe. We will now see how to use the <a
href="https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#boolean-indexing">Boolean
Filtering</a> to filter the dataframe to rows that match a
condition.</p>
<div class="sourceCode" id="cb138"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" tabindex="-1"></a>home_country <span class="op">=</span> <span class="st">&#39;India&#39;</span></span>
<span id="cb138-2"><a href="#cb138-2" tabindex="-1"></a>filtered <span class="op">=</span> df[df[<span class="st">&#39;country&#39;</span>] <span class="op">==</span> home_country]</span>
<span id="cb138-3"><a href="#cb138-3" tabindex="-1"></a>filtered</span></code></pre></div>
<div class="sourceCode" id="cb139"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" tabindex="-1"></a>filtered <span class="op">=</span> df[df[<span class="st">&#39;population&#39;</span>] <span class="op">&gt;</span> <span class="dv">1000000</span>]</span>
<span id="cb139-2"><a href="#cb139-2" tabindex="-1"></a>filtered</span></code></pre></div>
<p>Filtered dataframe is a just view of the original data and we cannot
make changes to it. We can save the filtered view to a new dataframe
using the <code>copy()</code> method.</p>
<div class="sourceCode" id="cb140"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" tabindex="-1"></a>country_df <span class="op">=</span> df[df[<span class="st">&#39;country&#39;</span>] <span class="op">==</span> home_country].copy()</span></code></pre></div>
<p>Let’s try to apply a filter to match a specific row. We want to
select a row with the name of the chosen <code>home_city</code>.</p>
<div class="sourceCode" id="cb141"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" tabindex="-1"></a>home_city <span class="op">=</span> <span class="st">&#39;Bengaluru&#39;</span></span>
<span id="cb141-2"><a href="#cb141-2" tabindex="-1"></a>filtered <span class="op">=</span> country_df[country_df[<span class="st">&#39;city_ascii&#39;</span>] <span class="op">==</span> home_city]</span>
<span id="cb141-3"><a href="#cb141-3" tabindex="-1"></a>filtered</span></code></pre></div>
<p>To locate a particular row or column from a dataframe, Pandas
providea <code>loc[]</code> and <code>iloc[]</code> methods - that
allows you to <em>locate</em> particular slices of data. Learn about <a
href="https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#different-choices-for-indexing">different
indexing methods</a> in Pandas. Here we can use <code>iloc[]</code> to
find the row matching the <code>home_city</code> name. Since
<code>iloc[]</code> uses index, the <em>0</em> here refers to the first
row.</p>
<div class="sourceCode" id="cb142"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" tabindex="-1"></a>filtered.iloc[<span class="dv">0</span>]</span></code></pre></div>
<p>Now that we have filtered down the data to a single row, we can
select individual column values using column names.</p>
<div class="sourceCode" id="cb143"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" tabindex="-1"></a>home_city_coordinates <span class="op">=</span> (filtered.iloc[<span class="dv">0</span>][<span class="st">&#39;lat&#39;</span>], filtered.iloc[<span class="dv">0</span>][<span class="st">&#39;lng&#39;</span>])</span>
<span id="cb143-2"><a href="#cb143-2" tabindex="-1"></a><span class="bu">print</span>(home_city_coordinates)</span></code></pre></div>
</div>
<div id="performing-calculations" class="section level2">
<h2>Performing calculations</h2>
<p>Let’s learn how to do calculations on a dataframe. We can iterate
over each row and perform some calculations. But pandas provide a much
more efficient way. You can use the <code>apply()</code> method to run a
function on each row. This is fast and makes it easy to complex
computations on large datasets.</p>
<p>The <code>apply()</code> function takes 2 arguments. A function to
apply, and the axis along which to apply it. <code>axis=0</code> means
it will be applied to columns and <code>axis=1</code> means it will
apply to rows.</p>
<p><img
src="https://github.com/spatialthoughts/python-foundation-web/blob/master/images/python_foundation/pandas_axis.png?raw=1" /></p>
<div class="sourceCode" id="cb144"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" tabindex="-1"></a><span class="im">from</span> geopy <span class="im">import</span> distance</span>
<span id="cb144-2"><a href="#cb144-2" tabindex="-1"></a></span>
<span id="cb144-3"><a href="#cb144-3" tabindex="-1"></a><span class="kw">def</span> calculate_distance(row):</span>
<span id="cb144-4"><a href="#cb144-4" tabindex="-1"></a>    city_coordinates <span class="op">=</span> (row[<span class="st">&#39;lat&#39;</span>], row[<span class="st">&#39;lng&#39;</span>])</span>
<span id="cb144-5"><a href="#cb144-5" tabindex="-1"></a>    <span class="cf">return</span> distance.geodesic(city_coordinates, home_city_coordinates).km</span>
<span id="cb144-6"><a href="#cb144-6" tabindex="-1"></a></span>
<span id="cb144-7"><a href="#cb144-7" tabindex="-1"></a>result <span class="op">=</span> country_df.<span class="bu">apply</span>(calculate_distance, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb144-8"><a href="#cb144-8" tabindex="-1"></a>result</span></code></pre></div>
<p>We can add these results to the dataframe by simply assigning the
result to a new column.</p>
<div class="sourceCode" id="cb145"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" tabindex="-1"></a>country_df[<span class="st">&#39;distance&#39;</span>] <span class="op">=</span> result</span>
<span id="cb145-2"><a href="#cb145-2" tabindex="-1"></a>country_df</span></code></pre></div>
<p>We are done with our analysis and ready to save the results. We can
further filter the results to only certain columns.</p>
<div class="sourceCode" id="cb146"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" tabindex="-1"></a>filtered <span class="op">=</span> country_df[[<span class="st">&#39;city_ascii&#39;</span>,<span class="st">&#39;distance&#39;</span>]]</span>
<span id="cb146-2"><a href="#cb146-2" tabindex="-1"></a>filtered</span></code></pre></div>
<p>Let’s rename the <code>city_ascii</code> column to give it a more
readable name.</p>
<div class="sourceCode" id="cb147"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb147-1"><a href="#cb147-1" tabindex="-1"></a>filtered <span class="op">=</span> filtered.rename(columns <span class="op">=</span> {<span class="st">&#39;city_ascii&#39;</span>: <span class="st">&#39;city&#39;</span>})</span>
<span id="cb147-2"><a href="#cb147-2" tabindex="-1"></a>filtered</span></code></pre></div>
<p>Now that we have added filtered the original data and computed the
distance for all cities, we can save the resulting dataframe to a file.
Similar to read methods, Pandas have several write methods, such as
<code>to_csv()</code>, <code>to_excel()</code> etc.</p>
<p>Here we will use the <code>to_csv()</code> method to write a CSV
file. Pandas assigns an index column (unique integer values) to a
dataframe by default. We specify <code>index=False</code> so that this
index is not added to our output.</p>
<div class="sourceCode" id="cb148"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" tabindex="-1"></a>output_filename <span class="op">=</span> <span class="st">&#39;cities_distance_pandas.csv&#39;</span></span>
<span id="cb148-2"><a href="#cb148-2" tabindex="-1"></a>output_dir <span class="op">=</span> <span class="st">&#39;output&#39;</span></span>
<span id="cb148-3"><a href="#cb148-3" tabindex="-1"></a>output_path <span class="op">=</span> os.path.join(output_dir, output_filename)</span>
<span id="cb148-4"><a href="#cb148-4" tabindex="-1"></a>filtered.to_csv(output_path, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb148-5"><a href="#cb148-5" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Successfully written output file at </span><span class="sc">{}</span><span class="st">&#39;</span>.<span class="bu">format</span>(output_path))</span></code></pre></div>
</div>
<div id="exercise-9" class="section level2">
<h2>Exercise</h2>
<p>You will notice that the output file contains a row with the
<code>home_city</code> as well. Modify the <code>filtered</code>
dataframe to remove this row and write the results to a file.</p>
<p>Hint: Use the Boolean filtering method we learnt earlier to select
rows that do not match the <code>home_city</code>.</p>
<div class="sourceCode" id="cb149"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb149-2"><a href="#cb149-2" tabindex="-1"></a><span class="im">from</span> geopy <span class="im">import</span> distance</span>
<span id="cb149-3"><a href="#cb149-3" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb149-4"><a href="#cb149-4" tabindex="-1"></a></span>
<span id="cb149-5"><a href="#cb149-5" tabindex="-1"></a><span class="kw">def</span> calculate_distance(row):</span>
<span id="cb149-6"><a href="#cb149-6" tabindex="-1"></a>    city_coordinates <span class="op">=</span> (row[<span class="st">&#39;lat&#39;</span>], row[<span class="st">&#39;lng&#39;</span>])</span>
<span id="cb149-7"><a href="#cb149-7" tabindex="-1"></a>    <span class="cf">return</span> distance.geodesic(city_coordinates, home_city_coordinates).km</span>
<span id="cb149-8"><a href="#cb149-8" tabindex="-1"></a></span>
<span id="cb149-9"><a href="#cb149-9" tabindex="-1"></a>data_pkg_path <span class="op">=</span> <span class="st">&#39;data&#39;</span></span>
<span id="cb149-10"><a href="#cb149-10" tabindex="-1"></a>filename <span class="op">=</span> <span class="st">&#39;worldcities.csv&#39;</span></span>
<span id="cb149-11"><a href="#cb149-11" tabindex="-1"></a>path <span class="op">=</span> os.path.join(data_pkg_path, filename)</span>
<span id="cb149-12"><a href="#cb149-12" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(path)</span>
<span id="cb149-13"><a href="#cb149-13" tabindex="-1"></a></span>
<span id="cb149-14"><a href="#cb149-14" tabindex="-1"></a>home_country <span class="op">=</span> <span class="st">&#39;India&#39;</span></span>
<span id="cb149-15"><a href="#cb149-15" tabindex="-1"></a>home_city <span class="op">=</span> <span class="st">&#39;Bengaluru&#39;</span></span>
<span id="cb149-16"><a href="#cb149-16" tabindex="-1"></a></span>
<span id="cb149-17"><a href="#cb149-17" tabindex="-1"></a>country_df <span class="op">=</span> df[df[<span class="st">&#39;country&#39;</span>] <span class="op">==</span> home_country].copy()</span>
<span id="cb149-18"><a href="#cb149-18" tabindex="-1"></a>filtered <span class="op">=</span> country_df[country_df[<span class="st">&#39;city_ascii&#39;</span>] <span class="op">==</span> home_city]</span>
<span id="cb149-19"><a href="#cb149-19" tabindex="-1"></a>home_city_coordinates <span class="op">=</span> (filtered.iloc[<span class="dv">0</span>][<span class="st">&#39;lat&#39;</span>], filtered.iloc[<span class="dv">0</span>][<span class="st">&#39;lng&#39;</span>])</span>
<span id="cb149-20"><a href="#cb149-20" tabindex="-1"></a></span>
<span id="cb149-21"><a href="#cb149-21" tabindex="-1"></a>country_df[<span class="st">&#39;distance&#39;</span>] <span class="op">=</span> country_df.<span class="bu">apply</span>(calculate_distance, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb149-22"><a href="#cb149-22" tabindex="-1"></a>filtered <span class="op">=</span> country_df[[<span class="st">&#39;city_ascii&#39;</span>,<span class="st">&#39;distance&#39;</span>]]</span>
<span id="cb149-23"><a href="#cb149-23" tabindex="-1"></a>filtered <span class="op">=</span> filtered.rename(columns <span class="op">=</span> {<span class="st">&#39;city_ascii&#39;</span>: <span class="st">&#39;city&#39;</span>})</span>
<span id="cb149-24"><a href="#cb149-24" tabindex="-1"></a>filtered</span></code></pre></div>
<hr />
<div style="page-break-after: always;"></div>
<p>Open the notebook named
<code>12_working_with_geopandas.ipynb</code>.</p>
<p><a
href="https://www.youtube.com/watch?v=wsqJQX8sZaA&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=28"
target="_blank"><img
src="https://img.youtube.com/vi/wsqJQX8sZaA/mqdefault.jpg"
alt="Watch the Video" /></a></p>
<p><a
href="https://www.youtube.com/watch?v=wsqJQX8sZaA&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=28"
target="_blank">Watch the Video ↗</a></p>
<hr />
</div>
</div>
<div id="working-with-geopandas" class="section level1">
<h1>Working with Geopandas</h1>
<p><img
src="https://github.com/spatialthoughts/python-foundation-web/blob/master/images/python_foundation/geopandas.png?raw=1" /></p>
<p>GeoPandas extends the Pandas library to enable spatial operations. It
provides new data types such as <strong>GeoDataFrame</strong> and
<strong>GeoSeries</strong> which are subclasses of Pandas
<strong>DataFrame</strong> and <strong>Series</strong> and enables
efficient vector data processing in Python.</p>
<p>GeoPandas make use of many other widely used spatial libraries - but
it provides an interface similar to Pandas that make it intuitive to use
it with spatial analysis. GeoPandas is built on top of the following
libraries that allow it to be spatially aware.</p>
<ul>
<li><a
href="https://shapely.readthedocs.io/en/latest/manual.html">Shapely</a>
for geometric operations (i.e. buffer, intersections etc.)</li>
<li><a
href="https://pyproj4.github.io/pyproj/stable/index.html">PyProj</a> for
working with projections</li>
<li><a href="https://pypi.org/project/Fiona/">Fiona</a> for file input
and output, which itself is based on the widely used <a
href="https://gdal.org/">GDAL/OGR</a> library</li>
</ul>
<p>We will carry out a geoprocessing task that shows various features of
this library and show how to do geo data processing in Python. The task
is to take a roads data layer from OpenStreetMap and compute the total
length of National Highways for each district in a state. The problem is
described in detail in my <a
href="https://courses.spatialthoughts.com/advanced-qgis.html#exercise-find-the-length-of-national-highways-in-a-state">Advanced
QGIS</a> course and show the steps needed to perform this analysis in
QGIS. We will replicate this example in Python.</p>
<p><img src="images/python_foundation/karnataka.png" /></p>
<p>By convention, <code>geopandas</code> is commonly imported as
<code>gpd</code></p>
<div class="sourceCode" id="cb150"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span></code></pre></div>
<div id="reading-spatial-data" class="section level2">
<h2>Reading Spatial Data</h2>
<div class="sourceCode" id="cb151"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb151-1"><a href="#cb151-1" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb151-2"><a href="#cb151-2" tabindex="-1"></a>data_pkg_path <span class="op">=</span> <span class="st">&#39;data&#39;</span></span>
<span id="cb151-3"><a href="#cb151-3" tabindex="-1"></a>filename <span class="op">=</span> <span class="st">&#39;karnataka.gpkg&#39;</span></span>
<span id="cb151-4"><a href="#cb151-4" tabindex="-1"></a>path <span class="op">=</span> os.path.join(data_pkg_path, filename)</span></code></pre></div>
<p>GeoPandas has a <code>read_file()</code> method that is able to open
a wide variety of vector datasets, including zip files. Here we will
open the GeoPackage <code>karnataka.gpkg</code> and read a layer called
<code>karnataka_major_roads</code>. The result of the read method is a
<strong>GeoDataFrame</strong>.</p>
<div class="sourceCode" id="cb152"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" tabindex="-1"></a>roads_gdf <span class="op">=</span> gpd.read_file(path, layer<span class="op">=</span><span class="st">&#39;karnataka_major_roads&#39;</span>)</span>
<span id="cb152-2"><a href="#cb152-2" tabindex="-1"></a>roads_gdf</span></code></pre></div>
<p>A GeoDataFrame contains a special column called <em>geometry</em>.
All spatial operations on the GeoDataFrame are applied to the geomety
column. The geometry column can be accessed using the
<code>geometry</code> attribute.</p>
<div class="sourceCode" id="cb153"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb153-1"><a href="#cb153-1" tabindex="-1"></a>roads_gdf.geometry</span></code></pre></div>
</div>
<div id="filtering-data-1" class="section level2">
<h2>Filtering Data</h2>
<p>One can use the standard Pandas filtering methods to select a subset
of the GeoDataFrame. In addition, GeoPandas also provide way to subset
the data based on a bounding box with the <a
href="https://geopandas.readthedocs.io/en/latest/indexing.html"><code>cx[]</code>
indexer</a>.</p>
<p>For our analysis, we need to apply a filter to extract only the road
segments where the <code>ref</code> attribute starts with
<strong>‘NH’</strong> - indicating a national highway. We can apply
boolean filtering using Panda’s <code>str.match()</code> method with a
regular expression.</p>
<div class="sourceCode" id="cb154"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" tabindex="-1"></a>filtered <span class="op">=</span> roads_gdf[roads_gdf[<span class="st">&#39;ref&#39;</span>].<span class="bu">str</span>.match(<span class="st">&#39;^NH&#39;</span>) <span class="op">==</span> <span class="va">True</span>]</span>
<span id="cb154-2"><a href="#cb154-2" tabindex="-1"></a>filtered</span></code></pre></div>
</div>
<div id="working-with-projections" class="section level2">
<h2>Working with Projections</h2>
<p>Dealing with projetions is a key aspect of working with spatial data.
GeoPandas uses the <code>pyproj</code> library to assign and manage
projections. Each GeoDataFrame as a <code>crs</code> attribute that
contains the projection info. Our source dataset is in EPSG:4326 WGS84
CRS.</p>
<div class="sourceCode" id="cb155"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" tabindex="-1"></a>filtered.crs</span></code></pre></div>
<p>Since our task is to compute line lengths, we need to use a Projected
CRS. We can use the <code>to_crs()</code> method to reproject the
GeoDataFrame.</p>
<div class="sourceCode" id="cb156"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb156-1"><a href="#cb156-1" tabindex="-1"></a>roads_reprojected <span class="op">=</span> filtered.to_crs(<span class="st">&#39;EPSG:32643&#39;</span>)</span>
<span id="cb156-2"><a href="#cb156-2" tabindex="-1"></a>roads_reprojected.crs</span></code></pre></div>
<p>Now that the layer has been reprojected, we can calculate the length
of each geometry using the <code>length</code> attribute. The result
would be in meters. We can add the line lengths in a new column named
<code>length</code>.</p>
<div class="sourceCode" id="cb157"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1" tabindex="-1"></a>roads_reprojected[<span class="st">&#39;length&#39;</span>] <span class="op">=</span> roads_reprojected[<span class="st">&#39;geometry&#39;</span>].length</span></code></pre></div>
<p>We can apply statistical operations on a DataFrame columns. Here we
can compute the total length of national highways in the state by
calling the <code>sum()</code> method.</p>
<div class="sourceCode" id="cb158"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" tabindex="-1"></a>total_length <span class="op">=</span> roads_reprojected[<span class="st">&#39;length&#39;</span>].<span class="bu">sum</span>()</span>
<span id="cb158-2"><a href="#cb158-2" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Total length of national highways in the state is </span><span class="sc">{}</span><span class="st"> KM&#39;</span>.<span class="bu">format</span>(total_length<span class="op">/</span><span class="dv">1000</span>))</span></code></pre></div>
</div>
<div id="performing-spatial-joins" class="section level2">
<h2>Performing Spatial joins</h2>
<p>There are two ways to combine datasets in geopandas – table joins and
spatial joins. For our task, we need information about which district
each road segments belongs to. This can be achived using another spatial
layer for the districts and doing a spatial join to transfer the
attributes of the district layer to the matching road segment.</p>
<p>The <code>karnataka.gpkg</code> contains a layer called
<code>karnataka_districts</code> with the district boundaries and
names.</p>
<div class="sourceCode" id="cb159"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" tabindex="-1"></a>districts_gdf <span class="op">=</span> gpd.read_file(path, layer<span class="op">=</span><span class="st">&#39;karnataka_districts&#39;</span>)</span>
<span id="cb159-2"><a href="#cb159-2" tabindex="-1"></a>districts_gdf</span></code></pre></div>
<p>Before joining this layer to the roads, we must reproject it to match
the CRS of the roads layer.</p>
<div class="sourceCode" id="cb160"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" tabindex="-1"></a>districts_reprojected <span class="op">=</span> districts_gdf.to_crs(<span class="st">&#39;EPSG:32643&#39;</span>)</span></code></pre></div>
<p>A spatial join is performed using the <code>sjoin()</code> method. It
takes 2 core arguments.</p>
<ul>
<li><code>predicate</code>: The spatial predicate to decdie which
objects to join. Options are <em>intersects</em>, <em>within</em> and
<em>contains</em>.</li>
<li><code>how</code>: The type of join to perform. Options are
<em>left</em>, <em>right</em> and <em>inner</em>.</li>
</ul>
<p>For our task, we can do a <em>left</em> join and add attributes of
the district that <em>intersect</em> the road.</p>
<div class="sourceCode" id="cb161"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1" tabindex="-1"></a>joined <span class="op">=</span> gpd.sjoin(roads_reprojected, districts_reprojected, how<span class="op">=</span><span class="st">&#39;left&#39;</span>, predicate<span class="op">=</span><span class="st">&#39;intersects&#39;</span>)</span></code></pre></div>
<p>Note: In this example, some road segments cross polygon boundaries. A
spatial join will duplicate these segments for each polygon they
intersect, resulting in an overestimation of the total length. A more
accurate method is to use a <a
href="(https://geopandas.org/en/stable/docs/reference/api/geopandas.overlay.html)">Spatial
Overlay</a>, which splits segments at polygon boundaries. The code
example below demonstrates this approach.</p>
<pre><code>joined = gpd.overlay(roads_reprojected, districts_reprojected, 
                     how=&#39;intersection&#39;, keep_geom_type=True)
# Update the length of each segment after the overlay
joined[&#39;length&#39;] = joined.geometry.length</code></pre>
<div class="sourceCode" id="cb163"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb163-1"><a href="#cb163-1" tabindex="-1"></a>joined</span></code></pre></div>
</div>
<div id="group-statistics" class="section level2">
<h2>Group Statistics</h2>
<p>The resulting geodataframe now has the matching column from the
intersecting district feature. We can now sum the length of the roads
and group them by districts. This type of <em>Group Statistics</em> is
performed using Panda’s <code>group_by()</code> method.</p>
<div class="sourceCode" id="cb164"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" tabindex="-1"></a>results <span class="op">=</span> joined.groupby(<span class="st">&#39;DISTRICT&#39;</span>)[<span class="st">&#39;length&#39;</span>].<span class="bu">sum</span>()<span class="op">/</span><span class="dv">1000</span></span>
<span id="cb164-2"><a href="#cb164-2" tabindex="-1"></a>results</span></code></pre></div>
<p>The result of the <code>group_by()</code> method is a Pandas
<em>Series</em>. It can be saved to a CSV file using the
<code>to_csv()</code> method.</p>
<div class="sourceCode" id="cb165"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" tabindex="-1"></a>output_filename <span class="op">=</span> <span class="st">&#39;national_highways_by_districts.csv&#39;</span></span>
<span id="cb165-2"><a href="#cb165-2" tabindex="-1"></a>output_dir <span class="op">=</span> <span class="st">&#39;output&#39;</span></span>
<span id="cb165-3"><a href="#cb165-3" tabindex="-1"></a>output_path <span class="op">=</span> os.path.join(output_dir, output_filename)</span>
<span id="cb165-4"><a href="#cb165-4" tabindex="-1"></a>results.to_csv(output_path)</span>
<span id="cb165-5"><a href="#cb165-5" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Successfully written output file at </span><span class="sc">{}</span><span class="st">&#39;</span>.<span class="bu">format</span>(output_path))</span></code></pre></div>
</div>
<div id="exercise-10" class="section level2">
<h2>Exercise</h2>
<p>Before writing the output to the file, round the distance numbers to
a whole number.</p>
<hr />
<div style="page-break-after: always;"></div>
<p>Open the notebook named
<code>13_creating_spatial_data.ipynb</code>.</p>
<p><a
href="https://www.youtube.com/watch?v=6fheYLAGuzc&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=30"
target="_blank"><img
src="https://img.youtube.com/vi/6fheYLAGuzc/mqdefault.jpg"
alt="Watch the Video" /></a></p>
<p><a
href="https://www.youtube.com/watch?v=6fheYLAGuzc&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=30"
target="_blank">Watch the Video ↗</a></p>
<hr />
</div>
</div>
<div id="creating-spatial-data" class="section level1">
<h1>Creating Spatial Data</h1>
<p>A common operation in spatial analysis is to take non-spatial data,
such as CSV files, and creating a spatial dataset from it using
coordinate information contained in the file. GeoPandas provides a
convenient way to take data from a delimited-text file, create geometry
and write the results as a spatial dataset.</p>
<p>We will read a tab-delimited file of places, filter it to a feature
class, create a GeoDataFrame and export it as a GeoPackage file.</p>
<p><img
src="https://github.com/spatialthoughts/python-foundation-web/blob/master/images/python_foundation/geonames_mountains.png?raw=1" /></p>
<div class="sourceCode" id="cb166"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb166-1"><a href="#cb166-1" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb166-2"><a href="#cb166-2" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb166-3"><a href="#cb166-3" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span></code></pre></div>
<div class="sourceCode" id="cb167"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1" tabindex="-1"></a>data_pkg_path <span class="op">=</span> <span class="st">&#39;data/geonames/&#39;</span></span>
<span id="cb167-2"><a href="#cb167-2" tabindex="-1"></a>filename <span class="op">=</span> <span class="st">&#39;US.txt&#39;</span></span>
<span id="cb167-3"><a href="#cb167-3" tabindex="-1"></a>path <span class="op">=</span> os.path.join(data_pkg_path, filename)</span></code></pre></div>
<div id="reading-tab-delimited-files" class="section level2">
<h2>Reading Tab-Delimited Files</h2>
<p>The source data comes from <a
href="https://en.wikipedia.org/wiki/GeoNames">GeoNames</a> - a free and
open database of geographic names of the world. It is a huge database
containing millions of records per country. The data is distributed as
country-level text files in a tab-delimited format. The files do not
contain a header row with column names, so we need to specify them when
reading the data. The data format is described in detail on the <a
href="https://www.geonames.org/export/">Data Export</a> page.</p>
<p>We specify the separator as <strong>\t</strong> (tab) as an argument
to the <code>read_csv()</code> method. Note that the file for USA has
more than 2M records.</p>
<div class="sourceCode" id="cb168"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1" tabindex="-1"></a>column_names <span class="op">=</span> [</span>
<span id="cb168-2"><a href="#cb168-2" tabindex="-1"></a>    <span class="st">&#39;geonameid&#39;</span>, <span class="st">&#39;name&#39;</span>, <span class="st">&#39;asciiname&#39;</span>, <span class="st">&#39;alternatenames&#39;</span>,</span>
<span id="cb168-3"><a href="#cb168-3" tabindex="-1"></a>    <span class="st">&#39;latitude&#39;</span>, <span class="st">&#39;longitude&#39;</span>, <span class="st">&#39;feature class&#39;</span>, <span class="st">&#39;feature code&#39;</span>,</span>
<span id="cb168-4"><a href="#cb168-4" tabindex="-1"></a>    <span class="st">&#39;country code&#39;</span>, <span class="st">&#39;cc2&#39;</span>, <span class="st">&#39;admin1 code&#39;</span>, <span class="st">&#39;admin2 code&#39;</span>,</span>
<span id="cb168-5"><a href="#cb168-5" tabindex="-1"></a>    <span class="st">&#39;admin3 code&#39;</span>, <span class="st">&#39;admin4 code&#39;</span>, <span class="st">&#39;population&#39;</span>, <span class="st">&#39;elevation&#39;</span>,</span>
<span id="cb168-6"><a href="#cb168-6" tabindex="-1"></a>    <span class="st">&#39;dem&#39;</span>, <span class="st">&#39;timezone&#39;</span>, <span class="st">&#39;modification date&#39;</span></span>
<span id="cb168-7"><a href="#cb168-7" tabindex="-1"></a>]</span>
<span id="cb168-8"><a href="#cb168-8" tabindex="-1"></a></span>
<span id="cb168-9"><a href="#cb168-9" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(path, sep<span class="op">=</span><span class="st">&#39;</span><span class="ch">\t</span><span class="st">&#39;</span>, names<span class="op">=</span>column_names)</span>
<span id="cb168-10"><a href="#cb168-10" tabindex="-1"></a>df.info()</span></code></pre></div>
</div>
<div id="filtering-data-2" class="section level2">
<h2>Filtering Data</h2>
<p>The input data as a column <code>feature_class</code> categorizing
the place into <a href="https://www.geonames.org/export/codes.html">9
feature classes</a>. We can select all rows with the value
<code>T</code> with the category <em>mountain,hill,rock…</em></p>
<div class="sourceCode" id="cb169"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb169-1"><a href="#cb169-1" tabindex="-1"></a>mountains <span class="op">=</span> df[df[<span class="st">&#39;feature class&#39;</span>]<span class="op">==</span><span class="st">&#39;T&#39;</span>]</span>
<span id="cb169-2"><a href="#cb169-2" tabindex="-1"></a>mountains.head()[[<span class="st">&#39;name&#39;</span>, <span class="st">&#39;latitude&#39;</span>, <span class="st">&#39;longitude&#39;</span>, <span class="st">&#39;dem&#39;</span>,<span class="st">&#39;feature class&#39;</span>]]</span></code></pre></div>
</div>
<div id="creating-geometries" class="section level2">
<h2>Creating Geometries</h2>
<p>GeoPandas has a conveinent function <code>points_from_xy()</code>
that creates a Geometry column from X and Y coordinates. We can then
take a Pandas dataframe and create a GeoDataFrame by specifying a CRS
and the geometry column.</p>
<div class="sourceCode" id="cb170"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1" tabindex="-1"></a>geometry <span class="op">=</span> gpd.points_from_xy(mountains.longitude, mountains.latitude)</span>
<span id="cb170-2"><a href="#cb170-2" tabindex="-1"></a>gdf <span class="op">=</span> gpd.GeoDataFrame(mountains, crs<span class="op">=</span><span class="st">&#39;EPSG:4326&#39;</span>, geometry<span class="op">=</span>geometry)</span>
<span id="cb170-3"><a href="#cb170-3" tabindex="-1"></a>gdf</span></code></pre></div>
</div>
<div id="writing-files-1" class="section level2">
<h2>Writing Files</h2>
<p>We can write the resulting GeoDataFrame to any of the supported
vector data format. The format is inferred from the file extension. Use
<code>.shp</code> if you want to save the results as a shapefile. Here
we are writing it as a new GeoPackage file so we use the
<code>.gpkg</code> extension.</p>
<p>You can open the resulting geopackage in a GIS and view the data.</p>
<div class="sourceCode" id="cb171"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb171-1"><a href="#cb171-1" tabindex="-1"></a>output_dir <span class="op">=</span> <span class="st">&#39;output&#39;</span></span>
<span id="cb171-2"><a href="#cb171-2" tabindex="-1"></a>output_filename <span class="op">=</span> <span class="st">&#39;mountains.gpkg&#39;</span></span>
<span id="cb171-3"><a href="#cb171-3" tabindex="-1"></a>output_path <span class="op">=</span> os.path.join(output_dir, output_filename)</span>
<span id="cb171-4"><a href="#cb171-4" tabindex="-1"></a></span>
<span id="cb171-5"><a href="#cb171-5" tabindex="-1"></a>gdf.to_file(filename<span class="op">=</span>output_path, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>)</span>
<span id="cb171-6"><a href="#cb171-6" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Successfully written output file at </span><span class="sc">{}</span><span class="st">&#39;</span>.<span class="bu">format</span>(output_path))</span></code></pre></div>
</div>
<div id="exercise-11" class="section level2">
<h2>Exercise</h2>
<p>The data package contains multiple geonames text files from different
countries in the <code>geonames/</code> folder. We have the code below
that reads all the files, extract the mountain features and merges them
in a single DataFrame using the <code>pd.concat()</code> function.</p>
<p>The exercise is to convert the merged DataFrame to a GeoDataFrame as
save it as a shapefile.</p>
<div class="sourceCode" id="cb172"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb172-1"><a href="#cb172-1" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb172-2"><a href="#cb172-2" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb172-3"><a href="#cb172-3" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span>
<span id="cb172-4"><a href="#cb172-4" tabindex="-1"></a></span>
<span id="cb172-5"><a href="#cb172-5" tabindex="-1"></a>data_pkg_path <span class="op">=</span> <span class="st">&#39;data/geonames/&#39;</span></span>
<span id="cb172-6"><a href="#cb172-6" tabindex="-1"></a>files <span class="op">=</span> os.listdir(data_pkg_path)</span>
<span id="cb172-7"><a href="#cb172-7" tabindex="-1"></a></span>
<span id="cb172-8"><a href="#cb172-8" tabindex="-1"></a>column_names <span class="op">=</span> [</span>
<span id="cb172-9"><a href="#cb172-9" tabindex="-1"></a>    <span class="st">&#39;geonameid&#39;</span>, <span class="st">&#39;name&#39;</span>, <span class="st">&#39;asciiname&#39;</span>, <span class="st">&#39;alternatenames&#39;</span>,</span>
<span id="cb172-10"><a href="#cb172-10" tabindex="-1"></a>    <span class="st">&#39;latitude&#39;</span>, <span class="st">&#39;longitude&#39;</span>, <span class="st">&#39;feature class&#39;</span>, <span class="st">&#39;feature code&#39;</span>,</span>
<span id="cb172-11"><a href="#cb172-11" tabindex="-1"></a>    <span class="st">&#39;country code&#39;</span>, <span class="st">&#39;cc2&#39;</span>, <span class="st">&#39;admin1 code&#39;</span>, <span class="st">&#39;admin2 code&#39;</span>,</span>
<span id="cb172-12"><a href="#cb172-12" tabindex="-1"></a>    <span class="st">&#39;admin3 code&#39;</span>, <span class="st">&#39;admin4 code&#39;</span>, <span class="st">&#39;population&#39;</span>, <span class="st">&#39;elevation&#39;</span>,</span>
<span id="cb172-13"><a href="#cb172-13" tabindex="-1"></a>    <span class="st">&#39;dem&#39;</span>, <span class="st">&#39;timezone&#39;</span>, <span class="st">&#39;modification date&#39;</span></span>
<span id="cb172-14"><a href="#cb172-14" tabindex="-1"></a>]</span>
<span id="cb172-15"><a href="#cb172-15" tabindex="-1"></a></span>
<span id="cb172-16"><a href="#cb172-16" tabindex="-1"></a>dataframes <span class="op">=</span> []</span>
<span id="cb172-17"><a href="#cb172-17" tabindex="-1"></a><span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> files:</span>
<span id="cb172-18"><a href="#cb172-18" tabindex="-1"></a>    path <span class="op">=</span> os.path.join(data_pkg_path, <span class="bu">file</span>)</span>
<span id="cb172-19"><a href="#cb172-19" tabindex="-1"></a>    df <span class="op">=</span> pd.read_csv(path, sep<span class="op">=</span><span class="st">&#39;</span><span class="ch">\t</span><span class="st">&#39;</span>, names<span class="op">=</span>column_names)</span>
<span id="cb172-20"><a href="#cb172-20" tabindex="-1"></a>    mountains <span class="op">=</span> df[df[<span class="st">&#39;feature class&#39;</span>]<span class="op">==</span><span class="st">&#39;T&#39;</span>]</span>
<span id="cb172-21"><a href="#cb172-21" tabindex="-1"></a>    dataframes.append(mountains)</span>
<span id="cb172-22"><a href="#cb172-22" tabindex="-1"></a></span>
<span id="cb172-23"><a href="#cb172-23" tabindex="-1"></a>merged <span class="op">=</span> pd.concat(dataframes)</span></code></pre></div>
<div class="sourceCode" id="cb173"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1" tabindex="-1"></a>merged</span></code></pre></div>
<hr />
<div style="page-break-after: always;"></div>
<p>Open the notebook named
<code>14_introduction_to_numpy.ipynb</code>.</p>
<p><a
href="https://www.youtube.com/watch?v=HfvkZFsx3ys&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=32"
target="_blank"><img
src="https://img.youtube.com/vi/HfvkZFsx3ys/mqdefault.jpg"
alt="Watch the Video" /></a></p>
<p><a
href="https://www.youtube.com/watch?v=HfvkZFsx3ys&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=32"
target="_blank">Watch the Video ↗</a></p>
<hr />
</div>
</div>
<div id="introduction-to-numpy" class="section level1">
<h1>Introduction to NumPy</h1>
<p><img
src="https://github.com/spatialthoughts/python-foundation-web/blob/master/images/python_foundation/numpy.png?raw=1" /></p>
<p>NumPy (Numerical Python) is an important Python library for
scientific computation. Libraries such as Pandas and GeoPandas are built
on top of NumPy.</p>
<p>It provides a fast and efficient ways to work with <em>Arrays</em>.
In the domain of spatial data analysis, it plays a critical role in
working with Raster data - such as satellite imagery, aerial photos,
elevation data etc. Since the underlying structure of raster data is a
2D array for each band - learning NumPy is critical in processing raster
data using Python.</p>
<p>By convention, <code>numpy</code> is commonly imported as
<code>np</code></p>
<div class="sourceCode" id="cb174"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb174-1"><a href="#cb174-1" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span></code></pre></div>
<div id="arrays" class="section level2">
<h2>Arrays</h2>
<p>The array object in NumPy is called <code>ndarray</code>. It provides
a lot of supporting functions that make working with arrays fast and
easy. Arrays may seem like Python Lists, but <code>ndarray</code> is
upto 50x faster in mathematical operations. You can create an array
using the <code>array()</code> method. As you can see, the rsulting
object is of type <code>numpy.ndarray</code></p>
<div class="sourceCode" id="cb175"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb175-1"><a href="#cb175-1" tabindex="-1"></a>a <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>])</span>
<span id="cb175-2"><a href="#cb175-2" tabindex="-1"></a><span class="bu">type</span>(a)</span></code></pre></div>
<p>Arrays can have any <em>dimensions</em>. We can create a 2D array
like below. <code>ndarray</code> objects have the property
<code>ndim</code> that stores the number of array dimensions. You can
also check the array size using the <code>shape</code> property.</p>
<div class="sourceCode" id="cb176"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb176-1"><a href="#cb176-1" tabindex="-1"></a>b <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>], [<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]])</span>
<span id="cb176-2"><a href="#cb176-2" tabindex="-1"></a><span class="bu">print</span>(b)</span>
<span id="cb176-3"><a href="#cb176-3" tabindex="-1"></a><span class="bu">print</span>(b.ndim)</span>
<span id="cb176-4"><a href="#cb176-4" tabindex="-1"></a><span class="bu">print</span>(b.shape)</span></code></pre></div>
<p>You can access elements of arrays like Python lists using
<code>[]</code> notation.</p>
<div class="sourceCode" id="cb177"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb177-1"><a href="#cb177-1" tabindex="-1"></a>b[<span class="dv">0</span>]</span></code></pre></div>
<div class="sourceCode" id="cb178"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb178-1"><a href="#cb178-1" tabindex="-1"></a>b[<span class="dv">0</span>][<span class="dv">2</span>]</span></code></pre></div>
</div>
<div id="array-operations" class="section level2">
<h2>Array Operations</h2>
<p>Mathematical operations on numpy arrays are easy and fast. NumPy as
many built-in functions for common operations.</p>
<div class="sourceCode" id="cb179"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb179-1"><a href="#cb179-1" tabindex="-1"></a>np.<span class="bu">sum</span>(b)</span></code></pre></div>
<p>You can also use the functions operations on arrays.</p>
<div class="sourceCode" id="cb180"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb180-1"><a href="#cb180-1" tabindex="-1"></a>c <span class="op">=</span> np.array([[<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>], [<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>]])</span>
<span id="cb180-2"><a href="#cb180-2" tabindex="-1"></a>np.divide(b, c)</span></code></pre></div>
<p>If the objects are numpy objects, you can use the Python operators as
well</p>
<div class="sourceCode" id="cb181"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb181-1"><a href="#cb181-1" tabindex="-1"></a>b<span class="op">/</span>c</span></code></pre></div>
<p>You can also combine array and scalar objects. The scalar operation
is applied to each item in the array.</p>
<div class="sourceCode" id="cb182"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb182-1"><a href="#cb182-1" tabindex="-1"></a><span class="bu">print</span>(b)</span>
<span id="cb182-2"><a href="#cb182-2" tabindex="-1"></a><span class="bu">print</span>(b<span class="op">*</span><span class="dv">2</span>)</span>
<span id="cb182-3"><a href="#cb182-3" tabindex="-1"></a><span class="bu">print</span>(b<span class="op">/</span><span class="dv">2</span>)</span></code></pre></div>
<p>An important concept in NumPy is the <em>Array Axes</em>. Similar to
the <code>pandas</code> library, In a 2D array, Axis 0 is the direction
of rows and Axis 1 is the direction of columns. The diagram below show
the directions.</p>
<p><img src="images/python_foundation/pandas_axis.png" /></p>
<p>Let’s see how we can apply a function on a specific axis. Here when
we apply <code>sum</code> function on axis-0 of a 2D array, it gives us
a 1D-array with values summed across rows.</p>
<div class="sourceCode" id="cb183"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb183-1"><a href="#cb183-1" tabindex="-1"></a><span class="bu">print</span>(b)</span>
<span id="cb183-2"><a href="#cb183-2" tabindex="-1"></a>row_sum <span class="op">=</span> b.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb183-3"><a href="#cb183-3" tabindex="-1"></a><span class="bu">print</span>(row_sum)</span></code></pre></div>
</div>
<div id="exercise-12" class="section level2">
<h2>Exercise</h2>
<p>Sum the array <code>b</code> along Axis-1. What do you think will be
the result?</p>
<div class="sourceCode" id="cb184"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb184-1"><a href="#cb184-1" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb184-2"><a href="#cb184-2" tabindex="-1"></a></span>
<span id="cb184-3"><a href="#cb184-3" tabindex="-1"></a>b <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>], [<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]])</span>
<span id="cb184-4"><a href="#cb184-4" tabindex="-1"></a>b</span></code></pre></div>
<hr />
<div style="page-break-after: always;"></div>
<p>Open the notebook named
<code>15_working_with_rasterio.ipynb</code>.</p>
<p><a
href="https://www.youtube.com/watch?v=N3sePRkzK9s&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=34"
target="_blank"><img
src="https://img.youtube.com/vi/N3sePRkzK9s/mqdefault.jpg"
alt="Watch the Video" /></a></p>
<p><a
href="https://www.youtube.com/watch?v=N3sePRkzK9s&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=34"
target="_blank">Watch the Video ↗</a></p>
<hr />
</div>
</div>
<div id="working-with-rasterio" class="section level1">
<h1>Working with RasterIO</h1>
<p><a href="https://rasterio.readthedocs.io/en/latest/">RasterIO</a> is
a modern library to work with geospatial data in a gridded format. It
excels at providing an easy way to read/write raster data and access
individual bands and pixels as <code>numpy</code> arrays.</p>
<p>RasterIO is built on top of the popular <a
href="https://gdal.org/">GDAL (Geospatial Data Abstraction Library)</a>.
GDAL is written in C++ so the Python API provided by GDAL is not very
intuitive for Python users. RaserIO aims to make it easy for Python
users to use the underlying GDAL library in an intuitive way.</p>
<p>In this section, we will take 4 individual SRTM tiles around the Mt.
Everest region and merge them to a single GeoTiff using RasterIO.</p>
<p><img
src="https://github.com/spatialthoughts/python-foundation-web/blob/master/images/python_foundation/srtm.png?raw=1" /></p>
<div class="sourceCode" id="cb185"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb185-1"><a href="#cb185-1" tabindex="-1"></a><span class="im">import</span> rasterio</span></code></pre></div>
<div class="sourceCode" id="cb186"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb186-1"><a href="#cb186-1" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb186-2"><a href="#cb186-2" tabindex="-1"></a>data_pkg_path <span class="op">=</span> <span class="st">&#39;data&#39;</span></span>
<span id="cb186-3"><a href="#cb186-3" tabindex="-1"></a>srtm_dir <span class="op">=</span> <span class="st">&#39;srtm&#39;</span></span>
<span id="cb186-4"><a href="#cb186-4" tabindex="-1"></a>filename <span class="op">=</span> <span class="st">&#39;N28E087.hgt&#39;</span></span>
<span id="cb186-5"><a href="#cb186-5" tabindex="-1"></a>path <span class="op">=</span> os.path.join(data_pkg_path, srtm_dir, filename)</span></code></pre></div>
<div id="reading-raster-data" class="section level2">
<h2>Reading Raster Data</h2>
<p>RasterIO can read any raster format supported by the GDAL library. We
can call the <code>open()</code> method with the file path of the
raster. The resulting dataset behaves much like Python’s File
object.</p>
<div class="sourceCode" id="cb187"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb187-1"><a href="#cb187-1" tabindex="-1"></a>dataset <span class="op">=</span> rasterio.<span class="bu">open</span>(path)</span></code></pre></div>
<p>You can check information about the raster using the
<code>meta</code> attribute.</p>
<p>An important property is the dataset <em>transform</em>. The
transform contains the pixel resolution of the dataset and the row and
column coordinates of the upper left corner of the dataset.</p>
<div class="sourceCode" id="cb188"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb188-1"><a href="#cb188-1" tabindex="-1"></a>metadata <span class="op">=</span> dataset.meta</span>
<span id="cb188-2"><a href="#cb188-2" tabindex="-1"></a>metadata</span></code></pre></div>
<p>To read the pixel values, we need to call the <code>read()</code>
method by passing it a band’s index number. Following the GDAL
convention, bands are indexed from 1. Since our dataset contain just
1-band, we can read it as follows.</p>
<div class="sourceCode" id="cb189"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb189-1"><a href="#cb189-1" tabindex="-1"></a>band1 <span class="op">=</span> dataset.read(<span class="dv">1</span>)</span>
<span id="cb189-2"><a href="#cb189-2" tabindex="-1"></a>band1</span></code></pre></div>
<p>Finally, when we are done with the dataset, we must close it. It is
especially important when writing a dataset.</p>
<div class="sourceCode" id="cb190"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb190-1"><a href="#cb190-1" tabindex="-1"></a>dataset.close()</span></code></pre></div>
</div>
<div id="merging-datasets" class="section level2">
<h2>Merging Datasets</h2>
<p>Let’s see how we can read the 4 individual tiles and mosaic them
together. RasterIO provides multiple sub-modules for various raster
operations. We can use the <code>rasterio.merge</code> module to carry
out this operation.</p>
<p>We first find all the individual files in the directory using the
<code>os.listdir()</code> function.</p>
<div class="sourceCode" id="cb191"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb191-1"><a href="#cb191-1" tabindex="-1"></a>srtm_path <span class="op">=</span> os.path.join(data_pkg_path, <span class="st">&#39;srtm&#39;</span>)</span>
<span id="cb191-2"><a href="#cb191-2" tabindex="-1"></a>all_files <span class="op">=</span> os.listdir(srtm_path)</span>
<span id="cb191-3"><a href="#cb191-3" tabindex="-1"></a>all_files</span></code></pre></div>
<p>The rasterio.merge module has a <code>merge()</code> method that
takes a list of <em>datasets</em> and returns the merged dataset. So we
create an empty list, open each of the files and append it to the
list.</p>
<div class="sourceCode" id="cb192"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb192-1"><a href="#cb192-1" tabindex="-1"></a>dataset_list <span class="op">=</span> []</span>
<span id="cb192-2"><a href="#cb192-2" tabindex="-1"></a><span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> all_files:</span>
<span id="cb192-3"><a href="#cb192-3" tabindex="-1"></a>    path <span class="op">=</span> os.path.join(srtm_path, <span class="bu">file</span>)</span>
<span id="cb192-4"><a href="#cb192-4" tabindex="-1"></a>    dataset_list.append(rasterio.<span class="bu">open</span>(path))</span>
<span id="cb192-5"><a href="#cb192-5" tabindex="-1"></a>dataset_list</span></code></pre></div>
<p>We can pass on the list of tile dataset to the merge method, which
will return us the merged data and a new <em>transform</em> which
contains the updated extent of the merged raster.</p>
<div class="sourceCode" id="cb193"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb193-1"><a href="#cb193-1" tabindex="-1"></a><span class="im">from</span> rasterio <span class="im">import</span> merge</span>
<span id="cb193-2"><a href="#cb193-2" tabindex="-1"></a>merged_result <span class="op">=</span> merge.merge(dataset_list)</span>
<span id="cb193-3"><a href="#cb193-3" tabindex="-1"></a>merged_result</span></code></pre></div>
<p>We save the data and the transform to separate variables.</p>
<div class="sourceCode" id="cb194"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb194-1"><a href="#cb194-1" tabindex="-1"></a>merged_data <span class="op">=</span> merged_result[<span class="dv">0</span>]</span>
<span id="cb194-2"><a href="#cb194-2" tabindex="-1"></a>merged_transform <span class="op">=</span> merged_result[<span class="dv">1</span>]</span></code></pre></div>
<p>Verify that the resulting array shape the sum of individual
rasters</p>
<div class="sourceCode" id="cb195"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb195-1"><a href="#cb195-1" tabindex="-1"></a>merged_data.shape</span></code></pre></div>
</div>
<div id="writing-raster-data" class="section level2">
<h2>Writing Raster Data</h2>
<p>Similar to regular Python files, to create a new file, we can open
the output file in the <em>write</em> mode. RasterIO provides a
<code>write()</code> method that we can use to write individual
bands.</p>
<div class="sourceCode" id="cb196"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb196-1"><a href="#cb196-1" tabindex="-1"></a>output_filename <span class="op">=</span> <span class="st">&#39;merged.tif&#39;</span></span>
<span id="cb196-2"><a href="#cb196-2" tabindex="-1"></a>output_dir <span class="op">=</span> <span class="st">&#39;output&#39;</span></span>
<span id="cb196-3"><a href="#cb196-3" tabindex="-1"></a>output_path <span class="op">=</span> os.path.join(output_dir, output_filename)</span></code></pre></div>
<p>We need to specify many metadata parameters to initialize the output
dataset. Some of these parameter values can be directly copied from the
input files, such as <code>crs</code>, <code>dtype</code>,
<code>nodata</code> etc. , while others can be obtained from the merged
dataset, such as <code>height</code> and <code>width</code>.</p>
<p>Remember to call the <code>close()</code> method which will finalize
the file and write the data to disk.</p>
<div class="sourceCode" id="cb197"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb197-1"><a href="#cb197-1" tabindex="-1"></a>new_dataset <span class="op">=</span> rasterio.<span class="bu">open</span>(output_path, <span class="st">&#39;w&#39;</span>, </span>
<span id="cb197-2"><a href="#cb197-2" tabindex="-1"></a>                            driver<span class="op">=</span><span class="st">&#39;GTiff&#39;</span>,</span>
<span id="cb197-3"><a href="#cb197-3" tabindex="-1"></a>                            height<span class="op">=</span>merged_data.shape[<span class="dv">1</span>],</span>
<span id="cb197-4"><a href="#cb197-4" tabindex="-1"></a>                            width<span class="op">=</span>merged_data.shape[<span class="dv">2</span>],</span>
<span id="cb197-5"><a href="#cb197-5" tabindex="-1"></a>                            count<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb197-6"><a href="#cb197-6" tabindex="-1"></a>                            nodata<span class="op">=-</span><span class="fl">32768.0</span>,</span>
<span id="cb197-7"><a href="#cb197-7" tabindex="-1"></a>                            dtype<span class="op">=</span>merged_data.dtype,</span>
<span id="cb197-8"><a href="#cb197-8" tabindex="-1"></a>                            crs<span class="op">=</span><span class="st">&#39;EPSG:4326&#39;</span>,</span>
<span id="cb197-9"><a href="#cb197-9" tabindex="-1"></a>                            transform<span class="op">=</span>merged_transform)</span>
<span id="cb197-10"><a href="#cb197-10" tabindex="-1"></a>new_dataset.write(merged_data)</span>
<span id="cb197-11"><a href="#cb197-11" tabindex="-1"></a>new_dataset.close()</span>
<span id="cb197-12"><a href="#cb197-12" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Successfully written output file at </span><span class="sc">{}</span><span class="st">&#39;</span>.<span class="bu">format</span>(output_path))</span></code></pre></div>
</div>
<div id="exercise-13" class="section level2">
<h2>Exercise</h2>
<p>The merged array represents elevation values. The extent of the tiles
cover Mt. Everest. Read the resulting raster and find the maximum
elevation value contained in it.</p>
<div class="sourceCode" id="cb198"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb198-1"><a href="#cb198-1" tabindex="-1"></a><span class="im">import</span> rasterio</span>
<span id="cb198-2"><a href="#cb198-2" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb198-3"><a href="#cb198-3" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb198-4"><a href="#cb198-4" tabindex="-1"></a></span>
<span id="cb198-5"><a href="#cb198-5" tabindex="-1"></a>output_filename <span class="op">=</span> <span class="st">&#39;merged.tif&#39;</span></span>
<span id="cb198-6"><a href="#cb198-6" tabindex="-1"></a>output_dir <span class="op">=</span> <span class="st">&#39;output&#39;</span></span>
<span id="cb198-7"><a href="#cb198-7" tabindex="-1"></a>output_path <span class="op">=</span> os.path.join(output_dir, output_filename)</span>
<span id="cb198-8"><a href="#cb198-8" tabindex="-1"></a></span>
<span id="cb198-9"><a href="#cb198-9" tabindex="-1"></a><span class="co"># Read the output file as a NumPy array and find the maximum value</span></span></code></pre></div>
<hr />
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="writing-standalone-python-scripts" class="section level1">
<h1>Writing Standalone Python Scripts</h1>
<p><a
href="https://www.youtube.com/watch?v=38GeIR4zom0&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=36"
target="_blank"><img
src="https://img.youtube.com/vi/38GeIR4zom0/mqdefault.jpg"
alt="Watch the Video" /></a></p>
<p><a
href="https://www.youtube.com/watch?v=38GeIR4zom0&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=36"
target="_blank">Watch the Video ↗</a></p>
<p>So far we have used Jupyter Notebooks to write and execute Python
code. A notebook is a great choice to interactively explore, visualize
and document workflows. But they are not suited for writing scripts for
automation. If you have tasks that are long running or want to execute
certain tasks on a schedule, you have to write scripts in a standalone
<code>.py</code> file and run it from a Terminal or Console.</p>
<div id="get-a-text-editor" class="section level2">
<h2>Get a Text Editor</h2>
<p>Any kind of software development requires a good text editor. If you
already have a favorite text editor or an IDE (Integrated Development
Environment), you may use it for this course. Otherwise, each platform
offers a wide variety of free or paid options for text editors. Choose
the one that fits your needs.</p>
<p>Below are my recommendations editors that are simple to use for
beginners.</p>
<ul>
<li>Windows: <a
href="https://notepad-plus-plus.org/downloads/">Notepad++</a> is a good
free editor for windows. Download and install the Notepad++ editor.</li>
<li>Mac: <a href="https://macromates.com/">TextMate</a> is an
open-source editor for Mac that is currently available for free.</li>
</ul>
</div>
<div id="writing-a-script" class="section level2">
<h2>Writing a Script</h2>
<p>Copy the following code and paste it in your text editor. Browse to
the data package directory and save the file as
<code>get_distance.py</code>. Make sure that there is no
<code>.txt</code> extension at the end.</p>
<div class="sourceCode" id="cb199"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb199-1"><a href="#cb199-1" tabindex="-1"></a><span class="im">from</span> geopy <span class="im">import</span> distance</span>
<span id="cb199-2"><a href="#cb199-2" tabindex="-1"></a></span>
<span id="cb199-3"><a href="#cb199-3" tabindex="-1"></a>san_francisco <span class="op">=</span> (<span class="fl">37.7749</span>, <span class="op">-</span><span class="fl">122.4194</span>)</span>
<span id="cb199-4"><a href="#cb199-4" tabindex="-1"></a>new_york <span class="op">=</span> (<span class="fl">40.661</span>, <span class="op">-</span><span class="fl">73.944</span>)</span>
<span id="cb199-5"><a href="#cb199-5" tabindex="-1"></a></span>
<span id="cb199-6"><a href="#cb199-6" tabindex="-1"></a>ellipsoid_distance <span class="op">=</span> distance.geodesic(san_francisco, new_york, ellipsoid<span class="op">=</span><span class="st">&#39;WGS-84&#39;</span>).km</span>
<span id="cb199-7"><a href="#cb199-7" tabindex="-1"></a></span>
<span id="cb199-8"><a href="#cb199-8" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Source Coordinates: </span><span class="sc">{}</span><span class="st">,</span><span class="sc">{}</span><span class="st">&#39;</span>.<span class="bu">format</span>(san_francisco[<span class="dv">0</span>], san_francisco[<span class="dv">1</span>]))</span>
<span id="cb199-9"><a href="#cb199-9" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Destination Coordinates: </span><span class="sc">{}</span><span class="st">,</span><span class="sc">{}</span><span class="st">&#39;</span>.<span class="bu">format</span>(san_francisco[<span class="dv">0</span>], san_francisco[<span class="dv">1</span>]))</span>
<span id="cb199-10"><a href="#cb199-10" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Ellipsoid Distance: </span><span class="sc">{}</span><span class="st"> km&#39;</span>.<span class="bu">format</span>(ellipsoid_distance))</span></code></pre></div>
</div>
<div id="executing-a-script" class="section level2">
<h2>Executing a Script</h2>
<div id="windows" class="section level3">
<h3>Windows</h3>
<ol style="list-style-type: decimal">
<li><p>Open Command Prompt/Terminal.</p></li>
<li><p>Navigate to the directory containing the script using the
<code>cd</code> command.</p></li>
</ol>
<pre><code>cd Downloads\python_foundation</code></pre>
<p><img src="images/python_foundation/win_script2.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="3" style="list-style-type: decimal">
<li>Run the script using the <code>python</code> command. The script
will run and print the distance.</li>
</ol>
<pre><code>python get_distance.py</code></pre>
<p><img src="images/python_foundation/win_script3.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="mac-and-linux" class="section level3">
<h3>Mac and Linux</h3>
<ol style="list-style-type: decimal">
<li>Open a Terminal Window.</li>
</ol>
<p><img src="images/python_foundation/mac_script1.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="2" style="list-style-type: decimal">
<li>Switch to the correct conda environment.</li>
</ol>
<pre><code>conda activate python_foundation</code></pre>
<p><img src="images/python_foundation/mac_script2.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="3" style="list-style-type: decimal">
<li>Navigate to the directory containing the script using the
<code>cd</code> command.</li>
</ol>
<pre><code>cd Downloads/python_foundation</code></pre>
<p><img src="images/python_foundation/mac_script3.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="4" style="list-style-type: decimal">
<li>Run the script using the <code>python</code> command. The script
will run and print the distance.</li>
</ol>
<blockquote>
<p>If you have multiple python installations on your system, you will
have to pick the right Python binary. If the command fails, try
<code>python3.7</code> instead of just <code>python</code> in the
command below. The script will run and print the distance.</p>
</blockquote>
<pre><code>python get_distance.py</code></pre>
<p><img src="images/python_foundation/mac_script4.png" width="75%" style="display: block; margin: auto;" /></p>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div id="what-next" class="section level1">
<h1>What next?</h1>
<p>To achieve mastery in programming, you need to practice writing code
and solve many diverse type of problems. I strongly recommend picking up
a project and implementing it in Python to improve your skills. You can
also take other courses to learn aspects of Python and spatial data
processing.</p>
<p><a
href="https://www.youtube.com/watch?v=a4oDDxQyaus&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=37"
target="_blank"><img
src="https://img.youtube.com/vi/a4oDDxQyaus/mqdefault.jpg"
alt="Watch the Video" /></a></p>
<p><a
href="https://www.youtube.com/watch?v=a4oDDxQyaus&amp;list=PLppGmFLhQ1HJspXSA0asH9kw1OhlLrxHT&amp;index=37"
target="_blank">Watch the Video ↗</a></p>
<div id="do-a-project" class="section level2">
<h2>Do a Project</h2>
<p>An ideal project is something that is both critical to your work and
also interesting to you. We encourage you to pick a project in your
domain that helps you automate a workflow or solves a problem otherwise
not possible.</p>
<p>You may want to check out this <a
href="https://github.com/sacridini/Awesome-Geospatial/blob/master/README.md#python">Awesome
Geospatial</a> that has a curated list of geospatial Python packages
that you can use for your project.</p>
<div id="example-projects" class="section level3">
<h3>Example Projects</h3>
<p>Below are some projects that our previous participants worked on.
These are good examples of what complete beginners can achieve after
completing this course. Use these as inspiration to come up with your
own project and start working on it!</p>
<ul>
<li><a
href="https://nbviewer.org/github/KlausAgerskov/Python_geocode_internships/blob/master/klaus_danish_geocode_final.ipynb">Geocoding
Addresses from a spreadsheet</a> by Klaus Agerskov</li>
<li><a
href="https://nbviewer.org/github/luicarboni/My_Projects/blob/master/Starting_with_OSMnx.ipynb">Retrieving
and visualizing data from OpenStreetMap</a> by Luigi Carboni</li>
<li><a
href="https://nbviewer.org/github/amitkb3/python_spatial_analysis_final_project/blob/master/PythonSpatialAnalysisCourse_FinalProject.ipynb">Route
Optimization</a> by Amit Bothra</li>
<li><a
href="https://github.com/AshishA2812/Python_Spatial_Project1/blob/master/DBscan%20clustering_AshishA.ipynb">Unsupervised
Clustering of industrial locations</a> by Ashish Andhale</li>
<li><a
href="https://nbviewer.jupyter.org/github/acoiman/mapping_wildfires/blob/master/mapping_wildfires.ipynb">Mapping
VIIRS Active Fires in South America</a> by Abraham Coiman</li>
<li><a
href="https://github.com/grsguru/spatial_python/blob/master/PROJECT_NDVI_BBMP.ipynb">Zonal
Statistics using Sentinel-2 imagery</a> by Gurudatta</li>
<li><a
href="https://nbviewer.org/github/deepikajpsharma/Spotify/blob/main/Spotify%20data%20analysis.ipynb">Analyzing
Music using Spotify API</a> by Deepika Sharma</li>
<li><a href="https://github.com/ulfboge/galago-wdpa/tree/main">Analyzing
Primate Distribution in Protected Areas</a> by Johan Karlsson</li>
<li><a
href="https://nbviewer.org/github/cosmith57/Python-Foundations-for-Spatial-Analysis/blob/main/Colby_Smith_PFSA.ipynb">Finding
Solar Sites from OpenStreetMap</a> by Colby Smith</li>
<li><a
href="https://nbviewer.org/github/valegio/saline_map/blob/main/saline_map.ipynb">Saline
System Visualizer</a> by Valentina Giovanetti</li>
</ul>
</div>
<div id="project-ideas" class="section level3">
<h3>Project Ideas</h3>
<p>If you do not have a project of your own, here are some
recommendation for projects that are a good fit for beginners, but are
still challenging to help you become proficient. You can try to work on
as many of the following problems as you like.</p>
<ul>
<li><strong>Geo-processing</strong>: I have several intermediate level
geoprocessing tutorials that use QGIS. You can take any of the following
tutorials and implement it using libraries such as <em>geopandas</em>
and <em>rasterio</em>.
<ul>
<li><a
href="https://www.qgistutorials.com/en/docs/3/performing_table_joins.html">Performing
Table Joins</a></li>
<li><a
href="https://www.qgistutorials.com/en/docs/3/performing_spatial_joins.html">Performing
Spatial Joins</a></li>
<li><a
href="https://www.qgistutorials.com/en/docs/3/nearest_neighbor_analysis.html">Nearest
Neighbor Analysis</a></li>
<li><a
href="https://www.qgistutorials.com/en/docs/3/sampling_raster_data.html">Sampling
Raster Data using Points or Polygons</a></li>
</ul></li>
<li><strong>Network Analysis</strong>: Use the <a
href="https://github.com/gboeing/osmnx">osmnx package</a> to do network
analysis with OpenStreetMap data and Python. Start by looking at <a
href="https://github.com/gboeing/osmnx-examples/tree/master/notebooks">examples</a></li>
<li><strong>Visualization and Interactive Mapping</strong>: Use the
plotting library <a
href="https://residentmario.github.io/geoplot/index.html">geoplot</a> or
mapping library <a
href="https://python-visualization.github.io/folium/">folium</a> to
create an interactive map. See this <a
href="https://medium.com/analytics-vidhya/interactive-choropleth-map-in-python-using-folium-4e1479d9e568">example</a></li>
<li><strong>Text Processing using LLMs</strong>: Use Large-Language
Models to process text and build applications. See our tutorial <a
href="https://www.geopythontutorials.com/notebooks/openai_mapping_news_articles.html">Natural
Language Processing using OpenAI API</a> for mapping news articles.</li>
<li><strong>Image Segmentation</strong>: <a
href="https://samgeo.gishub.org/">Segment Geospatial</a> is a Python
package to extract features from satellite imagery. Use this to extract
objects from satellite or drone imagery. See our tutorials for <a
href="https://www.geopythontutorials.com/notebooks/samgeo_farm_boundary_extraction.html">Extracting
Farm Boundaries</a> and <a
href="https://www.geopythontutorials.com/notebooks/samgeo_mine_perimeter_detection.html">Detecting
Mine Perimeter</a>.</li>
</ul>
</div>
</div>
<div id="keep-learning" class="section level2">
<h2>Keep Learning</h2>
<p>Here are some recommendations for courses and tutorials you could do
after you have completed this course.</p>
<ul>
<li>Spatial Thoughts’ <a
href="https://www.geopythontutorials.com/">Geospatial Python
Tutorials</a> covering step-by-step tutorials for GeoPandas, XArray and
more.</li>
<li>Spatial Thoughts’ Intermediate Python course <a
href="https://spatialthoughts.com/courses/python-dataviz/">Mapping and
Data Visualization with Python</a></li>
<li>University of Helsinki’s Free <a
href="https://geo-python-site.readthedocs.io/en/latest/">Geo-Python
Course</a></li>
<li>University of Helsinki’s Free <a
href="https://autogis-site.readthedocs.io/en/latest/">Automating GIS
Processes Course</a></li>
<li>Kaggle’s Free <a href="https://www.kaggle.com/learn">Python
Courses</a>, including <a
href="https://www.kaggle.com/learn/geospatial-analysis">Geospatial
Analysis</a></li>
<li>Allen Downey’s Free <a
href="https://allendowney.github.io/ElementsOfDataScience/">Elements of
Data Science Course</a></li>
<li><a href="https://geopython.github.io/geopython-workshop/">Doing
Geospatial in Python</a> online workshop. Covers some more geospatial
libraries, with a focus on OGC services and metadata.</li>
<li>Andrew Ng’s <a
href="https://www.deeplearning.ai/short-courses/chatgpt-prompt-engineering-for-developers/">ChatGPT
Prompt Engineering for Developers</a> that teaches how to use OpenAI API
for building applications.</li>
</ul>
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="data-credits" class="section level1">
<h1>Data Credits</h1>
<ul>
<li><a href="https://simplemaps.com/data/world-cities">World Cities
Database</a>: Basic database. Copyright SimpleMaps.com 2010-2020</li>
<li><a href="https://www.geonames.org">Geonames</a> places database for
USA, Canada and Mexico</li>
<li>Karnataka Admin Boundaries: Downloaded from <a
href="https://github.com/datameet/maps/tree/master/States">Datameet
Spatial Data repository</a>.</li>
<li>OpenStreetMap (osm) data layers: Data/Maps Copyright 2019 Geofabrik
GmbH and OpenStreetMap Contributors. <a
href="https://download.geofabrik.de/asia/india.html">OSM India free
extract</a> downloaded from Geofabrik.</li>
<li>Bangalore Sentinel-2 Imagery. Downloaded from <a
href="https://scihub.copernicus.eu/">Copernicus Open Access Hub</a>.
Copyright European Space Agency - ESA.</li>
<li>NASA Shuttle Radar Topography Mission (SRTM) Elevation Dataset.
Downloaded from <a href="https://dwtkns.com/srtm30m/%5D">30m SRTM Tile
Downloader</a>.</li>
</ul>
</div>
<div id="license" class="section level1">
<h1>License</h1>
<p>This course material is licensed under a <a
href="https://creativecommons.org/licenses/by/4.0/">Creative Commons
Attribution 4.0 International (CC BY 4.0)</a>. You are free to re-use
and adapt the material but are required to give appropriate credit to
the original author as below:</p>
<p><em>Python Foundation for Spatial Analysus Course</em> by Ujaval
Gandhi <a
href="https://spatialthoughts.com">www.spatialthoughts.com</a></p>
<p>© 2023 Ujaval Gandhi <a
href="https://spatialthoughts.com">www.spatialthoughts.com</a></p>
<hr />
<p><strong>This course is offered as an instructor-led online class.
Visit <a href="https://spatialthoughts.com/events/">Spatial Thoughts</a>
to know details of upcoming sessions.</strong></p>
</div>

<!-- Comment Section Powered by utterances -->
<div id="comments">
  <hr />
  <p>If you want to report any issues with this page, please comment below.</p>
<script src="https://utteranc.es/client.js"
        repo="spatialthoughts/courses"
        issue-term="title"
        label="comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
</div>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
