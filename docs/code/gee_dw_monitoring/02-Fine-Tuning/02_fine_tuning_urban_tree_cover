/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var built = 
    /* color: #ff0400 */
    /* shown: false */
    ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[77.55746624775949, 12.935821122826876],
                  [77.55747697659555, 12.935429001761442],
                  [77.55777738400522, 12.935193728826327],
                  [77.55752062496639, 12.935648232422064],
                  [77.55799269375301, 12.935836450444983],
                  [77.55782103237605, 12.936249483941939],
                  [77.55753135380245, 12.936228570869929]]]),
            {
              "landcover": 1,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.56818411665238, 12.93297109349934],
                  [77.56808755712784, 12.932829928374142],
                  [77.56798026876724, 12.932767188292866],
                  [77.5675940306691, 12.9324744010383],
                  [77.56758866625107, 12.93219729849878],
                  [77.56778178530014, 12.93198293594578],
                  [77.56807682829178, 12.931805171737762],
                  [77.56834504919327, 12.931894053857597],
                  [77.56850598173416, 12.93213455825844],
                  [77.56860790567673, 12.932254810371916],
                  [77.56883857565201, 12.932087503067805],
                  [77.56881711797989, 12.932312322231782],
                  [77.5688922198323, 12.932411660867626],
                  [77.56909606771744, 12.9324744010383],
                  [77.56909606771744, 12.932741046587681],
                  [77.56893513517655, 12.932892668439655]]]),
            {
              "landcover": 1,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.55966542082108, 12.92704470371513],
                  [77.55993364172257, 12.926971505255315],
                  [77.55999801473892, 12.927159729822899],
                  [77.56005434112824, 12.927525721631364],
                  [77.55993095951355, 12.927606762602116],
                  [77.55952326374329, 12.92761460527531]]]),
            {
              "landcover": 1,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.58913514122024, 12.908931210607625],
                  [77.58953210815444, 12.908910295247637],
                  [77.58983251556411, 12.908878922204362],
                  [77.59030458435073, 12.909004414353815],
                  [77.59054061874404, 12.908638395408474],
                  [77.59106633171096, 12.908648853100065],
                  [77.59147402748123, 12.909067160404927],
                  [77.5910019586946, 12.909443636380821],
                  [77.59061572059646, 12.909276313794859],
                  [77.58974668487564, 12.909224025463784],
                  [77.58923170074478, 12.909725992990666]]]),
            {
              "landcover": 1,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.61573227314476, 12.921415857429206],
                  [77.61545332340721, 12.920662940987198],
                  [77.61613996891502, 12.921196257034753],
                  [77.61602195171837, 12.921363571638516],
                  [77.61619361309532, 12.921792314799008],
                  [77.61573227314476, 12.921666829072132]]]),
            {
              "landcover": 1,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.62816320274716, 12.882943381724802],
                  [77.62788425300961, 12.882880629123182],
                  [77.62794862602597, 12.882587783441089],
                  [77.62773404930478, 12.882368148954866],
                  [77.62801299904233, 12.881949797019837],
                  [77.62857089851742, 12.881562820857978],
                  [77.63010456075271, 12.883191640487594],
                  [77.62838794698318, 12.883024300347486]]]),
            {
              "landcover": 1,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.61221335121711, 12.9521074223386],
                  [77.61397288033088, 12.951396422136343],
                  [77.61474535652717, 12.952379274820865],
                  [77.61435911842902, 12.954094029794597],
                  [77.61392996498664, 12.954094029794597],
                  [77.6133291501673, 12.954554083998717],
                  [77.6129858274134, 12.953968560318724]]]),
            {
              "landcover": 1,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.59805128761847, 12.95846451042281],
                  [77.5994245786341, 12.958307676320405],
                  [77.59967134186347, 12.959102301421517],
                  [77.59932801910956, 12.959583257487568],
                  [77.59893105217536, 12.960053757087966],
                  [77.59813711830695, 12.959896923986635]]]),
            {
              "landcover": 1,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.63455221948686, 13.010374248303735],
                  [77.63442347345415, 13.009370717999056],
                  [77.6357109337813, 13.008743509496409],
                  [77.63618300256792, 13.009098927842672],
                  [77.63607847733172, 13.00986916075317],
                  [77.63577806992205, 13.010193217206663],
                  [77.63577806992205, 13.010465006163697],
                  [77.63474810166034, 13.010590447120325]]]),
            {
              "landcover": 1,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.67136979766062, 13.015590361873178],
                  [77.6714556283491, 13.015355164770845],
                  [77.67200279898813, 13.015480603253204],
                  [77.67196524806192, 13.015809878967339],
                  [77.67188478179148, 13.015971903364512],
                  [77.67164874739817, 13.016008489504053],
                  [77.67131615348032, 13.015956223588763]]]),
            {
              "landcover": 1,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.60055607512109, 12.937216602088446],
                  [77.60086721136682, 12.937132950114206],
                  [77.60142511084192, 12.937028385106942],
                  [77.60136073782556, 12.936359168022458],
                  [77.60157531454675, 12.936254602690832],
                  [77.60167187407129, 12.936526472461921],
                  [77.60184353544824, 12.937112037116247],
                  [77.60250872328393, 12.936965646081536],
                  [77.60322755529992, 12.936777428910661],
                  [77.60324901297204, 12.93708066761605],
                  [77.6023048753988, 12.937143406612513],
                  [77.60206884100549, 12.937310710525937],
                  [77.60194009497278, 12.937572122665994],
                  [77.60224050238244, 12.938889635681452],
                  [77.60199373915307, 12.938973287066492],
                  [77.60184353544824, 12.938241336496006],
                  [77.60156458571069, 12.937342079997205],
                  [77.60078138067834, 12.937436188387357]]]),
            {
              "landcover": 1,
              "system:index": "10"
            })]),
    nationalPark = 
    /* color: #0b4a8b */
    /* shown: false */
    ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[77.57171894317565, 13.00974571743543],
                  [77.57220174079833, 13.009421660397162],
                  [77.57245923286376, 13.009191684177605],
                  [77.5727167249292, 13.009557555335734],
                  [77.57275964027343, 13.010048867184636],
                  [77.57264162307678, 13.010634258755037],
                  [77.57257725006042, 13.011052394744919],
                  [77.57242704635559, 13.011125568470652],
                  [77.57201935058532, 13.01079105983387],
                  [77.57148290878234, 13.010498364406496]]]),
            {
              "landcover": 2,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.57116564512269, 13.013013671615555],
                  [77.5708974242212, 13.012313298973975],
                  [77.57144459486024, 13.012114685476725],
                  [77.57174655647032, 13.012832946597658],
                  [77.5716714546179, 13.013679663736696],
                  [77.57112428397886, 13.013679663736696]]]),
            {
              "landcover": 2,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.58499108728763, 12.949247564868747],
                  [77.58530222353336, 12.94904890097151],
                  [77.58524857935306, 12.948662028717099],
                  [77.5853987830579, 12.948170595527872],
                  [77.58580647882816, 12.94804512306893],
                  [77.58636437830326, 12.9488816049352],
                  [77.58607469972965, 12.949027988973114],
                  [77.58563481745121, 12.94949850851256]]]),
            {
              "landcover": 2,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.52127227201635, 12.881502572157066],
                  [77.52011355772191, 12.87924345560438],
                  [77.52277430906469, 12.876775138310093],
                  [77.5245767535227, 12.877528186841339],
                  [77.5240188540476, 12.883426988708969],
                  [77.52187308683568, 12.883217813712905]]]),
            {
              "landcover": 2,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.5910989048272, 12.973849327897769],
                  [77.59060537836847, 12.972448359695232],
                  [77.59021914027032, 12.97177923776914],
                  [77.58953249476251, 12.969646399617162],
                  [77.58923208735284, 12.9687681668278],
                  [77.59107744715509, 12.970022784149249],
                  [77.59116327784356, 12.971151934328653],
                  [77.59217178843316, 12.971193754607238],
                  [77.59281551859674, 12.97175832767994],
                  [77.59318029902276, 12.972343809512944],
                  [77.59223616144952, 12.972992019934718]]]),
            {
              "landcover": 2,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.6027780366433, 12.977741635500964],
                  [77.60281022315148, 12.976978434405225],
                  [77.60407622580651, 12.976549786187062],
                  [77.60455902342919, 12.977908912140418],
                  [77.60427391550836, 12.978271735441785],
                  [77.60305082819757, 12.9786376521642]]]),
            {
              "landcover": 2,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.53948055718051, 13.060069056320518],
                  [77.54076801750766, 13.058396839354431],
                  [77.54205547783481, 13.05929565738082],
                  [77.54291378471957, 13.06080064768324],
                  [77.54115426366407, 13.063026769886232],
                  [77.53853641960727, 13.062619165396288]]]),
            {
              "landcover": 2,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.59158319925616, 12.895966653150252],
                  [77.59147591089557, 12.893644917177667],
                  [77.59269899820636, 12.893456667371083],
                  [77.59269899820636, 12.89577840509002]]]),
            {
              "landcover": 2,
              "system:index": "7"
            })]),
    garden = 
    /* color: #ffc82d */
    /* shown: false */
    /* displayProperties: [
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "polygon"
      },
      {
        "type": "polygon"
      },
      {
        "type": "polygon"
      },
      {
        "type": "polygon"
      },
      {
        "type": "polygon"
      },
      {
        "type": "polygon"
      },
      {
        "type": "polygon"
      },
      {
        "type": "polygon"
      },
      {
        "type": "polygon"
      }
    ] */
    ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[77.58051928977152, 12.921638012882644],
                  [77.58051928977152, 12.921638012882644],
                  [77.58051928977152, 12.921638012882644],
                  [77.58051928977152, 12.921638012882644]]], null, false),
            {
              "landcover": 3,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.58054611186166, 12.921643241456458],
                  [77.58054611186166, 12.920435437997126],
                  [77.58070167998453, 12.920435437997126],
                  [77.58070167998453, 12.921643241456458]]], null, false),
            {
              "landcover": 3,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.58496639231821, 12.91928514355793],
                  [77.58513268927713, 12.919034169521753],
                  [77.58549210528513, 12.919295600803975],
                  [77.58540627459665, 12.919478602538726],
                  [77.58515951136728, 12.919713890286383],
                  [77.58493420581003, 12.919630232445938]]]),
            {
              "landcover": 3,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.59550341650595, 12.92529082586494],
                  [77.59546586557974, 12.924935287789802],
                  [77.59614714666952, 12.924945744799238],
                  [77.59613641783346, 12.925322196847263]]]),
            {
              "landcover": 3,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.59431788012137, 12.92495620180823],
                  [77.59510644957174, 12.924914373769615],
                  [77.59514400049795, 12.92530128285948],
                  [77.59436615988363, 12.92534833932951]]]),
            {
              "landcover": 3,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.58106893991778, 12.915020807178204],
                  [77.58195943331073, 12.914958062621785],
                  [77.58203453516315, 12.91569008146616],
                  [77.58114710419804, 12.915747072340457]]]),
            {
              "landcover": 3,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.58189215023758, 12.925264271803345],
                  [77.58189751465561, 12.92447476736639],
                  [77.58269681294205, 12.924453853307629],
                  [77.58268608410599, 12.925353156252465],
                  [77.5820584471965, 12.925311328280348]]]),
            {
              "landcover": 3,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.56846373124301, 12.913512524240808],
                  [77.5687855963248, 12.913282459401634],
                  [77.56951515717685, 12.91307330936403],
                  [77.56950442834079, 12.913303374395756],
                  [77.56964390320957, 12.913721673910816],
                  [77.56910746140659, 12.913617099097701],
                  [77.5688392405051, 12.913993568220112],
                  [77.56890361352146, 12.914767419635023],
                  [77.56829206986606, 12.914223632404603]]]),
            {
              "landcover": 3,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.5766396110571, 12.95210406839103],
                  [77.57675226383573, 12.951962914098635],
                  [77.5769078319586, 12.951926318528294],
                  [77.57703121357328, 12.952009965538327],
                  [77.57709558658964, 12.952153032144517],
                  [77.57709558658964, 12.952524215199473],
                  [77.57659133129484, 12.95259740615912]]]),
            {
              "landcover": 3,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.56584841450672, 12.925263166983274],
                  [77.56563383778553, 12.92441614887677],
                  [77.56615955075245, 12.92430112150488],
                  [77.56631511887531, 12.925163825502247]]]),
            {
              "landcover": 3,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.57480676422192, 12.941854345206552],
                  [77.57474239120556, 12.940798256612911],
                  [77.57671649704052, 12.940714605840054],
                  [77.57667358169628, 12.942338160476737],
                  [77.57476384887768, 12.942484548357596]]]),
            {
              "landcover": 3,
              "system:index": "10"
            })]),
    isolatedGreen = 
    /* color: #00ffff */
    /* shown: false */
    ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[77.60793656057083, 12.939272671495173],
                  [77.60765224641526, 12.938326364701208],
                  [77.60823160356247, 12.938221800194288],
                  [77.6084890956279, 12.939042630394946],
                  [77.60844618028366, 12.939220389445568]]]),
            {
              "landcover": 4,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.56368912846887, 12.957003080995905],
                  [77.56478883416497, 12.957065814977387],
                  [77.56514825017297, 12.957118093283214],
                  [77.56517507226312, 12.95723310551739],
                  [77.56489612252557, 12.957206966377932],
                  [77.56476737649285, 12.95718082723571],
                  [77.56363548428857, 12.95718082723571]]]),
            {
              "landcover": 4,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.56614762047808, 12.958907604405269],
                  [77.56607373386241, 12.958714176008982],
                  [77.5664867940507, 12.958724631601802],
                  [77.56747384696818, 12.958766453968751],
                  [77.56793518691875, 12.958803048534051],
                  [77.5684126201234, 12.95878736514958],
                  [77.5684501710496, 12.958944198949833],
                  [77.56737192302562, 12.958912832197685],
                  [77.56666918426372, 12.958965110115738]]]),
            {
              "landcover": 4,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.56851088472689, 12.962117252093533],
                  [77.56853770681704, 12.96190291527356],
                  [77.56853770681704, 12.96138014176794],
                  [77.5684035963663, 12.961181487547947],
                  [77.56838213869418, 12.960972377671425],
                  [77.56858062216128, 12.9607946341383],
                  [77.56829094358767, 12.960710990078788],
                  [77.56826412149752, 12.960836456157512],
                  [77.56805284969072, 12.961259903706358],
                  [77.5678704594777, 12.961348775322676],
                  [77.56767734042863, 12.96126513144937],
                  [77.56800993434648, 12.961056021643113],
                  [77.5680850361989, 12.960559385149299],
                  [77.56849273196916, 12.960564612907033],
                  [77.56864830009202, 12.96062211823478],
                  [77.56888433448533, 12.960616890478253],
                  [77.56897552959184, 12.960810317396321],
                  [77.56881996146898, 12.960862594915943],
                  [77.56896480075578, 12.96126513144937],
                  [77.56912573329667, 12.961834954779917],
                  [77.56897552959184, 12.961981331204726],
                  [77.56871267310838, 12.962357727330419],
                  [77.5684820031331, 12.962326361008344]]]),
            {
              "landcover": 4,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.57452568282464, 12.921837701080543],
                  [77.57421991099694, 12.920959299827912],
                  [77.57381221522668, 12.921215500512409],
                  [77.57381221522668, 12.922010243820694],
                  [77.5737263845382, 12.922224614937832],
                  [77.5734206127105, 12.921199814763769],
                  [77.57234236468652, 12.921518758125826],
                  [77.57231017817834, 12.92140372941926],
                  [77.57346885720226, 12.92101681429016],
                  [77.57418232480022, 12.920791984953304],
                  [77.57441835919353, 12.920718784660421],
                  [77.57487969914409, 12.92194750101989],
                  [77.57471340218517, 12.922057300910945]]]),
            {
              "landcover": 4,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.58580109726185, 12.90900320022248],
                  [77.58615514885182, 12.90908686162086],
                  [77.58623219979488, 12.909280328497383],
                  [77.58618392003261, 12.909526083503001],
                  [77.58595861447536, 12.909510397020505],
                  [77.58577622426235, 12.909494710537018]]]),
            {
              "landcover": 4,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.5790603355235, 12.90459440164502],
                  [77.57903887785137, 12.904510738743422],
                  [77.57924540794552, 12.904461063882374],
                  [77.57926686561764, 12.904560413594627]]]),
            {
              "landcover": 4,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.57874919927777, 12.904591787179776],
                  [77.57874383485974, 12.90440354560986],
                  [77.57878406799496, 12.904372172001098],
                  [77.57882966554821, 12.904515967675595],
                  [77.57878675020397, 12.90453688340318],
                  [77.57879479683102, 12.904591787179776],
                  [77.57881357229412, 12.904659763267412],
                  [77.57878675020397, 12.904696365768501],
                  [77.57870896614254, 12.904712052553036]]]),
            {
              "landcover": 4,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.57269545353115, 12.905980064381774],
                  [77.57309242046536, 12.905964377676778],
                  [77.57305486953915, 12.906089871289156],
                  [77.57274909771145, 12.906152618071733],
                  [77.57244869030178, 12.90628334048485],
                  [77.57246478355587, 12.906126473580901]]]),
            {
              "landcover": 4,
              "system:index": "8"
            })]),
    waterbody = 
    /* color: #d63000 */
    /* shown: false */
    ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[77.61944514570256, 12.985154431540222],
                  [77.61768561658879, 12.983774436127218],
                  [77.61614066419621, 12.982603524918357],
                  [77.61614066419621, 12.981767156391507],
                  [77.61678439435978, 12.981432608192684],
                  [77.61794310865422, 12.980888966409168],
                  [77.61858683881779, 12.980428960894367],
                  [77.61905890760441, 12.97938349064927],
                  [77.61957389173527, 12.978965301320063],
                  [77.6203892832758, 12.97988531691568],
                  [77.62068969068547, 12.98047077961271],
                  [77.61957389173527, 12.980888966409168],
                  [77.6187155848505, 12.98118169674804],
                  [77.6172564631464, 12.981808974884697],
                  [77.61699897108097, 12.982478069818768],
                  [77.61811477003117, 12.982478069818768],
                  [77.61957389173527, 12.982143522576896],
                  [77.62068969068547, 12.981307152502035],
                  [77.62163382825871, 12.981767156391507],
                  [77.62017470655461, 12.982812616610275]]]),
            {
              "landcover": 5,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.61705279323951, 12.913604751308693],
                  [77.61610865566627, 12.909338061409425],
                  [77.61520743343726, 12.90766482980356],
                  [77.61829733822242, 12.907204689148696],
                  [77.61975645992652, 12.908585108572662],
                  [77.62035727474586, 12.911680566841879],
                  [77.61808276150123, 12.911513245753333]]]),
            {
              "landcover": 5,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.57954478237525, 12.901180951571499],
                  [77.57864356014625, 12.899967820203194],
                  [77.57804274532691, 12.899173006806603],
                  [77.57902979824439, 12.89904750972368],
                  [77.57945895168677, 12.898169028380611],
                  [77.58031725857154, 12.898252693403306],
                  [77.58126139614478, 12.898880180181855],
                  [77.58104681942359, 12.901264615586943]]]),
            {
              "landcover": 5,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.52197671633247, 12.940890936500946],
                  [77.52076435785774, 12.940368118904518],
                  [77.52090383272652, 12.939709367172293],
                  [77.521172053628, 12.939500239274341],
                  [77.52134371500496, 12.939918494894872],
                  [77.52155829172615, 12.939918494894872],
                  [77.52168703775887, 12.939677997998777],
                  [77.52201963167671, 12.939542064867965],
                  [77.5223414967585, 12.940420400713496],
                  [77.52243805628304, 12.940681809593913]]]),
            {
              "landcover": 5,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.56002218990443, 12.952976210240205],
                  [77.55957157878993, 12.952286124244173],
                  [77.5592067983639, 12.951784242319086],
                  [77.55905659465907, 12.951177800310667],
                  [77.55978615551112, 12.951470565602486],
                  [77.56034405498622, 12.951470565602486],
                  [77.56098778514979, 12.951094153021254],
                  [77.56128819255946, 12.951073241194504],
                  [77.56120236187098, 12.951386918411366],
                  [77.56120236187098, 12.951888801136858],
                  [77.56081612377284, 12.95211883038148],
                  [77.5607732084286, 12.952620711632493],
                  [77.5607732084286, 12.9528507402013]]]),
            {
              "landcover": 5,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.57648022441981, 12.934489610227581],
                  [77.57602961330531, 12.934217738236644],
                  [77.57594378261683, 12.933830842969495],
                  [77.57621200351832, 12.933297553915116],
                  [77.5764051225674, 12.93355897026068],
                  [77.57675917415736, 12.933736733219199],
                  [77.57697375087855, 12.933297553915116],
                  [77.57757456569789, 12.933768103139917],
                  [77.57716686992762, 12.934123628632285],
                  [77.57694156437037, 12.934416413951483]]]),
            {
              "landcover": 5,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.67427425528479, 12.938407462236507],
                  [77.67119310727965, 12.936608947194635],
                  [77.6713647686566, 12.9337229308417],
                  [77.67406843534361, 12.933597451112467],
                  [77.67518423429381, 12.93619068602391]]]),
            {
              "landcover": 5,
              "system:index": "6"
            })]),
    openarea = 
    /* color: #98ff00 */
    /* shown: false */
    ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[77.73264788022887, 12.900468596814665],
                  [77.73093126645934, 12.897707660746448],
                  [77.73350618711363, 12.896034351332165],
                  [77.73556612363707, 12.899380958970472]]]),
            {
              "landcover": 6,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.66170496421522, 12.882563666756962],
                  [77.66091103034681, 12.88112035075511],
                  [77.66170496421522, 12.880095382168715],
                  [77.66247744041151, 12.880764749883824],
                  [77.66365761237806, 12.881475951121704],
                  [77.66479486900037, 12.882354491040031],
                  [77.66569609122938, 12.883023852719427],
                  [77.66417259650892, 12.882710089654891],
                  [77.66367907005018, 12.882249903116058],
                  [77.66247744041151, 12.882166232745451],
                  [77.66211265998548, 12.882647336994827],
                  [77.66217703300184, 12.883233027877445]]]),
            {
              "landcover": 6,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.6221119302609, 12.873985908882297],
                  [77.6222192186215, 12.873839480886895],
                  [77.62215484560514, 12.873536165481486],
                  [77.62255181253934, 12.873504788004801],
                  [77.62271274508024, 12.87336881889381],
                  [77.62284149111295, 12.873536165481486],
                  [77.62251962603116, 12.873870858321686],
                  [77.62275566042447, 12.874236928104006],
                  [77.62271274508024, 12.874393814989942],
                  [77.62235869349027, 12.874111418524581]]]),
            {
              "landcover": 6,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.61023930358279, 12.872511695027958],
                  [77.61100105094302, 12.87229205171123],
                  [77.61121562766421, 12.873139246301209],
                  [77.61040023612368, 12.873400725534772]]]),
            {
              "landcover": 6,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.60768523145241, 12.871591723168615],
                  [77.60928382802528, 12.871246568032364],
                  [77.60929455686134, 12.871999633171612],
                  [77.60892977643532, 12.872334328063065],
                  [77.60818948674721, 12.872428460920776]]]),
            {
              "landcover": 6,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.61582841802162, 12.88325350376569],
                  [77.61574258733314, 12.882981576048445],
                  [77.6160215370707, 12.882741024360186],
                  [77.61745920110268, 12.882019367909525],
                  [77.61758794713539, 12.882636436597595],
                  [77.61707296300453, 12.882772400680446],
                  [77.61690130162758, 12.882992034812252],
                  [77.61690130162758, 12.883232586259464],
                  [77.61610736775917, 12.88325350376569]]]),
            {
              "landcover": 6,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.62236659510695, 12.889833138178536],
                  [77.62222175582015, 12.88934158923451],
                  [77.62270455344283, 12.889289296736871],
                  [77.6227903841313, 12.889686719445061],
                  [77.622554349738, 12.889723324136458],
                  [77.62261872275435, 12.890146892319073],
                  [77.62241487486922, 12.890173038479695]]]),
            {
              "landcover": 6,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[77.62784366591536, 12.889618739289698],
                  [77.62814943774306, 12.889597822315109],
                  [77.62848203166091, 12.889691948687021],
                  [77.62850348933303, 12.889854055133474],
                  [77.62826745493972, 12.88997955682638],
                  [77.62794558985793, 12.889922035224945]]]),
            {
              "landcover": 6,
              "system:index": "7"
            })]);
/***** End of imports. If edited, may not auto-convert in the playground. *****/
// Classifying Urban Green Cover using Dynamic World bands

// This example shows how to fine-tune Dynamic World dataset
// into multiple types of urban tree cover classes
// by building a classifier using DW probability bands
// along with Sentinel-2 NDVI.

// The area is classified into the following classes

// Forests/National Parks
// Gardens
// Isolated Trees
// Built
// Water
// Open Areas

// This code is part of the 'Urban True Tree Cover Project
// built during GEE Dynamic World Build-a-thon at New Delhi
// Credit: Nishalini, Shweta, Raj Bhagat P, Janhavi Mane, Jyoti

var bbmp = ee.FeatureCollection('users/ujavalgandhi/public/bangalore_boundary');
var geometry = bbmp.geometry();

var startDate = ee.Date('2024-01-01');
var endDate = startDate.advance(2, 'month');

var colFilter = ee.Filter.and(
    ee.Filter.bounds(geometry),
    ee.Filter.date(startDate, endDate));

var dwCol = ee.ImageCollection('GOOGLE/DYNAMICWORLD/V1').filter(colFilter);
var s2Col = ee.ImageCollection('COPERNICUS/S2_HARMONIZED').filter(colFilter)
  .filter(ee.Filter.lte('CLOUDY_PIXEL_PERCENTAGE',10));

var dwS2Col = ee.ImageCollection(ee.Join.saveFirst('dw_img').apply(s2Col, dwCol,
    ee.Filter.equals({leftField: 'system:index', rightField: 'system:index'})));

var s2_comp = s2Col.median();
var dw_comp = dwS2Col.map(function(img){
  return ee.Image(img.get('dw_img'));
}).median();

var ndvi = s2_comp.normalizedDifference(['B8','B4']).rename('ndvi');

var image = dw_comp.addBands(ndvi);


// Create a single featurecollection from all training samples
var fc = built.merge(nationalPark).merge(garden).merge(isolatedGreen).merge(waterbody).merge(openarea);

// Define a dictionary with the target class names
var classNames = ee.Dictionary({
  '1': 'built',
  '2': 'nationalPark',
  '3': 'garden',
  '4': 'isolatedGreen',
  '5': 'waterbody',
  '6': 'openarea'
});

// Create a chart showing distribution of different DW probabilities
// for each landcover class from training samples
// This helps visualize if the classes can be separated using the
// probability bands as input to the classifier.

var fc_prop = dw_comp.reduceRegions({
  collection: fc,
  reducer: ee.Reducer.mean(),
  scale: 10
});
var aggregate = fc_prop.reduceColumns({
  reducer: ee.Reducer.mean().repeat(7).group(0, 'landcover'),
  selectors: ['landcover', 'water','trees','grass','crops','shrub_and_scrub','built','bare'], 
});
var processed = ee.List(aggregate.get('groups')).map(function(group) {
  var landcover = ee.Dictionary(group).get('landcover');
  var bands = ['water','trees','grass','crops','shrub_and_scrub','built','bare'];
  var values = ee.Dictionary(group).get('mean');
  var probabilities = ee.Dictionary.fromLists(bands, values);
  var classDict = ee.Dictionary({
    'landcover': ee.Dictionary(classNames).get(landcover)
  });
  var properties = classDict.combine(probabilities);
  return ee.Feature(null, properties);
});

var chart = ui.Chart.feature.byFeature({
  features: processed,
  xProperty: 'landcover',
  yProperties: ['water','trees','grass','crops','shrub_and_scrub','built','bare']
})
  .setChartType('ColumnChart')
  .setOptions({
      title: 'Dynamic World Band Probabilities for Different Land Cover Classes',
      vAxis: {
        title: 'Probability',
      },
    isStacked: true,
    legend: {position: 'top'},
    chartArea: {left:100, right:100}

  });
print(chart);


// Each landcover class has a unique combination of dynamic world
// probabilities and hence can be used as input to refine them
// to the targer landcover class

// We train a model using the dynamic world probabilities and 
// NDVI band from Sentinel-2
// Sentinl-2 based NDVI is useful to separate small vs large green patches
var bands = ['water','trees','grass','crops','shrub_and_scrub','built','bare','ndvi'];
var label = 'landcover';

var training = image.select(bands).sampleRegions({
  collection: fc,
  properties: [label],
  scale: 10
});

// We use all 
var trained = ee.Classifier.smileRandomForest(10).train(training, label, bands);
var classified = image.select(bands).classify(trained);



var palette = ['ff0000','129b0a','b9ff14','f7ae08','21e0ff','faff08'];
var viz_class = {
  'min':1,
  'max':6,
  'palette': palette
};

Map.centerObject(geometry);
Map.addLayer(s2_comp.clip(geometry),{bands:['B4','B3','B2'],min:500,max:2200},'Sentinel-2 Composite');
Map.addLayer(dw_comp.clip(geometry),{bands:['built','trees','water']},'DW composite', false);
Map.addLayer(ndvi,{},'S2 NDVI',false);
Map.addLayer(classified.clip(geometry), viz_class, 'Classified');

var areaImage = ee.Image.pixelArea().divide(1e6).addBands(classified);

// Calculate area for each class
var areas = areaImage.reduceRegion({
      reducer: ee.Reducer.sum().group({
      groupField: 1,
      groupName: 'classification',
    }),
    geometry: geometry,
    scale: 10,
    maxPixels: 1e10
    }); 
 
var classAreas = ee.List(areas.get('groups'))

// Process results to extract the areas and
// create a FeatureCollection

var classAreas = classAreas.map(function(item) {
  var areaDict = ee.Dictionary(item);
  var classNumber = ee.Number(areaDict.get('classification'));
  var className = classNames.get(classNumber);
  var area = ee.Number(
    areaDict.get('sum'));
  return ee.Feature(null, {'class': classNumber, 'class_name': className, 'area': area});
});
var classAreaFc = ee.FeatureCollection(classAreas);
print(classAreaFc);

// Add a Legend

var legend = ui.Panel({style: {position: 'middle-left', padding: '8px 15px'}});

var makeRow = function(color, name) {
  var colorBox = ui.Label({
    style: {color: '#ffffff',
      backgroundColor: color,
      padding: '10px',
      margin: '0 0 4px 0',
    }
  });
  var description = ui.Label({
    value: name,
    style: {
      margin: '0px 0 4px 6px',
    }
  }); 
  return ui.Panel({
    widgets: [colorBox, description],
    layout: ui.Panel.Layout.Flow('horizontal')}
)};

var title = ui.Label({
  value: 'Legend',
  style: {fontWeight: 'bold',
    fontSize: '16px',
    margin: '0px 0 4px 0px'}});

legend.add(title);

var palette = ['ff0000','129b0a','b9ff14','f7ae08','21e0ff','faff08'];
var classes = ['Built', 'National Parks', 'Garden', 'Isolated Green',  'Water', 'Open Area'];


legend.add(makeRow('#ff0000','Built'))
legend.add(makeRow('#129b0a','National Parks'))
legend.add(makeRow('#b9ff14','Garden'))
legend.add(makeRow('#f7ae08','Isolated Green'))
legend.add(makeRow('#21e0ff','Water'))
legend.add(makeRow('#faff08','Open Area'))
Map.add(legend);


