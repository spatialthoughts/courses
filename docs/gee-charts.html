<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Ujaval Gandhi" />


<title>Creating Publication Quality Charts with GEE (Full Course)</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<style>
.copy-btn {
  position: absolute;
  top: 5px;
  right: 5px;
  padding: 4px 8px;
  font-size: 18px;
  background: #969696;
  color: white;
  border: none;
  border-radius: 3px;
  cursor: pointer;
  opacity: 0.7;
  transition: opacity 0.3s;
}

.copy-btn:hover {
  opacity: 1;
}

.copy-btn.copied {
  background: #636363;
}

pre {
  position: relative;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Find all code blocks
  const codeBlocks = document.querySelectorAll('pre code');
  
  codeBlocks.forEach(function(codeBlock) {
    const pre = codeBlock.parentElement;
    
    // Create copy button
    const button = document.createElement('button');
    button.className = 'copy-btn';
    button.textContent = '⎘';
    
    // Add button to pre element
    pre.appendChild(button);
    
    // Add click event
    button.addEventListener('click', function() {
      // Create temporary textarea to copy text
      const textarea = document.createElement('textarea');
      textarea.value = codeBlock.textContent;
      document.body.appendChild(textarea);
      textarea.select();
      document.execCommand('copy');
      document.body.removeChild(textarea);
      
      // Update button text
      button.textContent = 'Copied!';
      button.classList.add('copied');
      
      // Reset button after 2 seconds
      setTimeout(function() {
        button.textContent = '⎘';
        button.classList.remove('copied');
      }, 2000);
    });
  });
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Courses</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="http://spatialthoughts.com">Back to Main Site</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="#">Back to Top</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Creating Publication Quality Charts with
GEE (Full Course)</h1>
<h3 class="subtitle">A comprehesive guide on creating high-quality data
visualizations with Google Earth Engine and Google Charts.</h3>
<h4 class="author">Ujaval Gandhi</h4>

</div>

<div id="TOC">
<ul>
<li><a href="#introduction" id="toc-introduction">Introduction</a></li>
<li><a href="#setting-up-the-environment"
id="toc-setting-up-the-environment">Setting up the Environment</a>
<ul>
<li><a href="#sign-up-for-google-earth-engine"
id="toc-sign-up-for-google-earth-engine">Sign-up for Google Earth
Engine</a></li>
<li><a href="#get-the-course-materials"
id="toc-get-the-course-materials">Get the Course Materials</a></li>
<li><a href="#get-the-course-videos" id="toc-get-the-course-videos">Get
the Course Videos</a></li>
</ul></li>
<li><a href="#module-1.-time-series-charts"
id="toc-module-1.-time-series-charts">Module 1. Time-Series Charts</a>
<ul>
<li><a href="#simple-time-series" id="toc-simple-time-series">1.1 Simple
Time-Series</a></li>
<li><a href="#time-series-with-trendlines"
id="toc-time-series-with-trendlines">1.2 Time-Series with
Trendlines</a></li>
<li><a href="#time-series-at-multiple-locations"
id="toc-time-series-at-multiple-locations">1.3 Time-Series at Multiple
Locations</a></li>
<li><a href="#multi-year-time-series"
id="toc-multi-year-time-series">1.4 Multi-Year Time-Series</a></li>
</ul></li>
<li><a href="#module-2.-image-charts"
id="toc-module-2.-image-charts">Module 2. Image Charts</a>
<ul>
<li><a href="#image-histogram" id="toc-image-histogram">2.1 Image
Histogram</a></li>
<li><a href="#image-scatter-chart" id="toc-image-scatter-chart">2.2
Image Scatter Chart</a></li>
<li><a href="#image-class-areas-table"
id="toc-image-class-areas-table">2.3 Image Class Areas (Table)</a></li>
</ul></li>
<li><a href="#module-3.-featurecollection-charts"
id="toc-module-3.-featurecollection-charts">Module 3. FeatureCollection
Charts</a>
<ul>
<li><a href="#image-class-areas-pie-chart"
id="toc-image-class-areas-pie-chart">3.1 Image Class Areas (Pie
Chart)</a></li>
<li><a href="#featurecollection-column-chart"
id="toc-featurecollection-column-chart">3.2 FeatureCollection Column
Chart</a></li>
</ul></li>
<li><a href="#advanced-charts" id="toc-advanced-charts">4. Advanced
Charts</a>
<ul>
<li><a href="#datatable-charts" id="toc-datatable-charts">4.1 DataTable
Charts</a></li>
<li><a href="#box-plots" id="toc-box-plots">4.2 Box Plots</a></li>
</ul></li>
<li><a href="#exporting-charts" id="toc-exporting-charts">Exporting
Charts</a></li>
<li><a href="#supplement" id="toc-supplement">Supplement</a>
<ul>
<li><a href="#dual-y-axis-chart" id="toc-dual-y-axis-chart">Dual Y-Axis
Chart</a></li>
<li><a href="#night-time-lights-ntl-trends"
id="toc-night-time-lights-ntl-trends">Night Time Lights (NTL)
Trends</a></li>
<li><a href="#population-time-series"
id="toc-population-time-series">Population Time Series</a></li>
<li><a href="#daily-time-series-chart"
id="toc-daily-time-series-chart">Daily Time Series Chart</a></li>
<li><a href="#surface-water-area-time-series"
id="toc-surface-water-area-time-series">Surface Water Area Time
Series</a></li>
<li><a href="#histogram-with-reducer"
id="toc-histogram-with-reducer">Histogram with Reducer</a></li>
<li><a href="#histogram-of-multiple-bands"
id="toc-histogram-of-multiple-bands">Histogram of Multiple
Bands</a></li>
<li><a href="#precipitation-combo-chart"
id="toc-precipitation-combo-chart">Precipitation Combo Chart</a></li>
<li><a href="#transect-chart" id="toc-transect-chart">Transect
Chart</a></li>
<li><a href="#logo-chart" id="toc-logo-chart">Logo Chart</a></li>
<li><a href="#stacked-bar-chart-datatable"
id="toc-stacked-bar-chart-datatable">Stacked Bar Chart
(DataTable)</a></li>
<li><a href="#colored-bar-chart-datatable"
id="toc-colored-bar-chart-datatable">Colored Bar Chart
(DataTable)</a></li>
<li><a href="#box-plot-with-outliers-datatable"
id="toc-box-plot-with-outliers-datatable">Box Plot with Outliers
(DataTable)</a></li>
<li><a href="#spectral-profile-charts-datatable"
id="toc-spectral-profile-charts-datatable">Spectral Profile Charts
(DataTable)</a></li>
</ul></li>
<li><a href="#references" id="toc-references">References</a></li>
<li><a href="#data-credits" id="toc-data-credits">Data Credits</a></li>
<li><a href="#license" id="toc-license">License</a></li>
<li><a href="#citing-and-referencing"
id="toc-citing-and-referencing">Citing and Referencing</a></li>
</ul>
</div>

<div style="page-break-after: always;"></div>
<hr />
<p><img src="images/spatial_thoughts_logo.png" width="250pt" style="display: block; margin: auto;" /></p>
<hr />
<div style="page-break-after: always;"></div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>This is an intermediate-level class that is suited for participants
who are familiar with the Google Earth Engine API and want to learn
advanced data visualization methods. This class also introduces novel
earth observation and climate datasets along with techniques to work
with them.</p>
<p><a
href="https://www.youtube.com/watch?v=quHX1HOCIKU&amp;list=PLppGmFLhQ1HKyrR75waIq6TfqL0ESlQao"
target="_blank"><img
src="https://img.youtube.com/vi/quHX1HOCIKU/mqdefault.jpg"
alt="Watch the video" /></a></p>
<p><a
href="https://www.youtube.com/watch?v=quHX1HOCIKU&amp;list=PLppGmFLhQ1HKyrR75waIq6TfqL0ESlQao"
target="_blank">Watch the Video ↗</a></p>
<p><a
href="https://docs.google.com/presentation/d/1_mqS5eqJghkBBpspnvnyVuz6utfgfe_TVjLiTC-JtsM/edit?usp=sharing"
target="_blank">Access the Presentation ↗</a></p>
</div>
<div id="setting-up-the-environment" class="section level1">
<h1>Setting up the Environment</h1>
<div id="sign-up-for-google-earth-engine" class="section level2">
<h2>Sign-up for Google Earth Engine</h2>
<p>If you already have a Google Earth Engine account, you can skip this
step.</p>
<p>Visit our <a href="gee-sign-up.html">GEE Sign-Up Guide</a> for
step-by-step instructions.</p>
</div>
<div id="get-the-course-materials" class="section level2">
<h2>Get the Course Materials</h2>
<p>The course material and exercises are in the form of Earth Engine
scripts shared via a code repository.</p>
<ol style="list-style-type: decimal">
<li><a
href="https://code.earthengine.google.co.in/?accept_repo=users/ujavalgandhi/GEE-Charts">Click
this link</a> to open Google Earth Engine code editor and add the
repository to your account.</li>
<li>If successful, you will have a new repository named
<code>users/ujavalgandhi/GEE-Charts</code> in the <em>Scripts</em> tab
in the <em>Reader</em> section.</li>
<li>Verify that your code editor looks like below</li>
</ol>
<div class="figure" style="text-align: center">
<img src="images/gee_charts/repository.png" alt="Code Editor with Course Repository" width="50%" />
<p class="caption">
Code Editor with Course Repository
</p>
</div>
<p>If you do not see the repository in the <em>Reader</em> section,
click <em>Refresh repository cache</em> button in your <em>Scripts</em>
tab and it will show up.</p>
<div class="figure" style="text-align: center">
<img src="images/common/repository_cache.png" alt="Refresh repository cache" width="50%" />
<p class="caption">
Refresh repository cache
</p>
</div>
</div>
<div id="get-the-course-videos" class="section level2">
<h2>Get the Course Videos</h2>
<p>The course is accompanied by a set of videos covering the all the
modules. These videos are recorded from our live instructor-led classes
and are edited to make them easier to consume for self-study. We have 2
versions of the videos</p>
<div id="youtube" class="section level3">
<h3>YouTube</h3>
<p>We have created a YouTube Playlist with separate videos for each
script and exercise to enable effective online-learning. <a
href="https://www.youtube.com/watch?v=quHX1HOCIKU&amp;list=PLppGmFLhQ1HKyrR75waIq6TfqL0ESlQao"
target="_blank">Access the YouTube Playlist ↗</a></p>
</div>
<div id="vimeo" class="section level3">
<h3>Vimeo</h3>
<p>We are also making combined full-length video for each module
available on Vimeo. These videos can be downloaded for offline learning.
<a href="https://vimeo.com/showcase/11003930" target="_blank">Access the
Vimeo Playlist ↗</a></p>
</div>
</div>
</div>
<div id="module-1.-time-series-charts" class="section level1">
<h1>Module 1. Time-Series Charts</h1>
<p>In this section, we will explore various built-in functions to create
time-series charts from ImageCollections. We will also explore the
customization options provided by Google Charts to make high-quality
functional graphics.</p>
<p><a
href="https://www.youtube.com/watch?v=lD2Sj-A2sjc&amp;list=PLppGmFLhQ1HKyrR75waIq6TfqL0ESlQao&amp;index=3"
target="_blank"><img
src="https://img.youtube.com/vi/lD2Sj-A2sjc/mqdefault.jpg"
alt="Start Module 1 Videos" /></a></p>
<p><a
href="https://www.youtube.com/watch?v=lD2Sj-A2sjc&amp;list=PLppGmFLhQ1HKyrR75waIq6TfqL0ESlQao&amp;index=3"
target="_blank">Start Module 1 Videos ↗</a></p>
<div id="simple-time-series" class="section level2">
<h2>1.1 Simple Time-Series</h2>
<p>We start by using the time-series charting function
<code>ui.Chart.image.series()</code> that allows you to create a
time-series plot from an ImageCollection at a single location. You get
one time-series per band of the input dataset. We take the TerraClimate
dataset and select the bands for monthly maximum and minimum
temperatures. The resulting chart is a <a
href="https://developers.google.com/chart/interactive/docs/gallery/linechart">Line
Chart</a> that can be further customized using the
<code>.setOptions()</code> method.</p>
<p>Here are the customization applied to the default time-series
chart:</p>
<ul>
<li><code>lineWidth</code>: Sets the thickness of the line</li>
<li><code>pointSize</code>: Sets the size of the data point</li>
<li><code>title</code>: Sets the chart title</li>
<li><code>vAxis</code>: Sets the options for Y-Axis. Axis label is
specified using the <code>title</code> option.</li>
<li><code>hAxis</code>: Sets the options for X-Axis. Grid lines are
specified using the <code>gridlines</code> option. Date format for tick
labels is specified with <code>format</code> option.</li>
<li><code>series</code>: Sets the options for each individual
time-series. Series count starts from 0.</li>
</ul>
<div class="figure" style="text-align: center">
<img src="images/gee_charts/time_series.png" alt="Time-Series Chart" width="75%" />
<p class="caption">
Time-Series Chart
</p>
</div>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3A01-Time_Series_Charts%2F01b_Time_Series_(complete)"
target="_blank">Open in Code Editor ↗</a></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co">// Select a location</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="kw">var</span> geometry <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Point</span>([<span class="fl">77.57738128916243</span><span class="op">,</span> <span class="fl">12.964758918835752</span>])<span class="op">;</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co">// We use TerraClimate Dataset</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="kw">var</span> terraclimate <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&#39;IDAHO_EPSCOR/TERRACLIMATE&#39;</span>)<span class="op">;</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co">// Select the temerature bands</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co">// &#39;tmmx&#39; = Maximum temperature</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="co">// &#39;tmmn&#39; (Minimum temperature)</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="kw">var</span> temp <span class="op">=</span> terraclimate<span class="op">.</span><span class="fu">select</span>([<span class="st">&#39;tmmx&#39;</span><span class="op">,</span> <span class="st">&#39;tmmn&#39;</span>])<span class="op">;</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="co">// The pixel values have a scale factor of 0.1</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="co">// We must multiply the pixel values with the scale factor</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="co">// to get the temperature values in °C</span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="kw">var</span> tempScaled <span class="op">=</span> temp<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(image) {</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>  <span class="cf">return</span> image<span class="op">.</span><span class="fu">multiply</span>(<span class="fl">0.1</span>)</span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>    <span class="op">.</span><span class="fu">copyProperties</span>(image<span class="op">,</span>[<span class="st">&#39;system:time_start&#39;</span>])<span class="op">;</span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a><span class="co">// Filter the collection</span></span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a><span class="kw">var</span> startYear <span class="op">=</span> <span class="dv">2022</span><span class="op">;</span></span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a><span class="kw">var</span> endYear <span class="op">=</span> <span class="dv">2022</span><span class="op">;</span></span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a><span class="kw">var</span> startDate <span class="op">=</span> ee<span class="op">.</span><span class="at">Date</span><span class="op">.</span><span class="fu">fromYMD</span>(startYear<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a><span class="kw">var</span> endDate <span class="op">=</span> ee<span class="op">.</span><span class="at">Date</span><span class="op">.</span><span class="fu">fromYMD</span>(endYear <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" tabindex="-1"></a><span class="kw">var</span> filtered <span class="op">=</span> tempScaled</span>
<span id="cb1-27"><a href="#cb1-27" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">date</span>(startDate<span class="op">,</span> endDate))<span class="op">;</span></span>
<span id="cb1-28"><a href="#cb1-28" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" tabindex="-1"></a><span class="co">// Create a time-series chart</span></span>
<span id="cb1-30"><a href="#cb1-30" tabindex="-1"></a><span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">image</span><span class="op">.</span><span class="fu">series</span>({</span>
<span id="cb1-31"><a href="#cb1-31" tabindex="-1"></a>  <span class="dt">imageCollection</span><span class="op">:</span> filtered<span class="op">.</span><span class="fu">select</span>([<span class="st">&#39;tmmx&#39;</span>])<span class="op">,</span></span>
<span id="cb1-32"><a href="#cb1-32" tabindex="-1"></a>  <span class="dt">region</span><span class="op">:</span> geometry<span class="op">,</span></span>
<span id="cb1-33"><a href="#cb1-33" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">mean</span>()<span class="op">,</span></span>
<span id="cb1-34"><a href="#cb1-34" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="fl">4638.3</span></span>
<span id="cb1-35"><a href="#cb1-35" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb1-36"><a href="#cb1-36" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" tabindex="-1"></a><span class="co">// Print the chart</span></span>
<span id="cb1-38"><a href="#cb1-38" tabindex="-1"></a><span class="fu">print</span>(chart)<span class="op">;</span></span>
<span id="cb1-39"><a href="#cb1-39" tabindex="-1"></a></span>
<span id="cb1-40"><a href="#cb1-40" tabindex="-1"></a><span class="co">// We can use .setOptions() to customize the chart</span></span>
<span id="cb1-41"><a href="#cb1-41" tabindex="-1"></a><span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">image</span><span class="op">.</span><span class="fu">series</span>({</span>
<span id="cb1-42"><a href="#cb1-42" tabindex="-1"></a>  <span class="dt">imageCollection</span><span class="op">:</span> filtered<span class="op">.</span><span class="fu">select</span>([<span class="st">&#39;tmmx&#39;</span>])<span class="op">,</span></span>
<span id="cb1-43"><a href="#cb1-43" tabindex="-1"></a>  <span class="dt">region</span><span class="op">:</span> geometry<span class="op">,</span></span>
<span id="cb1-44"><a href="#cb1-44" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">mean</span>()<span class="op">,</span></span>
<span id="cb1-45"><a href="#cb1-45" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="fl">4638.3</span></span>
<span id="cb1-46"><a href="#cb1-46" tabindex="-1"></a>})<span class="op">.</span><span class="fu">setOptions</span>({</span>
<span id="cb1-47"><a href="#cb1-47" tabindex="-1"></a>  <span class="dt">lineWidth</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb1-48"><a href="#cb1-48" tabindex="-1"></a>  <span class="dt">pointSize</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb1-49"><a href="#cb1-49" tabindex="-1"></a>  <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Monthly Temperature Time-Series&#39;</span><span class="op">,</span></span>
<span id="cb1-50"><a href="#cb1-50" tabindex="-1"></a>  <span class="dt">vAxis</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Temparature (°C)&#39;</span>}<span class="op">,</span></span>
<span id="cb1-51"><a href="#cb1-51" tabindex="-1"></a>  <span class="dt">hAxis</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">&#39;&#39;</span><span class="op">,</span> <span class="dt">format</span><span class="op">:</span> <span class="st">&#39;YYYY-MMM&#39;</span><span class="op">,</span> <span class="dt">gridlines</span><span class="op">:</span> {<span class="dt">count</span><span class="op">:</span> <span class="dv">12</span>}}</span>
<span id="cb1-52"><a href="#cb1-52" tabindex="-1"></a>})</span>
<span id="cb1-53"><a href="#cb1-53" tabindex="-1"></a><span class="fu">print</span>(chart)<span class="op">;</span>    </span>
<span id="cb1-54"><a href="#cb1-54" tabindex="-1"></a>    </span>
<span id="cb1-55"><a href="#cb1-55" tabindex="-1"></a><span class="co">// We can select multiple bands and get a time-series for each band</span></span>
<span id="cb1-56"><a href="#cb1-56" tabindex="-1"></a><span class="co">// Additionally, we can specify the &#39;series&#39; options</span></span>
<span id="cb1-57"><a href="#cb1-57" tabindex="-1"></a><span class="co">// to specify styling options for each series.</span></span>
<span id="cb1-58"><a href="#cb1-58" tabindex="-1"></a><span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">image</span><span class="op">.</span><span class="fu">series</span>({</span>
<span id="cb1-59"><a href="#cb1-59" tabindex="-1"></a>  <span class="dt">imageCollection</span><span class="op">:</span> filtered<span class="op">.</span><span class="fu">select</span>([<span class="st">&#39;tmmx&#39;</span><span class="op">,</span> <span class="st">&#39;tmmn&#39;</span>]<span class="op">,</span> [<span class="st">&#39;maximum&#39;</span><span class="op">,</span> <span class="st">&#39;minimum&#39;</span>])<span class="op">,</span></span>
<span id="cb1-60"><a href="#cb1-60" tabindex="-1"></a>  <span class="dt">region</span><span class="op">:</span> geometry<span class="op">,</span></span>
<span id="cb1-61"><a href="#cb1-61" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">mean</span>()<span class="op">,</span></span>
<span id="cb1-62"><a href="#cb1-62" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="fl">4638.3</span></span>
<span id="cb1-63"><a href="#cb1-63" tabindex="-1"></a>})<span class="op">.</span><span class="fu">setChartType</span>(<span class="st">&#39;LineChart&#39;</span>)</span>
<span id="cb1-64"><a href="#cb1-64" tabindex="-1"></a>  <span class="op">.</span><span class="fu">setOptions</span>({</span>
<span id="cb1-65"><a href="#cb1-65" tabindex="-1"></a>      <span class="dt">lineWidth</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb1-66"><a href="#cb1-66" tabindex="-1"></a>      <span class="dt">pointSize</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb1-67"><a href="#cb1-67" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Monthly Temperature Time-Series&#39;</span><span class="op">,</span></span>
<span id="cb1-68"><a href="#cb1-68" tabindex="-1"></a>      <span class="dt">vAxis</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Temparature (°C)&#39;</span>}<span class="op">,</span></span>
<span id="cb1-69"><a href="#cb1-69" tabindex="-1"></a>      <span class="dt">hAxis</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">&#39;&#39;</span><span class="op">,</span> <span class="dt">format</span><span class="op">:</span> <span class="st">&#39;YYYY-MMM&#39;</span><span class="op">,</span> <span class="dt">gridlines</span><span class="op">:</span> {<span class="dt">count</span><span class="op">:</span> <span class="dv">12</span>}}<span class="op">,</span></span>
<span id="cb1-70"><a href="#cb1-70" tabindex="-1"></a>      <span class="dt">series</span><span class="op">:</span> {</span>
<span id="cb1-71"><a href="#cb1-71" tabindex="-1"></a>        <span class="dv">0</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;red&#39;</span>}<span class="op">,</span></span>
<span id="cb1-72"><a href="#cb1-72" tabindex="-1"></a>        <span class="dv">1</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;blue&#39;</span>}</span>
<span id="cb1-73"><a href="#cb1-73" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb1-74"><a href="#cb1-74" tabindex="-1"></a>    })</span>
<span id="cb1-75"><a href="#cb1-75" tabindex="-1"></a></span>
<span id="cb1-76"><a href="#cb1-76" tabindex="-1"></a><span class="co">// Print the chart</span></span>
<span id="cb1-77"><a href="#cb1-77" tabindex="-1"></a><span class="fu">print</span>(chart)<span class="op">;</span></span></code></pre></div>
<div id="exercise" class="section level3">
<h3>Exercise</h3>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3A01-Time_Series_Charts%2F01c_Time_Series_(exercise)"
target="_blank">Open in Code Editor ↗</a></p>
<pre><code>// Exercise

// a) Delete the &#39;geometry&#39; and add a new point at your chosen location
// b) Modify the chart options display the series with dashed lines
// c) Print the chart.

// See reference:
// https://developers.google.com/chart/interactive/docs/lines#dashed </code></pre>
</div>
</div>
<div id="time-series-with-trendlines" class="section level2">
<h2>1.2 Time-Series with Trendlines</h2>
<p>Google Charts can dynamically compute and display <a
href="https://developers.google.com/chart/interactive/docs/gallery/trendlines">Trendlines</a>
on the chart. You can choose from linear, polynomial or exponential
trendlines. The linear trendline fit a least-square regression model on
the dataset. Here we take a time-series of precipitation data, aggregate
it to yearly precipitation and then display a linear trendline to
indicate whether we see an increasing or decreasing rainfall in the
region.</p>
<p>Here are the styling options applied to the time-series chart:</p>
<ul>
<li><code>vAxis.ticks</code>: Sets the tick positions for Y-Axis. We
manually specify the exact tick marks we want.</li>
<li><code>gridlines.color</code>: Sets the color of the grid lines.</li>
<li><code>legend</code>: Sets the position of the legend. The
<code>in</code> options makes the legend appear inside the chart.</li>
<li><code>series.visibleInLegend</code>: Sets whether a particular
series label is visible in the legend.</li>
<li><code>trendlines</code>: Sets the option for trendlines. We override
the default label using <code>labelInLegend</code> option.</li>
</ul>
<div class="figure" style="text-align: center">
<img src="images/gee_charts/time_series_trend.png" alt="Time-Series Chart with Trendline" width="75%" />
<p class="caption">
Time-Series Chart with Trendline
</p>
</div>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3A01-Time_Series_Charts%2F02b_Time_Series_With_Trend_(complete)"
target="_blank">Open in Code Editor ↗</a></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co">// Select a region</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="kw">var</span> geometry <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Point</span>([<span class="fl">77.6045</span><span class="op">,</span> <span class="fl">12.8992</span>])<span class="op">;</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">// We use the CHIRPS Rainfall Dataset</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="kw">var</span> chirps <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&#39;UCSB-CHG/CHIRPS/PENTAD&#39;</span>)<span class="op">;</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">// We will compute the trend of total annual precipitation</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="kw">var</span> createAnnualImage <span class="op">=</span> <span class="kw">function</span>(year) {</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>  <span class="kw">var</span> startDate <span class="op">=</span> ee<span class="op">.</span><span class="at">Date</span><span class="op">.</span><span class="fu">fromYMD</span>(year<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>  <span class="kw">var</span> endDate <span class="op">=</span> startDate<span class="op">.</span><span class="fu">advance</span>(<span class="dv">1</span><span class="op">,</span> <span class="st">&#39;year&#39;</span>)<span class="op">;</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>  <span class="kw">var</span> seasonFiltered <span class="op">=</span> chirps</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>    <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">date</span>(startDate<span class="op">,</span> endDate))<span class="op">;</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>  <span class="co">// Calculate total precipitation</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>  <span class="kw">var</span> total <span class="op">=</span> seasonFiltered<span class="op">.</span><span class="fu">reduce</span>(ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">sum</span>())<span class="op">.</span><span class="fu">rename</span>(<span class="st">&#39;Precipitation&#39;</span>)<span class="op">;</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>  <span class="cf">return</span> total<span class="op">.</span><span class="fu">set</span>({</span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>    <span class="st">&#39;system:time_start&#39;</span><span class="op">:</span> startDate<span class="op">.</span><span class="fu">millis</span>()<span class="op">,</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>    <span class="st">&#39;system:time_end&#39;</span><span class="op">:</span> endDate<span class="op">.</span><span class="fu">millis</span>()<span class="op">,</span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a>    <span class="st">&#39;year&#39;</span><span class="op">:</span> year<span class="op">,</span></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a><span class="co">// Aggregate Precipitation Data over 40 years</span></span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a><span class="kw">var</span> years <span class="op">=</span> ee<span class="op">.</span><span class="at">List</span><span class="op">.</span><span class="fu">sequence</span>(<span class="dv">1981</span><span class="op">,</span> <span class="dv">2020</span>)<span class="op">;</span></span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a><span class="kw">var</span> yearlyImages <span class="op">=</span> years<span class="op">.</span><span class="fu">map</span>(createAnnualImage)<span class="op">;</span></span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a><span class="kw">var</span> yearlyCol <span class="op">=</span> ee<span class="op">.</span><span class="at">ImageCollection</span><span class="op">.</span><span class="fu">fromImages</span>(yearlyImages)<span class="op">;</span></span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a></span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a><span class="co">// Create a time-series with a trendline</span></span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a><span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">image</span><span class="op">.</span><span class="fu">series</span>({</span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a>  <span class="dt">imageCollection</span><span class="op">:</span> yearlyCol<span class="op">,</span></span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a>  <span class="dt">region</span><span class="op">:</span> geometry<span class="op">,</span></span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">mean</span>()<span class="op">,</span></span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">5566</span><span class="op">,</span></span>
<span id="cb3-33"><a href="#cb3-33" tabindex="-1"></a>})<span class="op">.</span><span class="fu">setOptions</span>({</span>
<span id="cb3-34"><a href="#cb3-34" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Annual Total Precipitation&#39;</span><span class="op">,</span></span>
<span id="cb3-35"><a href="#cb3-35" tabindex="-1"></a>    <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;blue&#39;</span><span class="op">,</span></span>
<span id="cb3-36"><a href="#cb3-36" tabindex="-1"></a>    <span class="dt">pointSize</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb3-37"><a href="#cb3-37" tabindex="-1"></a>    <span class="dt">lineWidth</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb3-38"><a href="#cb3-38" tabindex="-1"></a>    <span class="dt">vAxis</span><span class="op">:</span> {</span>
<span id="cb3-39"><a href="#cb3-39" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Rainfall (mm)&#39;</span><span class="op">,</span></span>
<span id="cb3-40"><a href="#cb3-40" tabindex="-1"></a>      <span class="dt">ticks</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">200</span><span class="op">,</span> <span class="dv">400</span><span class="op">,</span> <span class="dv">600</span><span class="op">,</span> <span class="dv">800</span><span class="op">,</span> <span class="dv">1000</span><span class="op">,</span> <span class="dv">1200</span><span class="op">,</span> <span class="dv">1400</span>]<span class="op">,</span> </span>
<span id="cb3-41"><a href="#cb3-41" tabindex="-1"></a>      <span class="dt">gridlines</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;#f0f0f0&#39;</span>}</span>
<span id="cb3-42"><a href="#cb3-42" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb3-43"><a href="#cb3-43" tabindex="-1"></a>    <span class="dt">hAxis</span><span class="op">:</span> {</span>
<span id="cb3-44"><a href="#cb3-44" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Year&#39;</span><span class="op">,</span></span>
<span id="cb3-45"><a href="#cb3-45" tabindex="-1"></a>      <span class="dt">gridlines</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;#f0f0f0&#39;</span>}</span>
<span id="cb3-46"><a href="#cb3-46" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb3-47"><a href="#cb3-47" tabindex="-1"></a>    <span class="dt">legend</span><span class="op">:</span> {</span>
<span id="cb3-48"><a href="#cb3-48" tabindex="-1"></a>      <span class="dt">position</span><span class="op">:</span> <span class="st">&#39;in&#39;</span></span>
<span id="cb3-49"><a href="#cb3-49" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb3-50"><a href="#cb3-50" tabindex="-1"></a>    <span class="dt">series</span><span class="op">:</span> {</span>
<span id="cb3-51"><a href="#cb3-51" tabindex="-1"></a>      <span class="dv">0</span><span class="op">:</span> {</span>
<span id="cb3-52"><a href="#cb3-52" tabindex="-1"></a>        <span class="dt">visibleInLegend</span><span class="op">:</span> <span class="kw">false</span></span>
<span id="cb3-53"><a href="#cb3-53" tabindex="-1"></a>      }</span>
<span id="cb3-54"><a href="#cb3-54" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb3-55"><a href="#cb3-55" tabindex="-1"></a>    <span class="dt">trendlines</span><span class="op">:</span> {</span>
<span id="cb3-56"><a href="#cb3-56" tabindex="-1"></a>      <span class="dv">0</span><span class="op">:</span> {</span>
<span id="cb3-57"><a href="#cb3-57" tabindex="-1"></a>        <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;linear&#39;</span><span class="op">,</span> </span>
<span id="cb3-58"><a href="#cb3-58" tabindex="-1"></a>        <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;black&#39;</span><span class="op">,</span> </span>
<span id="cb3-59"><a href="#cb3-59" tabindex="-1"></a>        <span class="dt">lineWidth</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb3-60"><a href="#cb3-60" tabindex="-1"></a>        <span class="dt">pointSize</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb3-61"><a href="#cb3-61" tabindex="-1"></a>        <span class="dt">visibleInLegend</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb3-62"><a href="#cb3-62" tabindex="-1"></a>        <span class="dt">labelInLegend</span><span class="op">:</span> <span class="st">&#39;Precipitation Trend&#39;</span><span class="op">,</span></span>
<span id="cb3-63"><a href="#cb3-63" tabindex="-1"></a>      }</span>
<span id="cb3-64"><a href="#cb3-64" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb3-65"><a href="#cb3-65" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb3-66"><a href="#cb3-66" tabindex="-1"></a><span class="fu">print</span>(chart)<span class="op">;</span></span></code></pre></div>
<div id="exercise-1" class="section level3">
<h3>Exercise</h3>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3A01-Time_Series_Charts%2F02c_Time_Series_With_Trend_(exercise)"
target="_blank">Open in Code Editor ↗</a></p>
<pre><code>// Exercise

// a) Delete the &#39;geometry&#39; and add a new point at your chosen location
// b) Modify the chart options to remove the legend from the chart.
// c) Print the chart.

// Hint: Use legend &#39;position&#39; option
// See reference:
// https://developers.google.com/chart/interactive/docs/gallery/linechart</code></pre>
</div>
</div>
<div id="time-series-at-multiple-locations" class="section level2">
<h2>1.3 Time-Series at Multiple Locations</h2>
<p>So far, we have learnt how to display time-series of one or more
variables at a single location using the
<code>ui.Chart.image.series()</code> function. If you wanted to plot
time-series of multiple locations in a single chart, you can use the
<code>ui.Chart.image.series.byRegion()</code> function. This function
takes a FeatureCollection with one or more locations and extract the
time-series at each geometry.</p>
<p>Here we take the Global Forecast System (GFS) dataset and create a
chart of 16-day temperature-forecasts at 2 cities.</p>
<div class="figure" style="text-align: center">
<img src="images/gee_charts/time_series_by_region.png" alt="Time-Series Chart at Multiple Locations" width="75%" />
<p class="caption">
Time-Series Chart at Multiple Locations
</p>
</div>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3A01-Time_Series_Charts%2F03b_Time_Series_By_Region_(complete)"
target="_blank">Open in Code Editor ↗</a></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co">// Select the locations</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="kw">var</span> geometry1 <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Point</span>([<span class="fl">72.57</span><span class="op">,</span> <span class="fl">23.04</span>])<span class="op">;</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="kw">var</span> geometry2 <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Point</span>([<span class="fl">77.58</span><span class="op">,</span> <span class="fl">12.97</span>])<span class="op">;</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>    </span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">// We use the NOAA GFS dataset</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="kw">var</span> gfs <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&#39;NOAA/GFS0P25&#39;</span>)<span class="op">;</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">// Select the temperature band</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="kw">var</span> forecast <span class="op">=</span> gfs<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;temperature_2m_above_ground&#39;</span>)<span class="op">;</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">// Get the forecasts for today</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">// Forecasts are generated every 6 hours</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co">// To account for ingestion delay, we get the forests</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">// generated in past 12 hours</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="co">// If you still get an error, increase the number of hours</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="kw">var</span> periodHours <span class="op">=</span> <span class="dv">12</span><span class="op">;</span> </span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="kw">var</span> now <span class="op">=</span> ee<span class="op">.</span><span class="fu">Date</span>(<span class="bu">Date</span><span class="op">.</span><span class="fu">now</span>())<span class="op">;</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="kw">var</span> before <span class="op">=</span> now<span class="op">.</span><span class="fu">advance</span>(<span class="op">-</span>periodHours<span class="op">,</span> <span class="st">&#39;hour&#39;</span>)<span class="op">;</span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a><span class="kw">var</span> filtered <span class="op">=</span> forecast</span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">date</span>(before<span class="op">,</span> now))<span class="op">;</span></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a></span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a><span class="co">// All forecast images have a timestamp of the current day</span></span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a><span class="co">// As we want a time-series of forecasts, we update the</span></span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a><span class="co">// timestamp to the date the image is forecasting.</span></span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a><span class="kw">var</span> filtered <span class="op">=</span> filtered<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;temperature_2m_above_ground&#39;</span>)</span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a>  <span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(image) {</span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a>    <span class="kw">var</span> forecastTime <span class="op">=</span> image<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;forecast_time&#39;</span>)<span class="op">;</span></span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a>    <span class="cf">return</span> image<span class="op">.</span><span class="fu">set</span>(<span class="st">&#39;system:time_start&#39;</span><span class="op">,</span> forecastTime)<span class="op">;</span></span>
<span id="cb5-31"><a href="#cb5-31" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb5-32"><a href="#cb5-32" tabindex="-1"></a></span>
<span id="cb5-33"><a href="#cb5-33" tabindex="-1"></a><span class="co">// Create a chart of forecast at a single location</span></span>
<span id="cb5-34"><a href="#cb5-34" tabindex="-1"></a><span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">image</span><span class="op">.</span><span class="fu">series</span>({</span>
<span id="cb5-35"><a href="#cb5-35" tabindex="-1"></a>  <span class="dt">imageCollection</span><span class="op">:</span> filtered<span class="op">,</span></span>
<span id="cb5-36"><a href="#cb5-36" tabindex="-1"></a>  <span class="dt">region</span><span class="op">:</span> geometry1<span class="op">,</span></span>
<span id="cb5-37"><a href="#cb5-37" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">first</span>()<span class="op">,</span></span>
<span id="cb5-38"><a href="#cb5-38" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">27830</span>})<span class="op">.</span><span class="fu">setOptions</span>({</span>
<span id="cb5-39"><a href="#cb5-39" tabindex="-1"></a>    <span class="dt">lineWidth</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb5-40"><a href="#cb5-40" tabindex="-1"></a>    <span class="dt">pointSize</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb5-41"><a href="#cb5-41" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Temperature Forecast at a Single Location&#39;</span><span class="op">,</span></span>
<span id="cb5-42"><a href="#cb5-42" tabindex="-1"></a>    <span class="dt">vAxis</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Temparature (°C)&#39;</span>}<span class="op">,</span></span>
<span id="cb5-43"><a href="#cb5-43" tabindex="-1"></a>    <span class="dt">hAxis</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">&#39;&#39;</span><span class="op">,</span> <span class="dt">format</span><span class="op">:</span> <span class="st">&#39;YYYY-MM-dd&#39;</span>}<span class="op">,</span></span>
<span id="cb5-44"><a href="#cb5-44" tabindex="-1"></a>    <span class="dt">series</span><span class="op">:</span> {</span>
<span id="cb5-45"><a href="#cb5-45" tabindex="-1"></a>      <span class="dv">0</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;#fc8d62&#39;</span>}<span class="op">,</span></span>
<span id="cb5-46"><a href="#cb5-46" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb5-47"><a href="#cb5-47" tabindex="-1"></a>    <span class="dt">legend</span><span class="op">:</span> {</span>
<span id="cb5-48"><a href="#cb5-48" tabindex="-1"></a>      <span class="dt">position</span><span class="op">:</span> <span class="st">&#39;none&#39;</span></span>
<span id="cb5-49"><a href="#cb5-49" tabindex="-1"></a>    }</span>
<span id="cb5-50"><a href="#cb5-50" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb5-51"><a href="#cb5-51" tabindex="-1"></a><span class="fu">print</span>(chart)<span class="op">;</span></span>
<span id="cb5-52"><a href="#cb5-52" tabindex="-1"></a></span>
<span id="cb5-53"><a href="#cb5-53" tabindex="-1"></a></span>
<span id="cb5-54"><a href="#cb5-54" tabindex="-1"></a><span class="co">// For plotting multiple locations, we need a FeatureCollection</span></span>
<span id="cb5-55"><a href="#cb5-55" tabindex="-1"></a><span class="kw">var</span> locations <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>([</span>
<span id="cb5-56"><a href="#cb5-56" tabindex="-1"></a>  ee<span class="op">.</span><span class="fu">Feature</span>(geometry1<span class="op">,</span> {<span class="st">&#39;name&#39;</span><span class="op">:</span> <span class="st">&#39;Ahmedabad&#39;</span>})<span class="op">,</span></span>
<span id="cb5-57"><a href="#cb5-57" tabindex="-1"></a>  ee<span class="op">.</span><span class="fu">Feature</span>(geometry2<span class="op">,</span> {<span class="st">&#39;name&#39;</span><span class="op">:</span> <span class="st">&#39;Bengaluru&#39;</span>})</span>
<span id="cb5-58"><a href="#cb5-58" tabindex="-1"></a>  ])<span class="op">;</span></span>
<span id="cb5-59"><a href="#cb5-59" tabindex="-1"></a>  </span>
<span id="cb5-60"><a href="#cb5-60" tabindex="-1"></a><span class="co">// Create a chart of forecasted temperatures</span></span>
<span id="cb5-61"><a href="#cb5-61" tabindex="-1"></a></span>
<span id="cb5-62"><a href="#cb5-62" tabindex="-1"></a><span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">image</span><span class="op">.</span><span class="fu">seriesByRegion</span>({</span>
<span id="cb5-63"><a href="#cb5-63" tabindex="-1"></a>  <span class="dt">imageCollection</span><span class="op">:</span> filtered<span class="op">,</span></span>
<span id="cb5-64"><a href="#cb5-64" tabindex="-1"></a>  <span class="dt">regions</span><span class="op">:</span> locations<span class="op">,</span></span>
<span id="cb5-65"><a href="#cb5-65" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">first</span>()<span class="op">,</span></span>
<span id="cb5-66"><a href="#cb5-66" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">27830</span><span class="op">,</span></span>
<span id="cb5-67"><a href="#cb5-67" tabindex="-1"></a>  <span class="dt">seriesProperty</span><span class="op">:</span> <span class="st">&#39;name&#39;</span></span>
<span id="cb5-68"><a href="#cb5-68" tabindex="-1"></a>})<span class="op">.</span><span class="fu">setOptions</span>({</span>
<span id="cb5-69"><a href="#cb5-69" tabindex="-1"></a>      <span class="dt">lineWidth</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb5-70"><a href="#cb5-70" tabindex="-1"></a>      <span class="dt">pointSize</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb5-71"><a href="#cb5-71" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Temperature Forecast at Multiple Locations&#39;</span><span class="op">,</span></span>
<span id="cb5-72"><a href="#cb5-72" tabindex="-1"></a>      <span class="dt">vAxis</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Temperature (°C)&#39;</span>}<span class="op">,</span></span>
<span id="cb5-73"><a href="#cb5-73" tabindex="-1"></a>      <span class="dt">hAxis</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">&#39;&#39;</span><span class="op">,</span> <span class="dt">format</span><span class="op">:</span> <span class="st">&#39;YYYY-MM-dd&#39;</span>}<span class="op">,</span></span>
<span id="cb5-74"><a href="#cb5-74" tabindex="-1"></a>      <span class="dt">series</span><span class="op">:</span> {</span>
<span id="cb5-75"><a href="#cb5-75" tabindex="-1"></a>        <span class="dv">0</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;#fc8d62&#39;</span>}<span class="op">,</span></span>
<span id="cb5-76"><a href="#cb5-76" tabindex="-1"></a>        <span class="dv">1</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;#8da0cb&#39;</span>}</span>
<span id="cb5-77"><a href="#cb5-77" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb5-78"><a href="#cb5-78" tabindex="-1"></a>      <span class="dt">legend</span><span class="op">:</span> {</span>
<span id="cb5-79"><a href="#cb5-79" tabindex="-1"></a>        <span class="dt">position</span><span class="op">:</span> <span class="st">&#39;top&#39;</span></span>
<span id="cb5-80"><a href="#cb5-80" tabindex="-1"></a>      }</span>
<span id="cb5-81"><a href="#cb5-81" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb5-82"><a href="#cb5-82" tabindex="-1"></a><span class="fu">print</span>(chart)<span class="op">;</span></span></code></pre></div>
<div id="exercise-2" class="section level3">
<h3>Exercise</h3>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3A01-Time_Series_Charts%2F03c_Time_Series_By_Region_(exercise)"
target="_blank">Open in Code Editor ↗</a></p>
<pre><code>// Exercise

// a) Replace the &#39;geometry1&#39; and &#39;geometry2&#39; points with your chosen locations.
// b) Modify the chart options to limit the Y-Axis range to the 
//    actual range of temperatures at your chosen locations (i.e. between 20-45 degrees)
// c) Print the chart.</code></pre>
</div>
</div>
<div id="multi-year-time-series" class="section level2">
<h2>1.4 Multi-Year Time-Series</h2>
<p>Another useful function to plot time-series is
`<code>ui.Chart.image.doySeriesByYear()</code> that extracts and plots
values from an image band at different Day-Of-Year (DOY) over many
years. This type of chart is helpful visualize both inter-annual and
inter-annual variations in a single chart.</p>
<p>Here we take the MODIS 16-day Vegetation Indices (VI) dataset and
create a chart of NDVI Time-Series over 4 years.</p>
<p>Here are the styling options applied to the time-series chart:</p>
<ul>
<li><code>interpolateNulls</code>: Sets whether to fill missing (i.e
masked) time-series values</li>
<li><code>curveType</code>: Apply smoothing on the time-series by <a
href="https://developers.google.com/chart/interactive/docs/gallery/linechart#curving-the-lines">fitting
a function</a>.</li>
</ul>
<div class="figure" style="text-align: center">
<img src="images/gee_charts/time_series_by_year.png" alt="DOY Time-Series Chart" width="75%" />
<p class="caption">
DOY Time-Series Chart
</p>
</div>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3A01-Time_Series_Charts%2F04b_Time_Series_By_Year_(complete)"
target="_blank">Open in Code Editor ↗</a></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co">// Select a location</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="kw">var</span> geometry <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Point</span>([<span class="fl">81.73099978484261</span><span class="op">,</span> <span class="fl">27.371459793533507</span>])<span class="op">;</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">// We use the MODIS 16-day Vegetation Indicies dataset</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="kw">var</span> modis <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&#39;MODIS/061/MOD13Q1&#39;</span>)<span class="op">;</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">// Filter the collection</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="kw">var</span> startYear <span class="op">=</span> <span class="dv">2019</span><span class="op">;</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="kw">var</span> endYear <span class="op">=</span> <span class="dv">2022</span><span class="op">;</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="kw">var</span> startDate <span class="op">=</span> ee<span class="op">.</span><span class="at">Date</span><span class="op">.</span><span class="fu">fromYMD</span>(startYear<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="kw">var</span> endDate <span class="op">=</span> ee<span class="op">.</span><span class="at">Date</span><span class="op">.</span><span class="fu">fromYMD</span>(endYear <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="kw">var</span> filtered <span class="op">=</span> modis</span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">date</span>(startDate<span class="op">,</span> endDate))</span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a>  </span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="co">// Pre-Processing: Cloud Masking and Scaling</span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a><span class="co">// Function for Cloud Masking</span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a><span class="kw">var</span> bitwiseExtract <span class="op">=</span> <span class="kw">function</span>(input<span class="op">,</span> fromBit<span class="op">,</span> toBit) {</span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a>  <span class="kw">var</span> maskSize <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(<span class="dv">1</span>)<span class="op">.</span><span class="fu">add</span>(toBit)<span class="op">.</span><span class="fu">subtract</span>(fromBit)</span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a>  <span class="kw">var</span> mask <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(<span class="dv">1</span>)<span class="op">.</span><span class="fu">leftShift</span>(maskSize)<span class="op">.</span><span class="fu">subtract</span>(<span class="dv">1</span>)</span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a>  <span class="cf">return</span> input<span class="op">.</span><span class="fu">rightShift</span>(fromBit)<span class="op">.</span><span class="fu">bitwiseAnd</span>(mask)</span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a>}</span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a></span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a><span class="kw">var</span> maskSnowAndClouds <span class="op">=</span> <span class="kw">function</span>(image) {</span>
<span id="cb7-27"><a href="#cb7-27" tabindex="-1"></a>  <span class="kw">var</span> summaryQa <span class="op">=</span> image<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;SummaryQA&#39;</span>)</span>
<span id="cb7-28"><a href="#cb7-28" tabindex="-1"></a>  <span class="co">// Select pixels which are less than or equals to 1 (0 or 1)</span></span>
<span id="cb7-29"><a href="#cb7-29" tabindex="-1"></a>  <span class="kw">var</span> qaMask <span class="op">=</span> <span class="fu">bitwiseExtract</span>(summaryQa<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">.</span><span class="fu">lte</span>(<span class="dv">1</span>)</span>
<span id="cb7-30"><a href="#cb7-30" tabindex="-1"></a>  <span class="kw">var</span> maskedImage <span class="op">=</span> image<span class="op">.</span><span class="fu">updateMask</span>(qaMask)</span>
<span id="cb7-31"><a href="#cb7-31" tabindex="-1"></a>  <span class="cf">return</span> maskedImage<span class="op">.</span><span class="fu">copyProperties</span>(</span>
<span id="cb7-32"><a href="#cb7-32" tabindex="-1"></a>    image<span class="op">,</span> [<span class="st">&#39;system:index&#39;</span><span class="op">,</span> <span class="st">&#39;system:time_start&#39;</span>])</span>
<span id="cb7-33"><a href="#cb7-33" tabindex="-1"></a>}</span>
<span id="cb7-34"><a href="#cb7-34" tabindex="-1"></a></span>
<span id="cb7-35"><a href="#cb7-35" tabindex="-1"></a><span class="co">// Function for Scaling Pixel Values</span></span>
<span id="cb7-36"><a href="#cb7-36" tabindex="-1"></a><span class="co">// MODIS NDVI values come as NDVI x 10000</span></span>
<span id="cb7-37"><a href="#cb7-37" tabindex="-1"></a><span class="co">// that need to be scaled by 0.0001</span></span>
<span id="cb7-38"><a href="#cb7-38" tabindex="-1"></a><span class="kw">var</span> ndviScaled <span class="op">=</span> <span class="kw">function</span>(image) {</span>
<span id="cb7-39"><a href="#cb7-39" tabindex="-1"></a>  <span class="kw">var</span> scaled <span class="op">=</span> image<span class="op">.</span><span class="fu">divide</span>(<span class="dv">10000</span>)</span>
<span id="cb7-40"><a href="#cb7-40" tabindex="-1"></a>  <span class="cf">return</span> scaled<span class="op">.</span><span class="fu">copyProperties</span>(</span>
<span id="cb7-41"><a href="#cb7-41" tabindex="-1"></a>    image<span class="op">,</span> [<span class="st">&#39;system:index&#39;</span><span class="op">,</span> <span class="st">&#39;system:time_start&#39;</span>])</span>
<span id="cb7-42"><a href="#cb7-42" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb7-43"><a href="#cb7-43" tabindex="-1"></a></span>
<span id="cb7-44"><a href="#cb7-44" tabindex="-1"></a><span class="co">// Apply the functions and select the &#39;NDVI&#39; band</span></span>
<span id="cb7-45"><a href="#cb7-45" tabindex="-1"></a><span class="kw">var</span> processedCol <span class="op">=</span> filtered</span>
<span id="cb7-46"><a href="#cb7-46" tabindex="-1"></a>  <span class="op">.</span><span class="fu">map</span>(maskSnowAndClouds)</span>
<span id="cb7-47"><a href="#cb7-47" tabindex="-1"></a>  <span class="op">.</span><span class="fu">map</span>(ndviScaled)</span>
<span id="cb7-48"><a href="#cb7-48" tabindex="-1"></a>  <span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;NDVI&#39;</span>)<span class="op">;</span></span>
<span id="cb7-49"><a href="#cb7-49" tabindex="-1"></a></span>
<span id="cb7-50"><a href="#cb7-50" tabindex="-1"></a><span class="co">// Plot a time-series</span></span>
<span id="cb7-51"><a href="#cb7-51" tabindex="-1"></a><span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">image</span><span class="op">.</span><span class="fu">series</span>({</span>
<span id="cb7-52"><a href="#cb7-52" tabindex="-1"></a>  <span class="dt">imageCollection</span><span class="op">:</span> processedCol<span class="op">,</span></span>
<span id="cb7-53"><a href="#cb7-53" tabindex="-1"></a>  <span class="dt">region</span><span class="op">:</span> geometry<span class="op">,</span></span>
<span id="cb7-54"><a href="#cb7-54" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">mean</span>()<span class="op">,</span></span>
<span id="cb7-55"><a href="#cb7-55" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">250</span></span>
<span id="cb7-56"><a href="#cb7-56" tabindex="-1"></a>})<span class="op">.</span><span class="fu">setOptions</span>({</span>
<span id="cb7-57"><a href="#cb7-57" tabindex="-1"></a>    <span class="dt">interpolateNulls</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb7-58"><a href="#cb7-58" tabindex="-1"></a>    <span class="dt">lineWidth</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb7-59"><a href="#cb7-59" tabindex="-1"></a>    <span class="dt">pointSize</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb7-60"><a href="#cb7-60" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;NDVI Time-Series&#39;</span><span class="op">,</span></span>
<span id="cb7-61"><a href="#cb7-61" tabindex="-1"></a>    <span class="dt">vAxis</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">&#39;NDVI&#39;</span>}<span class="op">,</span></span>
<span id="cb7-62"><a href="#cb7-62" tabindex="-1"></a>})</span>
<span id="cb7-63"><a href="#cb7-63" tabindex="-1"></a><span class="fu">print</span>(chart)<span class="op">;</span></span>
<span id="cb7-64"><a href="#cb7-64" tabindex="-1"></a></span>
<span id="cb7-65"><a href="#cb7-65" tabindex="-1"></a><span class="co">// We can plot a yearly time-series </span></span>
<span id="cb7-66"><a href="#cb7-66" tabindex="-1"></a><span class="co">// that allows us to compare changes over time</span></span>
<span id="cb7-67"><a href="#cb7-67" tabindex="-1"></a><span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">image</span><span class="op">.</span><span class="fu">doySeriesByYear</span>({</span>
<span id="cb7-68"><a href="#cb7-68" tabindex="-1"></a>  <span class="dt">imageCollection</span><span class="op">:</span> processedCol<span class="op">,</span></span>
<span id="cb7-69"><a href="#cb7-69" tabindex="-1"></a>  <span class="dt">region</span><span class="op">:</span> geometry<span class="op">,</span></span>
<span id="cb7-70"><a href="#cb7-70" tabindex="-1"></a>  <span class="dt">regionReducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">mean</span>()<span class="op">,</span></span>
<span id="cb7-71"><a href="#cb7-71" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">250</span><span class="op">,</span></span>
<span id="cb7-72"><a href="#cb7-72" tabindex="-1"></a>  <span class="dt">bandName</span><span class="op">:</span> <span class="st">&#39;NDVI&#39;</span></span>
<span id="cb7-73"><a href="#cb7-73" tabindex="-1"></a>})<span class="op">.</span><span class="fu">setOptions</span>({</span>
<span id="cb7-74"><a href="#cb7-74" tabindex="-1"></a>      <span class="dt">interpolateNulls</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb7-75"><a href="#cb7-75" tabindex="-1"></a>      <span class="dt">curveType</span><span class="op">:</span> <span class="st">&#39;function&#39;</span><span class="op">,</span></span>
<span id="cb7-76"><a href="#cb7-76" tabindex="-1"></a>      <span class="dt">lineWidth</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb7-77"><a href="#cb7-77" tabindex="-1"></a>      <span class="dt">pointSize</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb7-78"><a href="#cb7-78" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Multi-Year NDVI Time-Series&#39;</span><span class="op">,</span></span>
<span id="cb7-79"><a href="#cb7-79" tabindex="-1"></a>      <span class="dt">vAxis</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">&#39;NDVI&#39;</span>}<span class="op">,</span></span>
<span id="cb7-80"><a href="#cb7-80" tabindex="-1"></a>      <span class="dt">hAxis</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Day-of-Year&#39;</span>}<span class="op">,</span></span>
<span id="cb7-81"><a href="#cb7-81" tabindex="-1"></a>      <span class="dt">legend</span><span class="op">:</span> {<span class="dt">position</span><span class="op">:</span> <span class="st">&#39;top&#39;</span>}</span>
<span id="cb7-82"><a href="#cb7-82" tabindex="-1"></a>    })</span>
<span id="cb7-83"><a href="#cb7-83" tabindex="-1"></a><span class="fu">print</span>(chart)</span></code></pre></div>
<div id="exercise-3" class="section level3">
<h3>Exercise</h3>
<div class="figure" style="text-align: center">
<img src="images/gee_charts/time_series_by_year_exercise.png" alt="Exercise 04c" width="100%" />
<p class="caption">
Exercise 04c
</p>
</div>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3A01-Time_Series_Charts%2F04c_Time_Series_By_Year_(exercise)"
target="_blank">Open in Code Editor ↗</a></p>
<pre><code>// Exercise

// a) Replace the &#39;geometry&#39; with your chosen location.
// b) Modify the chart to specify custom colors for each year.
//    Use color codes from https://colorbrewer2.org/
// c) Modify the chart to plot only the time-series
//    with lines without any points.
// c) Print the chart.</code></pre>
</div>
</div>
</div>
<div id="module-2.-image-charts" class="section level1">
<h1>Module 2. Image Charts</h1>
<p>This section covers charting functions and techniques to plot values
from an image. We will also learn how to deal with limitations of the
charting API and create plots by extracting data from large regions.</p>
<p><a
href="https://www.youtube.com/watch?v=6LYOBYujE8U&amp;list=PLppGmFLhQ1HKyrR75waIq6TfqL0ESlQao&amp;index=11"
target="_blank"><img
src="https://img.youtube.com/vi/6LYOBYujE8U/mqdefault.jpg"
alt="Start Module 2 Videos" /></a></p>
<p><a
href="https://www.youtube.com/watch?v=6LYOBYujE8U&amp;list=PLppGmFLhQ1HKyrR75waIq6TfqL0ESlQao&amp;index=11"
target="_blank">Start Module 2 Videos ↗</a></p>
<div id="image-histogram" class="section level2">
<h2>2.1 Image Histogram</h2>
<p>A histogram plot is a bar chart showing count of pixel values.
Typically the pixel values are grouped into range of values called
<em>buckets</em> on the X-Axis and the total count of pixels is shown on
the Y-Axis.</p>
<p>Here we take the Harmonized Night Time Lights dataset that contains
images from both DMSP and VIIRS sensors.</p>
<p>Below is the list of styling options applied to the histogram:</p>
<ul>
<li><code>hAxis.ticks</code>: Sets the tick labels on the X-Axis.</li>
<li><code>bar.gap</code>: Sets the gap between each histogram bar</li>
</ul>
<div class="figure" style="text-align: center">
<img src="images/gee_charts/image_histogram.png" alt="Image Histogram" width="75%" />
<p class="caption">
Image Histogram
</p>
</div>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3A02-Image_Charts%2F01b_Image_Histogram_(complete)"
target="_blank">Open in Code Editor ↗</a></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co">// We use the Harmonized Global Night Time Lights (1992-2020) dataset</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="kw">var</span> dmsp <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&#39;projects/sat-io/open-datasets/Harmonized_NTL/dmsp&#39;</span>)<span class="op">;</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="kw">var</span> viirs <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&#39;projects/sat-io/open-datasets/Harmonized_NTL/viirs&#39;</span>)<span class="op">;</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">// Merge both collections to create a single Night Lights Collection</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="kw">var</span> ntlCol <span class="op">=</span> dmsp<span class="op">.</span><span class="fu">merge</span>(viirs)<span class="op">;</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">// Using GeoBoundries admin boundaries</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="kw">var</span> admin0 <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(<span class="st">&quot;projects/sat-io/open-datasets/geoboundaries/CGAZ_ADM0&quot;</span>)<span class="op">;</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="kw">var</span> admin1 <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(<span class="st">&quot;projects/sat-io/open-datasets/geoboundaries/CGAZ_ADM1&quot;</span>)<span class="op">;</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="kw">var</span> admin2 <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(<span class="st">&quot;projects/sat-io/open-datasets/geoboundaries/CGAZ_ADM2&quot;</span>)<span class="op">;</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co">// Select a Admin0 value</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="fu">print</span>(admin0<span class="op">.</span><span class="fu">aggregate_array</span>(<span class="st">&#39;shapeName&#39;</span>))<span class="op">;</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="kw">var</span> admin0Name <span class="op">=</span> <span class="st">&#39;Ghana&#39;</span><span class="op">;</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="co">// Now we have admin0 values, fetch admin1 values for that country</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a><span class="kw">var</span> selectedAdmin0 <span class="op">=</span> admin0<span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">eq</span>(<span class="st">&#39;shapeName&#39;</span><span class="op">,</span> admin0Name))<span class="op">;</span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="kw">var</span> shapeID <span class="op">=</span> ee<span class="op">.</span><span class="fu">Feature</span>(selectedAdmin0<span class="op">.</span><span class="fu">first</span>())<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;shapeID&#39;</span>)<span class="op">;</span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a><span class="kw">var</span> admin1Filtered <span class="op">=</span> admin1<span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">eq</span>(<span class="st">&#39;ADM0_shape&#39;</span><span class="op">,</span> shapeID))<span class="op">;</span></span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a></span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a><span class="co">// Select a Admin1 value</span></span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a><span class="fu">print</span>(admin1Filtered<span class="op">.</span><span class="fu">aggregate_array</span>(<span class="st">&#39;shapeName&#39;</span>))<span class="op">;</span></span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a><span class="kw">var</span> admin1Name <span class="op">=</span> <span class="st">&#39;Greater Accra&#39;</span><span class="op">;</span></span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a></span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a><span class="kw">var</span> selected <span class="op">=</span> admin1Filtered</span>
<span id="cb9-28"><a href="#cb9-28" tabindex="-1"></a>        <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">eq</span>(<span class="st">&#39;shapeName&#39;</span><span class="op">,</span> admin1Name))</span>
<span id="cb9-29"><a href="#cb9-29" tabindex="-1"></a>        </span>
<span id="cb9-30"><a href="#cb9-30" tabindex="-1"></a><span class="kw">var</span> geometry <span class="op">=</span> selected<span class="op">.</span><span class="fu">geometry</span>()<span class="op">;</span></span>
<span id="cb9-31"><a href="#cb9-31" tabindex="-1"></a></span>
<span id="cb9-32"><a href="#cb9-32" tabindex="-1"></a><span class="kw">var</span> year <span class="op">=</span> <span class="dv">2009</span><span class="op">;</span></span>
<span id="cb9-33"><a href="#cb9-33" tabindex="-1"></a><span class="kw">var</span> startDate <span class="op">=</span> ee<span class="op">.</span><span class="at">Date</span><span class="op">.</span><span class="fu">fromYMD</span>(year<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb9-34"><a href="#cb9-34" tabindex="-1"></a><span class="kw">var</span> endDate <span class="op">=</span> startDate<span class="op">.</span><span class="fu">advance</span>(<span class="dv">1</span><span class="op">,</span> <span class="st">&#39;year&#39;</span>)</span>
<span id="cb9-35"><a href="#cb9-35" tabindex="-1"></a></span>
<span id="cb9-36"><a href="#cb9-36" tabindex="-1"></a><span class="co">// We filter for the selected year</span></span>
<span id="cb9-37"><a href="#cb9-37" tabindex="-1"></a><span class="kw">var</span> filtered <span class="op">=</span> ntlCol</span>
<span id="cb9-38"><a href="#cb9-38" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">date</span>(startDate<span class="op">,</span> endDate))</span>
<span id="cb9-39"><a href="#cb9-39" tabindex="-1"></a></span>
<span id="cb9-40"><a href="#cb9-40" tabindex="-1"></a><span class="co">// Extract the image and set the masked pixels to 0</span></span>
<span id="cb9-41"><a href="#cb9-41" tabindex="-1"></a><span class="kw">var</span> ntlImage <span class="op">=</span> ee<span class="op">.</span><span class="fu">Image</span>(filtered<span class="op">.</span><span class="fu">first</span>())<span class="op">.</span><span class="fu">unmask</span>(<span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb9-42"><a href="#cb9-42" tabindex="-1"></a></span>
<span id="cb9-43"><a href="#cb9-43" tabindex="-1"></a><span class="kw">var</span> palette <span class="op">=</span>[<span class="st">&#39;#253494&#39;</span><span class="op">,</span><span class="st">&#39;#2c7fb8&#39;</span><span class="op">,</span><span class="st">&#39;#41b6c4&#39;</span><span class="op">,</span><span class="st">&#39;#a1dab4&#39;</span><span class="op">,</span><span class="st">&#39;#ffffcc&#39;</span> ]<span class="op">;</span></span>
<span id="cb9-44"><a href="#cb9-44" tabindex="-1"></a><span class="kw">var</span> ntlVis <span class="op">=</span> {<span class="dt">min</span><span class="op">:</span><span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">63</span><span class="op">,</span>  <span class="dt">palette</span><span class="op">:</span> palette}</span>
<span id="cb9-45"><a href="#cb9-45" tabindex="-1"></a></span>
<span id="cb9-46"><a href="#cb9-46" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">centerObject</span>(geometry<span class="op">,</span> <span class="dv">10</span>)<span class="op">;</span></span>
<span id="cb9-47"><a href="#cb9-47" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(ntlImage<span class="op">.</span><span class="fu">clip</span>(geometry)<span class="op">,</span> ntlVis<span class="op">,</span> <span class="st">&#39;Night Time Lights &#39;</span> <span class="op">+</span> year)<span class="op">;</span></span>
<span id="cb9-48"><a href="#cb9-48" tabindex="-1"></a></span>
<span id="cb9-49"><a href="#cb9-49" tabindex="-1"></a><span class="co">// Extract the native resolution of the image</span></span>
<span id="cb9-50"><a href="#cb9-50" tabindex="-1"></a><span class="kw">var</span> resolution <span class="op">=</span> ntlImage<span class="op">.</span><span class="fu">projection</span>()<span class="op">.</span><span class="fu">nominalScale</span>()<span class="op">;</span></span>
<span id="cb9-51"><a href="#cb9-51" tabindex="-1"></a></span>
<span id="cb9-52"><a href="#cb9-52" tabindex="-1"></a><span class="co">// NTL images have DN values from 0-63</span></span>
<span id="cb9-53"><a href="#cb9-53" tabindex="-1"></a><span class="co">// We can create a histogram to show pixel counts</span></span>
<span id="cb9-54"><a href="#cb9-54" tabindex="-1"></a><span class="co">// for each DN value</span></span>
<span id="cb9-55"><a href="#cb9-55" tabindex="-1"></a><span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">image</span><span class="op">.</span><span class="fu">histogram</span>({</span>
<span id="cb9-56"><a href="#cb9-56" tabindex="-1"></a>  <span class="dt">image</span><span class="op">:</span> ntlImage<span class="op">,</span></span>
<span id="cb9-57"><a href="#cb9-57" tabindex="-1"></a>  <span class="dt">region</span><span class="op">:</span> geometry<span class="op">,</span></span>
<span id="cb9-58"><a href="#cb9-58" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> resolution<span class="op">,</span></span>
<span id="cb9-59"><a href="#cb9-59" tabindex="-1"></a>  <span class="dt">maxBuckets</span><span class="op">:</span> <span class="dv">63</span><span class="op">,</span></span>
<span id="cb9-60"><a href="#cb9-60" tabindex="-1"></a>  <span class="dt">minBucketWidth</span><span class="op">:</span> <span class="dv">1</span>})</span>
<span id="cb9-61"><a href="#cb9-61" tabindex="-1"></a></span>
<span id="cb9-62"><a href="#cb9-62" tabindex="-1"></a><span class="fu">print</span>(chart)<span class="op">;</span></span>
<span id="cb9-63"><a href="#cb9-63" tabindex="-1"></a></span>
<span id="cb9-64"><a href="#cb9-64" tabindex="-1"></a><span class="co">// Add options to add labels and ticks</span></span>
<span id="cb9-65"><a href="#cb9-65" tabindex="-1"></a><span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">image</span><span class="op">.</span><span class="fu">histogram</span>({</span>
<span id="cb9-66"><a href="#cb9-66" tabindex="-1"></a>  <span class="dt">image</span><span class="op">:</span> ntlImage<span class="op">,</span></span>
<span id="cb9-67"><a href="#cb9-67" tabindex="-1"></a>  <span class="dt">region</span><span class="op">:</span> geometry<span class="op">,</span></span>
<span id="cb9-68"><a href="#cb9-68" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> resolution<span class="op">,</span></span>
<span id="cb9-69"><a href="#cb9-69" tabindex="-1"></a>  <span class="dt">maxBuckets</span><span class="op">:</span> <span class="dv">63</span><span class="op">,</span></span>
<span id="cb9-70"><a href="#cb9-70" tabindex="-1"></a>  <span class="dt">minBucketWidth</span><span class="op">:</span> <span class="dv">1</span></span>
<span id="cb9-71"><a href="#cb9-71" tabindex="-1"></a>})<span class="op">.</span><span class="fu">setOptions</span>({</span>
<span id="cb9-72"><a href="#cb9-72" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Night Time Lights Distribution for &#39;</span> <span class="op">+</span> admin1Name <span class="op">+</span> <span class="st">&#39; &#39;</span> <span class="op">+</span> year<span class="op">,</span></span>
<span id="cb9-73"><a href="#cb9-73" tabindex="-1"></a>    <span class="dt">vAxis</span><span class="op">:</span> {</span>
<span id="cb9-74"><a href="#cb9-74" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Number of Grids&#39;</span><span class="op">,</span> </span>
<span id="cb9-75"><a href="#cb9-75" tabindex="-1"></a>      <span class="dt">gridlines</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;transparent&#39;</span>}<span class="op">,</span></span>
<span id="cb9-76"><a href="#cb9-76" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb9-77"><a href="#cb9-77" tabindex="-1"></a>    <span class="dt">hAxis</span><span class="op">:</span> {</span>
<span id="cb9-78"><a href="#cb9-78" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Level of Observed Nighttime Lights&#39;</span><span class="op">,</span></span>
<span id="cb9-79"><a href="#cb9-79" tabindex="-1"></a>      <span class="dt">ticks</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">13</span><span class="op">,</span> <span class="dv">21</span><span class="op">,</span> <span class="dv">29</span><span class="op">,</span> <span class="dv">37</span><span class="op">,</span> <span class="dv">45</span><span class="op">,</span> <span class="dv">53</span><span class="op">,</span> <span class="dv">61</span>]<span class="op">,</span></span>
<span id="cb9-80"><a href="#cb9-80" tabindex="-1"></a>      <span class="dt">gridlines</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;transparent&#39;</span>}</span>
<span id="cb9-81"><a href="#cb9-81" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb9-82"><a href="#cb9-82" tabindex="-1"></a>    <span class="dt">bar</span><span class="op">:</span> { <span class="dt">gap</span><span class="op">:</span> <span class="dv">1</span> }<span class="op">,</span></span>
<span id="cb9-83"><a href="#cb9-83" tabindex="-1"></a>    <span class="dt">legend</span><span class="op">:</span> { <span class="dt">position</span><span class="op">:</span> <span class="st">&#39;none&#39;</span> }<span class="op">,</span></span>
<span id="cb9-84"><a href="#cb9-84" tabindex="-1"></a>    <span class="dt">colors</span><span class="op">:</span> [<span class="st">&#39;#525252&#39;</span>]</span>
<span id="cb9-85"><a href="#cb9-85" tabindex="-1"></a>  })</span>
<span id="cb9-86"><a href="#cb9-86" tabindex="-1"></a>  </span>
<span id="cb9-87"><a href="#cb9-87" tabindex="-1"></a><span class="fu">print</span>(chart)<span class="op">;</span>  </span></code></pre></div>
<div id="exercise-4" class="section level3">
<h3>Exercise</h3>
<div class="figure" style="text-align: center">
<img src="images/gee_charts/image_histogram_exercise.png" alt="Exercise 01c" width="100%" />
<p class="caption">
Exercise 01c
</p>
</div>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3A02-Image_Charts%2F01c_Image_Histogram_(exercise)"
target="_blank">Open in Code Editor ↗</a></p>
<pre><code>// Exercise

// The code now has a function createChart that creates a chart
// for the given year

// a) Change the name of the country to your chosen country
// b) Call the function to create histograms for the year 2010 and 2020
// c) Print the charts. 

// Tip: Adjust the hAxis.viewWindow parameter to appropriate values
//      for your chosen country</code></pre>
</div>
</div>
<div id="image-scatter-chart" class="section level2">
<h2>2.2 Image Scatter Chart</h2>
<p>A scatter plot is useful to explore the relationship between 2
variables. In Earth Engine, you can extract the pixel values from an
image using any of the sampling functions such as <code>sample()</code>
or <code>stratifiedSample()</code> to get a FeatureCollection with pixel
values for a random subset of the pixels. We can then plot the results
using the built-in charting functions for FeatureCollections.</p>
<p>Here we use the Sentinel-2 Surface Reflectance dataset along with
Global Surface Water Yearly Water History dataset to get reflectance
values of water and non-water pixels within the chosen region. We then
use the <code>ui.Chart.feature.groups()</code> function to plot the
results. Note that you can explicitly set the desired chart type using
the <code>setChartType()</code> function.</p>
<p>Below is the list of new styling options applied to the scatter
plot:</p>
<ul>
<li><code>titleTextStyle</code>: Sets the style of the title text.</li>
<li><code>dataOpacity</code>: Sets the transparency for the data points.
Useful when you have overlapping data points.</li>
<li><code>pointShape</code>: Sets the shape of the marker from the <a
href="https://developers.google.com/chart/interactive/docs/points">available
marker shapes</a>.</li>
</ul>
<div class="figure" style="text-align: center">
<img src="images/gee_charts/image_scatterchart.png" alt="Scatter Plot" width="75%" />
<p class="caption">
Scatter Plot
</p>
</div>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3A02-Image_Charts%2F02b_Image_Scatter_Chart_(complete)"
target="_blank">Open in Code Editor ↗</a></p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode js"><code class="sourceCode javascript"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co">// We want to plot the relationship between</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="co">// 2 spectral bands for different classes</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">// Select a region</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="kw">var</span> geometry <span class="op">=</span>   ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Polygon</span>([[</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>  [<span class="fl">76.816</span><span class="op">,</span> <span class="fl">13.006</span>]<span class="op">,</span>[<span class="fl">76.816</span><span class="op">,</span> <span class="fl">12.901</span>]<span class="op">,</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>  [<span class="fl">76.899</span><span class="op">,</span> <span class="fl">12.901</span>]<span class="op">,</span>[<span class="fl">76.899</span><span class="op">,</span> <span class="fl">13.006</span>]</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>]])<span class="op">;</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">// We use the Sentinel-2 SR data</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="kw">var</span> s2 <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&#39;COPERNICUS/S2_SR_HARMONIZED&#39;</span>)<span class="op">;</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="co">// Add function for cloud masking</span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="kw">function</span> <span class="fu">maskS2clouds</span>(image) {</span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>  <span class="kw">var</span> qa <span class="op">=</span> image<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;QA60&#39;</span>)<span class="op">;</span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>  <span class="kw">var</span> cloudBitMask <span class="op">=</span> <span class="dv">1</span> <span class="op">&lt;&lt;</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a>  <span class="kw">var</span> cirrusBitMask <span class="op">=</span> <span class="dv">1</span> <span class="op">&lt;&lt;</span> <span class="dv">11</span><span class="op">;</span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a>  <span class="kw">var</span> mask <span class="op">=</span> qa<span class="op">.</span><span class="fu">bitwiseAnd</span>(cloudBitMask)<span class="op">.</span><span class="fu">eq</span>(<span class="dv">0</span>)<span class="op">.</span><span class="fu">and</span>(</span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a>             qa<span class="op">.</span><span class="fu">bitwiseAnd</span>(cirrusBitMask)<span class="op">.</span><span class="fu">eq</span>(<span class="dv">0</span>))<span class="op">;</span></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a>  <span class="cf">return</span> image<span class="op">.</span><span class="fu">updateMask</span>(mask)</span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a>      <span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;B.*&#39;</span>)</span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a>      <span class="op">.</span><span class="fu">multiply</span>(<span class="fl">0.0001</span>)</span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a>      <span class="op">.</span><span class="fu">copyProperties</span>(image<span class="op">,</span> [<span class="st">&#39;system:time_start&#39;</span>])<span class="op">;</span></span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a>}</span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a></span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a><span class="co">// Filter and apply cloud mask</span></span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a><span class="kw">var</span> filtered <span class="op">=</span> s2</span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a><span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">lt</span>(<span class="st">&#39;CLOUDY_PIXEL_PERCENTAGE&#39;</span><span class="op">,</span> <span class="dv">30</span>))</span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">date</span>(<span class="st">&#39;2020-01-01&#39;</span><span class="op">,</span> <span class="st">&#39;2021-01-01&#39;</span>))</span>
<span id="cb11-30"><a href="#cb11-30" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">bounds</span>(geometry))</span>
<span id="cb11-31"><a href="#cb11-31" tabindex="-1"></a>  <span class="op">.</span><span class="fu">map</span>(maskS2clouds)</span>
<span id="cb11-32"><a href="#cb11-32" tabindex="-1"></a>  <span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;B.*&#39;</span>)<span class="op">;</span></span>
<span id="cb11-33"><a href="#cb11-33" tabindex="-1"></a></span>
<span id="cb11-34"><a href="#cb11-34" tabindex="-1"></a><span class="co">// Create a composite</span></span>
<span id="cb11-35"><a href="#cb11-35" tabindex="-1"></a><span class="kw">var</span> composite <span class="op">=</span> filtered<span class="op">.</span><span class="fu">median</span>()<span class="op">;</span></span>
<span id="cb11-36"><a href="#cb11-36" tabindex="-1"></a></span>
<span id="cb11-37"><a href="#cb11-37" tabindex="-1"></a><span class="kw">var</span> rgbVis <span class="op">=</span> {<span class="dt">bands</span><span class="op">:</span> [<span class="st">&#39;B4&#39;</span><span class="op">,</span> <span class="st">&#39;B3&#39;</span><span class="op">,</span> <span class="st">&#39;B2&#39;</span>]<span class="op">,</span> <span class="dt">min</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="fl">0.3</span><span class="op">,</span> <span class="dt">gamma</span><span class="op">:</span> <span class="fl">1.2</span>}<span class="op">;</span></span>
<span id="cb11-38"><a href="#cb11-38" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">centerObject</span>(geometry<span class="op">,</span> <span class="dv">12</span>)<span class="op">;</span></span>
<span id="cb11-39"><a href="#cb11-39" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(composite<span class="op">.</span><span class="fu">clip</span>(geometry)<span class="op">,</span> rgbVis<span class="op">,</span> <span class="st">&#39;RGB&#39;</span>)<span class="op">;</span></span>
<span id="cb11-40"><a href="#cb11-40" tabindex="-1"></a></span>
<span id="cb11-41"><a href="#cb11-41" tabindex="-1"></a><span class="co">// Use the Global Surface Water Yearly dataset</span></span>
<span id="cb11-42"><a href="#cb11-42" tabindex="-1"></a><span class="kw">var</span> gswYearly <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&#39;JRC/GSW1_4/YearlyHistory&#39;</span>)<span class="op">;</span></span>
<span id="cb11-43"><a href="#cb11-43" tabindex="-1"></a></span>
<span id="cb11-44"><a href="#cb11-44" tabindex="-1"></a><span class="co">// Extract the image for the chosen year</span></span>
<span id="cb11-45"><a href="#cb11-45" tabindex="-1"></a><span class="kw">var</span> filtered <span class="op">=</span> gswYearly<span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">eq</span>(<span class="st">&#39;year&#39;</span><span class="op">,</span> <span class="dv">2020</span>))<span class="op">;</span></span>
<span id="cb11-46"><a href="#cb11-46" tabindex="-1"></a><span class="kw">var</span> gsw2020 <span class="op">=</span> ee<span class="op">.</span><span class="fu">Image</span>(filtered<span class="op">.</span><span class="fu">first</span>())<span class="op">;</span></span>
<span id="cb11-47"><a href="#cb11-47" tabindex="-1"></a></span>
<span id="cb11-48"><a href="#cb11-48" tabindex="-1"></a><span class="co">// Select permanent or seasonal water</span></span>
<span id="cb11-49"><a href="#cb11-49" tabindex="-1"></a><span class="kw">var</span> water <span class="op">=</span> gsw2020<span class="op">.</span><span class="fu">eq</span>(<span class="dv">3</span>)<span class="op">.</span><span class="fu">or</span>(gsw2020<span class="op">.</span><span class="fu">eq</span>(<span class="dv">2</span>))<span class="op">.</span><span class="fu">rename</span>(<span class="st">&#39;water&#39;</span>)<span class="op">;</span></span>
<span id="cb11-50"><a href="#cb11-50" tabindex="-1"></a><span class="kw">var</span> waterVis <span class="op">=</span> {<span class="dt">min</span><span class="op">:</span><span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span><span class="dv">1</span><span class="op">,</span> <span class="dt">palette</span><span class="op">:</span> [<span class="st">&#39;white&#39;</span><span class="op">,</span><span class="st">&#39;blue&#39;</span>]}<span class="op">;</span></span>
<span id="cb11-51"><a href="#cb11-51" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(water<span class="op">.</span><span class="fu">clip</span>(geometry)<span class="op">.</span><span class="fu">selfMask</span>()<span class="op">,</span> waterVis<span class="op">,</span> <span class="st">&#39;Water&#39;</span><span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb11-52"><a href="#cb11-52" tabindex="-1"></a></span>
<span id="cb11-53"><a href="#cb11-53" tabindex="-1"></a><span class="co">// We want to splot the relationship between </span></span>
<span id="cb11-54"><a href="#cb11-54" tabindex="-1"></a><span class="co">// &#39;NIR&#39; (B8) and &#39;GREEN&#39; (B3) band reflectance</span></span>
<span id="cb11-55"><a href="#cb11-55" tabindex="-1"></a><span class="co">// for water and non-water pixels</span></span>
<span id="cb11-56"><a href="#cb11-56" tabindex="-1"></a></span>
<span id="cb11-57"><a href="#cb11-57" tabindex="-1"></a><span class="co">// Select the bands</span></span>
<span id="cb11-58"><a href="#cb11-58" tabindex="-1"></a><span class="kw">var</span> bands <span class="op">=</span> composite<span class="op">.</span><span class="fu">select</span>([<span class="st">&#39;B8&#39;</span><span class="op">,</span> <span class="st">&#39;B3&#39;</span>])<span class="op">;</span></span>
<span id="cb11-59"><a href="#cb11-59" tabindex="-1"></a></span>
<span id="cb11-60"><a href="#cb11-60" tabindex="-1"></a><span class="co">// Extract samples for both classes</span></span>
<span id="cb11-61"><a href="#cb11-61" tabindex="-1"></a><span class="kw">var</span> samples <span class="op">=</span> bands<span class="op">.</span><span class="fu">addBands</span>(water)<span class="op">.</span><span class="fu">stratifiedSample</span>({</span>
<span id="cb11-62"><a href="#cb11-62" tabindex="-1"></a>  <span class="dt">numPoints</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span></span>
<span id="cb11-63"><a href="#cb11-63" tabindex="-1"></a>  <span class="dt">classBand</span><span class="op">:</span> <span class="st">&#39;water&#39;</span><span class="op">,</span></span>
<span id="cb11-64"><a href="#cb11-64" tabindex="-1"></a>  <span class="dt">region</span><span class="op">:</span> geometry<span class="op">,</span></span>
<span id="cb11-65"><a href="#cb11-65" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">10</span>})</span>
<span id="cb11-66"><a href="#cb11-66" tabindex="-1"></a></span>
<span id="cb11-67"><a href="#cb11-67" tabindex="-1"></a><span class="fu">print</span>(samples<span class="op">.</span><span class="fu">first</span>())<span class="op">;</span></span>
<span id="cb11-68"><a href="#cb11-68" tabindex="-1"></a></span>
<span id="cb11-69"><a href="#cb11-69" tabindex="-1"></a><span class="co">// Create a chart and set the chart type</span></span>
<span id="cb11-70"><a href="#cb11-70" tabindex="-1"></a><span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">feature</span><span class="op">.</span><span class="fu">groups</span>({</span>
<span id="cb11-71"><a href="#cb11-71" tabindex="-1"></a>  <span class="dt">features</span><span class="op">:</span> samples<span class="op">,</span></span>
<span id="cb11-72"><a href="#cb11-72" tabindex="-1"></a>  <span class="dt">xProperty</span><span class="op">:</span> <span class="st">&#39;B3&#39;</span><span class="op">,</span></span>
<span id="cb11-73"><a href="#cb11-73" tabindex="-1"></a>  <span class="dt">yProperty</span><span class="op">:</span> <span class="st">&#39;B8&#39;</span><span class="op">,</span></span>
<span id="cb11-74"><a href="#cb11-74" tabindex="-1"></a>  <span class="dt">seriesProperty</span><span class="op">:</span> <span class="st">&#39;water&#39;</span></span>
<span id="cb11-75"><a href="#cb11-75" tabindex="-1"></a>})<span class="op">.</span><span class="fu">setChartType</span>(<span class="st">&#39;ScatterChart&#39;</span>)<span class="op">;</span></span>
<span id="cb11-76"><a href="#cb11-76" tabindex="-1"></a>  </span>
<span id="cb11-77"><a href="#cb11-77" tabindex="-1"></a><span class="fu">print</span>(chart)<span class="op">;</span></span>
<span id="cb11-78"><a href="#cb11-78" tabindex="-1"></a></span>
<span id="cb11-79"><a href="#cb11-79" tabindex="-1"></a><span class="co">// Customize the style</span></span>
<span id="cb11-80"><a href="#cb11-80" tabindex="-1"></a><span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">feature</span><span class="op">.</span><span class="fu">groups</span>({</span>
<span id="cb11-81"><a href="#cb11-81" tabindex="-1"></a>  <span class="dt">features</span><span class="op">:</span> samples<span class="op">,</span></span>
<span id="cb11-82"><a href="#cb11-82" tabindex="-1"></a>  <span class="dt">xProperty</span><span class="op">:</span> <span class="st">&#39;B3&#39;</span><span class="op">,</span></span>
<span id="cb11-83"><a href="#cb11-83" tabindex="-1"></a>  <span class="dt">yProperty</span><span class="op">:</span> <span class="st">&#39;B8&#39;</span><span class="op">,</span></span>
<span id="cb11-84"><a href="#cb11-84" tabindex="-1"></a>  <span class="dt">seriesProperty</span><span class="op">:</span> <span class="st">&#39;water&#39;</span></span>
<span id="cb11-85"><a href="#cb11-85" tabindex="-1"></a>})<span class="op">.</span><span class="fu">setChartType</span>(<span class="st">&#39;ScatterChart&#39;</span>)</span>
<span id="cb11-86"><a href="#cb11-86" tabindex="-1"></a>  <span class="op">.</span><span class="fu">setOptions</span>({</span>
<span id="cb11-87"><a href="#cb11-87" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Relationship Among Spectral Values &#39;</span> <span class="op">+</span></span>
<span id="cb11-88"><a href="#cb11-88" tabindex="-1"></a>      <span class="st">&#39;for Water and Non-Water Pixels&#39;</span><span class="op">,</span></span>
<span id="cb11-89"><a href="#cb11-89" tabindex="-1"></a>    <span class="dt">titleTextStyle</span><span class="op">:</span> {<span class="dt">bold</span><span class="op">:</span> <span class="kw">true</span>}<span class="op">,</span></span>
<span id="cb11-90"><a href="#cb11-90" tabindex="-1"></a>    <span class="dt">dataOpacity</span><span class="op">:</span> <span class="fl">0.8</span><span class="op">,</span></span>
<span id="cb11-91"><a href="#cb11-91" tabindex="-1"></a>    <span class="dt">hAxis</span><span class="op">:</span> {</span>
<span id="cb11-92"><a href="#cb11-92" tabindex="-1"></a>      <span class="st">&#39;title&#39;</span><span class="op">:</span> <span class="st">&#39;Green reflectance&#39;</span><span class="op">,</span></span>
<span id="cb11-93"><a href="#cb11-93" tabindex="-1"></a>      <span class="dt">titleTextStyle</span><span class="op">:</span> {<span class="dt">italic</span><span class="op">:</span> <span class="kw">true</span>}<span class="op">,</span></span>
<span id="cb11-94"><a href="#cb11-94" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb11-95"><a href="#cb11-95" tabindex="-1"></a>    <span class="dt">vAxis</span><span class="op">:</span> {</span>
<span id="cb11-96"><a href="#cb11-96" tabindex="-1"></a>      <span class="st">&#39;title&#39;</span><span class="op">:</span> <span class="st">&#39;NIR Reflectance&#39;</span><span class="op">,</span></span>
<span id="cb11-97"><a href="#cb11-97" tabindex="-1"></a>      <span class="dt">titleTextStyle</span><span class="op">:</span> {<span class="dt">italic</span><span class="op">:</span> <span class="kw">true</span>}<span class="op">,</span></span>
<span id="cb11-98"><a href="#cb11-98" tabindex="-1"></a></span>
<span id="cb11-99"><a href="#cb11-99" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb11-100"><a href="#cb11-100" tabindex="-1"></a>    <span class="dt">series</span><span class="op">:</span> {</span>
<span id="cb11-101"><a href="#cb11-101" tabindex="-1"></a>      <span class="dv">0</span><span class="op">:</span> {</span>
<span id="cb11-102"><a href="#cb11-102" tabindex="-1"></a>        <span class="dt">pointShape</span><span class="op">:</span> <span class="st">&#39;triangle&#39;</span><span class="op">,</span></span>
<span id="cb11-103"><a href="#cb11-103" tabindex="-1"></a>        <span class="dt">pointSize</span><span class="op">:</span> <span class="dv">4</span><span class="op">,</span></span>
<span id="cb11-104"><a href="#cb11-104" tabindex="-1"></a>        <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;#2c7bb6&#39;</span><span class="op">,</span></span>
<span id="cb11-105"><a href="#cb11-105" tabindex="-1"></a>        <span class="dt">labelInLegend</span><span class="op">:</span> <span class="st">&#39;Water&#39;</span><span class="op">,</span></span>
<span id="cb11-106"><a href="#cb11-106" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb11-107"><a href="#cb11-107" tabindex="-1"></a>      <span class="dv">1</span><span class="op">:</span> {</span>
<span id="cb11-108"><a href="#cb11-108" tabindex="-1"></a>        <span class="dt">pointShape</span><span class="op">:</span> <span class="st">&#39;triangle&#39;</span><span class="op">,</span></span>
<span id="cb11-109"><a href="#cb11-109" tabindex="-1"></a>        <span class="dt">pointSize</span><span class="op">:</span> <span class="dv">4</span><span class="op">,</span></span>
<span id="cb11-110"><a href="#cb11-110" tabindex="-1"></a>        <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;#f46d43&#39;</span><span class="op">,</span></span>
<span id="cb11-111"><a href="#cb11-111" tabindex="-1"></a>        <span class="dt">labelInLegend</span><span class="op">:</span> <span class="st">&#39;Non-Water&#39;</span></span>
<span id="cb11-112"><a href="#cb11-112" tabindex="-1"></a>      }</span>
<span id="cb11-113"><a href="#cb11-113" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb11-114"><a href="#cb11-114" tabindex="-1"></a>    <span class="dt">legend</span><span class="op">:</span> {<span class="dt">position</span><span class="op">:</span> <span class="st">&#39;in&#39;</span>}</span>
<span id="cb11-115"><a href="#cb11-115" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb11-116"><a href="#cb11-116" tabindex="-1"></a><span class="fu">print</span>(chart)<span class="op">;</span></span></code></pre></div>
<div id="exercise-5" class="section level3">
<h3>Exercise</h3>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3A02-Image_Charts%2F02c_Image_Scatter_Chart_(exercise)"
target="_blank">Open in Code Editor ↗</a></p>
<pre><code>// Exercise
// The code now contains a function createChart() that creates a scatter plot
// between the chosen bands

// a) Delete the &#39;geometry&#39; and add a new polygon at your chosen location
// b) Create a chart for B3 and B11
// c) Print the chart.</code></pre>
</div>
</div>
<div id="image-class-areas-table" class="section level2">
<h2>2.3 Image Class Areas (Table)</h2>
<p>Many analysts would want to create a chart or a table showing areas
of different landcover classes in an image. The EE API has a dedicated
function <code>ui.Chart.Image.byClass()</code> that can tabulate image
pixel values by class.</p>
<p>Here we use the ESA Landcover 2021 dataset and create a
<strong>Table</strong> chart of areas within the buffer zone of a
location. Note that we are using <code>setChartType()</code> function
with the option <strong>Table</strong> to create a table. Such tables
are useful when you are creating apps and want to display a formatted
table. The <a
href="https://google.earthengine.app/view/population-explorer">Global
Population Explorer</a> is a good example where you can switch between a
<em>Bar Chart</em> and a <em>Table</em> to display the results.</p>
<div class="figure" style="text-align: center">
<img src="images/gee_charts/image_by_class_table.png" alt="Table Chart" width="75%" />
<p class="caption">
Table Chart
</p>
</div>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3A02-Image_Charts%2F03b_Area_By_Class_Table_(complete)"
target="_blank">Open in Code Editor ↗</a></p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode js"><code class="sourceCode javascript"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co">// Select a region</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="kw">var</span> geometry <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Point</span>([<span class="fl">77.6045</span><span class="op">,</span> <span class="fl">12.8992</span>])<span class="op">;</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co">// We use the ESA WorldCover 2021 dataset</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="kw">var</span> worldcover <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&#39;ESA/WorldCover/v200&#39;</span>)<span class="op">.</span><span class="fu">first</span>()<span class="op">;</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="co">// The image has 11 classes</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="co">// Remap the class values to have continuous values</span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="co">// from 0 to 10</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="kw">var</span> classified <span class="op">=</span> worldcover<span class="op">.</span><span class="fu">remap</span>(</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>  [<span class="dv">10</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">30</span><span class="op">,</span> <span class="dv">40</span><span class="op">,</span> <span class="dv">50</span><span class="op">,</span> <span class="dv">60</span><span class="op">,</span> <span class="dv">70</span><span class="op">,</span> <span class="dv">80</span><span class="op">,</span> <span class="dv">90</span><span class="op">,</span> <span class="dv">95</span><span class="op">,</span> <span class="dv">100</span>]<span class="op">,</span></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>  [<span class="dv">0</span><span class="op">,</span>  <span class="dv">1</span> <span class="op">,</span> <span class="dv">2</span><span class="op">,</span>  <span class="dv">3</span><span class="op">,</span>  <span class="dv">4</span><span class="op">,</span>  <span class="dv">5</span><span class="op">,</span>  <span class="dv">6</span><span class="op">,</span>  <span class="dv">7</span><span class="op">,</span>  <span class="dv">8</span><span class="op">,</span>  <span class="dv">9</span><span class="op">,</span>  <span class="dv">10</span>])<span class="op">.</span><span class="fu">rename</span>(<span class="st">&#39;classification&#39;</span>)<span class="op">;</span></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a><span class="co">// Define a list of class names</span></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="kw">var</span> worldCoverClassNames<span class="op">=</span> [</span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a>  <span class="st">&#39;Tree Cover&#39;</span><span class="op">,</span> <span class="st">&#39;Shrubland&#39;</span><span class="op">,</span> <span class="st">&#39;Grassland&#39;</span><span class="op">,</span> <span class="st">&#39;Cropland&#39;</span><span class="op">,</span> <span class="st">&#39;Built-up&#39;</span><span class="op">,</span></span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a>  <span class="st">&#39;Bare / sparse Vegetation&#39;</span><span class="op">,</span> <span class="st">&#39;Snow and Ice&#39;</span><span class="op">,</span> </span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a>  <span class="st">&#39;Permanent Water Bodies&#39;</span><span class="op">,</span> <span class="st">&#39;Herbaceous Wetland&#39;</span><span class="op">,</span> </span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a>  <span class="st">&#39;Mangroves&#39;</span><span class="op">,</span> <span class="st">&#39;Moss and Lichen&#39;</span>]<span class="op">;</span></span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a><span class="co">// Define a list of class colors</span></span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a><span class="kw">var</span> worldCoverPalette <span class="op">=</span> [</span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a>  <span class="st">&#39;006400&#39;</span><span class="op">,</span> <span class="st">&#39;ffbb22&#39;</span><span class="op">,</span> <span class="st">&#39;ffff4c&#39;</span><span class="op">,</span> <span class="st">&#39;f096ff&#39;</span><span class="op">,</span> <span class="st">&#39;fa0000&#39;</span><span class="op">,</span></span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a>  <span class="st">&#39;b4b4b4&#39;</span><span class="op">,</span> <span class="st">&#39;f0f0f0&#39;</span><span class="op">,</span> <span class="st">&#39;0064c8&#39;</span><span class="op">,</span> <span class="st">&#39;0096a0&#39;</span><span class="op">,</span> <span class="st">&#39;00cf75&#39;</span><span class="op">,</span></span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a>  <span class="st">&#39;fae6a0&#39;</span>]<span class="op">;</span></span>
<span id="cb13-25"><a href="#cb13-25" tabindex="-1"></a>  </span>
<span id="cb13-26"><a href="#cb13-26" tabindex="-1"></a><span class="kw">var</span> visParams <span class="op">=</span> {<span class="dt">min</span><span class="op">:</span><span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span><span class="dv">10</span><span class="op">,</span> <span class="dt">palette</span><span class="op">:</span> worldCoverPalette}<span class="op">;</span></span>
<span id="cb13-27"><a href="#cb13-27" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(classified<span class="op">,</span> visParams<span class="op">,</span> <span class="st">&#39;Landcover&#39;</span>)<span class="op">;</span></span>
<span id="cb13-28"><a href="#cb13-28" tabindex="-1"></a></span>
<span id="cb13-29"><a href="#cb13-29" tabindex="-1"></a><span class="co">// We want to compute the class areas in a buffer zone</span></span>
<span id="cb13-30"><a href="#cb13-30" tabindex="-1"></a><span class="kw">var</span> bufferDistance <span class="op">=</span> <span class="dv">1000</span><span class="op">;</span></span>
<span id="cb13-31"><a href="#cb13-31" tabindex="-1"></a><span class="kw">var</span> buffer <span class="op">=</span> geometry<span class="op">.</span><span class="fu">buffer</span>(bufferDistance)<span class="op">;</span></span>
<span id="cb13-32"><a href="#cb13-32" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">centerObject</span>(buffer<span class="op">,</span> <span class="dv">12</span>)<span class="op">;</span></span>
<span id="cb13-33"><a href="#cb13-33" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(buffer<span class="op">,</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;gray&#39;</span>}<span class="op">,</span> <span class="st">&#39;Buffer Zone&#39;</span>)<span class="op">;</span></span>
<span id="cb13-34"><a href="#cb13-34" tabindex="-1"></a></span>
<span id="cb13-35"><a href="#cb13-35" tabindex="-1"></a><span class="co">// Create an area image and convert to Hectares</span></span>
<span id="cb13-36"><a href="#cb13-36" tabindex="-1"></a><span class="kw">var</span> areaImage <span class="op">=</span> ee<span class="op">.</span><span class="at">Image</span><span class="op">.</span><span class="fu">pixelArea</span>()<span class="op">.</span><span class="fu">divide</span>(<span class="fl">1e4</span>)<span class="op">;</span></span>
<span id="cb13-37"><a href="#cb13-37" tabindex="-1"></a></span>
<span id="cb13-38"><a href="#cb13-38" tabindex="-1"></a><span class="co">// Add the band containing classes</span></span>
<span id="cb13-39"><a href="#cb13-39" tabindex="-1"></a><span class="kw">var</span> areaImageWithClass <span class="op">=</span> areaImage<span class="op">.</span><span class="fu">addBands</span>(classified)<span class="op">;</span></span>
<span id="cb13-40"><a href="#cb13-40" tabindex="-1"></a></span>
<span id="cb13-41"><a href="#cb13-41" tabindex="-1"></a><span class="co">// Create a chart</span></span>
<span id="cb13-42"><a href="#cb13-42" tabindex="-1"></a><span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">image</span><span class="op">.</span><span class="fu">byClass</span>({</span>
<span id="cb13-43"><a href="#cb13-43" tabindex="-1"></a>  <span class="dt">image</span><span class="op">:</span> areaImageWithClass<span class="op">,</span></span>
<span id="cb13-44"><a href="#cb13-44" tabindex="-1"></a>  <span class="dt">classBand</span><span class="op">:</span> <span class="st">&#39;classification&#39;</span><span class="op">,</span></span>
<span id="cb13-45"><a href="#cb13-45" tabindex="-1"></a>  <span class="dt">region</span><span class="op">:</span> buffer<span class="op">,</span></span>
<span id="cb13-46"><a href="#cb13-46" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">sum</span>()<span class="op">,</span></span>
<span id="cb13-47"><a href="#cb13-47" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span></span>
<span id="cb13-48"><a href="#cb13-48" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb13-49"><a href="#cb13-49" tabindex="-1"></a><span class="fu">print</span>(chart)<span class="op">;</span></span>
<span id="cb13-50"><a href="#cb13-50" tabindex="-1"></a></span>
<span id="cb13-51"><a href="#cb13-51" tabindex="-1"></a><span class="co">// Set the chart type and add styling options</span></span>
<span id="cb13-52"><a href="#cb13-52" tabindex="-1"></a><span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">image</span><span class="op">.</span><span class="fu">byClass</span>({</span>
<span id="cb13-53"><a href="#cb13-53" tabindex="-1"></a>  <span class="dt">image</span><span class="op">:</span> areaImageWithClass<span class="op">,</span></span>
<span id="cb13-54"><a href="#cb13-54" tabindex="-1"></a>  <span class="dt">classBand</span><span class="op">:</span> <span class="st">&#39;classification&#39;</span><span class="op">,</span></span>
<span id="cb13-55"><a href="#cb13-55" tabindex="-1"></a>  <span class="dt">region</span><span class="op">:</span> buffer<span class="op">,</span></span>
<span id="cb13-56"><a href="#cb13-56" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">sum</span>()<span class="op">,</span></span>
<span id="cb13-57"><a href="#cb13-57" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span></span>
<span id="cb13-58"><a href="#cb13-58" tabindex="-1"></a>  <span class="dt">classLabels</span><span class="op">:</span> worldCoverClassNames<span class="op">,</span></span>
<span id="cb13-59"><a href="#cb13-59" tabindex="-1"></a>  <span class="dt">xLabels</span><span class="op">:</span> [<span class="st">&#39;Area (Hectares)&#39;</span>]</span>
<span id="cb13-60"><a href="#cb13-60" tabindex="-1"></a>})<span class="op">.</span><span class="fu">setChartType</span>(<span class="st">&#39;Table&#39;</span>)<span class="op">;</span></span>
<span id="cb13-61"><a href="#cb13-61" tabindex="-1"></a></span>
<span id="cb13-62"><a href="#cb13-62" tabindex="-1"></a><span class="fu">print</span>(chart)<span class="op">;</span></span></code></pre></div>
<div id="exercise-6" class="section level3">
<h3>Exercise</h3>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3A02-Image_Charts%2F03c_Area_By_Class_Table_(exercise)"
target="_blank">Open in Code Editor ↗</a></p>
<pre><code>// Exercise

// a) Delete the &#39;geometry&#39; and add a new point at your chosen location
// b) Change the buffer distance to 10km and Area units to Square Kilometers
// c) Print the chart.</code></pre>
</div>
</div>
</div>
<div id="module-3.-featurecollection-charts" class="section level1">
<h1>Module 3. FeatureCollection Charts</h1>
<p><a
href="https://www.youtube.com/watch?v=oT7ajtbqNy8&amp;list=PLppGmFLhQ1HKyrR75waIq6TfqL0ESlQao&amp;index=17"
target="_blank"><img
src="https://img.youtube.com/vi/oT7ajtbqNy8/mqdefault.jpg"
alt="Start Module 3 Videos" /></a></p>
<p><a
href="https://www.youtube.com/watch?v=oT7ajtbqNy8&amp;list=PLppGmFLhQ1HKyrR75waIq6TfqL0ESlQao&amp;index=17"
target="_blank">Start Module 3 Videos ↗</a></p>
<div id="image-class-areas-pie-chart" class="section level2">
<h2>3.1 Image Class Areas (Pie Chart)</h2>
<p>One of the biggest limitations of the GEE Charting API is that it
cannot create charts from more than 10000000 pixels. While this may seem
like a big number, you can easily run into this limit when working with
images that cover large areas. If you try creating charts for large
regions, you may run into an error such as below:</p>
<blockquote>
<p><em>Image.reduceRegion: Too many pixels in the region. Found
159578190, but maxPixels allows only 10000000. Ensure that you are not
aggregating at a higher resolution than you intended; that is a frequent
cause of this error. If not, then you may set the ‘maxPixels’ argument
to a limit suitable for your computation; set ‘bestEffort’ to true to
aggregate at whatever scale results in ‘maxPixels’ total pixels; or
both.</em></p>
</blockquote>
<div class="figure" style="text-align: center">
<img src="images/gee_charts/chart_error.png" alt="Chart Error" width="75%" />
<p class="caption">
Chart Error
</p>
</div>
<p>Fortunately, there is a way around it. Earth Engine allows you to
aggregate values from very large regions using reducers that have an
option to specify a <code>maxPixels</code> parameter. You will need to
use the appropriate reducer and create a FeatureCollection with the
results. The resulting value can then be plotted easily using the
charting functions.</p>
<p>Here we take the same dataset as the previous section, but try to
summarize the area by class over a much larger region. We use a Grouped
Reducer to compute the class areas and post-process the result into a
FeatureCollection. If you find the code hard to understand, please
review our article on <a
href="https://spatialthoughts.com/2020/06/19/calculating-area-gee/">Calculating
Area in Google Earth Engine</a> for explanation.</p>
<p>We set the chart type to <code>PieChart</code> and plot the
percentage of area of each class in the region.</p>
<p>Below is the list of new styling options applied to the pie
chart:</p>
<ul>
<li><code>pieSliceBorderColor</code>: Sets the edge color of each pie
slice.</li>
<li><code>pieSliceTextStyle</code>: Sets the text style of pie slice
labels.</li>
<li><code>pieSliceText</code>: Sets the format of the text.</li>
<li><code>sliceVisibilityThreshold</code>: Sets the threshold below
which to group small slices into <em>others</em> category.</li>
</ul>
<div class="figure" style="text-align: center">
<img src="images/gee_charts/area_by_class_piechart.png" alt="Pie Chart" width="75%" />
<p class="caption">
Pie Chart
</p>
</div>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3A03-FeatureCollection_Charts%2F01b_Area_By_Class_Pie_Chart_(complete)"
target="_blank">Open in Code Editor ↗</a></p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode js"><code class="sourceCode javascript"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co">// Select a region</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="kw">var</span> geometry <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Point</span>([<span class="fl">77.6045</span><span class="op">,</span> <span class="fl">12.8992</span>])<span class="op">;</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="co">// We use the ESA WorldCover 2021 dataset</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="kw">var</span> worldcover <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&#39;ESA/WorldCover/v200&#39;</span>)<span class="op">.</span><span class="fu">first</span>()<span class="op">;</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co">// The image has 11 classes</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="co">// Remap the class values to have continuous values</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co">// from 0 to 10</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="kw">var</span> classified <span class="op">=</span> worldcover<span class="op">.</span><span class="fu">remap</span>(</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>  [<span class="dv">10</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">30</span><span class="op">,</span> <span class="dv">40</span><span class="op">,</span> <span class="dv">50</span><span class="op">,</span> <span class="dv">60</span><span class="op">,</span> <span class="dv">70</span><span class="op">,</span> <span class="dv">80</span><span class="op">,</span> <span class="dv">90</span><span class="op">,</span> <span class="dv">95</span><span class="op">,</span> <span class="dv">100</span>]<span class="op">,</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>  [<span class="dv">0</span><span class="op">,</span>  <span class="dv">1</span> <span class="op">,</span> <span class="dv">2</span><span class="op">,</span>  <span class="dv">3</span><span class="op">,</span>  <span class="dv">4</span><span class="op">,</span>  <span class="dv">5</span><span class="op">,</span>  <span class="dv">6</span><span class="op">,</span>  <span class="dv">7</span><span class="op">,</span>  <span class="dv">8</span><span class="op">,</span>  <span class="dv">9</span><span class="op">,</span>  <span class="dv">10</span>])<span class="op">.</span><span class="fu">rename</span>(<span class="st">&#39;classification&#39;</span>)<span class="op">;</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="co">// Define a list of class names</span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="kw">var</span> worldCoverClassNames<span class="op">=</span> [</span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a>  <span class="st">&#39;Tree Cover&#39;</span><span class="op">,</span> <span class="st">&#39;Shrubland&#39;</span><span class="op">,</span> <span class="st">&#39;Grassland&#39;</span><span class="op">,</span> <span class="st">&#39;Cropland&#39;</span><span class="op">,</span> <span class="st">&#39;Built-up&#39;</span><span class="op">,</span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a>  <span class="st">&#39;Bare / sparse Vegetation&#39;</span><span class="op">,</span> <span class="st">&#39;Snow and Ice&#39;</span><span class="op">,</span> </span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a>  <span class="st">&#39;Permanent Water Bodies&#39;</span><span class="op">,</span> <span class="st">&#39;Herbaceous Wetland&#39;</span><span class="op">,</span> </span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a>  <span class="st">&#39;Mangroves&#39;</span><span class="op">,</span> <span class="st">&#39;Moss and Lichen&#39;</span>]<span class="op">;</span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a><span class="co">// Define a list of class colors</span></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a><span class="kw">var</span> worldCoverPalette <span class="op">=</span> [</span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a>  <span class="st">&#39;006400&#39;</span><span class="op">,</span> <span class="st">&#39;ffbb22&#39;</span><span class="op">,</span> <span class="st">&#39;ffff4c&#39;</span><span class="op">,</span> <span class="st">&#39;f096ff&#39;</span><span class="op">,</span> <span class="st">&#39;fa0000&#39;</span><span class="op">,</span></span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a>  <span class="st">&#39;b4b4b4&#39;</span><span class="op">,</span> <span class="st">&#39;f0f0f0&#39;</span><span class="op">,</span> <span class="st">&#39;0064c8&#39;</span><span class="op">,</span> <span class="st">&#39;0096a0&#39;</span><span class="op">,</span> <span class="st">&#39;00cf75&#39;</span><span class="op">,</span></span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a>  <span class="st">&#39;fae6a0&#39;</span>]<span class="op">;</span></span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a><span class="co">// We define a dictionary with class names</span></span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a><span class="kw">var</span> classNames <span class="op">=</span> ee<span class="op">.</span><span class="at">Dictionary</span><span class="op">.</span><span class="fu">fromLists</span>(</span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a>  [<span class="st">&#39;0&#39;</span><span class="op">,</span><span class="st">&#39;1&#39;</span><span class="op">,</span><span class="st">&#39;2&#39;</span><span class="op">,</span><span class="st">&#39;3&#39;</span><span class="op">,</span><span class="st">&#39;4&#39;</span><span class="op">,</span><span class="st">&#39;5&#39;</span><span class="op">,</span><span class="st">&#39;6&#39;</span><span class="op">,</span><span class="st">&#39;7&#39;</span><span class="op">,</span><span class="st">&#39;8&#39;</span><span class="op">,</span><span class="st">&#39;9&#39;</span><span class="op">,</span> <span class="st">&#39;10&#39;</span>]<span class="op">,</span></span>
<span id="cb15-28"><a href="#cb15-28" tabindex="-1"></a>  worldCoverClassNames</span>
<span id="cb15-29"><a href="#cb15-29" tabindex="-1"></a>)<span class="op">;</span></span>
<span id="cb15-30"><a href="#cb15-30" tabindex="-1"></a><span class="co">// We define a dictionary with class colors</span></span>
<span id="cb15-31"><a href="#cb15-31" tabindex="-1"></a><span class="kw">var</span> classColors <span class="op">=</span> ee<span class="op">.</span><span class="at">Dictionary</span><span class="op">.</span><span class="fu">fromLists</span>(</span>
<span id="cb15-32"><a href="#cb15-32" tabindex="-1"></a>  [<span class="st">&#39;0&#39;</span><span class="op">,</span><span class="st">&#39;1&#39;</span><span class="op">,</span><span class="st">&#39;2&#39;</span><span class="op">,</span><span class="st">&#39;3&#39;</span><span class="op">,</span><span class="st">&#39;4&#39;</span><span class="op">,</span><span class="st">&#39;5&#39;</span><span class="op">,</span><span class="st">&#39;6&#39;</span><span class="op">,</span><span class="st">&#39;7&#39;</span><span class="op">,</span><span class="st">&#39;8&#39;</span><span class="op">,</span><span class="st">&#39;9&#39;</span><span class="op">,</span> <span class="st">&#39;10&#39;</span>]<span class="op">,</span></span>
<span id="cb15-33"><a href="#cb15-33" tabindex="-1"></a>  worldCoverPalette</span>
<span id="cb15-34"><a href="#cb15-34" tabindex="-1"></a>)<span class="op">;</span></span>
<span id="cb15-35"><a href="#cb15-35" tabindex="-1"></a><span class="kw">var</span> visParams <span class="op">=</span> {<span class="dt">min</span><span class="op">:</span><span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span><span class="dv">10</span><span class="op">,</span> <span class="dt">palette</span><span class="op">:</span> worldCoverPalette}<span class="op">;</span></span>
<span id="cb15-36"><a href="#cb15-36" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(classified<span class="op">,</span> visParams<span class="op">,</span> <span class="st">&#39;Landcover&#39;</span>)<span class="op">;</span></span>
<span id="cb15-37"><a href="#cb15-37" tabindex="-1"></a></span>
<span id="cb15-38"><a href="#cb15-38" tabindex="-1"></a><span class="co">// We want to compute the class areas in a buffer zone</span></span>
<span id="cb15-39"><a href="#cb15-39" tabindex="-1"></a><span class="kw">var</span> bufferDistance <span class="op">=</span> <span class="dv">50000</span><span class="op">;</span></span>
<span id="cb15-40"><a href="#cb15-40" tabindex="-1"></a><span class="kw">var</span> buffer <span class="op">=</span> geometry<span class="op">.</span><span class="fu">buffer</span>(bufferDistance)<span class="op">;</span></span>
<span id="cb15-41"><a href="#cb15-41" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">centerObject</span>(buffer<span class="op">,</span> <span class="dv">12</span>)<span class="op">;</span></span>
<span id="cb15-42"><a href="#cb15-42" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(buffer<span class="op">,</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;gray&#39;</span>}<span class="op">,</span> <span class="st">&#39;Buffer Zone&#39;</span>)<span class="op">;</span></span>
<span id="cb15-43"><a href="#cb15-43" tabindex="-1"></a></span>
<span id="cb15-44"><a href="#cb15-44" tabindex="-1"></a><span class="co">// Create an area image and convert to Hectares</span></span>
<span id="cb15-45"><a href="#cb15-45" tabindex="-1"></a><span class="kw">var</span> areaImage <span class="op">=</span> ee<span class="op">.</span><span class="at">Image</span><span class="op">.</span><span class="fu">pixelArea</span>()<span class="op">.</span><span class="fu">divide</span>(<span class="fl">1e4</span>)<span class="op">;</span></span>
<span id="cb15-46"><a href="#cb15-46" tabindex="-1"></a></span>
<span id="cb15-47"><a href="#cb15-47" tabindex="-1"></a><span class="co">// Add the band containing classes</span></span>
<span id="cb15-48"><a href="#cb15-48" tabindex="-1"></a><span class="kw">var</span> areaImageWithClass <span class="op">=</span> areaImage<span class="op">.</span><span class="fu">addBands</span>(classified)<span class="op">;</span></span>
<span id="cb15-49"><a href="#cb15-49" tabindex="-1"></a></span>
<span id="cb15-50"><a href="#cb15-50" tabindex="-1"></a><span class="co">// As charting functions do not work on more than</span></span>
<span id="cb15-51"><a href="#cb15-51" tabindex="-1"></a><span class="co">// 10000000 pixels, we need to extract the areas using</span></span>
<span id="cb15-52"><a href="#cb15-52" tabindex="-1"></a><span class="co">// a reducer and create a FeatureCollection first</span></span>
<span id="cb15-53"><a href="#cb15-53" tabindex="-1"></a></span>
<span id="cb15-54"><a href="#cb15-54" tabindex="-1"></a><span class="co">// Use a Grouped Reducer to calculate areas</span></span>
<span id="cb15-55"><a href="#cb15-55" tabindex="-1"></a><span class="kw">var</span> areas <span class="op">=</span> areaImageWithClass<span class="op">.</span><span class="fu">reduceRegion</span>({</span>
<span id="cb15-56"><a href="#cb15-56" tabindex="-1"></a>      <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">sum</span>()<span class="op">.</span><span class="fu">group</span>({</span>
<span id="cb15-57"><a href="#cb15-57" tabindex="-1"></a>      <span class="dt">groupField</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb15-58"><a href="#cb15-58" tabindex="-1"></a>      <span class="dt">groupName</span><span class="op">:</span> <span class="st">&#39;classification&#39;</span><span class="op">,</span></span>
<span id="cb15-59"><a href="#cb15-59" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb15-60"><a href="#cb15-60" tabindex="-1"></a>    <span class="dt">geometry</span><span class="op">:</span> buffer<span class="op">,</span></span>
<span id="cb15-61"><a href="#cb15-61" tabindex="-1"></a>    <span class="dt">scale</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span></span>
<span id="cb15-62"><a href="#cb15-62" tabindex="-1"></a>    <span class="dt">maxPixels</span><span class="op">:</span> <span class="fl">1e10</span></span>
<span id="cb15-63"><a href="#cb15-63" tabindex="-1"></a>    })<span class="op">;</span> </span>
<span id="cb15-64"><a href="#cb15-64" tabindex="-1"></a> </span>
<span id="cb15-65"><a href="#cb15-65" tabindex="-1"></a><span class="kw">var</span> classAreas <span class="op">=</span> ee<span class="op">.</span><span class="fu">List</span>(areas<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;groups&#39;</span>))<span class="op">;</span></span>
<span id="cb15-66"><a href="#cb15-66" tabindex="-1"></a></span>
<span id="cb15-67"><a href="#cb15-67" tabindex="-1"></a><span class="co">// Process results to extract the areas and</span></span>
<span id="cb15-68"><a href="#cb15-68" tabindex="-1"></a><span class="co">// create a FeatureCollection</span></span>
<span id="cb15-69"><a href="#cb15-69" tabindex="-1"></a><span class="kw">var</span> classAreaList <span class="op">=</span> classAreas<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(item) {</span>
<span id="cb15-70"><a href="#cb15-70" tabindex="-1"></a>  <span class="kw">var</span> areaDict <span class="op">=</span> ee<span class="op">.</span><span class="fu">Dictionary</span>(item)<span class="op">;</span></span>
<span id="cb15-71"><a href="#cb15-71" tabindex="-1"></a>  <span class="kw">var</span> classNumber <span class="op">=</span> areaDict<span class="op">.</span><span class="fu">getNumber</span>(<span class="st">&#39;classification&#39;</span>)<span class="op">.</span><span class="fu">format</span>()<span class="op">;</span></span>
<span id="cb15-72"><a href="#cb15-72" tabindex="-1"></a>  <span class="kw">var</span> classArea <span class="op">=</span> areaDict<span class="op">.</span><span class="fu">getNumber</span>(<span class="st">&#39;sum&#39;</span>)<span class="op">;</span></span>
<span id="cb15-73"><a href="#cb15-73" tabindex="-1"></a>  <span class="kw">var</span> className <span class="op">=</span> classNames<span class="op">.</span><span class="fu">get</span>(classNumber)<span class="op">;</span></span>
<span id="cb15-74"><a href="#cb15-74" tabindex="-1"></a>  <span class="kw">var</span> classColor <span class="op">=</span> classColors<span class="op">.</span><span class="fu">get</span>(classNumber)<span class="op">;</span></span>
<span id="cb15-75"><a href="#cb15-75" tabindex="-1"></a>  <span class="co">// Create a feature with geometry and </span></span>
<span id="cb15-76"><a href="#cb15-76" tabindex="-1"></a>  <span class="co">// required data as a dictionary</span></span>
<span id="cb15-77"><a href="#cb15-77" tabindex="-1"></a>  <span class="cf">return</span> ee<span class="op">.</span><span class="fu">Feature</span>(geometry<span class="op">,</span> {</span>
<span id="cb15-78"><a href="#cb15-78" tabindex="-1"></a>    <span class="st">&#39;class&#39;</span><span class="op">:</span> classNumber<span class="op">,</span></span>
<span id="cb15-79"><a href="#cb15-79" tabindex="-1"></a>    <span class="st">&#39;class_name&#39;</span><span class="op">:</span> className<span class="op">,</span></span>
<span id="cb15-80"><a href="#cb15-80" tabindex="-1"></a>    <span class="st">&#39;Area&#39;</span><span class="op">:</span> classArea<span class="op">,</span></span>
<span id="cb15-81"><a href="#cb15-81" tabindex="-1"></a>    <span class="st">&#39;color&#39;</span><span class="op">:</span> classColor</span>
<span id="cb15-82"><a href="#cb15-82" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb15-83"><a href="#cb15-83" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb15-84"><a href="#cb15-84" tabindex="-1"></a></span>
<span id="cb15-85"><a href="#cb15-85" tabindex="-1"></a><span class="kw">var</span> classAreaFc <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(classAreaList)<span class="op">;</span></span>
<span id="cb15-86"><a href="#cb15-86" tabindex="-1"></a></span>
<span id="cb15-87"><a href="#cb15-87" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;Class Area (FeatureCollection)&#39;</span><span class="op">,</span> classAreaFc)<span class="op">;</span></span>
<span id="cb15-88"><a href="#cb15-88" tabindex="-1"></a></span>
<span id="cb15-89"><a href="#cb15-89" tabindex="-1"></a><span class="co">// We can now chart the resulting FeatureCollection</span></span>
<span id="cb15-90"><a href="#cb15-90" tabindex="-1"></a><span class="co">// If your area is large, it is advisable to first Export</span></span>
<span id="cb15-91"><a href="#cb15-91" tabindex="-1"></a><span class="co">// the featurecolleciton as an Asset and import it once</span></span>
<span id="cb15-92"><a href="#cb15-92" tabindex="-1"></a><span class="co">// the export is finished.</span></span>
<span id="cb15-93"><a href="#cb15-93" tabindex="-1"></a><span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">feature</span><span class="op">.</span><span class="fu">byFeature</span>({</span>
<span id="cb15-94"><a href="#cb15-94" tabindex="-1"></a>  <span class="dt">features</span><span class="op">:</span> classAreaFc<span class="op">,</span></span>
<span id="cb15-95"><a href="#cb15-95" tabindex="-1"></a>  <span class="dt">xProperty</span><span class="op">:</span> <span class="st">&#39;class_name&#39;</span><span class="op">,</span></span>
<span id="cb15-96"><a href="#cb15-96" tabindex="-1"></a>  <span class="dt">yProperties</span><span class="op">:</span> [<span class="st">&#39;Area&#39;</span>]</span>
<span id="cb15-97"><a href="#cb15-97" tabindex="-1"></a>})<span class="op">.</span><span class="fu">setChartType</span>(<span class="st">&#39;PieChart&#39;</span>)</span>
<span id="cb15-98"><a href="#cb15-98" tabindex="-1"></a><span class="op">.</span><span class="fu">setOptions</span>({</span>
<span id="cb15-99"><a href="#cb15-99" tabindex="-1"></a>  <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Area by class&#39;</span><span class="op">,</span></span>
<span id="cb15-100"><a href="#cb15-100" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb15-101"><a href="#cb15-101" tabindex="-1"></a></span>
<span id="cb15-102"><a href="#cb15-102" tabindex="-1"></a><span class="fu">print</span>(chart)<span class="op">;</span></span>
<span id="cb15-103"><a href="#cb15-103" tabindex="-1"></a></span>
<span id="cb15-104"><a href="#cb15-104" tabindex="-1"></a><span class="co">// The pie colors do not match the class colors</span></span>
<span id="cb15-105"><a href="#cb15-105" tabindex="-1"></a><span class="co">// We need to create a list of colors for</span></span>
<span id="cb15-106"><a href="#cb15-106" tabindex="-1"></a><span class="co">// all the classes present in the FeatureCollection</span></span>
<span id="cb15-107"><a href="#cb15-107" tabindex="-1"></a><span class="kw">var</span> colors <span class="op">=</span> classAreaFc<span class="op">.</span><span class="fu">aggregate_array</span>(<span class="st">&#39;color&#39;</span>)<span class="op">;</span></span>
<span id="cb15-108"><a href="#cb15-108" tabindex="-1"></a><span class="fu">print</span>(colors)<span class="op">;</span></span>
<span id="cb15-109"><a href="#cb15-109" tabindex="-1"></a></span>
<span id="cb15-110"><a href="#cb15-110" tabindex="-1"></a><span class="co">// The variable &#39;colors&#39; is a server-side object</span></span>
<span id="cb15-111"><a href="#cb15-111" tabindex="-1"></a><span class="co">// Use evaluate() to convert it to client-side</span></span>
<span id="cb15-112"><a href="#cb15-112" tabindex="-1"></a><span class="co">// and use the results in the chart</span></span>
<span id="cb15-113"><a href="#cb15-113" tabindex="-1"></a>colors<span class="op">.</span><span class="fu">evaluate</span>(<span class="kw">function</span>(colorlist) {</span>
<span id="cb15-114"><a href="#cb15-114" tabindex="-1"></a>  <span class="co">// Let&#39;s create a Pie Chart</span></span>
<span id="cb15-115"><a href="#cb15-115" tabindex="-1"></a>  <span class="kw">var</span> areaChart <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">feature</span><span class="op">.</span><span class="fu">byFeature</span>({</span>
<span id="cb15-116"><a href="#cb15-116" tabindex="-1"></a>    <span class="dt">features</span><span class="op">:</span> classAreaFc<span class="op">,</span></span>
<span id="cb15-117"><a href="#cb15-117" tabindex="-1"></a>    <span class="dt">xProperty</span><span class="op">:</span> <span class="st">&#39;class_name&#39;</span><span class="op">,</span></span>
<span id="cb15-118"><a href="#cb15-118" tabindex="-1"></a>    <span class="dt">yProperties</span><span class="op">:</span> [<span class="st">&#39;Area&#39;</span>]</span>
<span id="cb15-119"><a href="#cb15-119" tabindex="-1"></a>  })<span class="op">.</span><span class="fu">setChartType</span>(<span class="st">&#39;PieChart&#39;</span>)</span>
<span id="cb15-120"><a href="#cb15-120" tabindex="-1"></a>    <span class="op">.</span><span class="fu">setOptions</span>({</span>
<span id="cb15-121"><a href="#cb15-121" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Area by class&#39;</span><span class="op">,</span></span>
<span id="cb15-122"><a href="#cb15-122" tabindex="-1"></a>      <span class="dt">colors</span><span class="op">:</span> colorlist<span class="op">,</span></span>
<span id="cb15-123"><a href="#cb15-123" tabindex="-1"></a>      <span class="dt">pieSliceBorderColor</span><span class="op">:</span> <span class="st">&#39;#fafafa&#39;</span><span class="op">,</span></span>
<span id="cb15-124"><a href="#cb15-124" tabindex="-1"></a>      <span class="dt">pieSliceTextStyle</span><span class="op">:</span> {<span class="st">&#39;color&#39;</span><span class="op">:</span> <span class="st">&#39;#252525&#39;</span>}<span class="op">,</span> </span>
<span id="cb15-125"><a href="#cb15-125" tabindex="-1"></a>      <span class="dt">pieSliceText</span><span class="op">:</span> <span class="st">&#39;percentage&#39;</span><span class="op">,</span></span>
<span id="cb15-126"><a href="#cb15-126" tabindex="-1"></a>      <span class="dt">sliceVisibilityThreshold</span><span class="op">:</span> <span class="fl">0.10</span></span>
<span id="cb15-127"><a href="#cb15-127" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb15-128"><a href="#cb15-128" tabindex="-1"></a>  <span class="fu">print</span>(areaChart)<span class="op">;</span> </span>
<span id="cb15-129"><a href="#cb15-129" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<div id="exercise-7" class="section level3">
<h3>Exercise</h3>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3A03-FeatureCollection_Charts%2F01c_Area_By_Class_Pie_Chart_(exercise)"
target="_blank">Open in Code Editor ↗</a></p>
<pre><code>/ Exercise

// a) Delete the &#39;geometry&#39; and add a new point at your chosen location
// b) Modify the chart options to show one of the slices separated from the pie.
// c) Print the chart.

// Hint: Use the &#39;offset&#39; property 
// https://developers.google.com/chart/interactive/docs/gallery/piechart#exploding-a-slice</code></pre>
<div class="figure" style="text-align: center">
<img src="images/gee_charts/area_by_class_piechart_exercise.png" alt="Exercise 04c" width="75%" />
<p class="caption">
Exercise 04c
</p>
</div>
</div>
</div>
<div id="featurecollection-column-chart" class="section level2">
<h2>3.2 FeatureCollection Column Chart</h2>
<p>In the previous example, we used the
<code>ui.Chart.feature.byFeature()</code> function to create a plot from
the properties of each feature. There are fewer built-in functions to
create different plots from FeatureCollections, but we can always use
the GEE API to process our data and create a FeatureCollection to meet
our requirements.</p>
<p>Here we take the WRI Global Power Plant Database and create a plot
showing total installed capacity by fuel type for the chosen country.
The FeatureCollection has one feature for each power plant, so we first
need to process the collection to create one feature for each fuel type
having a property with the total capacity. We use the a <a
href="https://developers.google.com/earth-engine/guides/reducers_grouping">Grouped
Reducer</a> with the <code>reduceColumns()</code> function to calculate
group statistics on a FeatureCollection.</p>
<p>We then use the <code>ui.Chart.feature.byFeature()</code> function to
create a Bar Chart.</p>
<blockquote>
<p>Google Charts uses the term <em>Column Chart</em> for a vertical bar
chart, while the term <em>Bar Chart</em> is used for a horizonal bar
chart.</p>
</blockquote>
<p>Below is the list of new styling options applied to the column
chart:</p>
<ul>
<li><code>backgroundColor</code>: Sets the background color for the
whole chart.</li>
</ul>
<div class="figure" style="text-align: center">
<img src="images/gee_charts/group_stats_column_chart.png" alt="Column Chart" width="75%" />
<p class="caption">
Column Chart
</p>
</div>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3A03-FeatureCollection_Charts%2F02b_Group_Statistics_Column_Chart_(complete)"
target="_blank">Open in Code Editor ↗</a></p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode js"><code class="sourceCode javascript"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co">// Use the WRI Global Power Plant Database</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="kw">var</span> table <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(<span class="st">&#39;projects/sat-io/open-datasets/global_power_plant_DB_1-3&#39;</span>)<span class="op">;</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="co">// Select features for a country</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="kw">var</span> country <span class="op">=</span> <span class="st">&#39;Germany&#39;</span><span class="op">;</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="kw">var</span> filtered <span class="op">=</span> table</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">eq</span>(<span class="st">&#39;country_long&#39;</span><span class="op">,</span> country))<span class="op">;</span></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a><span class="fu">print</span>(filtered<span class="op">.</span><span class="fu">first</span>())<span class="op">;</span></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="co">// We want to calculate total installed capacity</span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="co">// by each fuel type</span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="co">// We use a Grouped Reducer to sum &#39;capacity_mw&#39;</span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="co">// values grouped by &#39;primary_fuel&#39;</span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a><span class="kw">var</span> stats <span class="op">=</span> filtered<span class="op">.</span><span class="fu">reduceColumns</span>({</span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a>  <span class="dt">selectors</span><span class="op">:</span> [<span class="st">&#39;capacity_mw&#39;</span><span class="op">,</span> <span class="st">&#39;primary_fuel&#39;</span>]<span class="op">,</span></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">sum</span>()<span class="op">.</span><span class="fu">setOutputs</span>([<span class="st">&#39;capacity_mw&#39;</span>])<span class="op">.</span><span class="fu">group</span>({</span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a>      <span class="dt">groupField</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a>      <span class="dt">groupName</span><span class="op">:</span> <span class="st">&#39;primary_fuel&#39;</span><span class="op">,</span></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a>    })</span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a></span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a><span class="co">// Post-process the result into a FeatureCollection</span></span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a><span class="kw">var</span> groupStats <span class="op">=</span> ee<span class="op">.</span><span class="fu">List</span>(stats<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;groups&#39;</span>))<span class="op">;</span></span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a><span class="kw">var</span> groupFc <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(groupStats<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(item) {</span>
<span id="cb17-25"><a href="#cb17-25" tabindex="-1"></a>  <span class="cf">return</span> ee<span class="op">.</span><span class="fu">Feature</span>(<span class="kw">null</span><span class="op">,</span> item)<span class="op">;</span></span>
<span id="cb17-26"><a href="#cb17-26" tabindex="-1"></a>}))<span class="op">;</span></span>
<span id="cb17-27"><a href="#cb17-27" tabindex="-1"></a></span>
<span id="cb17-28"><a href="#cb17-28" tabindex="-1"></a><span class="co">// Create a chart</span></span>
<span id="cb17-29"><a href="#cb17-29" tabindex="-1"></a><span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">feature</span><span class="op">.</span><span class="fu">byFeature</span>({</span>
<span id="cb17-30"><a href="#cb17-30" tabindex="-1"></a>  <span class="dt">features</span><span class="op">:</span> groupFc<span class="op">,</span></span>
<span id="cb17-31"><a href="#cb17-31" tabindex="-1"></a>  <span class="dt">xProperty</span><span class="op">:</span> <span class="st">&#39;primary_fuel&#39;</span><span class="op">,</span></span>
<span id="cb17-32"><a href="#cb17-32" tabindex="-1"></a>  <span class="dt">yProperties</span><span class="op">:</span> [<span class="st">&#39;capacity_mw&#39;</span>]</span>
<span id="cb17-33"><a href="#cb17-33" tabindex="-1"></a>})<span class="op">.</span><span class="fu">setChartType</span>(<span class="st">&#39;ColumnChart&#39;</span>)</span>
<span id="cb17-34"><a href="#cb17-34" tabindex="-1"></a>  <span class="op">.</span><span class="fu">setOptions</span>({</span>
<span id="cb17-35"><a href="#cb17-35" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Installed Power Generation Capacity by Fuel Type for &#39;</span> <span class="op">+</span> country<span class="op">,</span></span>
<span id="cb17-36"><a href="#cb17-36" tabindex="-1"></a>    <span class="dt">vAxis</span><span class="op">:</span> {</span>
<span id="cb17-37"><a href="#cb17-37" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Capacity (MW)&#39;</span><span class="op">,</span></span>
<span id="cb17-38"><a href="#cb17-38" tabindex="-1"></a>      <span class="dt">format</span><span class="op">:</span> <span class="st">&#39;short&#39;</span> </span>
<span id="cb17-39"><a href="#cb17-39" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb17-40"><a href="#cb17-40" tabindex="-1"></a>    <span class="dt">hAxis</span><span class="op">:</span> {</span>
<span id="cb17-41"><a href="#cb17-41" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Type of Fuel&#39;</span>}<span class="op">,</span></span>
<span id="cb17-42"><a href="#cb17-42" tabindex="-1"></a>    <span class="dt">backgroundColor</span><span class="op">:</span> <span class="st">&#39;#feedde&#39;</span><span class="op">,</span></span>
<span id="cb17-43"><a href="#cb17-43" tabindex="-1"></a>    <span class="dt">colors</span><span class="op">:</span> [<span class="st">&#39;#d94801&#39;</span>]<span class="op">,</span></span>
<span id="cb17-44"><a href="#cb17-44" tabindex="-1"></a>    <span class="dt">legend</span><span class="op">:</span> { <span class="dt">position</span><span class="op">:</span> <span class="st">&#39;none&#39;</span> }<span class="op">,</span></span>
<span id="cb17-45"><a href="#cb17-45" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb17-46"><a href="#cb17-46" tabindex="-1"></a><span class="fu">print</span>(chart)<span class="op">;</span></span></code></pre></div>
<div id="exercise-8" class="section level3">
<h3>Exercise</h3>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3A03-FeatureCollection_Charts%2F02c_Group_Statistics_Column_Chart_(exercise)"
target="_blank">Open in Code Editor ↗</a></p>
<pre><code>// a) Change the country name to your chosen country
// b) Sort the groupFc by &#39;capacity_mw&#39; property so the bars are plotted
//    from largest to smallest values
// c) Print the chart

// Hint: Use the .sort() function</code></pre>
<div class="figure" style="text-align: center">
<img src="images/gee_charts/group_stats_column_chart_exercise.png" alt="Exercise 02c" width="75%" />
<p class="caption">
Exercise 02c
</p>
</div>
</div>
</div>
</div>
<div id="advanced-charts" class="section level1">
<h1>4. Advanced Charts</h1>
<p><a
href="https://www.youtube.com/watch?v=tm1guEctfOc&amp;list=PLppGmFLhQ1HKyrR75waIq6TfqL0ESlQao&amp;index=21"
target="_blank"><img
src="https://img.youtube.com/vi/tm1guEctfOc/mqdefault.jpg"
alt="Start Module 4 Videos" /></a></p>
<p><a
href="https://www.youtube.com/watch?v=tm1guEctfOc&amp;list=PLppGmFLhQ1HKyrR75waIq6TfqL0ESlQao&amp;index=21"
target="_blank">Start Module 4 Videos ↗</a></p>
<div id="datatable-charts" class="section level2">
<h2>4.1 DataTable Charts</h2>
<p>The charting helper functions provided by the GEE Javascript API
offer a simpler way to create many types of commonly used charts. But in
doing so, it offers a subset of the functionality provided by Google
Charts API. Whenever you find yourself limited by the built-in charting
functions and want additional customization, you can use the
<code>ui.Chart()</code> function which allows you to specify a Google
Charts <a
href="https://developers.google.com/chart/interactive/docs/reference#DataTable">DataTable</a>
for creating your chart. There are many options to create a DataTable
object but I would recommend using the <a
href="https://developers.google.com/chart/interactive/docs/datatables_dataviews#javascriptliteral">Javascript
Literal Initializer</a> which is more explicit and readable compared to
other methods. You create a table object with a <code>cols</code> key
containing column specifications and a <code>rows</code> key with the
data values.</p>
<p>Here we take a sample dataset from the survey of <a
href="https://doi.org/10.1016/j.cageo.2021.104916">Users of open Big
Earth data – An analysis of the current state</a> by Wagemann, J. et. al
and reproduce a chart showing <em>Use of Programming Languages</em> for
using the GEE Charts API.</p>
<p>Below is the list of new styling options applied to the pie
chart:</p>
<ul>
<li><code>annotations.alwaysOutside</code>: Renders the annotations
outside of the bars.</li>
<li><code>annotations.textStyle</code>: Sets the text style of the
annotations.</li>
<li><code>annotations.boxStyle</code>: Sets the style of the box around
annotation text.</li>
</ul>
<div class="figure" style="text-align: center">
<img src="images/gee_charts/datatable_columnchart.png" alt="DataTable Column Chart" width="75%" />
<p class="caption">
DataTable Column Chart
</p>
</div>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3A04-Advanced_Charts%2F01b_DataTable_Chart_(complete)"
target="_blank">Open in Code Editor ↗</a></p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode js"><code class="sourceCode javascript"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co">// We use the Big Earth Data - Survey 2019 data</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="co">// https://zenodo.org/record/4075058</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="co">// Create a DataTable</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="kw">var</span> dataTable <span class="op">=</span> {</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>  <span class="dt">cols</span><span class="op">:</span> [</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>    {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;language&#39;</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">&#39;Programming Language&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;string&#39;</span>}<span class="op">,</span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>    {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;responses&#39;</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">&#39;Number of Responses&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;number&#39;</span>}<span class="op">,</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>    {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;percentage&#39;</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">&#39;Percentage&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;number&#39;</span><span class="op">,</span> <span class="dt">role</span><span class="op">:</span> <span class="st">&#39;annotation&#39;</span>}<span class="op">,</span></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>    {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;style&#39;</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">&#39;Style&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;string&#39;</span><span class="op">,</span> <span class="dt">role</span><span class="op">:</span> <span class="st">&#39;style&#39;</span>}<span class="op">,</span></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a>  ]<span class="op">,</span></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a>  <span class="dt">rows</span><span class="op">:</span> [</span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a>    {<span class="dt">c</span><span class="op">:</span> [ {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;Python&#39;</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="dv">178</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="fl">77.1</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;color: #8dd3c7&#39;</span>}]}<span class="op">,</span></span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a>    {<span class="dt">c</span><span class="op">:</span> [ {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;R&#39;</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="dv">102</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="fl">44.2</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;color: #ffffb3&#39;</span>} ]}<span class="op">,</span></span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a>    {<span class="dt">c</span><span class="op">:</span> [ {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;Javascript&#39;</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="dv">59</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="fl">25.5</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;color: #bebada&#39;</span>} ]}<span class="op">,</span></span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a>    {<span class="dt">c</span><span class="op">:</span> [ {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;Fortran&#39;</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="dv">37</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="dv">16</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;color: #fb8072&#39;</span>} ]}<span class="op">,</span></span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a>    {<span class="dt">c</span><span class="op">:</span> [ {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;Java&#39;</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="dv">32</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="fl">13.9</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;color: #80b1d3&#39;</span>}]}<span class="op">,</span></span>
<span id="cb19-19"><a href="#cb19-19" tabindex="-1"></a>    {<span class="dt">c</span><span class="op">:</span> [ {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;C++&#39;</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="dv">27</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="fl">11.7</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;color: #fdb462&#39;</span>}]}<span class="op">,</span></span>
<span id="cb19-20"><a href="#cb19-20" tabindex="-1"></a>    {<span class="dt">c</span><span class="op">:</span> [ {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;C&#39;</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="dv">18</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="fl">7.8</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;color: #b3de69&#39;</span>}]}<span class="op">,</span></span>
<span id="cb19-21"><a href="#cb19-21" tabindex="-1"></a>    {<span class="dt">c</span><span class="op">:</span> [ {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;PHP&#39;</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="dv">14</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="fl">6.1</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;color: #fccde5&#39;</span>} ]}<span class="op">,</span></span>
<span id="cb19-22"><a href="#cb19-22" tabindex="-1"></a>    {<span class="dt">c</span><span class="op">:</span> [ {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;Julia&#39;</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="dv">6</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="fl">2.6</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;color: #d9d9d9&#39;</span>} ]}<span class="op">,</span></span>
<span id="cb19-23"><a href="#cb19-23" tabindex="-1"></a>    {<span class="dt">c</span><span class="op">:</span> [ {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;Scala&#39;</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="dv">3</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="fl">1.3</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;color: #bc80bd&#39;</span>}]}<span class="op">,</span></span>
<span id="cb19-24"><a href="#cb19-24" tabindex="-1"></a>    ]</span>
<span id="cb19-25"><a href="#cb19-25" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb19-26"><a href="#cb19-26" tabindex="-1"></a></span>
<span id="cb19-27"><a href="#cb19-27" tabindex="-1"></a><span class="co">// Create a dictionary for options</span></span>
<span id="cb19-28"><a href="#cb19-28" tabindex="-1"></a><span class="kw">var</span> options <span class="op">=</span> {</span>
<span id="cb19-29"><a href="#cb19-29" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Use of Programming Languages by Users of Big Earth Data&#39;</span><span class="op">,</span></span>
<span id="cb19-30"><a href="#cb19-30" tabindex="-1"></a>    <span class="dt">vAxis</span><span class="op">:</span> {</span>
<span id="cb19-31"><a href="#cb19-31" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Number of Responses&#39;</span><span class="op">,</span></span>
<span id="cb19-32"><a href="#cb19-32" tabindex="-1"></a>      <span class="dt">viewWindow</span><span class="op">:</span> {<span class="dt">min</span><span class="op">:</span><span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">200</span>}</span>
<span id="cb19-33"><a href="#cb19-33" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb19-34"><a href="#cb19-34" tabindex="-1"></a>    <span class="dt">hAxis</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Programming language&#39;</span>}<span class="op">,</span></span>
<span id="cb19-35"><a href="#cb19-35" tabindex="-1"></a>    <span class="dt">legend</span><span class="op">:</span> {<span class="dt">position</span><span class="op">:</span> <span class="st">&#39;none&#39;</span>}<span class="op">,</span></span>
<span id="cb19-36"><a href="#cb19-36" tabindex="-1"></a>    <span class="dt">annotations</span><span class="op">:</span> {</span>
<span id="cb19-37"><a href="#cb19-37" tabindex="-1"></a>      <span class="dt">alwaysOutside</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb19-38"><a href="#cb19-38" tabindex="-1"></a>      <span class="dt">textStyle</span><span class="op">:</span> {<span class="dt">bold</span><span class="op">:</span> <span class="kw">true</span>}<span class="op">,</span></span>
<span id="cb19-39"><a href="#cb19-39" tabindex="-1"></a>      <span class="dt">boxStyle</span><span class="op">:</span> {</span>
<span id="cb19-40"><a href="#cb19-40" tabindex="-1"></a>      <span class="dt">stroke</span><span class="op">:</span> <span class="st">&#39;#404040&#39;</span><span class="op">,</span></span>
<span id="cb19-41"><a href="#cb19-41" tabindex="-1"></a>      <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb19-42"><a href="#cb19-42" tabindex="-1"></a>      }</span>
<span id="cb19-43"><a href="#cb19-43" tabindex="-1"></a>    }</span>
<span id="cb19-44"><a href="#cb19-44" tabindex="-1"></a>  }</span>
<span id="cb19-45"><a href="#cb19-45" tabindex="-1"></a>  </span>
<span id="cb19-46"><a href="#cb19-46" tabindex="-1"></a><span class="co">// Use ui.Chart() to create a chart</span></span>
<span id="cb19-47"><a href="#cb19-47" tabindex="-1"></a><span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="fu">Chart</span>(dataTable<span class="op">,</span> <span class="st">&#39;ColumnChart&#39;</span><span class="op">,</span> options)<span class="op">;</span></span>
<span id="cb19-48"><a href="#cb19-48" tabindex="-1"></a><span class="co">// Print the chart</span></span>
<span id="cb19-49"><a href="#cb19-49" tabindex="-1"></a><span class="fu">print</span>(chart)<span class="op">;</span></span></code></pre></div>
<div id="exercise-9" class="section level3">
<h3>Exercise</h3>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3A04-Advanced_Charts%2F01c_DataTable_Chart_(exercise)"
target="_blank">Open in Code Editor ↗</a></p>
<pre><code>// Exercise

// The DataTable now has an additional value with the &#39;f&#39; key showing the formatted value

// a) Change the chart to show horizonal bars. Hint: Use the type &#39;BarChart&#39;
// b) Fix the X and Y-axis labels</code></pre>
<div class="figure" style="text-align: center">
<img src="images/gee_charts/datatable_columnchart_exercise.png" alt="Exercise 01c" width="75%" />
<p class="caption">
Exercise 01c
</p>
</div>
</div>
</div>
<div id="box-plots" class="section level2">
<h2>4.2 Box Plots</h2>
<p>Many scientific analysis require showing the spread of values at each
data point using a <em>Box Plot</em> or a <em>Whisker Plot</em>. Google
Charts supports this using <a
href="https://developers.google.com/chart/interactive/docs/gallery/intervals">Intervals</a>.
To display the intervals, we must define a DataTable where certain
columns are assigned the <code>role</code> of an
<code>interval</code>.</p>
<p>We start with a Sentinel-2 NDVI Time-Series at a farm polygon showing
the median values within the polygon at each observation. We process the
results using <a
href="https://developers.google.com/earth-engine/guides/reducers_intro#combining-reducers">Combined
Reducers</a> and calculate the minimum, first quartile, second quartile,
third quartile and maximum values. Since these values will be used in a
DataTable, we apply additional formatting to create a dictionary for
each row as per the Javascript literal format.</p>
<p>Below is the list of new styling options applied to the interval
chart:</p>
<ul>
<li><code>intervals</code>: Sets style of the interval values.</li>
<li><code>interval</code>: Override the style of selected
intervals.</li>
</ul>
<div class="figure" style="text-align: center">
<img src="images/gee_charts/box_plot.png" alt="Box Plot" width="75%" />
<p class="caption">
Box Plot
</p>
</div>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3A04-Advanced_Charts%2F02b_Box_Plots_(complete)"
target="_blank">Open in Code Editor ↗</a></p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode js"><code class="sourceCode javascript"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="kw">var</span> s2 <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&#39;COPERNICUS/S2_HARMONIZED&#39;</span>)<span class="op">;</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="kw">var</span> geometry <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Polygon</span>([[</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>  [<span class="fl">82.60642647743225</span><span class="op">,</span> <span class="fl">27.16350437805251</span>]<span class="op">,</span></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>  [<span class="fl">82.60984897613525</span><span class="op">,</span> <span class="fl">27.1618529901377</span>]<span class="op">,</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>  [<span class="fl">82.61088967323303</span><span class="op">,</span> <span class="fl">27.163695288375266</span>]<span class="op">,</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>  [<span class="fl">82.60757446289062</span><span class="op">,</span> <span class="fl">27.16517483230927</span>]</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>]])<span class="op">;</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(geometry<span class="op">,</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;red&#39;</span>}<span class="op">,</span> <span class="st">&#39;Farm&#39;</span>)<span class="op">;</span></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">centerObject</span>(geometry)<span class="op">;</span></span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a><span class="kw">var</span> rgbVis <span class="op">=</span> {<span class="dt">min</span><span class="op">:</span> <span class="fl">0.0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">3000</span><span class="op">,</span> <span class="dt">bands</span><span class="op">:</span> [<span class="st">&#39;B4&#39;</span><span class="op">,</span> <span class="st">&#39;B3&#39;</span><span class="op">,</span> <span class="st">&#39;B2&#39;</span>]}<span class="op">;</span></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a><span class="kw">var</span> filtered <span class="op">=</span> s2</span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">date</span>(<span class="st">&#39;2017-01-01&#39;</span><span class="op">,</span> <span class="st">&#39;2018-01-01&#39;</span>))</span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">lt</span>(<span class="st">&#39;CLOUDY_PIXEL_PERCENTAGE&#39;</span><span class="op">,</span> <span class="dv">30</span>))</span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">bounds</span>(geometry))<span class="op">;</span></span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a></span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a><span class="co">// Write a function for Cloud masking</span></span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a><span class="kw">function</span> <span class="fu">maskS2clouds</span>(image) {</span>
<span id="cb21-20"><a href="#cb21-20" tabindex="-1"></a>  <span class="kw">var</span> qa <span class="op">=</span> image<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;QA60&#39;</span>)<span class="op">;</span></span>
<span id="cb21-21"><a href="#cb21-21" tabindex="-1"></a>  <span class="kw">var</span> cloudBitMask <span class="op">=</span> <span class="dv">1</span> <span class="op">&lt;&lt;</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb21-22"><a href="#cb21-22" tabindex="-1"></a>  <span class="kw">var</span> cirrusBitMask <span class="op">=</span> <span class="dv">1</span> <span class="op">&lt;&lt;</span> <span class="dv">11</span><span class="op">;</span></span>
<span id="cb21-23"><a href="#cb21-23" tabindex="-1"></a>  <span class="kw">var</span> mask <span class="op">=</span> qa<span class="op">.</span><span class="fu">bitwiseAnd</span>(cloudBitMask)<span class="op">.</span><span class="fu">eq</span>(<span class="dv">0</span>)<span class="op">.</span><span class="fu">and</span>(</span>
<span id="cb21-24"><a href="#cb21-24" tabindex="-1"></a>             qa<span class="op">.</span><span class="fu">bitwiseAnd</span>(cirrusBitMask)<span class="op">.</span><span class="fu">eq</span>(<span class="dv">0</span>))<span class="op">;</span></span>
<span id="cb21-25"><a href="#cb21-25" tabindex="-1"></a>  <span class="cf">return</span> image<span class="op">.</span><span class="fu">updateMask</span>(mask)<span class="op">.</span><span class="fu">multiply</span>(<span class="fl">0.0001</span>)</span>
<span id="cb21-26"><a href="#cb21-26" tabindex="-1"></a>      <span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;B.*&#39;</span>)</span>
<span id="cb21-27"><a href="#cb21-27" tabindex="-1"></a>      <span class="op">.</span><span class="fu">copyProperties</span>(image<span class="op">,</span> [<span class="st">&#39;system:time_start&#39;</span>])<span class="op">;</span></span>
<span id="cb21-28"><a href="#cb21-28" tabindex="-1"></a>}</span>
<span id="cb21-29"><a href="#cb21-29" tabindex="-1"></a></span>
<span id="cb21-30"><a href="#cb21-30" tabindex="-1"></a><span class="kw">var</span> filtered <span class="op">=</span> filtered<span class="op">.</span><span class="fu">map</span>(maskS2clouds)<span class="op">;</span></span>
<span id="cb21-31"><a href="#cb21-31" tabindex="-1"></a><span class="co">// Write a function that computes NDVI for an image and adds it as a band</span></span>
<span id="cb21-32"><a href="#cb21-32" tabindex="-1"></a><span class="kw">function</span> <span class="fu">addNDVI</span>(image) {</span>
<span id="cb21-33"><a href="#cb21-33" tabindex="-1"></a>  <span class="kw">var</span> ndvi <span class="op">=</span> image<span class="op">.</span><span class="fu">normalizedDifference</span>([<span class="st">&#39;B8&#39;</span><span class="op">,</span> <span class="st">&#39;B4&#39;</span>])<span class="op">.</span><span class="fu">rename</span>(<span class="st">&#39;ndvi&#39;</span>)<span class="op">;</span></span>
<span id="cb21-34"><a href="#cb21-34" tabindex="-1"></a>  <span class="cf">return</span> image<span class="op">.</span><span class="fu">addBands</span>(ndvi)<span class="op">;</span></span>
<span id="cb21-35"><a href="#cb21-35" tabindex="-1"></a>}</span>
<span id="cb21-36"><a href="#cb21-36" tabindex="-1"></a></span>
<span id="cb21-37"><a href="#cb21-37" tabindex="-1"></a><span class="co">// Map the function over the collection</span></span>
<span id="cb21-38"><a href="#cb21-38" tabindex="-1"></a><span class="kw">var</span> withNdvi <span class="op">=</span> filtered<span class="op">.</span><span class="fu">map</span>(addNDVI)<span class="op">;</span></span>
<span id="cb21-39"><a href="#cb21-39" tabindex="-1"></a></span>
<span id="cb21-40"><a href="#cb21-40" tabindex="-1"></a><span class="co">// Plot the median NDVI values over time</span></span>
<span id="cb21-41"><a href="#cb21-41" tabindex="-1"></a><span class="co">// Display a time-series chart</span></span>
<span id="cb21-42"><a href="#cb21-42" tabindex="-1"></a><span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">image</span><span class="op">.</span><span class="fu">series</span>({</span>
<span id="cb21-43"><a href="#cb21-43" tabindex="-1"></a>  <span class="dt">imageCollection</span><span class="op">:</span> withNdvi<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;ndvi&#39;</span>)<span class="op">,</span></span>
<span id="cb21-44"><a href="#cb21-44" tabindex="-1"></a>  <span class="dt">region</span><span class="op">:</span> geometry<span class="op">,</span></span>
<span id="cb21-45"><a href="#cb21-45" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">median</span>()<span class="op">,</span></span>
<span id="cb21-46"><a href="#cb21-46" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">10</span></span>
<span id="cb21-47"><a href="#cb21-47" tabindex="-1"></a>})<span class="op">.</span><span class="fu">setOptions</span>({</span>
<span id="cb21-48"><a href="#cb21-48" tabindex="-1"></a>      <span class="dt">lineWidth</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb21-49"><a href="#cb21-49" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;NDVI Time Series&#39;</span><span class="op">,</span></span>
<span id="cb21-50"><a href="#cb21-50" tabindex="-1"></a>      <span class="dt">interpolateNulls</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb21-51"><a href="#cb21-51" tabindex="-1"></a>      <span class="dt">vAxis</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">&#39;NDVI&#39;</span>}<span class="op">,</span></span>
<span id="cb21-52"><a href="#cb21-52" tabindex="-1"></a>      <span class="dt">hAxis</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">&#39;&#39;</span><span class="op">,</span> <span class="dt">format</span><span class="op">:</span> <span class="st">&#39;YYYY-MMM&#39;</span>}</span>
<span id="cb21-53"><a href="#cb21-53" tabindex="-1"></a>    })</span>
<span id="cb21-54"><a href="#cb21-54" tabindex="-1"></a><span class="fu">print</span>(chart)<span class="op">;</span></span>
<span id="cb21-55"><a href="#cb21-55" tabindex="-1"></a></span>
<span id="cb21-56"><a href="#cb21-56" tabindex="-1"></a><span class="co">// Extract the values from each image</span></span>
<span id="cb21-57"><a href="#cb21-57" tabindex="-1"></a><span class="kw">var</span> values <span class="op">=</span> withNdvi<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(image) {</span>
<span id="cb21-58"><a href="#cb21-58" tabindex="-1"></a>  <span class="kw">var</span> ndvi <span class="op">=</span> image<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;ndvi&#39;</span>)<span class="op">;</span></span>
<span id="cb21-59"><a href="#cb21-59" tabindex="-1"></a>  </span>
<span id="cb21-60"><a href="#cb21-60" tabindex="-1"></a>  <span class="kw">var</span> allReducers <span class="op">=</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">median</span>()</span>
<span id="cb21-61"><a href="#cb21-61" tabindex="-1"></a>    <span class="op">.</span><span class="fu">combine</span>({<span class="dt">reducer2</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">min</span>()<span class="op">,</span> <span class="dt">sharedInputs</span><span class="op">:</span> <span class="kw">true</span>} )</span>
<span id="cb21-62"><a href="#cb21-62" tabindex="-1"></a>    <span class="op">.</span><span class="fu">combine</span>({<span class="dt">reducer2</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">max</span>()<span class="op">,</span> <span class="dt">sharedInputs</span><span class="op">:</span> <span class="kw">true</span>} )</span>
<span id="cb21-63"><a href="#cb21-63" tabindex="-1"></a>    <span class="op">.</span><span class="fu">combine</span>({<span class="dt">reducer2</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">percentile</span>([<span class="dv">25</span>])<span class="op">,</span> <span class="dt">sharedInputs</span><span class="op">:</span> <span class="kw">true</span>} )</span>
<span id="cb21-64"><a href="#cb21-64" tabindex="-1"></a>    <span class="op">.</span><span class="fu">combine</span>({<span class="dt">reducer2</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">percentile</span>([<span class="dv">50</span>])<span class="op">,</span> <span class="dt">sharedInputs</span><span class="op">:</span> <span class="kw">true</span>} )</span>
<span id="cb21-65"><a href="#cb21-65" tabindex="-1"></a>    <span class="op">.</span><span class="fu">combine</span>({<span class="dt">reducer2</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">percentile</span>([<span class="dv">75</span>])<span class="op">,</span> <span class="dt">sharedInputs</span><span class="op">:</span> <span class="kw">true</span>} )</span>
<span id="cb21-66"><a href="#cb21-66" tabindex="-1"></a>  </span>
<span id="cb21-67"><a href="#cb21-67" tabindex="-1"></a>  <span class="kw">var</span> stats <span class="op">=</span> ndvi<span class="op">.</span><span class="fu">reduceRegion</span>({</span>
<span id="cb21-68"><a href="#cb21-68" tabindex="-1"></a>    <span class="dt">reducer</span><span class="op">:</span> allReducers<span class="op">,</span></span>
<span id="cb21-69"><a href="#cb21-69" tabindex="-1"></a>    <span class="dt">geometry</span><span class="op">:</span> geometry<span class="op">,</span></span>
<span id="cb21-70"><a href="#cb21-70" tabindex="-1"></a>    <span class="dt">scale</span><span class="op">:</span> <span class="dv">10</span>})<span class="op">;</span></span>
<span id="cb21-71"><a href="#cb21-71" tabindex="-1"></a>  <span class="kw">var</span> date <span class="op">=</span> image<span class="op">.</span><span class="fu">date</span>()<span class="op">;</span></span>
<span id="cb21-72"><a href="#cb21-72" tabindex="-1"></a>  <span class="kw">var</span> dateString <span class="op">=</span> date<span class="op">.</span><span class="fu">format</span>(<span class="st">&#39;YYYY-MM-dd&#39;</span>)<span class="op">;</span></span>
<span id="cb21-73"><a href="#cb21-73" tabindex="-1"></a></span>
<span id="cb21-74"><a href="#cb21-74" tabindex="-1"></a>  <span class="kw">var</span> properties <span class="op">=</span> {</span>
<span id="cb21-75"><a href="#cb21-75" tabindex="-1"></a>    <span class="st">&#39;date&#39;</span><span class="op">:</span> dateString<span class="op">,</span></span>
<span id="cb21-76"><a href="#cb21-76" tabindex="-1"></a>    <span class="st">&#39;median&#39;</span><span class="op">:</span> stats<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;ndvi_p50&#39;</span>)<span class="op">,</span> <span class="co">// median is 50th percentile</span></span>
<span id="cb21-77"><a href="#cb21-77" tabindex="-1"></a>    <span class="st">&#39;min&#39;</span><span class="op">:</span> stats<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;ndvi_min&#39;</span>)<span class="op">,</span></span>
<span id="cb21-78"><a href="#cb21-78" tabindex="-1"></a>    <span class="st">&#39;max&#39;</span><span class="op">:</span> stats<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;ndvi_max&#39;</span>)<span class="op">,</span></span>
<span id="cb21-79"><a href="#cb21-79" tabindex="-1"></a>    <span class="st">&#39;p25&#39;</span><span class="op">:</span> stats<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;ndvi_p25&#39;</span>)<span class="op">,</span></span>
<span id="cb21-80"><a href="#cb21-80" tabindex="-1"></a>    <span class="st">&#39;p50&#39;</span><span class="op">:</span> stats<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;ndvi_p50&#39;</span>)<span class="op">,</span></span>
<span id="cb21-81"><a href="#cb21-81" tabindex="-1"></a>    <span class="st">&#39;p75&#39;</span><span class="op">:</span> stats<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;ndvi_p75&#39;</span>)<span class="op">,</span></span>
<span id="cb21-82"><a href="#cb21-82" tabindex="-1"></a>  }</span>
<span id="cb21-83"><a href="#cb21-83" tabindex="-1"></a>  <span class="cf">return</span> ee<span class="op">.</span><span class="fu">Feature</span>(<span class="kw">null</span><span class="op">,</span> properties)</span>
<span id="cb21-84"><a href="#cb21-84" tabindex="-1"></a>  </span>
<span id="cb21-85"><a href="#cb21-85" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb21-86"><a href="#cb21-86" tabindex="-1"></a></span>
<span id="cb21-87"><a href="#cb21-87" tabindex="-1"></a><span class="co">// Remove null values</span></span>
<span id="cb21-88"><a href="#cb21-88" tabindex="-1"></a><span class="kw">var</span> values <span class="op">=</span> values<span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">notNull</span>(</span>
<span id="cb21-89"><a href="#cb21-89" tabindex="-1"></a>  [<span class="st">&#39;median&#39;</span><span class="op">,</span> <span class="st">&#39;min&#39;</span><span class="op">,</span> <span class="st">&#39;max&#39;</span><span class="op">,</span> <span class="st">&#39;p25&#39;</span><span class="op">,</span> <span class="st">&#39;p50&#39;</span><span class="op">,</span> <span class="st">&#39;p75&#39;</span>]))<span class="op">;</span></span>
<span id="cb21-90"><a href="#cb21-90" tabindex="-1"></a>  </span>
<span id="cb21-91"><a href="#cb21-91" tabindex="-1"></a><span class="co">// Format the results as a list of DataTable rows</span></span>
<span id="cb21-92"><a href="#cb21-92" tabindex="-1"></a></span>
<span id="cb21-93"><a href="#cb21-93" tabindex="-1"></a><span class="co">// We need a list to map() over</span></span>
<span id="cb21-94"><a href="#cb21-94" tabindex="-1"></a><span class="kw">var</span> dateList <span class="op">=</span> values<span class="op">.</span><span class="fu">aggregate_array</span>(<span class="st">&#39;date&#39;</span>)<span class="op">;</span></span>
<span id="cb21-95"><a href="#cb21-95" tabindex="-1"></a></span>
<span id="cb21-96"><a href="#cb21-96" tabindex="-1"></a><span class="co">// Helper function to format dates as per DataTable requirements</span></span>
<span id="cb21-97"><a href="#cb21-97" tabindex="-1"></a><span class="co">// Converts date strings</span></span>
<span id="cb21-98"><a href="#cb21-98" tabindex="-1"></a><span class="co">// &#39;2017-01-01&#39; becomes &#39;Date(2017,0,1)&#39;</span></span>
<span id="cb21-99"><a href="#cb21-99" tabindex="-1"></a><span class="co">// month is indexed from 0 in Date String representation</span></span>
<span id="cb21-100"><a href="#cb21-100" tabindex="-1"></a><span class="kw">function</span> <span class="fu">formatDate</span>(date) {</span>
<span id="cb21-101"><a href="#cb21-101" tabindex="-1"></a>  <span class="kw">var</span> year <span class="op">=</span> ee<span class="op">.</span><span class="fu">Date</span>(date)<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;year&#39;</span>)<span class="op">.</span><span class="fu">format</span>()<span class="op">;</span></span>
<span id="cb21-102"><a href="#cb21-102" tabindex="-1"></a>  <span class="kw">var</span> month <span class="op">=</span> ee<span class="op">.</span><span class="fu">Date</span>(date)<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;month&#39;</span>)<span class="op">.</span><span class="fu">subtract</span>(<span class="dv">1</span>)<span class="op">.</span><span class="fu">format</span>()<span class="op">;</span></span>
<span id="cb21-103"><a href="#cb21-103" tabindex="-1"></a>  <span class="kw">var</span> day <span class="op">=</span> ee<span class="op">.</span><span class="fu">Date</span>(date)<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;day&#39;</span>)<span class="op">.</span><span class="fu">format</span>()<span class="op">;</span></span>
<span id="cb21-104"><a href="#cb21-104" tabindex="-1"></a>  <span class="cf">return</span> ee<span class="op">.</span><span class="fu">String</span>(<span class="st">&#39;Date(&#39;</span>)</span>
<span id="cb21-105"><a href="#cb21-105" tabindex="-1"></a>    <span class="op">.</span><span class="fu">cat</span>(year)</span>
<span id="cb21-106"><a href="#cb21-106" tabindex="-1"></a>    <span class="op">.</span><span class="fu">cat</span>(<span class="st">&#39;, &#39;</span>)</span>
<span id="cb21-107"><a href="#cb21-107" tabindex="-1"></a>    <span class="op">.</span><span class="fu">cat</span>(month)</span>
<span id="cb21-108"><a href="#cb21-108" tabindex="-1"></a>    <span class="op">.</span><span class="fu">cat</span>(<span class="st">&#39;, &#39;</span>)</span>
<span id="cb21-109"><a href="#cb21-109" tabindex="-1"></a>    <span class="op">.</span><span class="fu">cat</span>(day)</span>
<span id="cb21-110"><a href="#cb21-110" tabindex="-1"></a>    <span class="op">.</span><span class="fu">cat</span>(ee<span class="op">.</span><span class="fu">String</span>(<span class="st">&#39;)&#39;</span>))<span class="op">;</span></span>
<span id="cb21-111"><a href="#cb21-111" tabindex="-1"></a>}</span>
<span id="cb21-112"><a href="#cb21-112" tabindex="-1"></a></span>
<span id="cb21-113"><a href="#cb21-113" tabindex="-1"></a><span class="kw">var</span> rowList <span class="op">=</span> dateList<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(date) {</span>
<span id="cb21-114"><a href="#cb21-114" tabindex="-1"></a>  <span class="kw">var</span> f <span class="op">=</span> values<span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">eq</span>(<span class="st">&#39;date&#39;</span><span class="op">,</span> date))<span class="op">.</span><span class="fu">first</span>()<span class="op">;</span></span>
<span id="cb21-115"><a href="#cb21-115" tabindex="-1"></a>  <span class="kw">var</span> x <span class="op">=</span> <span class="fu">formatDate</span>(date)<span class="op">;</span></span>
<span id="cb21-116"><a href="#cb21-116" tabindex="-1"></a>  <span class="kw">var</span> median <span class="op">=</span> f<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;median&#39;</span>)<span class="op">;</span></span>
<span id="cb21-117"><a href="#cb21-117" tabindex="-1"></a>  <span class="kw">var</span> min <span class="op">=</span> f<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;min&#39;</span>)<span class="op">;</span></span>
<span id="cb21-118"><a href="#cb21-118" tabindex="-1"></a>  <span class="kw">var</span> max <span class="op">=</span> f<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;max&#39;</span>)<span class="op">;</span></span>
<span id="cb21-119"><a href="#cb21-119" tabindex="-1"></a>  <span class="kw">var</span> p25 <span class="op">=</span> f<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;p25&#39;</span>)<span class="op">;</span></span>
<span id="cb21-120"><a href="#cb21-120" tabindex="-1"></a>  <span class="kw">var</span> p50 <span class="op">=</span> f<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;p50&#39;</span>)<span class="op">;</span></span>
<span id="cb21-121"><a href="#cb21-121" tabindex="-1"></a>  <span class="kw">var</span> p75 <span class="op">=</span> f<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;p75&#39;</span>)<span class="op">;</span></span>
<span id="cb21-122"><a href="#cb21-122" tabindex="-1"></a>  <span class="kw">var</span> rowDict <span class="op">=</span> {</span>
<span id="cb21-123"><a href="#cb21-123" tabindex="-1"></a>    <span class="dt">c</span><span class="op">:</span> [{<span class="dt">v</span><span class="op">:</span> x}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> median}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> min}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> max}<span class="op">,</span></span>
<span id="cb21-124"><a href="#cb21-124" tabindex="-1"></a>        {<span class="dt">v</span><span class="op">:</span> p25}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> p50}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> p75}]</span>
<span id="cb21-125"><a href="#cb21-125" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb21-126"><a href="#cb21-126" tabindex="-1"></a>  <span class="cf">return</span> rowDict<span class="op">;</span></span>
<span id="cb21-127"><a href="#cb21-127" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb21-128"><a href="#cb21-128" tabindex="-1"></a></span>
<span id="cb21-129"><a href="#cb21-129" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;Rows&#39;</span><span class="op">,</span> rowList)<span class="op">;</span></span>
<span id="cb21-130"><a href="#cb21-130" tabindex="-1"></a></span>
<span id="cb21-131"><a href="#cb21-131" tabindex="-1"></a><span class="co">// We need to convert the server-side rowList object</span></span>
<span id="cb21-132"><a href="#cb21-132" tabindex="-1"></a><span class="co">// to client-side javascript object</span></span>
<span id="cb21-133"><a href="#cb21-133" tabindex="-1"></a><span class="co">// use evaluate()</span></span>
<span id="cb21-134"><a href="#cb21-134" tabindex="-1"></a>rowList<span class="op">.</span><span class="fu">evaluate</span>(<span class="kw">function</span>(rowListClient) {</span>
<span id="cb21-135"><a href="#cb21-135" tabindex="-1"></a>  <span class="kw">var</span> dataTable <span class="op">=</span> {</span>
<span id="cb21-136"><a href="#cb21-136" tabindex="-1"></a>    <span class="dt">cols</span><span class="op">:</span> [</span>
<span id="cb21-137"><a href="#cb21-137" tabindex="-1"></a>      {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;x&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;date&#39;</span>}<span class="op">,</span></span>
<span id="cb21-138"><a href="#cb21-138" tabindex="-1"></a>      {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;median&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;number&#39;</span>}<span class="op">,</span></span>
<span id="cb21-139"><a href="#cb21-139" tabindex="-1"></a>      {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;min&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;number&#39;</span><span class="op">,</span> <span class="dt">role</span><span class="op">:</span> <span class="st">&#39;interval&#39;</span>}<span class="op">,</span></span>
<span id="cb21-140"><a href="#cb21-140" tabindex="-1"></a>      {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;max&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;number&#39;</span><span class="op">,</span> <span class="dt">role</span><span class="op">:</span> <span class="st">&#39;interval&#39;</span>}<span class="op">,</span></span>
<span id="cb21-141"><a href="#cb21-141" tabindex="-1"></a>      {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;firstQuartile&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;number&#39;</span><span class="op">,</span> <span class="dt">role</span><span class="op">:</span> <span class="st">&#39;interval&#39;</span>}<span class="op">,</span></span>
<span id="cb21-142"><a href="#cb21-142" tabindex="-1"></a>      {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;median&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;number&#39;</span><span class="op">,</span> <span class="dt">role</span><span class="op">:</span> <span class="st">&#39;interval&#39;</span>}<span class="op">,</span></span>
<span id="cb21-143"><a href="#cb21-143" tabindex="-1"></a>      {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;thirdQuartile&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span><span class="st">&#39;number&#39;</span><span class="op">,</span> <span class="dt">role</span><span class="op">:</span> <span class="st">&#39;interval&#39;</span>}</span>
<span id="cb21-144"><a href="#cb21-144" tabindex="-1"></a>    ]<span class="op">,</span></span>
<span id="cb21-145"><a href="#cb21-145" tabindex="-1"></a>    <span class="dt">rows</span><span class="op">:</span> rowListClient</span>
<span id="cb21-146"><a href="#cb21-146" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb21-147"><a href="#cb21-147" tabindex="-1"></a></span>
<span id="cb21-148"><a href="#cb21-148" tabindex="-1"></a>  <span class="kw">var</span> options <span class="op">=</span> {</span>
<span id="cb21-149"><a href="#cb21-149" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span><span class="st">&#39;NDVI Time-Series Box Plot&#39;</span><span class="op">,</span></span>
<span id="cb21-150"><a href="#cb21-150" tabindex="-1"></a>    <span class="dt">vAxis</span><span class="op">:</span> {</span>
<span id="cb21-151"><a href="#cb21-151" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;NDVI&#39;</span><span class="op">,</span></span>
<span id="cb21-152"><a href="#cb21-152" tabindex="-1"></a>      <span class="dt">gridlines</span><span class="op">:</span> {</span>
<span id="cb21-153"><a href="#cb21-153" tabindex="-1"></a>        <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;#d9d9d9&#39;</span></span>
<span id="cb21-154"><a href="#cb21-154" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-155"><a href="#cb21-155" tabindex="-1"></a>      <span class="dt">minorGridlines</span><span class="op">:</span> {</span>
<span id="cb21-156"><a href="#cb21-156" tabindex="-1"></a>        <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;transparent&#39;</span></span>
<span id="cb21-157"><a href="#cb21-157" tabindex="-1"></a>      }</span>
<span id="cb21-158"><a href="#cb21-158" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb21-159"><a href="#cb21-159" tabindex="-1"></a>    <span class="dt">hAxis</span><span class="op">:</span> {</span>
<span id="cb21-160"><a href="#cb21-160" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;&#39;</span><span class="op">,</span></span>
<span id="cb21-161"><a href="#cb21-161" tabindex="-1"></a>      <span class="dt">format</span><span class="op">:</span> <span class="st">&#39;YYYY-MMM&#39;</span><span class="op">,</span></span>
<span id="cb21-162"><a href="#cb21-162" tabindex="-1"></a>      <span class="dt">viewWindow</span><span class="op">:</span> {</span>
<span id="cb21-163"><a href="#cb21-163" tabindex="-1"></a>        <span class="dt">min</span><span class="op">:</span> <span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2017</span><span class="op">,</span> <span class="dv">0</span>)<span class="op">,</span></span>
<span id="cb21-164"><a href="#cb21-164" tabindex="-1"></a>        <span class="dt">max</span><span class="op">:</span> <span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2018</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb21-165"><a href="#cb21-165" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-166"><a href="#cb21-166" tabindex="-1"></a>      <span class="dt">gridlines</span><span class="op">:</span> {</span>
<span id="cb21-167"><a href="#cb21-167" tabindex="-1"></a>        <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;#d9d9d9&#39;</span></span>
<span id="cb21-168"><a href="#cb21-168" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-169"><a href="#cb21-169" tabindex="-1"></a>      <span class="dt">minorGridlines</span><span class="op">:</span> {</span>
<span id="cb21-170"><a href="#cb21-170" tabindex="-1"></a>        <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;transparent&#39;</span></span>
<span id="cb21-171"><a href="#cb21-171" tabindex="-1"></a>      }</span>
<span id="cb21-172"><a href="#cb21-172" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb21-173"><a href="#cb21-173" tabindex="-1"></a>    <span class="dt">legend</span><span class="op">:</span> {<span class="dt">position</span><span class="op">:</span> <span class="st">&#39;none&#39;</span>}<span class="op">,</span></span>
<span id="cb21-174"><a href="#cb21-174" tabindex="-1"></a>    <span class="dt">lineWidth</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb21-175"><a href="#cb21-175" tabindex="-1"></a>    <span class="dt">series</span><span class="op">:</span> [{<span class="st">&#39;color&#39;</span><span class="op">:</span> <span class="st">&#39;#D3362D&#39;</span>}]<span class="op">,</span></span>
<span id="cb21-176"><a href="#cb21-176" tabindex="-1"></a>    <span class="dt">interpolateNulls</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb21-177"><a href="#cb21-177" tabindex="-1"></a>    <span class="dt">intervals</span><span class="op">:</span> {</span>
<span id="cb21-178"><a href="#cb21-178" tabindex="-1"></a>      <span class="dt">barWidth</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb21-179"><a href="#cb21-179" tabindex="-1"></a>      <span class="dt">boxWidth</span><span class="op">:</span> <span class="dv">4</span><span class="op">,</span></span>
<span id="cb21-180"><a href="#cb21-180" tabindex="-1"></a>      <span class="dt">lineWidth</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb21-181"><a href="#cb21-181" tabindex="-1"></a>      <span class="dt">style</span><span class="op">:</span> <span class="st">&#39;boxes&#39;</span></span>
<span id="cb21-182"><a href="#cb21-182" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb21-183"><a href="#cb21-183" tabindex="-1"></a>    <span class="dt">interval</span><span class="op">:</span> {</span>
<span id="cb21-184"><a href="#cb21-184" tabindex="-1"></a>      <span class="dt">min</span><span class="op">:</span> {</span>
<span id="cb21-185"><a href="#cb21-185" tabindex="-1"></a>        <span class="dt">style</span><span class="op">:</span> <span class="st">&#39;bars&#39;</span><span class="op">,</span></span>
<span id="cb21-186"><a href="#cb21-186" tabindex="-1"></a>        <span class="dt">fillOpacity</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb21-187"><a href="#cb21-187" tabindex="-1"></a>        <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;#777777&#39;</span></span>
<span id="cb21-188"><a href="#cb21-188" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-189"><a href="#cb21-189" tabindex="-1"></a>      <span class="dt">max</span><span class="op">:</span> {</span>
<span id="cb21-190"><a href="#cb21-190" tabindex="-1"></a>        <span class="dt">style</span><span class="op">:</span> <span class="st">&#39;bars&#39;</span><span class="op">,</span></span>
<span id="cb21-191"><a href="#cb21-191" tabindex="-1"></a>        <span class="dt">fillOpacity</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb21-192"><a href="#cb21-192" tabindex="-1"></a>        <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;#777777&#39;</span></span>
<span id="cb21-193"><a href="#cb21-193" tabindex="-1"></a>      }</span>
<span id="cb21-194"><a href="#cb21-194" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb21-195"><a href="#cb21-195" tabindex="-1"></a>    <span class="dt">chartArea</span><span class="op">:</span> {<span class="dt">left</span><span class="op">:</span><span class="dv">100</span><span class="op">,</span> <span class="dt">right</span><span class="op">:</span><span class="dv">100</span>}</span>
<span id="cb21-196"><a href="#cb21-196" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb21-197"><a href="#cb21-197" tabindex="-1"></a>    </span>
<span id="cb21-198"><a href="#cb21-198" tabindex="-1"></a>  <span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="fu">Chart</span>(dataTable<span class="op">,</span> <span class="st">&#39;LineChart&#39;</span><span class="op">,</span> options)<span class="op">;</span></span>
<span id="cb21-199"><a href="#cb21-199" tabindex="-1"></a>  <span class="fu">print</span>(chart)<span class="op">;</span></span>
<span id="cb21-200"><a href="#cb21-200" tabindex="-1"></a>  })<span class="op">;</span></span></code></pre></div>
<div id="exercise-10" class="section level3">
<h3>Exercise</h3>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3A04-Advanced_Charts%2F02b_Box_Plots_(exercise)"
target="_blank">Open in Code Editor ↗</a></p>
<pre><code>// Exercise

// a) Delete the &#39;geometry&#39; and add a polygon at your chosen location.
// b) Modify the chart options hide the line connecting the bars.
// c) Print the chart.

// Hint: Set the lideWidth to 0.</code></pre>
<div class="figure" style="text-align: center">
<img src="images/gee_charts/box_plot_exercise.png" alt="Exercise 02c" width="75%" />
<p class="caption">
Exercise 02c
</p>
</div>
</div>
</div>
</div>
<div id="exporting-charts" class="section level1">
<h1>Exporting Charts</h1>
<p>The charts produced by Google Earth Engine can be exported in SVG
(Scalable Vector Graphics) format. This is a vector format that
preserves the full-fidelity of the chart and can be converted to an
image format at any resolution. Here are the steps to create a
high-resolution graphic from your chart.</p>
<p>1 Once the chart is rendered in the Code Editor, click the arrow next
to the chart to view it in a new tab.</p>
<p><img src="images/gee_charts/export1.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="2" style="list-style-type: decimal">
<li>Click the <em>Download SVG</em> button.</li>
</ol>
<p><img src="images/gee_charts/export2.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="3" style="list-style-type: decimal">
<li>You can open the resulting SVG in a graphics software and export it
at a chosen resolution from there. You can also use free web-based
tools. Visit <a href="https://www.svgviewer.dev/"
class="uri">https://www.svgviewer.dev/</a> and upload your SVG
file.</li>
</ol>
<p><img src="images/gee_charts/export3.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="4" style="list-style-type: decimal">
<li>Switch to the <em>.png</em> tab. Choose the scale factor. The higher
the number the higher the resolution of the output file. Click
<em>Download .png</em> button.</li>
</ol>
<p><img src="images/gee_charts/export4.png" width="75%" style="display: block; margin: auto;" /></p>
<p>You now have a hi-resolution PNG image of your chart.</p>
</div>
<div id="supplement" class="section level1">
<h1>Supplement</h1>
<p><a
href="https://www.youtube.com/watch?v=wWIDiettodw&amp;list=PLppGmFLhQ1HKyrR75waIq6TfqL0ESlQao&amp;index=26"
target="_blank"><img
src="https://img.youtube.com/vi/wWIDiettodw/mqdefault.jpg"
alt="Start Supplement Videos" /></a></p>
<p><a
href="https://www.youtube.com/watch?v=wWIDiettodw&amp;list=PLppGmFLhQ1HKyrR75waIq6TfqL0ESlQao&amp;index=26"
target="_blank">Start Supplement Videos ↗</a></p>
<div id="dual-y-axis-chart" class="section level2">
<h2>Dual Y-Axis Chart</h2>
<p>When you are plotting 2 series on a chart that have very different
ranges - it makes sense to have 2 separate y-Axes. You can assign the
left axis to one series and right axis to another using the
<code>series.targetAxisIndex</code> option. Here’s an example of
plotting a monthly NDVI vs Rainfall time-series on the same chart.</p>
<div class="figure" style="text-align: center">
<img src="images/gee_charts/dual_y_axis.png" alt="Dual Y-Axis Chart" width="100%" />
<p class="caption">
Dual Y-Axis Chart
</p>
</div>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3ASupplement%2FDual_YAxis_Plots"
target="_blank">Open in Code Editor ↗</a></p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode js"><code class="sourceCode javascript"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co">/**** Start of imports. If edited, may not auto-convert in the playground. ****/</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="kw">var</span> geometry <span class="op">=</span> <span class="co">/* color: #00ff00 */</span>ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Polygon</span>(</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>        [[[<span class="fl">7.937819856526227</span><span class="op">,</span> <span class="fl">10.723387714834615</span>]<span class="op">,</span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>          [<span class="fl">7.938334840657086</span><span class="op">,</span> <span class="fl">10.721922445898615</span>]<span class="op">,</span></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>          [<span class="fl">7.939160961033673</span><span class="op">,</span> <span class="fl">10.722444251117416</span>]<span class="op">,</span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>          [<span class="fl">7.938603061558576</span><span class="op">,</span> <span class="fl">10.723767207790642</span>]]])<span class="op">;</span></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a><span class="co">/***** End of imports. If edited, may not auto-convert in the playground. *****/</span></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a><span class="co">// Charting Rainfall vs NDVI </span></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a><span class="co">// Select a location</span></span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a><span class="kw">var</span> geometry <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Polygon</span>([[</span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a>  [<span class="fl">7.9378</span><span class="op">,</span> <span class="fl">10.7233</span>]<span class="op">,</span></span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a>  [<span class="fl">7.9383</span><span class="op">,</span> <span class="fl">10.7219</span>]<span class="op">,</span></span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a>  [<span class="fl">7.9391</span><span class="op">,</span> <span class="fl">10.7224</span>]<span class="op">,</span></span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a>  [<span class="fl">7.9386</span><span class="op">,</span> <span class="fl">10.7237</span>]</span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a>]])<span class="op">;</span></span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">centerObject</span>(geometry<span class="op">,</span> <span class="dv">16</span>)<span class="op">;</span></span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a></span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a><span class="co">// Select a time period</span></span>
<span id="cb23-20"><a href="#cb23-20" tabindex="-1"></a><span class="kw">var</span> year <span class="op">=</span> <span class="dv">2020</span><span class="op">;</span></span>
<span id="cb23-21"><a href="#cb23-21" tabindex="-1"></a><span class="kw">var</span> startDate <span class="op">=</span> ee<span class="op">.</span><span class="at">Date</span><span class="op">.</span><span class="fu">fromYMD</span>(year<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb23-22"><a href="#cb23-22" tabindex="-1"></a><span class="kw">var</span> endDate <span class="op">=</span> startDate<span class="op">.</span><span class="fu">advance</span>(<span class="dv">1</span><span class="op">,</span> <span class="st">&#39;year&#39;</span>)<span class="op">;</span></span>
<span id="cb23-23"><a href="#cb23-23" tabindex="-1"></a></span>
<span id="cb23-24"><a href="#cb23-24" tabindex="-1"></a><span class="co">// Get NDVI from Sentinel-2</span></span>
<span id="cb23-25"><a href="#cb23-25" tabindex="-1"></a><span class="kw">var</span> s2 <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&#39;COPERNICUS/S2_SR&#39;</span>)<span class="op">;</span></span>
<span id="cb23-26"><a href="#cb23-26" tabindex="-1"></a></span>
<span id="cb23-27"><a href="#cb23-27" tabindex="-1"></a><span class="co">// Function to remove cloud and snow pixels from Sentinel-2 SR image</span></span>
<span id="cb23-28"><a href="#cb23-28" tabindex="-1"></a><span class="kw">function</span> <span class="fu">maskCloudAndShadowsSR</span>(image) {</span>
<span id="cb23-29"><a href="#cb23-29" tabindex="-1"></a>  <span class="kw">var</span> cloudProb <span class="op">=</span> image<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;MSK_CLDPRB&#39;</span>)<span class="op">;</span></span>
<span id="cb23-30"><a href="#cb23-30" tabindex="-1"></a>  <span class="kw">var</span> snowProb <span class="op">=</span> image<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;MSK_SNWPRB&#39;</span>)<span class="op">;</span></span>
<span id="cb23-31"><a href="#cb23-31" tabindex="-1"></a>  <span class="kw">var</span> cloud <span class="op">=</span> cloudProb<span class="op">.</span><span class="fu">lt</span>(<span class="dv">5</span>)<span class="op">;</span></span>
<span id="cb23-32"><a href="#cb23-32" tabindex="-1"></a>  <span class="kw">var</span> snow <span class="op">=</span> snowProb<span class="op">.</span><span class="fu">lt</span>(<span class="dv">5</span>)<span class="op">;</span></span>
<span id="cb23-33"><a href="#cb23-33" tabindex="-1"></a>  <span class="kw">var</span> scl <span class="op">=</span> image<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;SCL&#39;</span>)<span class="op">;</span> </span>
<span id="cb23-34"><a href="#cb23-34" tabindex="-1"></a>  <span class="kw">var</span> shadow <span class="op">=</span> scl<span class="op">.</span><span class="fu">eq</span>(<span class="dv">3</span>)<span class="op">;</span> <span class="co">// 3 = cloud shadow</span></span>
<span id="cb23-35"><a href="#cb23-35" tabindex="-1"></a>  <span class="kw">var</span> cirrus <span class="op">=</span> scl<span class="op">.</span><span class="fu">eq</span>(<span class="dv">10</span>)<span class="op">;</span> <span class="co">// 10 = cirrus</span></span>
<span id="cb23-36"><a href="#cb23-36" tabindex="-1"></a>  <span class="co">// Cloud probability less than 5% or cloud shadow classification</span></span>
<span id="cb23-37"><a href="#cb23-37" tabindex="-1"></a>  <span class="kw">var</span> mask <span class="op">=</span> cloud<span class="op">.</span><span class="fu">and</span>(cirrus<span class="op">.</span><span class="fu">neq</span>(<span class="dv">1</span>))<span class="op">.</span><span class="fu">and</span>(shadow<span class="op">.</span><span class="fu">neq</span>(<span class="dv">1</span>))<span class="op">;</span></span>
<span id="cb23-38"><a href="#cb23-38" tabindex="-1"></a>  <span class="cf">return</span> image<span class="op">.</span><span class="fu">updateMask</span>(mask)<span class="op">;</span></span>
<span id="cb23-39"><a href="#cb23-39" tabindex="-1"></a>}</span>
<span id="cb23-40"><a href="#cb23-40" tabindex="-1"></a></span>
<span id="cb23-41"><a href="#cb23-41" tabindex="-1"></a><span class="kw">var</span> s2Filtered <span class="op">=</span> s2</span>
<span id="cb23-42"><a href="#cb23-42" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">date</span>(startDate<span class="op">,</span> endDate))</span>
<span id="cb23-43"><a href="#cb23-43" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">bounds</span>(geometry))</span>
<span id="cb23-44"><a href="#cb23-44" tabindex="-1"></a>  <span class="op">.</span><span class="fu">map</span>(maskCloudAndShadowsSR)<span class="op">;</span></span>
<span id="cb23-45"><a href="#cb23-45" tabindex="-1"></a>  </span>
<span id="cb23-46"><a href="#cb23-46" tabindex="-1"></a><span class="kw">function</span> <span class="fu">addNDVI</span>(image) {</span>
<span id="cb23-47"><a href="#cb23-47" tabindex="-1"></a>  <span class="kw">var</span> ndvi <span class="op">=</span> image<span class="op">.</span><span class="fu">normalizedDifference</span>([<span class="st">&#39;B8&#39;</span><span class="op">,</span> <span class="st">&#39;B4&#39;</span>])<span class="op">.</span><span class="fu">rename</span>(<span class="st">&#39;ndvi&#39;</span>)<span class="op">;</span></span>
<span id="cb23-48"><a href="#cb23-48" tabindex="-1"></a>  <span class="cf">return</span> image<span class="op">.</span><span class="fu">addBands</span>(ndvi)<span class="op">;</span></span>
<span id="cb23-49"><a href="#cb23-49" tabindex="-1"></a>}</span>
<span id="cb23-50"><a href="#cb23-50" tabindex="-1"></a></span>
<span id="cb23-51"><a href="#cb23-51" tabindex="-1"></a><span class="kw">var</span> withNdvi <span class="op">=</span> s2Filtered<span class="op">.</span><span class="fu">map</span>(addNDVI)<span class="op">;</span></span>
<span id="cb23-52"><a href="#cb23-52" tabindex="-1"></a></span>
<span id="cb23-53"><a href="#cb23-53" tabindex="-1"></a><span class="co">// Get Rainfall from CHIRPS</span></span>
<span id="cb23-54"><a href="#cb23-54" tabindex="-1"></a><span class="kw">var</span> chirps <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&#39;UCSB-CHG/CHIRPS/PENTAD&#39;</span>)<span class="op">;</span></span>
<span id="cb23-55"><a href="#cb23-55" tabindex="-1"></a><span class="kw">var</span> chirpsFiltered <span class="op">=</span> chirps</span>
<span id="cb23-56"><a href="#cb23-56" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">date</span>(startDate<span class="op">,</span> endDate))<span class="op">;</span></span>
<span id="cb23-57"><a href="#cb23-57" tabindex="-1"></a></span>
<span id="cb23-58"><a href="#cb23-58" tabindex="-1"></a><span class="co">// Create a collection of monthly images</span></span>
<span id="cb23-59"><a href="#cb23-59" tabindex="-1"></a><span class="co">// with bands for ndvi and rainfall</span></span>
<span id="cb23-60"><a href="#cb23-60" tabindex="-1"></a><span class="kw">var</span> months <span class="op">=</span> ee<span class="op">.</span><span class="at">List</span><span class="op">.</span><span class="fu">sequence</span>(<span class="dv">1</span><span class="op">,</span> <span class="dv">12</span>)<span class="op">;</span></span>
<span id="cb23-61"><a href="#cb23-61" tabindex="-1"></a></span>
<span id="cb23-62"><a href="#cb23-62" tabindex="-1"></a><span class="kw">var</span> byMonth <span class="op">=</span> months<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(month) {</span>
<span id="cb23-63"><a href="#cb23-63" tabindex="-1"></a>    <span class="co">// Total monthly rainfall</span></span>
<span id="cb23-64"><a href="#cb23-64" tabindex="-1"></a>    <span class="kw">var</span> monthlyRain <span class="op">=</span> chirpsFiltered</span>
<span id="cb23-65"><a href="#cb23-65" tabindex="-1"></a>      <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">calendarRange</span>(year<span class="op">,</span> year<span class="op">,</span> <span class="st">&#39;year&#39;</span>))</span>
<span id="cb23-66"><a href="#cb23-66" tabindex="-1"></a>      <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">calendarRange</span>(month<span class="op">,</span> month<span class="op">,</span> <span class="st">&#39;month&#39;</span>))<span class="op">;</span></span>
<span id="cb23-67"><a href="#cb23-67" tabindex="-1"></a>    <span class="kw">var</span> totalRain <span class="op">=</span> monthlyRain<span class="op">.</span><span class="fu">sum</span>()<span class="op">;</span></span>
<span id="cb23-68"><a href="#cb23-68" tabindex="-1"></a>    <span class="co">// Average NDVI</span></span>
<span id="cb23-69"><a href="#cb23-69" tabindex="-1"></a>    <span class="kw">var</span> monthlyNdvi <span class="op">=</span> withNdvi<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;ndvi&#39;</span>)</span>
<span id="cb23-70"><a href="#cb23-70" tabindex="-1"></a>      <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">calendarRange</span>(year<span class="op">,</span> year<span class="op">,</span> <span class="st">&#39;year&#39;</span>))</span>
<span id="cb23-71"><a href="#cb23-71" tabindex="-1"></a>      <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">calendarRange</span>(month<span class="op">,</span> month<span class="op">,</span> <span class="st">&#39;month&#39;</span>))<span class="op">;</span></span>
<span id="cb23-72"><a href="#cb23-72" tabindex="-1"></a>    <span class="kw">var</span> averageNdvi <span class="op">=</span> monthlyNdvi<span class="op">.</span><span class="fu">mean</span>()<span class="op">;</span></span>
<span id="cb23-73"><a href="#cb23-73" tabindex="-1"></a>  </span>
<span id="cb23-74"><a href="#cb23-74" tabindex="-1"></a>    <span class="cf">return</span> totalRain<span class="op">.</span><span class="fu">addBands</span>(averageNdvi)<span class="op">.</span><span class="fu">set</span>({</span>
<span id="cb23-75"><a href="#cb23-75" tabindex="-1"></a>      <span class="st">&#39;system:time_start&#39;</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Date</span><span class="op">.</span><span class="fu">fromYMD</span>(year<span class="op">,</span> month<span class="op">,</span> <span class="dv">1</span>)<span class="op">.</span><span class="fu">millis</span>()<span class="op">,</span></span>
<span id="cb23-76"><a href="#cb23-76" tabindex="-1"></a>      <span class="st">&#39;year&#39;</span><span class="op">:</span> year<span class="op">,</span></span>
<span id="cb23-77"><a href="#cb23-77" tabindex="-1"></a>      <span class="st">&#39;month&#39;</span><span class="op">:</span> month})</span>
<span id="cb23-78"><a href="#cb23-78" tabindex="-1"></a>})</span>
<span id="cb23-79"><a href="#cb23-79" tabindex="-1"></a><span class="kw">var</span> monthlyCol <span class="op">=</span> ee<span class="op">.</span><span class="at">ImageCollection</span><span class="op">.</span><span class="fu">fromImages</span>(byMonth)<span class="op">;</span></span>
<span id="cb23-80"><a href="#cb23-80" tabindex="-1"></a></span>
<span id="cb23-81"><a href="#cb23-81" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;Monthly Collection with NDVI and Precipitation&#39;</span><span class="op">,</span> monthlyCol)</span>
<span id="cb23-82"><a href="#cb23-82" tabindex="-1"></a></span>
<span id="cb23-83"><a href="#cb23-83" tabindex="-1"></a><span class="co">// We now create a time-series chart</span></span>
<span id="cb23-84"><a href="#cb23-84" tabindex="-1"></a><span class="co">// Since both of our bands have different ranges, </span></span>
<span id="cb23-85"><a href="#cb23-85" tabindex="-1"></a><span class="co">// we will create a chart with dual Y-Axis.</span></span>
<span id="cb23-86"><a href="#cb23-86" tabindex="-1"></a><span class="co">// Learn more at https://developers.google.com/chart/interactive/docs/gallery/columnchart#dual-y-charts</span></span>
<span id="cb23-87"><a href="#cb23-87" tabindex="-1"></a><span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">image</span><span class="op">.</span><span class="fu">series</span>({</span>
<span id="cb23-88"><a href="#cb23-88" tabindex="-1"></a>  <span class="dt">imageCollection</span><span class="op">:</span> monthlyCol<span class="op">,</span></span>
<span id="cb23-89"><a href="#cb23-89" tabindex="-1"></a>  <span class="dt">region</span><span class="op">:</span> geometry<span class="op">,</span></span>
<span id="cb23-90"><a href="#cb23-90" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">mean</span>()<span class="op">,</span></span>
<span id="cb23-91"><a href="#cb23-91" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span></span>
<span id="cb23-92"><a href="#cb23-92" tabindex="-1"></a>})<span class="op">.</span><span class="fu">setChartType</span>(<span class="st">&#39;ColumnChart&#39;</span>)</span>
<span id="cb23-93"><a href="#cb23-93" tabindex="-1"></a>  <span class="op">.</span><span class="fu">setOptions</span>({</span>
<span id="cb23-94"><a href="#cb23-94" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Total Monthly Rainfall vs. Mean Monthly NDVI&#39;</span><span class="op">,</span></span>
<span id="cb23-95"><a href="#cb23-95" tabindex="-1"></a>    <span class="dt">lineWidth</span><span class="op">:</span> <span class="fl">0.5</span><span class="op">,</span></span>
<span id="cb23-96"><a href="#cb23-96" tabindex="-1"></a>    <span class="dt">pointSize</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb23-97"><a href="#cb23-97" tabindex="-1"></a>    <span class="dt">series</span><span class="op">:</span> {</span>
<span id="cb23-98"><a href="#cb23-98" tabindex="-1"></a>      <span class="dv">0</span><span class="op">:</span> {<span class="dt">targetAxisIndex</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;#addd8e&#39;</span>}<span class="op">,</span></span>
<span id="cb23-99"><a href="#cb23-99" tabindex="-1"></a>      <span class="dv">1</span><span class="op">:</span> {<span class="dt">targetAxisIndex</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;#2b8cbe&#39;</span>}<span class="op">,</span> </span>
<span id="cb23-100"><a href="#cb23-100" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb23-101"><a href="#cb23-101" tabindex="-1"></a>    <span class="dt">vAxes</span><span class="op">:</span> {</span>
<span id="cb23-102"><a href="#cb23-102" tabindex="-1"></a>      <span class="dv">0</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">&#39;NDVI&#39;</span><span class="op">,</span> <span class="dt">gridlines</span><span class="op">:</span> {<span class="dt">count</span><span class="op">:</span> <span class="dv">5</span>}<span class="op">,</span> <span class="dt">viewWindow</span><span class="op">:</span> {<span class="dt">min</span><span class="op">:</span><span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span><span class="dv">1</span>}<span class="op">,</span></span>
<span id="cb23-103"><a href="#cb23-103" tabindex="-1"></a>          <span class="dt">titleTextStyle</span><span class="op">:</span> { <span class="dt">bold</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;#addd8e&#39;</span> }}<span class="op">,</span></span>
<span id="cb23-104"><a href="#cb23-104" tabindex="-1"></a>      <span class="dv">1</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Precipitation (mm)&#39;</span><span class="op">,</span> <span class="dt">gridlines</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;none&#39;</span>}<span class="op">,</span></span>
<span id="cb23-105"><a href="#cb23-105" tabindex="-1"></a>          <span class="dt">titleTextStyle</span><span class="op">:</span> { <span class="dt">bold</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;#2b8cbe&#39;</span> }}<span class="op">,</span></span>
<span id="cb23-106"><a href="#cb23-106" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb23-107"><a href="#cb23-107" tabindex="-1"></a>    <span class="dt">hAxis</span><span class="op">:</span> {</span>
<span id="cb23-108"><a href="#cb23-108" tabindex="-1"></a>      <span class="dt">gridlines</span><span class="op">:</span>  {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;none&#39;</span>}</span>
<span id="cb23-109"><a href="#cb23-109" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb23-110"><a href="#cb23-110" tabindex="-1"></a>    <span class="dt">chartArea</span><span class="op">:</span> {<span class="dt">left</span><span class="op">:</span> <span class="dv">100</span><span class="op">,</span> <span class="dt">right</span><span class="op">:</span> <span class="dv">100</span>}</span>
<span id="cb23-111"><a href="#cb23-111" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb23-112"><a href="#cb23-112" tabindex="-1"></a></span>
<span id="cb23-113"><a href="#cb23-113" tabindex="-1"></a><span class="fu">print</span>(chart)<span class="op">;</span></span></code></pre></div>
</div>
<div id="night-time-lights-ntl-trends" class="section level2">
<h2>Night Time Lights (NTL) Trends</h2>
<p>The section on <a href="#time-series-with-trendlines">Time-Series
with Trendlines</a> covered how to add trendlines to the chart. We can
apply this technique on a dataset of annual nighttime lights to see the
effect of COVID19. We plot two series on a plot and display the
trendline for the pre-covid series. This helps show the effect of
COVID19 on the trend of nighttime lights.</p>
<div class="figure" style="text-align: center">
<img src="images/gee_charts/ntl_trend.png" alt="Annual NTL Trend" width="75%" />
<p class="caption">
Annual NTL Trend
</p>
</div>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3ASupplement%2FNight_Time_Lights_Trends"
target="_blank">Open in Code Editor ↗</a></p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode js"><code class="sourceCode javascript"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="co">// Plot Annual Night Time Lights trends</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="co">// Compare the Pre-Covid trend with Post-Covid observations</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a><span class="co">// Use Municipal boundaries from DataMeet</span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a><span class="co">// http://projects.datameet.org/Municipal_Spatial_Data/</span></span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a><span class="kw">var</span> cities <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(<span class="st">&#39;users/ujavalgandhi/public/indian_cities&#39;</span>)<span class="op">;</span></span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a><span class="co">// Select Annual NTL collection</span></span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a><span class="kw">var</span> ntlCol <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&#39;NOAA/VIIRS/DNB/ANNUAL_V21&#39;</span>)</span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a>  <span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;average&#39;</span>)<span class="op">;</span></span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a><span class="kw">var</span> resolution <span class="op">=</span> ee<span class="op">.</span><span class="fu">Image</span>(ntlCol<span class="op">.</span><span class="fu">first</span>())<span class="op">.</span><span class="fu">projection</span>()<span class="op">.</span><span class="fu">nominalScale</span>()<span class="op">;</span></span>
<span id="cb24-13"><a href="#cb24-13" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;Input Resolution (m)&#39;</span><span class="op">,</span> resolution)<span class="op">;</span></span>
<span id="cb24-14"><a href="#cb24-14" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" tabindex="-1"></a><span class="kw">var</span> palette <span class="op">=</span>[<span class="st">&#39;#253494&#39;</span><span class="op">,</span><span class="st">&#39;#2c7fb8&#39;</span><span class="op">,</span><span class="st">&#39;#41b6c4&#39;</span><span class="op">,</span><span class="st">&#39;#a1dab4&#39;</span><span class="op">,</span><span class="st">&#39;#ffffcc&#39;</span> ]<span class="op">;</span></span>
<span id="cb24-16"><a href="#cb24-16" tabindex="-1"></a><span class="kw">var</span> ntlVis <span class="op">=</span> {<span class="dt">min</span><span class="op">:</span><span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">63</span><span class="op">,</span>  <span class="dt">palette</span><span class="op">:</span> palette}<span class="op">;</span></span>
<span id="cb24-17"><a href="#cb24-17" tabindex="-1"></a></span>
<span id="cb24-18"><a href="#cb24-18" tabindex="-1"></a><span class="co">// Visualize the datasets</span></span>
<span id="cb24-19"><a href="#cb24-19" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">centerObject</span>(cities<span class="op">.</span><span class="fu">first</span>())<span class="op">;</span></span>
<span id="cb24-20"><a href="#cb24-20" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(ntlCol<span class="op">.</span><span class="fu">first</span>()<span class="op">,</span> ntlVis<span class="op">,</span> <span class="st">&#39;NTL Image&#39;</span>)<span class="op">;</span></span>
<span id="cb24-21"><a href="#cb24-21" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(cities<span class="op">,</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;red&#39;</span>}<span class="op">,</span> <span class="st">&#39;Cities&#39;</span>)<span class="op">;</span></span>
<span id="cb24-22"><a href="#cb24-22" tabindex="-1"></a></span>
<span id="cb24-23"><a href="#cb24-23" tabindex="-1"></a><span class="co">// Define dates for pre-Covid and post-Covid</span></span>
<span id="cb24-24"><a href="#cb24-24" tabindex="-1"></a><span class="kw">var</span> preCovidStartDate <span class="op">=</span> ee<span class="op">.</span><span class="at">Date</span><span class="op">.</span><span class="fu">fromYMD</span>(<span class="dv">2012</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb24-25"><a href="#cb24-25" tabindex="-1"></a><span class="kw">var</span> preCovidEndDate <span class="op">=</span> ee<span class="op">.</span><span class="at">Date</span><span class="op">.</span><span class="fu">fromYMD</span>(<span class="dv">2020</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb24-26"><a href="#cb24-26" tabindex="-1"></a></span>
<span id="cb24-27"><a href="#cb24-27" tabindex="-1"></a><span class="co">// Start the post-covid plot from 2019 for data continuity</span></span>
<span id="cb24-28"><a href="#cb24-28" tabindex="-1"></a><span class="kw">var</span> postCovidStartDate <span class="op">=</span> ee<span class="op">.</span><span class="at">Date</span><span class="op">.</span><span class="fu">fromYMD</span>(<span class="dv">2019</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb24-29"><a href="#cb24-29" tabindex="-1"></a><span class="kw">var</span> postCovidEndDate <span class="op">=</span> ee<span class="op">.</span><span class="at">Date</span><span class="op">.</span><span class="fu">fromYMD</span>(<span class="dv">2023</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb24-30"><a href="#cb24-30" tabindex="-1"></a></span>
<span id="cb24-31"><a href="#cb24-31" tabindex="-1"></a><span class="kw">var</span> preFiltered <span class="op">=</span> ntlCol</span>
<span id="cb24-32"><a href="#cb24-32" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">date</span>(preCovidStartDate<span class="op">,</span> preCovidEndDate))<span class="op">;</span></span>
<span id="cb24-33"><a href="#cb24-33" tabindex="-1"></a>  </span>
<span id="cb24-34"><a href="#cb24-34" tabindex="-1"></a><span class="kw">var</span> postFiltered <span class="op">=</span> ntlCol</span>
<span id="cb24-35"><a href="#cb24-35" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">date</span>(postCovidStartDate<span class="op">,</span> postCovidEndDate))<span class="op">;</span></span>
<span id="cb24-36"><a href="#cb24-36" tabindex="-1"></a></span>
<span id="cb24-37"><a href="#cb24-37" tabindex="-1"></a><span class="co">// Rename bands </span></span>
<span id="cb24-38"><a href="#cb24-38" tabindex="-1"></a><span class="kw">var</span> preCovid <span class="op">=</span> preFiltered<span class="op">.</span><span class="fu">select</span>([<span class="st">&#39;average&#39;</span>]<span class="op">,</span> [<span class="st">&#39;pre_covid&#39;</span>])<span class="op">;</span></span>
<span id="cb24-39"><a href="#cb24-39" tabindex="-1"></a><span class="kw">var</span> postCovid <span class="op">=</span> postFiltered<span class="op">.</span><span class="fu">select</span>([<span class="st">&#39;average&#39;</span>]<span class="op">,</span> [<span class="st">&#39;post_covid&#39;</span>])<span class="op">;</span></span>
<span id="cb24-40"><a href="#cb24-40" tabindex="-1"></a></span>
<span id="cb24-41"><a href="#cb24-41" tabindex="-1"></a><span class="co">// Merge collections</span></span>
<span id="cb24-42"><a href="#cb24-42" tabindex="-1"></a><span class="kw">var</span> collection <span class="op">=</span> preCovid<span class="op">.</span><span class="fu">merge</span>(postCovid)<span class="op">;</span></span>
<span id="cb24-43"><a href="#cb24-43" tabindex="-1"></a></span>
<span id="cb24-44"><a href="#cb24-44" tabindex="-1"></a><span class="co">// Write a function to create a chart from the given city name</span></span>
<span id="cb24-45"><a href="#cb24-45" tabindex="-1"></a><span class="kw">var</span> createChart <span class="op">=</span> <span class="kw">function</span>(cityName) {</span>
<span id="cb24-46"><a href="#cb24-46" tabindex="-1"></a>  <span class="fu">print</span>(cityName)<span class="op">;</span></span>
<span id="cb24-47"><a href="#cb24-47" tabindex="-1"></a>  <span class="kw">var</span> geometry <span class="op">=</span> cities<span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">eq</span>(<span class="st">&#39;Name&#39;</span><span class="op">,</span> cityName))<span class="op">.</span><span class="fu">geometry</span>()<span class="op">;</span></span>
<span id="cb24-48"><a href="#cb24-48" tabindex="-1"></a></span>
<span id="cb24-49"><a href="#cb24-49" tabindex="-1"></a>  <span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">image</span><span class="op">.</span><span class="fu">series</span>({</span>
<span id="cb24-50"><a href="#cb24-50" tabindex="-1"></a>    <span class="dt">imageCollection</span><span class="op">:</span> collection<span class="op">,</span></span>
<span id="cb24-51"><a href="#cb24-51" tabindex="-1"></a>    <span class="dt">region</span><span class="op">:</span> geometry<span class="op">,</span></span>
<span id="cb24-52"><a href="#cb24-52" tabindex="-1"></a>    <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">mean</span>()<span class="op">,</span></span>
<span id="cb24-53"><a href="#cb24-53" tabindex="-1"></a>    <span class="dt">scale</span><span class="op">:</span> resolution<span class="op">,</span></span>
<span id="cb24-54"><a href="#cb24-54" tabindex="-1"></a>  })</span>
<span id="cb24-55"><a href="#cb24-55" tabindex="-1"></a>  <span class="op">.</span><span class="fu">setOptions</span>({</span>
<span id="cb24-56"><a href="#cb24-56" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;VIIRS NTL Time Series for &#39;</span> <span class="op">+</span> cityName<span class="op">,</span></span>
<span id="cb24-57"><a href="#cb24-57" tabindex="-1"></a>    <span class="dt">pointSize</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb24-58"><a href="#cb24-58" tabindex="-1"></a>    <span class="dt">lineWidth</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb24-59"><a href="#cb24-59" tabindex="-1"></a>    <span class="dt">vAxis</span><span class="op">:</span> {</span>
<span id="cb24-60"><a href="#cb24-60" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Average Nighttime Lights&#39;</span><span class="op">,</span></span>
<span id="cb24-61"><a href="#cb24-61" tabindex="-1"></a>      <span class="dt">viewWindow</span><span class="op">:</span> {<span class="dt">min</span><span class="op">:</span><span class="dv">0</span>}<span class="op">,</span></span>
<span id="cb24-62"><a href="#cb24-62" tabindex="-1"></a>      <span class="dt">gridlines</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;#c7beb5&#39;</span>}</span>
<span id="cb24-63"><a href="#cb24-63" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb24-64"><a href="#cb24-64" tabindex="-1"></a>    <span class="dt">hAxis</span><span class="op">:</span> {</span>
<span id="cb24-65"><a href="#cb24-65" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;&#39;</span><span class="op">,</span> </span>
<span id="cb24-66"><a href="#cb24-66" tabindex="-1"></a>      <span class="dt">format</span><span class="op">:</span> <span class="st">&#39;YYYY&#39;</span><span class="op">,</span></span>
<span id="cb24-67"><a href="#cb24-67" tabindex="-1"></a>      <span class="dt">ticks</span><span class="op">:</span> [</span>
<span id="cb24-68"><a href="#cb24-68" tabindex="-1"></a>        <span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2013</span><span class="op">,</span><span class="dv">0</span>)<span class="op">,</span> <span class="co">// month indexing starts from 0</span></span>
<span id="cb24-69"><a href="#cb24-69" tabindex="-1"></a>        <span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2015</span><span class="op">,</span><span class="dv">0</span>)<span class="op">,</span></span>
<span id="cb24-70"><a href="#cb24-70" tabindex="-1"></a>        <span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2017</span><span class="op">,</span><span class="dv">0</span>)<span class="op">,</span></span>
<span id="cb24-71"><a href="#cb24-71" tabindex="-1"></a>        <span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2019</span><span class="op">,</span><span class="dv">0</span>)<span class="op">,</span></span>
<span id="cb24-72"><a href="#cb24-72" tabindex="-1"></a>        <span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2021</span><span class="op">,</span><span class="dv">0</span>)<span class="op">,</span></span>
<span id="cb24-73"><a href="#cb24-73" tabindex="-1"></a>        ]<span class="op">,</span></span>
<span id="cb24-74"><a href="#cb24-74" tabindex="-1"></a>      <span class="dt">gridlines</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;#c7beb5&#39;</span>}</span>
<span id="cb24-75"><a href="#cb24-75" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb24-76"><a href="#cb24-76" tabindex="-1"></a>    <span class="dt">series</span><span class="op">:</span> {</span>
<span id="cb24-77"><a href="#cb24-77" tabindex="-1"></a>      <span class="dv">0</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;#2166ac&#39;</span><span class="op">,</span> <span class="dt">visibleInLegend</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="dt">labelInLegend</span><span class="op">:</span> <span class="st">&#39;Actual&#39;</span>}<span class="op">,</span></span>
<span id="cb24-78"><a href="#cb24-78" tabindex="-1"></a>      <span class="dv">1</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;#2166ac&#39;</span><span class="op">,</span> <span class="dt">visibleInLegend</span><span class="op">:</span> <span class="kw">false</span>}<span class="op">,</span> </span>
<span id="cb24-79"><a href="#cb24-79" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb24-80"><a href="#cb24-80" tabindex="-1"></a>    <span class="dt">trendlines</span><span class="op">:</span> {</span>
<span id="cb24-81"><a href="#cb24-81" tabindex="-1"></a>      <span class="dv">1</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;red&#39;</span><span class="op">,</span> <span class="dt">pointSize</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">lineWidth</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb24-82"><a href="#cb24-82" tabindex="-1"></a>        <span class="dt">labelInLegend</span><span class="op">:</span> <span class="st">&#39;Pre-Covid Trend&#39;</span><span class="op">,</span> <span class="dt">visibleInLegend</span><span class="op">:</span> <span class="kw">true</span>}</span>
<span id="cb24-83"><a href="#cb24-83" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb24-84"><a href="#cb24-84" tabindex="-1"></a>    <span class="dt">legend</span><span class="op">:</span> {</span>
<span id="cb24-85"><a href="#cb24-85" tabindex="-1"></a>      <span class="dt">position</span><span class="op">:</span> <span class="st">&#39;top&#39;</span></span>
<span id="cb24-86"><a href="#cb24-86" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb24-87"><a href="#cb24-87" tabindex="-1"></a>    <span class="dt">backgroundColor</span><span class="op">:</span> <span class="st">&#39;#fef3e7&#39;</span></span>
<span id="cb24-88"><a href="#cb24-88" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb24-89"><a href="#cb24-89" tabindex="-1"></a>  <span class="cf">return</span> chart<span class="op">;</span></span>
<span id="cb24-90"><a href="#cb24-90" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb24-91"><a href="#cb24-91" tabindex="-1"></a></span>
<span id="cb24-92"><a href="#cb24-92" tabindex="-1"></a><span class="co">// We get a list of city names</span></span>
<span id="cb24-93"><a href="#cb24-93" tabindex="-1"></a><span class="kw">var</span> cityNames <span class="op">=</span> cities<span class="op">.</span><span class="fu">aggregate_array</span>(<span class="st">&#39;Name&#39;</span>)<span class="op">;</span></span>
<span id="cb24-94"><a href="#cb24-94" tabindex="-1"></a><span class="fu">print</span>(cityNames)<span class="op">;</span></span>
<span id="cb24-95"><a href="#cb24-95" tabindex="-1"></a></span>
<span id="cb24-96"><a href="#cb24-96" tabindex="-1"></a><span class="co">// Call the function for each city name to create the chart</span></span>
<span id="cb24-97"><a href="#cb24-97" tabindex="-1"></a>cityNames<span class="op">.</span><span class="fu">evaluate</span>(<span class="kw">function</span>(cityNames) {</span>
<span id="cb24-98"><a href="#cb24-98" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> cityNames<span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb24-99"><a href="#cb24-99" tabindex="-1"></a>    <span class="kw">var</span> chart <span class="op">=</span> <span class="fu">createChart</span>(cityNames[i])<span class="op">;</span></span>
<span id="cb24-100"><a href="#cb24-100" tabindex="-1"></a>    <span class="fu">print</span>(chart)<span class="op">;</span></span>
<span id="cb24-101"><a href="#cb24-101" tabindex="-1"></a>  }</span>
<span id="cb24-102"><a href="#cb24-102" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
</div>
<div id="population-time-series" class="section level2">
<h2>Population Time Series</h2>
<p>Earth Engine makes it very easy to plot variables over time and
compare trends of different regions. Here we take the LandScan
population dataset and compare the population of two countries over
time.</p>
<div class="figure" style="text-align: center">
<img src="images/gee_charts/population_time_series.png" alt="Population Time-Series" width="75%" />
<p class="caption">
Population Time-Series
</p>
</div>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3ASupplement%2FPopulation_TimeSeries_Chart"
target="_blank">Open in Code Editor ↗</a></p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode js"><code class="sourceCode javascript"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="co">// Plot a Population Time-Series</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a><span class="co">// Using GeoBoundries admin boundaries</span></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a><span class="kw">var</span> admin0 <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(<span class="st">&quot;projects/sat-io/open-datasets/geoboundaries/CGAZ_ADM0&quot;</span>)<span class="op">;</span></span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a><span class="kw">var</span> admin1 <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(<span class="st">&quot;projects/sat-io/open-datasets/geoboundaries/CGAZ_ADM1&quot;</span>)<span class="op">;</span></span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a><span class="kw">var</span> admin2 <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(<span class="st">&quot;projects/sat-io/open-datasets/geoboundaries/CGAZ_ADM2&quot;</span>)<span class="op">;</span></span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(admin0)</span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a><span class="co">// Let&#39;s select 2 Admin0 regions to compare</span></span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a><span class="kw">var</span> region1 <span class="op">=</span> <span class="st">&#39;India&#39;</span><span class="op">;</span></span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a><span class="kw">var</span> region2 <span class="op">=</span> <span class="st">&#39;People</span><span class="sc">\&#39;</span><span class="st">s Republic of China&#39;</span><span class="op">;</span> </span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a><span class="kw">var</span> selectedRegions <span class="op">=</span> admin0<span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">inList</span>(<span class="st">&#39;shapeName&#39;</span><span class="op">,</span> [region1<span class="op">,</span> region2]))<span class="op">;</span></span>
<span id="cb25-14"><a href="#cb25-14" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;Filtered Admin0 collection&#39;</span><span class="op">,</span> selectedRegions)<span class="op">;</span></span>
<span id="cb25-15"><a href="#cb25-15" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" tabindex="-1"></a><span class="co">// We pick Landscan population dataset</span></span>
<span id="cb25-17"><a href="#cb25-17" tabindex="-1"></a><span class="kw">var</span> landscan <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&quot;projects/sat-io/open-datasets/ORNL/LANDSCAN_GLOBAL&quot;</span>)<span class="op">;</span></span>
<span id="cb25-18"><a href="#cb25-18" tabindex="-1"></a><span class="kw">var</span> band <span class="op">=</span> <span class="st">&#39;b1&#39;</span><span class="op">;</span></span>
<span id="cb25-19"><a href="#cb25-19" tabindex="-1"></a></span>
<span id="cb25-20"><a href="#cb25-20" tabindex="-1"></a><span class="kw">var</span> startYear <span class="op">=</span> <span class="dv">2001</span><span class="op">;</span></span>
<span id="cb25-21"><a href="#cb25-21" tabindex="-1"></a><span class="kw">var</span> endYear <span class="op">=</span> <span class="dv">2023</span><span class="op">;</span></span>
<span id="cb25-22"><a href="#cb25-22" tabindex="-1"></a></span>
<span id="cb25-23"><a href="#cb25-23" tabindex="-1"></a><span class="kw">var</span> startDate <span class="op">=</span> ee<span class="op">.</span><span class="at">Date</span><span class="op">.</span><span class="fu">fromYMD</span>(startYear<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb25-24"><a href="#cb25-24" tabindex="-1"></a><span class="kw">var</span> endDate <span class="op">=</span> ee<span class="op">.</span><span class="at">Date</span><span class="op">.</span><span class="fu">fromYMD</span>(endYear <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb25-25"><a href="#cb25-25" tabindex="-1"></a></span>
<span id="cb25-26"><a href="#cb25-26" tabindex="-1"></a><span class="kw">var</span> populationFiltered <span class="op">=</span> landscan</span>
<span id="cb25-27"><a href="#cb25-27" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">date</span>(startDate<span class="op">,</span> endDate))</span>
<span id="cb25-28"><a href="#cb25-28" tabindex="-1"></a>  <span class="op">.</span><span class="fu">select</span>(band)<span class="op">;</span></span>
<span id="cb25-29"><a href="#cb25-29" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;Filtered Population Collection&#39;</span><span class="op">,</span> populationFiltered)<span class="op">;</span></span>
<span id="cb25-30"><a href="#cb25-30" tabindex="-1"></a></span>
<span id="cb25-31"><a href="#cb25-31" tabindex="-1"></a><span class="co">// Extract the resolution of the population dataset</span></span>
<span id="cb25-32"><a href="#cb25-32" tabindex="-1"></a><span class="kw">var</span> projection <span class="op">=</span> populationFiltered<span class="op">.</span><span class="fu">first</span>()<span class="op">.</span><span class="fu">projection</span>()<span class="op">;</span></span>
<span id="cb25-33"><a href="#cb25-33" tabindex="-1"></a><span class="kw">var</span> resolution <span class="op">=</span> projection<span class="op">.</span><span class="fu">nominalScale</span>()<span class="op">;</span></span>
<span id="cb25-34"><a href="#cb25-34" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;Population Data Resolution&#39;</span><span class="op">,</span> resolution)<span class="op">;</span></span>
<span id="cb25-35"><a href="#cb25-35" tabindex="-1"></a></span>
<span id="cb25-36"><a href="#cb25-36" tabindex="-1"></a><span class="co">// Create a time-series chart comparing the population</span></span>
<span id="cb25-37"><a href="#cb25-37" tabindex="-1"></a><span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">image</span><span class="op">.</span><span class="fu">seriesByRegion</span>({</span>
<span id="cb25-38"><a href="#cb25-38" tabindex="-1"></a>  <span class="dt">imageCollection</span><span class="op">:</span> populationFiltered<span class="op">,</span></span>
<span id="cb25-39"><a href="#cb25-39" tabindex="-1"></a>  <span class="dt">regions</span><span class="op">:</span> selectedRegions<span class="op">,</span></span>
<span id="cb25-40"><a href="#cb25-40" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">sum</span>()<span class="op">,</span></span>
<span id="cb25-41"><a href="#cb25-41" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> resolution<span class="op">,</span></span>
<span id="cb25-42"><a href="#cb25-42" tabindex="-1"></a>  <span class="dt">seriesProperty</span><span class="op">:</span> <span class="st">&#39;shapeName&#39;</span></span>
<span id="cb25-43"><a href="#cb25-43" tabindex="-1"></a>})<span class="op">.</span><span class="fu">setChartType</span>(<span class="st">&#39;ColumnChart&#39;</span>)</span>
<span id="cb25-44"><a href="#cb25-44" tabindex="-1"></a>  <span class="op">.</span><span class="fu">setOptions</span>({</span>
<span id="cb25-45"><a href="#cb25-45" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Population Time Series (LandScan Global)&#39;</span><span class="op">,</span></span>
<span id="cb25-46"><a href="#cb25-46" tabindex="-1"></a>    <span class="dt">vAxis</span><span class="op">:</span> {</span>
<span id="cb25-47"><a href="#cb25-47" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Population&#39;</span><span class="op">,</span> </span>
<span id="cb25-48"><a href="#cb25-48" tabindex="-1"></a>      <span class="co">// Set viewWindow so Y-axis starts from 0</span></span>
<span id="cb25-49"><a href="#cb25-49" tabindex="-1"></a>      <span class="dt">viewWindow</span><span class="op">:</span> {</span>
<span id="cb25-50"><a href="#cb25-50" tabindex="-1"></a>        <span class="dt">min</span><span class="op">:</span> <span class="dv">0</span></span>
<span id="cb25-51"><a href="#cb25-51" tabindex="-1"></a>      }</span>
<span id="cb25-52"><a href="#cb25-52" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb25-53"><a href="#cb25-53" tabindex="-1"></a>    <span class="dt">hAxis</span><span class="op">:</span> {</span>
<span id="cb25-54"><a href="#cb25-54" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;&#39;</span><span class="op">,</span></span>
<span id="cb25-55"><a href="#cb25-55" tabindex="-1"></a>      <span class="dt">format</span><span class="op">:</span> <span class="st">&#39;YYYY&#39;</span><span class="op">,</span></span>
<span id="cb25-56"><a href="#cb25-56" tabindex="-1"></a>      <span class="dt">gridlines</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;transparent&#39;</span>}</span>
<span id="cb25-57"><a href="#cb25-57" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb25-58"><a href="#cb25-58" tabindex="-1"></a>    <span class="dt">legend</span><span class="op">:</span> {</span>
<span id="cb25-59"><a href="#cb25-59" tabindex="-1"></a>      <span class="dt">position</span><span class="op">:</span> <span class="st">&#39;bottom&#39;</span></span>
<span id="cb25-60"><a href="#cb25-60" tabindex="-1"></a>    }</span>
<span id="cb25-61"><a href="#cb25-61" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb25-62"><a href="#cb25-62" tabindex="-1"></a>  </span>
<span id="cb25-63"><a href="#cb25-63" tabindex="-1"></a><span class="fu">print</span>(chart)<span class="op">;</span></span></code></pre></div>
</div>
<div id="daily-time-series-chart" class="section level2">
<h2>Daily Time Series Chart</h2>
<p>This example shows how to work with Sentinel-5p dataset to aggregate
and plot a daily time-series of atmospheric concentrations. Many times
when plotting a daily time-series, you would see an shift between the
grid labels and the data points. This is because all the GEE datasets
have the timestamps in UTC - while the charts are created using your
browser’s timezone. The offset you see if due to the difference between
your timezone and UTC. To avoid this - you can specify a timezone when
working with dates in GEE as shown here.</p>
<p>Below is the list of new styling options applied to the time-series
chart:</p>
<ul>
<li><code>slantedText</code> and <code>slantedTextAngle</code>: Apply a
rotation the axis labels</li>
<li><code>gridlines.units</code>: Specify a date format for the tick
labels</li>
</ul>
<div class="figure" style="text-align: center">
<img src="images/gee_charts/no2_time_series.png" alt="NO2 Daily Time-Series" width="75%" />
<p class="caption">
NO2 Daily Time-Series
</p>
</div>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3ASupplement%2FDaily_Time_Series_Chart"
target="_blank">Open in Code Editor ↗</a></p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode js"><code class="sourceCode javascript"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="co">// Example script showing how to use Sentinel-5p</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="co">// data and create a daily time-series of</span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a><span class="co">// atmospheric concentrations for a chosen variable</span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a><span class="co">// over a region.</span></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a><span class="co">// Choose the location</span></span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a><span class="kw">var</span> geometry <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Point</span>([<span class="fl">77.4294</span><span class="op">,</span> <span class="fl">13.0708</span>])<span class="op">;</span></span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a><span class="co">// Choose the collection</span></span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a><span class="kw">var</span> NO2 <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&#39;COPERNICUS/S5P/NRTI/L3_NO2&#39;</span>)<span class="op">;</span></span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a><span class="co">// Choose the start and end dates</span></span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a></span>
<span id="cb26-14"><a href="#cb26-14" tabindex="-1"></a><span class="co">// Default timezone for the dates is Earth Engine is UTC.</span></span>
<span id="cb26-15"><a href="#cb26-15" tabindex="-1"></a><span class="co">// Charts are created with your local timezone.</span></span>
<span id="cb26-16"><a href="#cb26-16" tabindex="-1"></a></span>
<span id="cb26-17"><a href="#cb26-17" tabindex="-1"></a><span class="co">// For hourly or daily time-series, it is important to make</span></span>
<span id="cb26-18"><a href="#cb26-18" tabindex="-1"></a><span class="co">// sure the timezone for dates matches your browser timezone.</span></span>
<span id="cb26-19"><a href="#cb26-19" tabindex="-1"></a><span class="co">// otherwise you will see the data points shifted in the chart.</span></span>
<span id="cb26-20"><a href="#cb26-20" tabindex="-1"></a></span>
<span id="cb26-21"><a href="#cb26-21" tabindex="-1"></a><span class="co">// You can specify your local timezone as IANA zone id</span></span>
<span id="cb26-22"><a href="#cb26-22" tabindex="-1"></a><span class="co">// https://en.wikipedia.org/wiki/List_of_tz_database_time_zones</span></span>
<span id="cb26-23"><a href="#cb26-23" tabindex="-1"></a></span>
<span id="cb26-24"><a href="#cb26-24" tabindex="-1"></a><span class="co">// Here we specify the dates in timezone for India</span></span>
<span id="cb26-25"><a href="#cb26-25" tabindex="-1"></a><span class="kw">var</span> tz <span class="op">=</span> <span class="st">&#39;Asia/Kolkata&#39;</span><span class="op">;</span></span>
<span id="cb26-26"><a href="#cb26-26" tabindex="-1"></a><span class="kw">var</span> startDate <span class="op">=</span> ee<span class="op">.</span><span class="at">Date</span><span class="op">.</span><span class="fu">fromYMD</span>(<span class="dv">2022</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> tz)<span class="op">;</span></span>
<span id="cb26-27"><a href="#cb26-27" tabindex="-1"></a><span class="kw">var</span> endDate <span class="op">=</span> ee<span class="op">.</span><span class="at">Date</span><span class="op">.</span><span class="fu">fromYMD</span>(<span class="dv">2022</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> tz)<span class="op">;</span></span>
<span id="cb26-28"><a href="#cb26-28" tabindex="-1"></a></span>
<span id="cb26-29"><a href="#cb26-29" tabindex="-1"></a><span class="kw">var</span> NO2Filtered <span class="op">=</span> NO2</span>
<span id="cb26-30"><a href="#cb26-30" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">date</span>(startDate<span class="op">,</span> endDate))</span>
<span id="cb26-31"><a href="#cb26-31" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">bounds</span>(geometry))</span>
<span id="cb26-32"><a href="#cb26-32" tabindex="-1"></a>  <span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;tropospheric_NO2_column_number_density&#39;</span>)<span class="op">;</span></span>
<span id="cb26-33"><a href="#cb26-33" tabindex="-1"></a>  </span>
<span id="cb26-34"><a href="#cb26-34" tabindex="-1"></a><span class="co">// S5P captures multiple images in a single day</span></span>
<span id="cb26-35"><a href="#cb26-35" tabindex="-1"></a><span class="co">// Aggregate the collection to daily images</span></span>
<span id="cb26-36"><a href="#cb26-36" tabindex="-1"></a></span>
<span id="cb26-37"><a href="#cb26-37" tabindex="-1"></a><span class="co">// Get a list of number of days</span></span>
<span id="cb26-38"><a href="#cb26-38" tabindex="-1"></a><span class="kw">var</span> days <span class="op">=</span> endDate<span class="op">.</span><span class="fu">difference</span>(startDate<span class="op">,</span> <span class="st">&#39;day&#39;</span>)<span class="op">;</span></span>
<span id="cb26-39"><a href="#cb26-39" tabindex="-1"></a><span class="kw">var</span> daysList <span class="op">=</span> ee<span class="op">.</span><span class="at">List</span><span class="op">.</span><span class="fu">sequence</span>(<span class="dv">0</span><span class="op">,</span> days)<span class="op">;</span></span>
<span id="cb26-40"><a href="#cb26-40" tabindex="-1"></a></span>
<span id="cb26-41"><a href="#cb26-41" tabindex="-1"></a><span class="kw">var</span> result <span class="op">=</span> daysList<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(day) {</span>
<span id="cb26-42"><a href="#cb26-42" tabindex="-1"></a>  <span class="kw">var</span> dayStart <span class="op">=</span> startDate<span class="op">.</span><span class="fu">advance</span>(day<span class="op">,</span> <span class="st">&#39;day&#39;</span><span class="op">,</span> tz)<span class="op">;</span></span>
<span id="cb26-43"><a href="#cb26-43" tabindex="-1"></a>  <span class="kw">var</span> dayEnd <span class="op">=</span> dayStart<span class="op">.</span><span class="fu">advance</span>(<span class="dv">1</span><span class="op">,</span> <span class="st">&#39;day&#39;</span><span class="op">,</span> tz)<span class="op">;</span></span>
<span id="cb26-44"><a href="#cb26-44" tabindex="-1"></a>  <span class="kw">var</span> dayFiltered <span class="op">=</span> NO2Filtered</span>
<span id="cb26-45"><a href="#cb26-45" tabindex="-1"></a>    <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">date</span>(dayStart<span class="op">,</span> dayEnd))<span class="op">;</span></span>
<span id="cb26-46"><a href="#cb26-46" tabindex="-1"></a>  </span>
<span id="cb26-47"><a href="#cb26-47" tabindex="-1"></a>  <span class="kw">var</span> dayMeanImage <span class="op">=</span> dayFiltered<span class="op">.</span><span class="fu">mean</span>()<span class="op">.</span><span class="fu">rename</span>(<span class="st">&#39;no2&#39;</span>)<span class="op">;</span></span>
<span id="cb26-48"><a href="#cb26-48" tabindex="-1"></a>  <span class="co">// Extract the spatial mean over the region</span></span>
<span id="cb26-49"><a href="#cb26-49" tabindex="-1"></a>  <span class="co">// Specify maxPixels and tileScale to enable</span></span>
<span id="cb26-50"><a href="#cb26-50" tabindex="-1"></a>  <span class="co">// computation over large region</span></span>
<span id="cb26-51"><a href="#cb26-51" tabindex="-1"></a>  <span class="kw">var</span> stats <span class="op">=</span> dayMeanImage<span class="op">.</span><span class="fu">reduceRegion</span>({</span>
<span id="cb26-52"><a href="#cb26-52" tabindex="-1"></a>    <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">mean</span>()<span class="op">,</span></span>
<span id="cb26-53"><a href="#cb26-53" tabindex="-1"></a>    <span class="dt">geometry</span><span class="op">:</span> geometry<span class="op">,</span></span>
<span id="cb26-54"><a href="#cb26-54" tabindex="-1"></a>    <span class="dt">scale</span><span class="op">:</span> <span class="fl">1113.2</span><span class="op">,</span></span>
<span id="cb26-55"><a href="#cb26-55" tabindex="-1"></a>    <span class="dt">maxPixels</span><span class="op">:</span> <span class="fl">1e10</span><span class="op">,</span></span>
<span id="cb26-56"><a href="#cb26-56" tabindex="-1"></a>    <span class="dt">tileScale</span><span class="op">:</span> <span class="dv">16</span></span>
<span id="cb26-57"><a href="#cb26-57" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb26-58"><a href="#cb26-58" tabindex="-1"></a>  <span class="co">// Some time periods have no matching images</span></span>
<span id="cb26-59"><a href="#cb26-59" tabindex="-1"></a>  <span class="co">// or they have nodata values</span></span>
<span id="cb26-60"><a href="#cb26-60" tabindex="-1"></a>  <span class="co">// We need to handle both these cases and </span></span>
<span id="cb26-61"><a href="#cb26-61" tabindex="-1"></a>  <span class="co">// set a nodata value of -9999</span></span>
<span id="cb26-62"><a href="#cb26-62" tabindex="-1"></a>  <span class="kw">var</span> dayMeanNO2 <span class="op">=</span> ee<span class="op">.</span><span class="fu">List</span>([stats<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;no2&#39;</span><span class="op">,</span> <span class="op">-</span><span class="dv">9999</span>)<span class="op">,</span> <span class="op">-</span><span class="dv">9999</span>])</span>
<span id="cb26-63"><a href="#cb26-63" tabindex="-1"></a>      <span class="op">.</span><span class="fu">reduce</span>(ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">firstNonNull</span>())</span>
<span id="cb26-64"><a href="#cb26-64" tabindex="-1"></a>  <span class="co">// Create a feature with the extracted value and date as properties</span></span>
<span id="cb26-65"><a href="#cb26-65" tabindex="-1"></a>  <span class="kw">var</span> f <span class="op">=</span> ee<span class="op">.</span><span class="fu">Feature</span>(geometry<span class="op">,</span> {</span>
<span id="cb26-66"><a href="#cb26-66" tabindex="-1"></a>    <span class="st">&#39;no2&#39;</span><span class="op">:</span> dayMeanNO2<span class="op">,</span></span>
<span id="cb26-67"><a href="#cb26-67" tabindex="-1"></a>    <span class="st">&#39;date&#39;</span><span class="op">:</span> dayStart<span class="op">.</span><span class="fu">format</span>(<span class="st">&#39;YYYY-MM-dd&#39;</span><span class="op">,</span> tz)<span class="op">,</span></span>
<span id="cb26-68"><a href="#cb26-68" tabindex="-1"></a>    <span class="st">&#39;system:time_start&#39;</span><span class="op">:</span> dayStart<span class="op">.</span><span class="fu">millis</span>()</span>
<span id="cb26-69"><a href="#cb26-69" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb26-70"><a href="#cb26-70" tabindex="-1"></a>  <span class="cf">return</span> f<span class="op">;</span></span>
<span id="cb26-71"><a href="#cb26-71" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb26-72"><a href="#cb26-72" tabindex="-1"></a></span>
<span id="cb26-73"><a href="#cb26-73" tabindex="-1"></a><span class="co">// Remove any No Data values before charting</span></span>
<span id="cb26-74"><a href="#cb26-74" tabindex="-1"></a><span class="kw">var</span> no2Fc <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(result)</span>
<span id="cb26-75"><a href="#cb26-75" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">neq</span>(<span class="st">&#39;no2&#39;</span><span class="op">,</span> <span class="op">-</span><span class="dv">9999</span>))<span class="op">;</span></span>
<span id="cb26-76"><a href="#cb26-76" tabindex="-1"></a></span>
<span id="cb26-77"><a href="#cb26-77" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;Collection with Nulls Removed&#39;</span><span class="op">,</span> no2Fc)<span class="op">;</span></span>
<span id="cb26-78"><a href="#cb26-78" tabindex="-1"></a></span>
<span id="cb26-79"><a href="#cb26-79" tabindex="-1"></a><span class="co">// Create a chart</span></span>
<span id="cb26-80"><a href="#cb26-80" tabindex="-1"></a><span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">feature</span><span class="op">.</span><span class="fu">byFeature</span>({</span>
<span id="cb26-81"><a href="#cb26-81" tabindex="-1"></a>  <span class="dt">features</span><span class="op">:</span> no2Fc<span class="op">,</span></span>
<span id="cb26-82"><a href="#cb26-82" tabindex="-1"></a>  <span class="dt">xProperty</span><span class="op">:</span> <span class="st">&#39;system:time_start&#39;</span><span class="op">,</span></span>
<span id="cb26-83"><a href="#cb26-83" tabindex="-1"></a>  <span class="dt">yProperties</span><span class="op">:</span> [<span class="st">&#39;no2&#39;</span>]}) </span>
<span id="cb26-84"><a href="#cb26-84" tabindex="-1"></a>  <span class="op">.</span><span class="fu">setChartType</span>(<span class="st">&#39;LineChart&#39;</span>)</span>
<span id="cb26-85"><a href="#cb26-85" tabindex="-1"></a>  <span class="op">.</span><span class="fu">setOptions</span>({</span>
<span id="cb26-86"><a href="#cb26-86" tabindex="-1"></a>    <span class="dt">interpolateNulls</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb26-87"><a href="#cb26-87" tabindex="-1"></a>    <span class="dt">lineWidth</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb26-88"><a href="#cb26-88" tabindex="-1"></a>    <span class="dt">pointSize</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb26-89"><a href="#cb26-89" tabindex="-1"></a>    <span class="dt">series</span><span class="op">:</span> {</span>
<span id="cb26-90"><a href="#cb26-90" tabindex="-1"></a>      <span class="dv">0</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;#31a354&#39;</span>}<span class="op">,</span></span>
<span id="cb26-91"><a href="#cb26-91" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb26-92"><a href="#cb26-92" tabindex="-1"></a>    <span class="dt">legend</span><span class="op">:</span> <span class="st">&#39;none&#39;</span><span class="op">,</span></span>
<span id="cb26-93"><a href="#cb26-93" tabindex="-1"></a>    <span class="dt">curveType</span><span class="op">:</span> <span class="st">&#39;function&#39;</span><span class="op">,</span></span>
<span id="cb26-94"><a href="#cb26-94" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;NO2 Time-Series&#39;</span><span class="op">,</span></span>
<span id="cb26-95"><a href="#cb26-95" tabindex="-1"></a>    <span class="dt">vAxis</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">&#39;NO2 (mol/m^2)&#39;</span><span class="op">,</span> <span class="dt">viewWindow</span><span class="op">:</span> {<span class="dt">min</span><span class="op">:</span><span class="dv">0</span>}}<span class="op">,</span></span>
<span id="cb26-96"><a href="#cb26-96" tabindex="-1"></a>    <span class="dt">hAxis</span><span class="op">:</span> {</span>
<span id="cb26-97"><a href="#cb26-97" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;&#39;</span><span class="op">,</span> </span>
<span id="cb26-98"><a href="#cb26-98" tabindex="-1"></a>      <span class="co">// Apply a rotation to display vertical labels on X-Axis</span></span>
<span id="cb26-99"><a href="#cb26-99" tabindex="-1"></a>      <span class="dt">slantedText</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb26-100"><a href="#cb26-100" tabindex="-1"></a>      <span class="dt">slantedTextAngle</span><span class="op">:</span> <span class="dv">90</span><span class="op">,</span></span>
<span id="cb26-101"><a href="#cb26-101" tabindex="-1"></a>      <span class="dt">gridlines</span><span class="op">:</span> {</span>
<span id="cb26-102"><a href="#cb26-102" tabindex="-1"></a>        <span class="dt">units</span><span class="op">:</span> {</span>
<span id="cb26-103"><a href="#cb26-103" tabindex="-1"></a>          <span class="dt">days</span><span class="op">:</span> {<span class="dt">format</span><span class="op">:</span> [<span class="st">&#39;MM-dd&#39;</span>]}<span class="op">,</span></span>
<span id="cb26-104"><a href="#cb26-104" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb26-105"><a href="#cb26-105" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb26-106"><a href="#cb26-106" tabindex="-1"></a>      <span class="dt">minorGridlines</span><span class="op">:</span> {</span>
<span id="cb26-107"><a href="#cb26-107" tabindex="-1"></a>        <span class="dt">count</span><span class="op">:</span><span class="dv">0</span></span>
<span id="cb26-108"><a href="#cb26-108" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb26-109"><a href="#cb26-109" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb26-110"><a href="#cb26-110" tabindex="-1"></a>    <span class="dt">chartArea</span><span class="op">:</span> {<span class="dt">left</span><span class="op">:</span><span class="dv">150</span><span class="op">,</span> <span class="dt">right</span><span class="op">:</span><span class="dv">50</span>}</span>
<span id="cb26-111"><a href="#cb26-111" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb26-112"><a href="#cb26-112" tabindex="-1"></a></span>
<span id="cb26-113"><a href="#cb26-113" tabindex="-1"></a><span class="fu">print</span>(chart)<span class="op">;</span></span></code></pre></div>
</div>
<div id="surface-water-area-time-series" class="section level2">
<h2>Surface Water Area Time Series</h2>
<p>The <a href="https://global-surface-water.appspot.com/">Global
Surface Water</a> dataset is one of the best Landsat-derived
ready-to-use dataset for studying surface water. Using the <a
href="https://developers.google.com/earth-engine/datasets/catalog/JRC_GSW1_4_YearlyHistory?hl=en">JRC
Yearly Water Classification History</a>, we can calculate the yearly
surface water area anywhere in the globe and create a time-series chart.
This example also shows how to customize the X-axis labels by supplying
a list of Javascript date objects for <code>ticks</code> parameter.</p>
<div class="figure" style="text-align: center">
<img src="images/gee_charts/surface_water_area.png" alt="Surface Water Area Time-Series" width="75%" />
<p class="caption">
Surface Water Area Time-Series
</p>
</div>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3ASupplement%2FSurface_Water_Area_TimeSeries_Chart"
target="_blank">Open in Code Editor ↗</a></p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode js"><code class="sourceCode javascript"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="co">// Example script showing how to calculate and plot</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a><span class="co">// a time-series of surface water area over a region</span></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a><span class="co">// using the Global Surface Water (GSW) Dataset.</span></span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a><span class="co">// Define the area of interest</span></span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a><span class="kw">var</span> geometry <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Polygon</span>([[</span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a>  [<span class="fl">77.4762</span><span class="op">,</span> <span class="fl">13.1789</span>]<span class="op">,</span></span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a>  [<span class="fl">77.4762</span><span class="op">,</span> <span class="fl">13.1398</span>]<span class="op">,</span></span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a>  [<span class="fl">77.5045</span><span class="op">,</span> <span class="fl">13.1398</span>]<span class="op">,</span></span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a>  [<span class="fl">77.5045</span><span class="op">,</span> <span class="fl">13.1789</span>]</span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a>]])<span class="op">;</span></span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">centerObject</span>(geometry)<span class="op">;</span></span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(geometry<span class="op">,</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;grey&#39;</span>}<span class="op">,</span> <span class="st">&#39;Area of Interest&#39;</span>)<span class="op">;</span></span>
<span id="cb27-13"><a href="#cb27-13" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" tabindex="-1"></a><span class="co">// Use the GSW Yearly dataset</span></span>
<span id="cb27-15"><a href="#cb27-15" tabindex="-1"></a><span class="co">// We have yearly images from 1984 to 2021</span></span>
<span id="cb27-16"><a href="#cb27-16" tabindex="-1"></a><span class="kw">var</span> gswYearly <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&#39;JRC/GSW1_4/YearlyHistory&#39;</span>)<span class="op">;</span></span>
<span id="cb27-17"><a href="#cb27-17" tabindex="-1"></a></span>
<span id="cb27-18"><a href="#cb27-18" tabindex="-1"></a><span class="kw">var</span> startYear <span class="op">=</span> <span class="dv">1990</span><span class="op">;</span></span>
<span id="cb27-19"><a href="#cb27-19" tabindex="-1"></a><span class="kw">var</span> endYear <span class="op">=</span> <span class="dv">2021</span><span class="op">;</span></span>
<span id="cb27-20"><a href="#cb27-20" tabindex="-1"></a></span>
<span id="cb27-21"><a href="#cb27-21" tabindex="-1"></a><span class="kw">var</span> startDate <span class="op">=</span> ee<span class="op">.</span><span class="at">Date</span><span class="op">.</span><span class="fu">fromYMD</span>(startYear<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb27-22"><a href="#cb27-22" tabindex="-1"></a><span class="kw">var</span> endDate <span class="op">=</span> ee<span class="op">.</span><span class="at">Date</span><span class="op">.</span><span class="fu">fromYMD</span>(endYear <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb27-23"><a href="#cb27-23" tabindex="-1"></a></span>
<span id="cb27-24"><a href="#cb27-24" tabindex="-1"></a><span class="kw">var</span> filtered <span class="op">=</span> gswYearly<span class="op">.</span><span class="fu">filter</span>(</span>
<span id="cb27-25"><a href="#cb27-25" tabindex="-1"></a>  ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">date</span>(startDate<span class="op">,</span> endDate))<span class="op">;</span></span>
<span id="cb27-26"><a href="#cb27-26" tabindex="-1"></a></span>
<span id="cb27-27"><a href="#cb27-27" tabindex="-1"></a><span class="co">// Each image has a band named waterClass with 4 values</span></span>
<span id="cb27-28"><a href="#cb27-28" tabindex="-1"></a><span class="co">// | Value | Description     |</span></span>
<span id="cb27-29"><a href="#cb27-29" tabindex="-1"></a><span class="co">// |-------|-----------------|</span></span>
<span id="cb27-30"><a href="#cb27-30" tabindex="-1"></a><span class="co">// | 0     | No Data         |</span></span>
<span id="cb27-31"><a href="#cb27-31" tabindex="-1"></a><span class="co">// | 1     | Not Water       |</span></span>
<span id="cb27-32"><a href="#cb27-32" tabindex="-1"></a><span class="co">// | 2     | Seasonal Water  | </span></span>
<span id="cb27-33"><a href="#cb27-33" tabindex="-1"></a><span class="co">// | 3     | Permanent Water |</span></span>
<span id="cb27-34"><a href="#cb27-34" tabindex="-1"></a></span>
<span id="cb27-35"><a href="#cb27-35" tabindex="-1"></a><span class="co">// We map() a function to select all pixels</span></span>
<span id="cb27-36"><a href="#cb27-36" tabindex="-1"></a><span class="co">// with value 2 and 3 (seasonal and permanent water)</span></span>
<span id="cb27-37"><a href="#cb27-37" tabindex="-1"></a></span>
<span id="cb27-38"><a href="#cb27-38" tabindex="-1"></a><span class="kw">var</span> waterCol <span class="op">=</span> filtered<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(image) {</span>
<span id="cb27-39"><a href="#cb27-39" tabindex="-1"></a>  <span class="kw">var</span> water <span class="op">=</span> image<span class="op">.</span><span class="fu">eq</span>(<span class="dv">2</span>)<span class="op">.</span><span class="fu">or</span>(image<span class="op">.</span><span class="fu">eq</span>(<span class="dv">3</span>))<span class="op">;</span></span>
<span id="cb27-40"><a href="#cb27-40" tabindex="-1"></a>  <span class="co">// Unmask it to fill nodata with 0</span></span>
<span id="cb27-41"><a href="#cb27-41" tabindex="-1"></a>  <span class="cf">return</span> water<span class="op">.</span><span class="fu">unmask</span>(<span class="dv">0</span>)</span>
<span id="cb27-42"><a href="#cb27-42" tabindex="-1"></a>    <span class="op">.</span><span class="fu">copyProperties</span>(image<span class="op">,</span> [<span class="st">&#39;system:time_start&#39;</span>])<span class="op">;</span></span>
<span id="cb27-43"><a href="#cb27-43" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb27-44"><a href="#cb27-44" tabindex="-1"></a></span>
<span id="cb27-45"><a href="#cb27-45" tabindex="-1"></a><span class="co">// Now we have binary images for each year</span></span>
<span id="cb27-46"><a href="#cb27-46" tabindex="-1"></a><span class="co">// Water pixels are value 1</span></span>
<span id="cb27-47"><a href="#cb27-47" tabindex="-1"></a><span class="co">// Visualize an image</span></span>
<span id="cb27-48"><a href="#cb27-48" tabindex="-1"></a><span class="kw">var</span> image <span class="op">=</span> waterCol<span class="op">.</span><span class="fu">first</span>()<span class="op">;</span></span>
<span id="cb27-49"><a href="#cb27-49" tabindex="-1"></a><span class="kw">var</span> waterVis <span class="op">=</span> {<span class="dt">min</span><span class="op">:</span><span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span><span class="dv">1</span><span class="op">,</span> <span class="dt">palette</span><span class="op">:</span> [<span class="st">&#39;white&#39;</span><span class="op">,</span> <span class="st">&#39;blue&#39;</span>]}<span class="op">;</span></span>
<span id="cb27-50"><a href="#cb27-50" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(image<span class="op">.</span><span class="fu">clip</span>(geometry)<span class="op">,</span> waterVis<span class="op">,</span> <span class="st">&#39;Surface Water&#39;</span>)<span class="op">;</span></span>
<span id="cb27-51"><a href="#cb27-51" tabindex="-1"></a></span>
<span id="cb27-52"><a href="#cb27-52" tabindex="-1"></a><span class="co">// We now multiply each image with ee.Image.pixelArea()</span></span>
<span id="cb27-53"><a href="#cb27-53" tabindex="-1"></a><span class="kw">var</span> waterColArea <span class="op">=</span> waterCol<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(image) {</span>
<span id="cb27-54"><a href="#cb27-54" tabindex="-1"></a>  <span class="kw">var</span> waterAreaImage <span class="op">=</span> image<span class="op">.</span><span class="fu">multiply</span>(ee<span class="op">.</span><span class="at">Image</span><span class="op">.</span><span class="fu">pixelArea</span>())<span class="op">;</span></span>
<span id="cb27-55"><a href="#cb27-55" tabindex="-1"></a>  <span class="co">// The area is in square meters. Convert to hectares</span></span>
<span id="cb27-56"><a href="#cb27-56" tabindex="-1"></a>  <span class="cf">return</span> waterAreaImage<span class="op">.</span><span class="fu">divide</span>(<span class="dv">10000</span>)</span>
<span id="cb27-57"><a href="#cb27-57" tabindex="-1"></a>    <span class="op">.</span><span class="fu">copyProperties</span>(image<span class="op">,</span> [<span class="st">&#39;system:time_start&#39;</span>])<span class="op">;</span></span>
<span id="cb27-58"><a href="#cb27-58" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb27-59"><a href="#cb27-59" tabindex="-1"></a></span>
<span id="cb27-60"><a href="#cb27-60" tabindex="-1"></a><span class="co">// Now we create a time-series chart </span></span>
<span id="cb27-61"><a href="#cb27-61" tabindex="-1"></a><span class="co">// We use ee.Reducer.sum() to get total surface water</span></span>
<span id="cb27-62"><a href="#cb27-62" tabindex="-1"></a><span class="co">// area for the Y-Axis</span></span>
<span id="cb27-63"><a href="#cb27-63" tabindex="-1"></a><span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">image</span><span class="op">.</span><span class="fu">series</span>({</span>
<span id="cb27-64"><a href="#cb27-64" tabindex="-1"></a>  <span class="dt">imageCollection</span><span class="op">:</span> waterColArea<span class="op">,</span></span>
<span id="cb27-65"><a href="#cb27-65" tabindex="-1"></a>  <span class="dt">region</span><span class="op">:</span> geometry<span class="op">,</span></span>
<span id="cb27-66"><a href="#cb27-66" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">sum</span>()<span class="op">,</span></span>
<span id="cb27-67"><a href="#cb27-67" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span></span>
<span id="cb27-68"><a href="#cb27-68" tabindex="-1"></a>})<span class="op">.</span><span class="fu">setChartType</span>(<span class="st">&#39;ColumnChart&#39;</span>)</span>
<span id="cb27-69"><a href="#cb27-69" tabindex="-1"></a>  <span class="op">.</span><span class="fu">setOptions</span>({</span>
<span id="cb27-70"><a href="#cb27-70" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Total Surface Water Area&#39;</span><span class="op">,</span></span>
<span id="cb27-71"><a href="#cb27-71" tabindex="-1"></a>    <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;#3690c0&#39;</span><span class="op">,</span></span>
<span id="cb27-72"><a href="#cb27-72" tabindex="-1"></a>    <span class="dt">pointSize</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb27-73"><a href="#cb27-73" tabindex="-1"></a>    <span class="dt">lineWidth</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb27-74"><a href="#cb27-74" tabindex="-1"></a>    <span class="dt">vAxis</span><span class="op">:</span> {</span>
<span id="cb27-75"><a href="#cb27-75" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Area (hectares)&#39;</span><span class="op">,</span></span>
<span id="cb27-76"><a href="#cb27-76" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb27-77"><a href="#cb27-77" tabindex="-1"></a>    <span class="dt">hAxis</span><span class="op">:</span> {</span>
<span id="cb27-78"><a href="#cb27-78" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Year&#39;</span><span class="op">,</span></span>
<span id="cb27-79"><a href="#cb27-79" tabindex="-1"></a>      <span class="dt">gridlines</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;none&#39;</span>}<span class="op">,</span></span>
<span id="cb27-80"><a href="#cb27-80" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb27-81"><a href="#cb27-81" tabindex="-1"></a>    <span class="dt">legend</span><span class="op">:</span> {</span>
<span id="cb27-82"><a href="#cb27-82" tabindex="-1"></a>      <span class="dt">position</span><span class="op">:</span> <span class="st">&#39;none&#39;</span></span>
<span id="cb27-83"><a href="#cb27-83" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb27-84"><a href="#cb27-84" tabindex="-1"></a>    <span class="dt">backgroundColor</span><span class="op">:</span> <span class="st">&#39;#fff7fb&#39;</span><span class="op">,</span></span>
<span id="cb27-85"><a href="#cb27-85" tabindex="-1"></a>    <span class="dt">chartArea</span><span class="op">:</span> {<span class="dt">left</span><span class="op">:</span><span class="dv">100</span><span class="op">,</span> <span class="dt">right</span><span class="op">:</span><span class="dv">100</span>}</span>
<span id="cb27-86"><a href="#cb27-86" tabindex="-1"></a>    </span>
<span id="cb27-87"><a href="#cb27-87" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb27-88"><a href="#cb27-88" tabindex="-1"></a><span class="fu">print</span>(chart)<span class="op">;</span></span>
<span id="cb27-89"><a href="#cb27-89" tabindex="-1"></a></span>
<span id="cb27-90"><a href="#cb27-90" tabindex="-1"></a><span class="co">// The default chart has unwanted X-Axis labels </span></span>
<span id="cb27-91"><a href="#cb27-91" tabindex="-1"></a><span class="co">// To remove these, we must supply the list of &#39;ticks&#39;</span></span>
<span id="cb27-92"><a href="#cb27-92" tabindex="-1"></a><span class="co">// with dates that we want labeled.</span></span>
<span id="cb27-93"><a href="#cb27-93" tabindex="-1"></a><span class="co">// Since charts are client side, we have to create </span></span>
<span id="cb27-94"><a href="#cb27-94" tabindex="-1"></a><span class="co">// this list of dates using Javascript.</span></span>
<span id="cb27-95"><a href="#cb27-95" tabindex="-1"></a></span>
<span id="cb27-96"><a href="#cb27-96" tabindex="-1"></a><span class="co">// We generate list of years to use for charting</span></span>
<span id="cb27-97"><a href="#cb27-97" tabindex="-1"></a><span class="co">// and use evaluate() to create a client-side list</span></span>
<span id="cb27-98"><a href="#cb27-98" tabindex="-1"></a><span class="co">// Alternatively, you can just create a client-side</span></span>
<span id="cb27-99"><a href="#cb27-99" tabindex="-1"></a><span class="co">// list with javascript Date() objects</span></span>
<span id="cb27-100"><a href="#cb27-100" tabindex="-1"></a><span class="co">// var yearsList = [new Date(1990, 0), new Date(1995, 9) ..]</span></span>
<span id="cb27-101"><a href="#cb27-101" tabindex="-1"></a></span>
<span id="cb27-102"><a href="#cb27-102" tabindex="-1"></a><span class="kw">var</span> years <span class="op">=</span> ee<span class="op">.</span><span class="at">List</span><span class="op">.</span><span class="fu">sequence</span>(startYear<span class="op">,</span> endYear<span class="op">,</span> <span class="dv">5</span>)<span class="op">;</span></span>
<span id="cb27-103"><a href="#cb27-103" tabindex="-1"></a></span>
<span id="cb27-104"><a href="#cb27-104" tabindex="-1"></a><span class="co">// evaluate() to get the year list on the client-side</span></span>
<span id="cb27-105"><a href="#cb27-105" tabindex="-1"></a>years<span class="op">.</span><span class="fu">evaluate</span>(<span class="kw">function</span>(yearsList) {</span>
<span id="cb27-106"><a href="#cb27-106" tabindex="-1"></a>  <span class="kw">var</span> clientSideDates <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb27-107"><a href="#cb27-107" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> yearsList<span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb27-108"><a href="#cb27-108" tabindex="-1"></a>    <span class="kw">var</span> date <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(yearsList[i]<span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb27-109"><a href="#cb27-109" tabindex="-1"></a>    clientSideDates<span class="op">.</span><span class="fu">push</span>(date)<span class="op">;</span></span>
<span id="cb27-110"><a href="#cb27-110" tabindex="-1"></a>  }</span>
<span id="cb27-111"><a href="#cb27-111" tabindex="-1"></a>  <span class="co">// Create the chart</span></span>
<span id="cb27-112"><a href="#cb27-112" tabindex="-1"></a>  </span>
<span id="cb27-113"><a href="#cb27-113" tabindex="-1"></a>  <span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">image</span><span class="op">.</span><span class="fu">series</span>({</span>
<span id="cb27-114"><a href="#cb27-114" tabindex="-1"></a>    <span class="dt">imageCollection</span><span class="op">:</span> waterColArea<span class="op">,</span></span>
<span id="cb27-115"><a href="#cb27-115" tabindex="-1"></a>    <span class="dt">region</span><span class="op">:</span> geometry<span class="op">,</span></span>
<span id="cb27-116"><a href="#cb27-116" tabindex="-1"></a>    <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">sum</span>()<span class="op">,</span></span>
<span id="cb27-117"><a href="#cb27-117" tabindex="-1"></a>    <span class="dt">scale</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span></span>
<span id="cb27-118"><a href="#cb27-118" tabindex="-1"></a>  })<span class="op">.</span><span class="fu">setChartType</span>(<span class="st">&#39;ColumnChart&#39;</span>)</span>
<span id="cb27-119"><a href="#cb27-119" tabindex="-1"></a>    <span class="op">.</span><span class="fu">setOptions</span>({</span>
<span id="cb27-120"><a href="#cb27-120" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Total Surface Water Area&#39;</span><span class="op">,</span></span>
<span id="cb27-121"><a href="#cb27-121" tabindex="-1"></a>      <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;#3690c0&#39;</span><span class="op">,</span></span>
<span id="cb27-122"><a href="#cb27-122" tabindex="-1"></a>      <span class="dt">pointSize</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb27-123"><a href="#cb27-123" tabindex="-1"></a>      <span class="dt">lineWidth</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb27-124"><a href="#cb27-124" tabindex="-1"></a>      <span class="dt">vAxis</span><span class="op">:</span> {</span>
<span id="cb27-125"><a href="#cb27-125" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Area (hectares)&#39;</span><span class="op">,</span></span>
<span id="cb27-126"><a href="#cb27-126" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb27-127"><a href="#cb27-127" tabindex="-1"></a>      <span class="dt">hAxis</span><span class="op">:</span> {</span>
<span id="cb27-128"><a href="#cb27-128" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Year&#39;</span><span class="op">,</span></span>
<span id="cb27-129"><a href="#cb27-129" tabindex="-1"></a>        <span class="dt">gridlines</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;none&#39;</span>}<span class="op">,</span></span>
<span id="cb27-130"><a href="#cb27-130" tabindex="-1"></a>        <span class="dt">ticks</span><span class="op">:</span> clientSideDates<span class="op">,</span></span>
<span id="cb27-131"><a href="#cb27-131" tabindex="-1"></a>        <span class="dt">format</span><span class="op">:</span> <span class="st">&#39;YYYY&#39;</span></span>
<span id="cb27-132"><a href="#cb27-132" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb27-133"><a href="#cb27-133" tabindex="-1"></a>      <span class="dt">legend</span><span class="op">:</span> {</span>
<span id="cb27-134"><a href="#cb27-134" tabindex="-1"></a>        <span class="dt">position</span><span class="op">:</span> <span class="st">&#39;none&#39;</span></span>
<span id="cb27-135"><a href="#cb27-135" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb27-136"><a href="#cb27-136" tabindex="-1"></a>      <span class="dt">backgroundColor</span><span class="op">:</span> <span class="st">&#39;#fff7fb&#39;</span><span class="op">,</span></span>
<span id="cb27-137"><a href="#cb27-137" tabindex="-1"></a>      <span class="dt">chartArea</span><span class="op">:</span> {<span class="dt">left</span><span class="op">:</span><span class="dv">100</span><span class="op">,</span> <span class="dt">right</span><span class="op">:</span><span class="dv">100</span>}</span>
<span id="cb27-138"><a href="#cb27-138" tabindex="-1"></a>      </span>
<span id="cb27-139"><a href="#cb27-139" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb27-140"><a href="#cb27-140" tabindex="-1"></a>  <span class="fu">print</span>(chart)<span class="op">;</span></span>
<span id="cb27-141"><a href="#cb27-141" tabindex="-1"></a>})</span></code></pre></div>
</div>
<div id="histogram-with-reducer" class="section level2">
<h2>Histogram with Reducer</h2>
<p>If you wish to compute histogram for a large region, you need to
extract the image statistics using
<code>ee.Reducer.fixedHistogram()</code> and create a FeatureCollection
with the resulting values. This will allow you to Export large
computations and you can then import the resulting FeatureCollection and
use <code>ui.Chart.feature.byFeature()</code> to create the
histogram.</p>
<div class="figure" style="text-align: center">
<img src="images/gee_charts/histogram_reducer.png" alt="Histogram of a Large Image" width="75%" />
<p class="caption">
Histogram of a Large Image
</p>
</div>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3ASupplement%2FHistogram_with_Reducer"
target="_blank">Open in Code Editor ↗</a></p>
<div class="sourceCode" id="cb28"><pre
class="sourceCode js"><code class="sourceCode javascript"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="co">// We use the Harmonized Global Night Time Lights (1992-2020) dataset</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a><span class="kw">var</span> dmsp <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&#39;projects/sat-io/open-datasets/Harmonized_NTL/dmsp&#39;</span>)<span class="op">;</span></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a><span class="kw">var</span> viirs <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&#39;projects/sat-io/open-datasets/Harmonized_NTL/viirs&#39;</span>)<span class="op">;</span></span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a><span class="co">// Merge both collections to create a single Night Lights Collection</span></span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a><span class="kw">var</span> ntlCol <span class="op">=</span> dmsp<span class="op">.</span><span class="fu">merge</span>(viirs)<span class="op">;</span></span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a><span class="co">// Using LSIB for country boundaries</span></span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a><span class="kw">var</span> lsib <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(<span class="st">&#39;USDOS/LSIB_SIMPLE/2017&#39;</span>)<span class="op">;</span></span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a>    </span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a><span class="kw">var</span> country <span class="op">=</span> <span class="st">&#39;Brazil&#39;</span><span class="op">;</span></span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a><span class="kw">var</span> selected <span class="op">=</span> lsib<span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">eq</span>(<span class="st">&#39;country_na&#39;</span><span class="op">,</span> country))<span class="op">;</span></span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a><span class="kw">var</span> geometry <span class="op">=</span> selected<span class="op">.</span><span class="fu">geometry</span>()<span class="op">;</span></span>
<span id="cb28-14"><a href="#cb28-14" tabindex="-1"></a></span>
<span id="cb28-15"><a href="#cb28-15" tabindex="-1"></a><span class="kw">var</span> year <span class="op">=</span> <span class="dv">2009</span><span class="op">;</span></span>
<span id="cb28-16"><a href="#cb28-16" tabindex="-1"></a><span class="kw">var</span> startDate <span class="op">=</span> ee<span class="op">.</span><span class="at">Date</span><span class="op">.</span><span class="fu">fromYMD</span>(year<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb28-17"><a href="#cb28-17" tabindex="-1"></a><span class="kw">var</span> endDate <span class="op">=</span> startDate<span class="op">.</span><span class="fu">advance</span>(<span class="dv">1</span><span class="op">,</span> <span class="st">&#39;year&#39;</span>)</span>
<span id="cb28-18"><a href="#cb28-18" tabindex="-1"></a></span>
<span id="cb28-19"><a href="#cb28-19" tabindex="-1"></a><span class="co">// We filter for the selected year</span></span>
<span id="cb28-20"><a href="#cb28-20" tabindex="-1"></a><span class="kw">var</span> filtered <span class="op">=</span> ntlCol</span>
<span id="cb28-21"><a href="#cb28-21" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">date</span>(startDate<span class="op">,</span> endDate))</span>
<span id="cb28-22"><a href="#cb28-22" tabindex="-1"></a></span>
<span id="cb28-23"><a href="#cb28-23" tabindex="-1"></a><span class="co">// Extract the image and set the masked pixels to 0</span></span>
<span id="cb28-24"><a href="#cb28-24" tabindex="-1"></a><span class="kw">var</span> ntlImage <span class="op">=</span> ee<span class="op">.</span><span class="fu">Image</span>(filtered<span class="op">.</span><span class="fu">first</span>())<span class="op">.</span><span class="fu">unmask</span>(<span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb28-25"><a href="#cb28-25" tabindex="-1"></a></span>
<span id="cb28-26"><a href="#cb28-26" tabindex="-1"></a><span class="kw">var</span> palette <span class="op">=</span>[<span class="st">&#39;#253494&#39;</span><span class="op">,</span><span class="st">&#39;#2c7fb8&#39;</span><span class="op">,</span><span class="st">&#39;#41b6c4&#39;</span><span class="op">,</span><span class="st">&#39;#a1dab4&#39;</span><span class="op">,</span><span class="st">&#39;#ffffcc&#39;</span> ]<span class="op">;</span></span>
<span id="cb28-27"><a href="#cb28-27" tabindex="-1"></a><span class="kw">var</span> ntlVis <span class="op">=</span> {<span class="dt">min</span><span class="op">:</span><span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">63</span><span class="op">,</span>  <span class="dt">palette</span><span class="op">:</span> palette}</span>
<span id="cb28-28"><a href="#cb28-28" tabindex="-1"></a></span>
<span id="cb28-29"><a href="#cb28-29" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">centerObject</span>(geometry<span class="op">,</span> <span class="dv">6</span>)<span class="op">;</span></span>
<span id="cb28-30"><a href="#cb28-30" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(ntlImage<span class="op">.</span><span class="fu">clip</span>(geometry)<span class="op">,</span> ntlVis<span class="op">,</span> <span class="st">&#39;Night Time Lights &#39;</span> <span class="op">+</span> year)<span class="op">;</span></span>
<span id="cb28-31"><a href="#cb28-31" tabindex="-1"></a></span>
<span id="cb28-32"><a href="#cb28-32" tabindex="-1"></a><span class="co">// Extract the native resolution of the image</span></span>
<span id="cb28-33"><a href="#cb28-33" tabindex="-1"></a><span class="kw">var</span> resolution <span class="op">=</span> ntlImage<span class="op">.</span><span class="fu">projection</span>()<span class="op">.</span><span class="fu">nominalScale</span>()<span class="op">;</span></span>
<span id="cb28-34"><a href="#cb28-34" tabindex="-1"></a></span>
<span id="cb28-35"><a href="#cb28-35" tabindex="-1"></a><span class="co">// NTL images have DN values from 0-63</span></span>
<span id="cb28-36"><a href="#cb28-36" tabindex="-1"></a><span class="co">// We can create a histogram to show pixel counts</span></span>
<span id="cb28-37"><a href="#cb28-37" tabindex="-1"></a><span class="co">// for each DN value</span></span>
<span id="cb28-38"><a href="#cb28-38" tabindex="-1"></a><span class="co">// var chart = ui.Chart.image.histogram({</span></span>
<span id="cb28-39"><a href="#cb28-39" tabindex="-1"></a><span class="co">//   image: ntlImage,</span></span>
<span id="cb28-40"><a href="#cb28-40" tabindex="-1"></a><span class="co">//   region: geometry,</span></span>
<span id="cb28-41"><a href="#cb28-41" tabindex="-1"></a><span class="co">//   scale: resolution,</span></span>
<span id="cb28-42"><a href="#cb28-42" tabindex="-1"></a><span class="co">//   maxBuckets: 63,</span></span>
<span id="cb28-43"><a href="#cb28-43" tabindex="-1"></a><span class="co">//   minBucketWidth: 1})</span></span>
<span id="cb28-44"><a href="#cb28-44" tabindex="-1"></a></span>
<span id="cb28-45"><a href="#cb28-45" tabindex="-1"></a><span class="co">// Fails</span></span>
<span id="cb28-46"><a href="#cb28-46" tabindex="-1"></a><span class="co">//print(chart);</span></span>
<span id="cb28-47"><a href="#cb28-47" tabindex="-1"></a></span>
<span id="cb28-48"><a href="#cb28-48" tabindex="-1"></a><span class="co">// Let&#39;s extract the data using reduceRegion</span></span>
<span id="cb28-49"><a href="#cb28-49" tabindex="-1"></a><span class="co">// and ee.Recuer.histogram() reducer</span></span>
<span id="cb28-50"><a href="#cb28-50" tabindex="-1"></a><span class="kw">var</span> stats <span class="op">=</span> ntlImage<span class="op">.</span><span class="fu">reduceRegion</span>({</span>
<span id="cb28-51"><a href="#cb28-51" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">fixedHistogram</span>({</span>
<span id="cb28-52"><a href="#cb28-52" tabindex="-1"></a>    <span class="dt">min</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb28-53"><a href="#cb28-53" tabindex="-1"></a>    <span class="dt">max</span><span class="op">:</span> <span class="dv">64</span><span class="op">,</span></span>
<span id="cb28-54"><a href="#cb28-54" tabindex="-1"></a>    <span class="dt">steps</span><span class="op">:</span> <span class="dv">64</span>})<span class="op">,</span></span>
<span id="cb28-55"><a href="#cb28-55" tabindex="-1"></a>  <span class="dt">geometry</span><span class="op">:</span> geometry<span class="op">,</span></span>
<span id="cb28-56"><a href="#cb28-56" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> resolution<span class="op">,</span></span>
<span id="cb28-57"><a href="#cb28-57" tabindex="-1"></a>  <span class="dt">maxPixels</span><span class="op">:</span> <span class="fl">1e10</span><span class="op">,</span></span>
<span id="cb28-58"><a href="#cb28-58" tabindex="-1"></a>  <span class="dt">tileScale</span><span class="op">:</span> <span class="dv">16</span></span>
<span id="cb28-59"><a href="#cb28-59" tabindex="-1"></a>})</span>
<span id="cb28-60"><a href="#cb28-60" tabindex="-1"></a></span>
<span id="cb28-61"><a href="#cb28-61" tabindex="-1"></a><span class="co">// Extract the histogram values from the results</span></span>
<span id="cb28-62"><a href="#cb28-62" tabindex="-1"></a><span class="kw">var</span> bandName <span class="op">=</span> <span class="st">&#39;b1&#39;</span><span class="op">;</span></span>
<span id="cb28-63"><a href="#cb28-63" tabindex="-1"></a><span class="kw">var</span> values <span class="op">=</span> ee<span class="op">.</span><span class="fu">Array</span>(stats<span class="op">.</span><span class="fu">get</span>(bandName))<span class="op">.</span><span class="fu">toList</span>()<span class="op">;</span></span>
<span id="cb28-64"><a href="#cb28-64" tabindex="-1"></a></span>
<span id="cb28-65"><a href="#cb28-65" tabindex="-1"></a><span class="co">// Create a FeatureCollection</span></span>
<span id="cb28-66"><a href="#cb28-66" tabindex="-1"></a><span class="kw">var</span> histogramFc <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(values<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(item){</span>
<span id="cb28-67"><a href="#cb28-67" tabindex="-1"></a>  <span class="kw">var</span> itemList <span class="op">=</span> ee<span class="op">.</span><span class="fu">List</span>(item)<span class="op">;</span></span>
<span id="cb28-68"><a href="#cb28-68" tabindex="-1"></a>  <span class="kw">var</span> bucket <span class="op">=</span> itemList<span class="op">.</span><span class="fu">get</span>(<span class="dv">0</span>)<span class="op">;</span> </span>
<span id="cb28-69"><a href="#cb28-69" tabindex="-1"></a>  <span class="kw">var</span> value <span class="op">=</span> itemList<span class="op">.</span><span class="fu">get</span>(<span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb28-70"><a href="#cb28-70" tabindex="-1"></a>  <span class="kw">var</span> nullGeom <span class="op">=</span> geometry<span class="op">.</span><span class="fu">centroid</span>()<span class="op">;</span></span>
<span id="cb28-71"><a href="#cb28-71" tabindex="-1"></a>  <span class="cf">return</span> ee<span class="op">.</span><span class="fu">Feature</span>(nullGeom<span class="op">,</span> {</span>
<span id="cb28-72"><a href="#cb28-72" tabindex="-1"></a>    <span class="dt">bucket</span><span class="op">:</span> bucket<span class="op">,</span></span>
<span id="cb28-73"><a href="#cb28-73" tabindex="-1"></a>    <span class="dt">value</span><span class="op">:</span> value</span>
<span id="cb28-74"><a href="#cb28-74" tabindex="-1"></a>  })</span>
<span id="cb28-75"><a href="#cb28-75" tabindex="-1"></a>}))<span class="op">;</span></span>
<span id="cb28-76"><a href="#cb28-76" tabindex="-1"></a><span class="co">// For large computations, we can export the results</span></span>
<span id="cb28-77"><a href="#cb28-77" tabindex="-1"></a>Export<span class="op">.</span><span class="at">table</span><span class="op">.</span><span class="fu">toAsset</span>({</span>
<span id="cb28-78"><a href="#cb28-78" tabindex="-1"></a>  <span class="dt">collection</span><span class="op">:</span> histogramFc<span class="op">,</span></span>
<span id="cb28-79"><a href="#cb28-79" tabindex="-1"></a>  <span class="dt">description</span><span class="op">:</span> <span class="st">&#39;Histogram_FeatureCollection&#39;</span><span class="op">,</span></span>
<span id="cb28-80"><a href="#cb28-80" tabindex="-1"></a>  <span class="dt">assetId</span><span class="op">:</span> <span class="st">&#39;users/ujavalgandhi/ee_dataviz/histogram_fc&#39;</span>})</span>
<span id="cb28-81"><a href="#cb28-81" tabindex="-1"></a></span>
<span id="cb28-82"><a href="#cb28-82" tabindex="-1"></a><span class="co">// Import the asset once export finishes</span></span>
<span id="cb28-83"><a href="#cb28-83" tabindex="-1"></a><span class="kw">var</span> histogramFcExported <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(<span class="st">&#39;users/ujavalgandhi/ee_dataviz/histogram_fc&#39;</span>)<span class="op">;</span></span>
<span id="cb28-84"><a href="#cb28-84" tabindex="-1"></a><span class="fu">print</span>(histogramFcExported)</span>
<span id="cb28-85"><a href="#cb28-85" tabindex="-1"></a></span>
<span id="cb28-86"><a href="#cb28-86" tabindex="-1"></a><span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">feature</span><span class="op">.</span><span class="fu">byFeature</span>({</span>
<span id="cb28-87"><a href="#cb28-87" tabindex="-1"></a>  <span class="dt">features</span><span class="op">:</span> histogramFcExported<span class="op">,</span></span>
<span id="cb28-88"><a href="#cb28-88" tabindex="-1"></a>  <span class="dt">xProperty</span><span class="op">:</span> <span class="st">&#39;bucket&#39;</span><span class="op">,</span></span>
<span id="cb28-89"><a href="#cb28-89" tabindex="-1"></a>  <span class="dt">yProperties</span><span class="op">:</span> [<span class="st">&#39;value&#39;</span>]</span>
<span id="cb28-90"><a href="#cb28-90" tabindex="-1"></a>})<span class="op">.</span><span class="fu">setChartType</span>(<span class="st">&#39;ColumnChart&#39;</span>)</span>
<span id="cb28-91"><a href="#cb28-91" tabindex="-1"></a><span class="op">.</span><span class="fu">setOptions</span>({</span>
<span id="cb28-92"><a href="#cb28-92" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Night Time Lights Distribution for &#39;</span> <span class="op">+</span> country <span class="op">+</span> <span class="st">&#39; &#39;</span> <span class="op">+</span> year<span class="op">,</span></span>
<span id="cb28-93"><a href="#cb28-93" tabindex="-1"></a>    <span class="dt">vAxis</span><span class="op">:</span> {</span>
<span id="cb28-94"><a href="#cb28-94" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Number of Grids&#39;</span><span class="op">,</span> </span>
<span id="cb28-95"><a href="#cb28-95" tabindex="-1"></a>      <span class="dt">gridlines</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;transparent&#39;</span>}<span class="op">,</span></span>
<span id="cb28-96"><a href="#cb28-96" tabindex="-1"></a>      <span class="co">//viewWindow: {min:0, max: 200000}</span></span>
<span id="cb28-97"><a href="#cb28-97" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb28-98"><a href="#cb28-98" tabindex="-1"></a>    <span class="dt">hAxis</span><span class="op">:</span> {</span>
<span id="cb28-99"><a href="#cb28-99" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Level of Observed Nighttime Lights&#39;</span><span class="op">,</span></span>
<span id="cb28-100"><a href="#cb28-100" tabindex="-1"></a>      <span class="dt">ticks</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">13</span><span class="op">,</span> <span class="dv">21</span><span class="op">,</span> <span class="dv">29</span><span class="op">,</span> <span class="dv">37</span><span class="op">,</span> <span class="dv">45</span><span class="op">,</span> <span class="dv">53</span><span class="op">,</span> <span class="dv">61</span>]<span class="op">,</span></span>
<span id="cb28-101"><a href="#cb28-101" tabindex="-1"></a>      <span class="dt">gridlines</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;transparent&#39;</span>}</span>
<span id="cb28-102"><a href="#cb28-102" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb28-103"><a href="#cb28-103" tabindex="-1"></a>    <span class="co">//bar: { gap: 1 },</span></span>
<span id="cb28-104"><a href="#cb28-104" tabindex="-1"></a>    <span class="dt">legend</span><span class="op">:</span> { <span class="dt">position</span><span class="op">:</span> <span class="st">&#39;none&#39;</span> }<span class="op">,</span></span>
<span id="cb28-105"><a href="#cb28-105" tabindex="-1"></a>    <span class="dt">colors</span><span class="op">:</span> [<span class="st">&#39;#525252&#39;</span>]</span>
<span id="cb28-106"><a href="#cb28-106" tabindex="-1"></a>  })</span>
<span id="cb28-107"><a href="#cb28-107" tabindex="-1"></a><span class="fu">print</span>(chart)</span></code></pre></div>
</div>
<div id="histogram-of-multiple-bands" class="section level2">
<h2>Histogram of Multiple Bands</h2>
<p>If you wish to compute a multi-band histogram, we can follow the same
method used in the previous section <a
href="#histogram-with-reducer">Histogram with Reducer</a>, but use the
<code>ui.Chart.feature.groups()</code> to create the plot.</p>
<div class="figure" style="text-align: center">
<img src="images/gee_charts/multiband_histogram.png" alt="Multi-band Histogram" width="75%" />
<p class="caption">
Multi-band Histogram
</p>
</div>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3ASupplement%2FMultiband_Histogram"
target="_blank">Open in Code Editor ↗</a></p>
<div class="sourceCode" id="cb29"><pre
class="sourceCode js"><code class="sourceCode javascript"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="co">// Create a histogram for multiple bands of a Sentinel-2 image</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a><span class="co">// Select the region</span></span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a><span class="kw">var</span> geometry <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Polygon</span>([[</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>  [<span class="fl">77.5765</span><span class="op">,</span> <span class="fl">12.95640</span>]<span class="op">,</span></span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>  [<span class="fl">77.5765</span><span class="op">,</span> <span class="fl">12.94018</span>]<span class="op">,</span></span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>  [<span class="fl">77.5966</span><span class="op">,</span> <span class="fl">12.94018</span>]<span class="op">,</span></span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a>  [<span class="fl">77.5966</span><span class="op">,</span> <span class="fl">12.95640</span>]</span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a>]])<span class="op">;</span></span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a><span class="kw">var</span> s2 <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&#39;COPERNICUS/S2_HARMONIZED&#39;</span>)<span class="op">;</span></span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a><span class="co">// Filter the Sentinel-2 collection</span></span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a><span class="kw">var</span> filteredS2 <span class="op">=</span> s2<span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">lt</span>(<span class="st">&#39;CLOUDY_PIXEL_PERCENTAGE&#39;</span><span class="op">,</span> <span class="dv">30</span>))</span>
<span id="cb29-14"><a href="#cb29-14" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">date</span>(<span class="st">&#39;2019-01-01&#39;</span><span class="op">,</span> <span class="st">&#39;2020-01-01&#39;</span>))</span>
<span id="cb29-15"><a href="#cb29-15" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">bounds</span>(geometry))<span class="op">;</span></span>
<span id="cb29-16"><a href="#cb29-16" tabindex="-1"></a><span class="co">// Sort the collection and pick the least cloudy image</span></span>
<span id="cb29-17"><a href="#cb29-17" tabindex="-1"></a><span class="kw">var</span> filteredS2Sorted <span class="op">=</span> filteredS2<span class="op">.</span><span class="fu">sort</span>(<span class="st">&#39;CLOUDY_PIXEL_PERCENTAGE&#39;</span>)<span class="op">;</span></span>
<span id="cb29-18"><a href="#cb29-18" tabindex="-1"></a><span class="kw">var</span> image <span class="op">=</span> filteredS2Sorted<span class="op">.</span><span class="fu">first</span>()<span class="op">;</span></span>
<span id="cb29-19"><a href="#cb29-19" tabindex="-1"></a></span>
<span id="cb29-20"><a href="#cb29-20" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">centerObject</span>(geometry<span class="op">,</span> <span class="dv">10</span>)<span class="op">;</span></span>
<span id="cb29-21"><a href="#cb29-21" tabindex="-1"></a><span class="kw">var</span> rgbVis <span class="op">=</span> {<span class="dt">min</span><span class="op">:</span> <span class="fl">0.0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">3000</span><span class="op">,</span> <span class="dt">bands</span><span class="op">:</span> [<span class="st">&#39;B4&#39;</span><span class="op">,</span> <span class="st">&#39;B3&#39;</span><span class="op">,</span> <span class="st">&#39;B2&#39;</span>]}<span class="op">;</span></span>
<span id="cb29-22"><a href="#cb29-22" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(image<span class="op">,</span> rgbVis<span class="op">,</span> <span class="st">&#39;Image&#39;</span>)<span class="op">;</span></span>
<span id="cb29-23"><a href="#cb29-23" tabindex="-1"></a></span>
<span id="cb29-24"><a href="#cb29-24" tabindex="-1"></a><span class="co">// Select bands</span></span>
<span id="cb29-25"><a href="#cb29-25" tabindex="-1"></a><span class="co">// Pad the band names by 0 so they are sorted correctly</span></span>
<span id="cb29-26"><a href="#cb29-26" tabindex="-1"></a><span class="kw">var</span> bands <span class="op">=</span> image<span class="op">.</span><span class="fu">select</span>(</span>
<span id="cb29-27"><a href="#cb29-27" tabindex="-1"></a>  [<span class="st">&#39;B11&#39;</span><span class="op">,</span> <span class="st">&#39;B8&#39;</span><span class="op">,</span> <span class="st">&#39;B4&#39;</span><span class="op">,</span> <span class="st">&#39;B3&#39;</span><span class="op">,</span> <span class="st">&#39;B2&#39;</span>]<span class="op">,</span></span>
<span id="cb29-28"><a href="#cb29-28" tabindex="-1"></a>  [<span class="st">&#39;B11&#39;</span><span class="op">,</span> <span class="st">&#39;B08&#39;</span><span class="op">,</span> <span class="st">&#39;B04&#39;</span><span class="op">,</span> <span class="st">&#39;B03&#39;</span><span class="op">,</span> <span class="st">&#39;B02&#39;</span>])<span class="op">;</span></span>
<span id="cb29-29"><a href="#cb29-29" tabindex="-1"></a>  </span>
<span id="cb29-30"><a href="#cb29-30" tabindex="-1"></a><span class="co">// Let&#39;s extract the data using reduceRegion</span></span>
<span id="cb29-31"><a href="#cb29-31" tabindex="-1"></a><span class="co">// and ee.Recuer.histogram() reducer</span></span>
<span id="cb29-32"><a href="#cb29-32" tabindex="-1"></a><span class="kw">var</span> stats <span class="op">=</span> bands<span class="op">.</span><span class="fu">reduceRegion</span>({</span>
<span id="cb29-33"><a href="#cb29-33" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">fixedHistogram</span>({</span>
<span id="cb29-34"><a href="#cb29-34" tabindex="-1"></a>    <span class="dt">min</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb29-35"><a href="#cb29-35" tabindex="-1"></a>    <span class="dt">max</span><span class="op">:</span> <span class="dv">5000</span><span class="op">,</span></span>
<span id="cb29-36"><a href="#cb29-36" tabindex="-1"></a>    <span class="dt">steps</span><span class="op">:</span> <span class="dv">100</span>})<span class="op">,</span></span>
<span id="cb29-37"><a href="#cb29-37" tabindex="-1"></a>  <span class="dt">geometry</span><span class="op">:</span> geometry<span class="op">,</span></span>
<span id="cb29-38"><a href="#cb29-38" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span></span>
<span id="cb29-39"><a href="#cb29-39" tabindex="-1"></a>  <span class="dt">maxPixels</span><span class="op">:</span> <span class="fl">1e10</span><span class="op">,</span></span>
<span id="cb29-40"><a href="#cb29-40" tabindex="-1"></a>  <span class="dt">tileScale</span><span class="op">:</span> <span class="dv">16</span></span>
<span id="cb29-41"><a href="#cb29-41" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb29-42"><a href="#cb29-42" tabindex="-1"></a></span>
<span id="cb29-43"><a href="#cb29-43" tabindex="-1"></a><span class="co">// We have a histogram for each band</span></span>
<span id="cb29-44"><a href="#cb29-44" tabindex="-1"></a><span class="co">// Get a list of bands and extract values</span></span>
<span id="cb29-45"><a href="#cb29-45" tabindex="-1"></a></span>
<span id="cb29-46"><a href="#cb29-46" tabindex="-1"></a><span class="kw">var</span> bands <span class="op">=</span> ee<span class="op">.</span><span class="fu">List</span>(stats<span class="op">.</span><span class="fu">keys</span>())<span class="op">;</span></span>
<span id="cb29-47"><a href="#cb29-47" tabindex="-1"></a></span>
<span id="cb29-48"><a href="#cb29-48" tabindex="-1"></a><span class="co">// Create a FeatureCollection</span></span>
<span id="cb29-49"><a href="#cb29-49" tabindex="-1"></a><span class="kw">var</span> histogramFc <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(bands<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(band){</span>
<span id="cb29-50"><a href="#cb29-50" tabindex="-1"></a>  <span class="kw">var</span> histogram <span class="op">=</span> stats<span class="op">.</span><span class="fu">get</span>(band)<span class="op">;</span></span>
<span id="cb29-51"><a href="#cb29-51" tabindex="-1"></a>  <span class="kw">var</span> values <span class="op">=</span> ee<span class="op">.</span><span class="fu">Array</span>(histogram)<span class="op">.</span><span class="fu">toList</span>()<span class="op">;</span></span>
<span id="cb29-52"><a href="#cb29-52" tabindex="-1"></a>  <span class="kw">var</span> features <span class="op">=</span> values<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(item) {</span>
<span id="cb29-53"><a href="#cb29-53" tabindex="-1"></a>    <span class="kw">var</span> itemList <span class="op">=</span> ee<span class="op">.</span><span class="fu">List</span>(item)<span class="op">;</span></span>
<span id="cb29-54"><a href="#cb29-54" tabindex="-1"></a>    <span class="kw">var</span> bucket <span class="op">=</span> itemList<span class="op">.</span><span class="fu">get</span>(<span class="dv">0</span>)<span class="op">;</span> </span>
<span id="cb29-55"><a href="#cb29-55" tabindex="-1"></a>    <span class="kw">var</span> value <span class="op">=</span> itemList<span class="op">.</span><span class="fu">get</span>(<span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb29-56"><a href="#cb29-56" tabindex="-1"></a>    <span class="co">// Exports require features to have a non-null</span></span>
<span id="cb29-57"><a href="#cb29-57" tabindex="-1"></a>    <span class="co">// geometry. Create a geometry for the centroid</span></span>
<span id="cb29-58"><a href="#cb29-58" tabindex="-1"></a>    <span class="kw">var</span> nullGeom <span class="op">=</span> geometry<span class="op">.</span><span class="fu">centroid</span>({<span class="dt">maxError</span><span class="op">:</span> <span class="dv">1</span>})<span class="op">;</span></span>
<span id="cb29-59"><a href="#cb29-59" tabindex="-1"></a>    <span class="cf">return</span> ee<span class="op">.</span><span class="fu">Feature</span>(nullGeom<span class="op">,</span> {</span>
<span id="cb29-60"><a href="#cb29-60" tabindex="-1"></a>      <span class="dt">bucket</span><span class="op">:</span> bucket<span class="op">,</span></span>
<span id="cb29-61"><a href="#cb29-61" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> value<span class="op">,</span></span>
<span id="cb29-62"><a href="#cb29-62" tabindex="-1"></a>      <span class="dt">band</span><span class="op">:</span> band</span>
<span id="cb29-63"><a href="#cb29-63" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb29-64"><a href="#cb29-64" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb29-65"><a href="#cb29-65" tabindex="-1"></a>  <span class="cf">return</span> features<span class="op">;</span></span>
<span id="cb29-66"><a href="#cb29-66" tabindex="-1"></a>})<span class="op">.</span><span class="fu">flatten</span>())<span class="op">;</span></span>
<span id="cb29-67"><a href="#cb29-67" tabindex="-1"></a></span>
<span id="cb29-68"><a href="#cb29-68" tabindex="-1"></a><span class="co">// For large computations, we can export the results</span></span>
<span id="cb29-69"><a href="#cb29-69" tabindex="-1"></a></span>
<span id="cb29-70"><a href="#cb29-70" tabindex="-1"></a><span class="co">// Replace this with your asset id</span></span>
<span id="cb29-71"><a href="#cb29-71" tabindex="-1"></a><span class="kw">var</span> exportAssetId <span class="op">=</span> <span class="st">&#39;users/ujavalgandhi/ee_dataviz/histogram_by_band_fc&#39;</span><span class="op">;</span></span>
<span id="cb29-72"><a href="#cb29-72" tabindex="-1"></a></span>
<span id="cb29-73"><a href="#cb29-73" tabindex="-1"></a>Export<span class="op">.</span><span class="at">table</span><span class="op">.</span><span class="fu">toAsset</span>({</span>
<span id="cb29-74"><a href="#cb29-74" tabindex="-1"></a>  <span class="dt">collection</span><span class="op">:</span> histogramFc<span class="op">,</span></span>
<span id="cb29-75"><a href="#cb29-75" tabindex="-1"></a>  <span class="dt">description</span><span class="op">:</span> <span class="st">&#39;Histogram_by_Band_FeatureCollection&#39;</span><span class="op">,</span></span>
<span id="cb29-76"><a href="#cb29-76" tabindex="-1"></a>  <span class="dt">assetId</span><span class="op">:</span> exportAssetId</span>
<span id="cb29-77"><a href="#cb29-77" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb29-78"><a href="#cb29-78" tabindex="-1"></a></span>
<span id="cb29-79"><a href="#cb29-79" tabindex="-1"></a><span class="co">// Import the asset once export finishes</span></span>
<span id="cb29-80"><a href="#cb29-80" tabindex="-1"></a><span class="kw">var</span> histogramFcExported <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(exportAssetId)<span class="op">;</span></span>
<span id="cb29-81"><a href="#cb29-81" tabindex="-1"></a></span>
<span id="cb29-82"><a href="#cb29-82" tabindex="-1"></a><span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">feature</span><span class="op">.</span><span class="fu">groups</span>({</span>
<span id="cb29-83"><a href="#cb29-83" tabindex="-1"></a>  <span class="dt">features</span><span class="op">:</span> histogramFcExported<span class="op">,</span></span>
<span id="cb29-84"><a href="#cb29-84" tabindex="-1"></a>  <span class="dt">xProperty</span><span class="op">:</span> <span class="st">&#39;bucket&#39;</span><span class="op">,</span></span>
<span id="cb29-85"><a href="#cb29-85" tabindex="-1"></a>  <span class="dt">yProperty</span><span class="op">:</span> <span class="st">&#39;value&#39;</span><span class="op">,</span></span>
<span id="cb29-86"><a href="#cb29-86" tabindex="-1"></a>  <span class="dt">seriesProperty</span><span class="op">:</span> <span class="st">&#39;band&#39;</span></span>
<span id="cb29-87"><a href="#cb29-87" tabindex="-1"></a>})</span>
<span id="cb29-88"><a href="#cb29-88" tabindex="-1"></a><span class="op">.</span><span class="fu">setChartType</span>(<span class="st">&#39;AreaChart&#39;</span>)</span>
<span id="cb29-89"><a href="#cb29-89" tabindex="-1"></a><span class="op">.</span><span class="fu">setOptions</span>({</span>
<span id="cb29-90"><a href="#cb29-90" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Histogram&#39;</span><span class="op">,</span></span>
<span id="cb29-91"><a href="#cb29-91" tabindex="-1"></a>    <span class="dt">vAxis</span><span class="op">:</span> {</span>
<span id="cb29-92"><a href="#cb29-92" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Count&#39;</span><span class="op">,</span> </span>
<span id="cb29-93"><a href="#cb29-93" tabindex="-1"></a>      <span class="dt">gridlines</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;transparent&#39;</span>}<span class="op">,</span></span>
<span id="cb29-94"><a href="#cb29-94" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb29-95"><a href="#cb29-95" tabindex="-1"></a>    <span class="dt">hAxis</span><span class="op">:</span> {</span>
<span id="cb29-96"><a href="#cb29-96" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Pixel Values&#39;</span><span class="op">,</span></span>
<span id="cb29-97"><a href="#cb29-97" tabindex="-1"></a>      <span class="dt">gridlines</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;transparent&#39;</span>}</span>
<span id="cb29-98"><a href="#cb29-98" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb29-99"><a href="#cb29-99" tabindex="-1"></a>    <span class="dt">lineWidth</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb29-100"><a href="#cb29-100" tabindex="-1"></a>    <span class="dt">areaOpacity</span><span class="op">:</span> <span class="fl">0.2</span><span class="op">,</span></span>
<span id="cb29-101"><a href="#cb29-101" tabindex="-1"></a>    <span class="dt">legend</span><span class="op">:</span> { <span class="dt">position</span><span class="op">:</span> <span class="st">&#39;top&#39;</span> }<span class="op">,</span></span>
<span id="cb29-102"><a href="#cb29-102" tabindex="-1"></a>    <span class="co">// series values are sorted alphabetically</span></span>
<span id="cb29-103"><a href="#cb29-103" tabindex="-1"></a>    <span class="dt">series</span><span class="op">:</span> {</span>
<span id="cb29-104"><a href="#cb29-104" tabindex="-1"></a>      <span class="dv">0</span><span class="op">:</span> {<span class="dt">labelInLegend</span><span class="op">:</span> <span class="st">&#39;Blue&#39;</span><span class="op">,</span> <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;blue&#39;</span>}<span class="op">,</span></span>
<span id="cb29-105"><a href="#cb29-105" tabindex="-1"></a>      <span class="dv">1</span><span class="op">:</span> {<span class="dt">labelInLegend</span><span class="op">:</span> <span class="st">&#39;Green&#39;</span><span class="op">,</span> <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;green&#39;</span>}<span class="op">,</span></span>
<span id="cb29-106"><a href="#cb29-106" tabindex="-1"></a>      <span class="dv">2</span><span class="op">:</span> {<span class="dt">labelInLegend</span><span class="op">:</span> <span class="st">&#39;Red&#39;</span><span class="op">,</span> <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;red&#39;</span>}<span class="op">,</span></span>
<span id="cb29-107"><a href="#cb29-107" tabindex="-1"></a>      <span class="dv">3</span><span class="op">:</span> {<span class="dt">labelInLegend</span><span class="op">:</span> <span class="st">&#39;NIR&#39;</span><span class="op">,</span> <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;orange&#39;</span>}<span class="op">,</span></span>
<span id="cb29-108"><a href="#cb29-108" tabindex="-1"></a>      <span class="dv">4</span><span class="op">:</span> {<span class="dt">labelInLegend</span><span class="op">:</span> <span class="st">&#39;SWIR&#39;</span><span class="op">,</span> <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;purple&#39;</span>}<span class="op">,</span></span>
<span id="cb29-109"><a href="#cb29-109" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb29-110"><a href="#cb29-110" tabindex="-1"></a>    <span class="dt">chartArea</span><span class="op">:</span> {</span>
<span id="cb29-111"><a href="#cb29-111" tabindex="-1"></a>        <span class="dt">width</span><span class="op">:</span> <span class="st">&#39;70%&#39;</span><span class="op">,</span></span>
<span id="cb29-112"><a href="#cb29-112" tabindex="-1"></a>        <span class="dt">height</span><span class="op">:</span> <span class="st">&#39;70%&#39;</span></span>
<span id="cb29-113"><a href="#cb29-113" tabindex="-1"></a>    }</span>
<span id="cb29-114"><a href="#cb29-114" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb29-115"><a href="#cb29-115" tabindex="-1"></a>  </span>
<span id="cb29-116"><a href="#cb29-116" tabindex="-1"></a><span class="fu">print</span>(chart)<span class="op">;</span></span></code></pre></div>
</div>
<div id="precipitation-combo-chart" class="section level2">
<h2>Precipitation Combo Chart</h2>
<p>Google Charts also supports <em>Combo Charts</em> - where each series
can be displayed with a different style. Here we create a chart with 2
series - monthly and cumulative precipitation. We can style each series
independently using the <em>style</em> option. The script also shows how
to add a border to the chart and adjust the margins to minimize
whitespace.</p>
<div class="figure" style="text-align: center">
<img src="images/gee_charts/precipitation_combochart.png" alt="Precipitation Combo Chart" width="75%" />
<p class="caption">
Precipitation Combo Chart
</p>
</div>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3ASupplement%2FPrecipitation_ComboChart"
target="_blank">Open in Code Editor ↗</a></p>
<div class="sourceCode" id="cb30"><pre
class="sourceCode js"><code class="sourceCode javascript"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="co">// Plotting Monthly and Cumumlative Rainfall</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a><span class="co">// Select a location</span></span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a><span class="kw">var</span> geometry <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Point</span>(<span class="fl">77.5946</span><span class="op">,</span> <span class="fl">12.9716</span>)</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a><span class="co">// Select a year</span></span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a><span class="kw">var</span> year <span class="op">=</span> <span class="dv">2019</span></span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a><span class="co">// Use the CHIRPS precipitation dataset</span></span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a><span class="kw">var</span> chirps <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&#39;UCSB-CHG/CHIRPS/PENTAD&#39;</span>)<span class="op">;</span></span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a><span class="co">// Create a list of months</span></span>
<span id="cb30-13"><a href="#cb30-13" tabindex="-1"></a><span class="kw">var</span> months <span class="op">=</span> ee<span class="op">.</span><span class="at">List</span><span class="op">.</span><span class="fu">sequence</span>(<span class="dv">1</span><span class="op">,</span> <span class="dv">12</span>)</span>
<span id="cb30-14"><a href="#cb30-14" tabindex="-1"></a></span>
<span id="cb30-15"><a href="#cb30-15" tabindex="-1"></a><span class="co">// Write a function that takes a month number</span></span>
<span id="cb30-16"><a href="#cb30-16" tabindex="-1"></a><span class="co">// and returns a monthly image containing 2 bands</span></span>
<span id="cb30-17"><a href="#cb30-17" tabindex="-1"></a><span class="kw">var</span> createMonthlyImage <span class="op">=</span> <span class="kw">function</span>(month) {</span>
<span id="cb30-18"><a href="#cb30-18" tabindex="-1"></a>  <span class="kw">var</span> yearStartDate <span class="op">=</span> ee<span class="op">.</span><span class="at">Date</span><span class="op">.</span><span class="fu">fromYMD</span>(year<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span>)</span>
<span id="cb30-19"><a href="#cb30-19" tabindex="-1"></a>  <span class="kw">var</span> monthStartDate <span class="op">=</span> ee<span class="op">.</span><span class="at">Date</span><span class="op">.</span><span class="fu">fromYMD</span>(year<span class="op">,</span> month<span class="op">,</span> <span class="dv">1</span>)</span>
<span id="cb30-20"><a href="#cb30-20" tabindex="-1"></a>  <span class="kw">var</span> monthEndDate <span class="op">=</span> monthStartDate<span class="op">.</span><span class="fu">advance</span>(<span class="dv">1</span><span class="op">,</span> <span class="st">&#39;month&#39;</span>)</span>
<span id="cb30-21"><a href="#cb30-21" tabindex="-1"></a>  </span>
<span id="cb30-22"><a href="#cb30-22" tabindex="-1"></a>  <span class="co">// Calculate Rainfall for the month</span></span>
<span id="cb30-23"><a href="#cb30-23" tabindex="-1"></a>  <span class="kw">var</span> monthTotal <span class="op">=</span> chirps</span>
<span id="cb30-24"><a href="#cb30-24" tabindex="-1"></a>    <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">date</span>(monthStartDate<span class="op">,</span> monthEndDate))</span>
<span id="cb30-25"><a href="#cb30-25" tabindex="-1"></a>    <span class="op">.</span><span class="fu">reduce</span>(ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">sum</span>())<span class="op">.</span><span class="fu">rename</span>(<span class="st">&#39;monthly&#39;</span>)</span>
<span id="cb30-26"><a href="#cb30-26" tabindex="-1"></a>  </span>
<span id="cb30-27"><a href="#cb30-27" tabindex="-1"></a>  <span class="co">// Calculate Cumulative Rainfall</span></span>
<span id="cb30-28"><a href="#cb30-28" tabindex="-1"></a>  <span class="kw">var</span> monthCumulative <span class="op">=</span> chirps</span>
<span id="cb30-29"><a href="#cb30-29" tabindex="-1"></a>    <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">date</span>(yearStartDate<span class="op">,</span> monthEndDate))</span>
<span id="cb30-30"><a href="#cb30-30" tabindex="-1"></a>    <span class="op">.</span><span class="fu">reduce</span>(ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">sum</span>())<span class="op">.</span><span class="fu">rename</span>(<span class="st">&#39;cumulative&#39;</span>)<span class="op">;</span></span>
<span id="cb30-31"><a href="#cb30-31" tabindex="-1"></a>  </span>
<span id="cb30-32"><a href="#cb30-32" tabindex="-1"></a>  <span class="kw">var</span> image <span class="op">=</span> ee<span class="op">.</span><span class="at">Image</span><span class="op">.</span><span class="fu">cat</span>([monthTotal<span class="op">,</span> monthCumulative])<span class="op">;</span></span>
<span id="cb30-33"><a href="#cb30-33" tabindex="-1"></a>  <span class="cf">return</span> image<span class="op">.</span><span class="fu">set</span>({</span>
<span id="cb30-34"><a href="#cb30-34" tabindex="-1"></a>    <span class="st">&#39;system:time_start&#39;</span><span class="op">:</span> monthStartDate<span class="op">.</span><span class="fu">millis</span>()<span class="op">,</span></span>
<span id="cb30-35"><a href="#cb30-35" tabindex="-1"></a>    <span class="st">&#39;system:time_end&#39;</span><span class="op">:</span> monthEndDate<span class="op">.</span><span class="fu">millis</span>()<span class="op">,</span></span>
<span id="cb30-36"><a href="#cb30-36" tabindex="-1"></a>    <span class="st">&#39;year&#39;</span><span class="op">:</span> <span class="dv">2019</span><span class="op">,</span></span>
<span id="cb30-37"><a href="#cb30-37" tabindex="-1"></a>    <span class="st">&#39;month&#39;</span><span class="op">:</span> month<span class="op">,</span></span>
<span id="cb30-38"><a href="#cb30-38" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb30-39"><a href="#cb30-39" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb30-40"><a href="#cb30-40" tabindex="-1"></a></span>
<span id="cb30-41"><a href="#cb30-41" tabindex="-1"></a><span class="co">// map() the function on the list  of months</span></span>
<span id="cb30-42"><a href="#cb30-42" tabindex="-1"></a><span class="co">// This creates a list with images for each month in the list</span></span>
<span id="cb30-43"><a href="#cb30-43" tabindex="-1"></a><span class="kw">var</span> monthlyImages <span class="op">=</span> months<span class="op">.</span><span class="fu">map</span>(createMonthlyImage)<span class="op">;</span></span>
<span id="cb30-44"><a href="#cb30-44" tabindex="-1"></a></span>
<span id="cb30-45"><a href="#cb30-45" tabindex="-1"></a><span class="co">// Create an imagecollection</span></span>
<span id="cb30-46"><a href="#cb30-46" tabindex="-1"></a><span class="kw">var</span> monthlyCollection <span class="op">=</span> ee<span class="op">.</span><span class="at">ImageCollection</span><span class="op">.</span><span class="fu">fromImages</span>(monthlyImages)<span class="op">;</span></span>
<span id="cb30-47"><a href="#cb30-47" tabindex="-1"></a><span class="fu">print</span>(monthlyCollection)<span class="op">;</span></span>
<span id="cb30-48"><a href="#cb30-48" tabindex="-1"></a></span>
<span id="cb30-49"><a href="#cb30-49" tabindex="-1"></a><span class="co">// Create a ComboChart</span></span>
<span id="cb30-50"><a href="#cb30-50" tabindex="-1"></a><span class="co">// We will plot monthly rainfall as Bars</span></span>
<span id="cb30-51"><a href="#cb30-51" tabindex="-1"></a><span class="co">// and cumulative rainfall as a Line</span></span>
<span id="cb30-52"><a href="#cb30-52" tabindex="-1"></a><span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">image</span><span class="op">.</span><span class="fu">series</span>({</span>
<span id="cb30-53"><a href="#cb30-53" tabindex="-1"></a>  <span class="dt">imageCollection</span><span class="op">:</span> monthlyCollection<span class="op">,</span></span>
<span id="cb30-54"><a href="#cb30-54" tabindex="-1"></a>  <span class="dt">region</span><span class="op">:</span> geometry<span class="op">,</span></span>
<span id="cb30-55"><a href="#cb30-55" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">mean</span>()<span class="op">,</span></span>
<span id="cb30-56"><a href="#cb30-56" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">5566</span><span class="op">,</span></span>
<span id="cb30-57"><a href="#cb30-57" tabindex="-1"></a>})<span class="op">.</span><span class="fu">setChartType</span>(<span class="st">&#39;ComboChart&#39;</span>)</span>
<span id="cb30-58"><a href="#cb30-58" tabindex="-1"></a>  <span class="op">.</span><span class="fu">setOptions</span>({</span>
<span id="cb30-59"><a href="#cb30-59" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Monthly and Cumulative Rainfall for &#39;</span> <span class="op">+</span> year<span class="op">,</span></span>
<span id="cb30-60"><a href="#cb30-60" tabindex="-1"></a>      <span class="dt">hAxis</span><span class="op">:</span> {</span>
<span id="cb30-61"><a href="#cb30-61" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Month&#39;</span><span class="op">,</span></span>
<span id="cb30-62"><a href="#cb30-62" tabindex="-1"></a>        <span class="dt">titleTextStyle</span><span class="op">:</span> {<span class="dt">fontSize</span><span class="op">:</span> <span class="dv">18</span>}<span class="op">,</span></span>
<span id="cb30-63"><a href="#cb30-63" tabindex="-1"></a>        <span class="dt">format</span><span class="op">:</span> <span class="st">&#39;MMM&#39;</span><span class="op">,</span> <span class="co">// Display the month name</span></span>
<span id="cb30-64"><a href="#cb30-64" tabindex="-1"></a>        <span class="dt">ticks</span><span class="op">:</span> [</span>
<span id="cb30-65"><a href="#cb30-65" tabindex="-1"></a>          <span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2019</span><span class="op">,</span> <span class="dv">0</span>)<span class="op">,</span></span>
<span id="cb30-66"><a href="#cb30-66" tabindex="-1"></a>          <span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2019</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">,</span></span>
<span id="cb30-67"><a href="#cb30-67" tabindex="-1"></a>          <span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2019</span><span class="op">,</span> <span class="dv">2</span>)<span class="op">,</span></span>
<span id="cb30-68"><a href="#cb30-68" tabindex="-1"></a>          <span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2019</span><span class="op">,</span> <span class="dv">3</span>)<span class="op">,</span></span>
<span id="cb30-69"><a href="#cb30-69" tabindex="-1"></a>          <span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2019</span><span class="op">,</span> <span class="dv">4</span>)<span class="op">,</span></span>
<span id="cb30-70"><a href="#cb30-70" tabindex="-1"></a>          <span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2019</span><span class="op">,</span> <span class="dv">5</span>)<span class="op">,</span></span>
<span id="cb30-71"><a href="#cb30-71" tabindex="-1"></a>          <span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2019</span><span class="op">,</span> <span class="dv">6</span>)<span class="op">,</span></span>
<span id="cb30-72"><a href="#cb30-72" tabindex="-1"></a>          <span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2019</span><span class="op">,</span> <span class="dv">7</span>)<span class="op">,</span></span>
<span id="cb30-73"><a href="#cb30-73" tabindex="-1"></a>          <span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2019</span><span class="op">,</span> <span class="dv">8</span>)<span class="op">,</span></span>
<span id="cb30-74"><a href="#cb30-74" tabindex="-1"></a>          <span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2019</span><span class="op">,</span> <span class="dv">9</span>)<span class="op">,</span></span>
<span id="cb30-75"><a href="#cb30-75" tabindex="-1"></a>          <span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2019</span><span class="op">,</span> <span class="dv">10</span>)<span class="op">,</span></span>
<span id="cb30-76"><a href="#cb30-76" tabindex="-1"></a>          <span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2019</span><span class="op">,</span> <span class="dv">11</span>)<span class="op">,</span></span>
<span id="cb30-77"><a href="#cb30-77" tabindex="-1"></a>          <span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2019</span><span class="op">,</span> <span class="dv">12</span>)<span class="op">,</span></span>
<span id="cb30-78"><a href="#cb30-78" tabindex="-1"></a>          ]</span>
<span id="cb30-79"><a href="#cb30-79" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb30-80"><a href="#cb30-80" tabindex="-1"></a>      <span class="dt">vAxes</span><span class="op">:</span> {</span>
<span id="cb30-81"><a href="#cb30-81" tabindex="-1"></a>        <span class="dv">0</span><span class="op">:</span> {</span>
<span id="cb30-82"><a href="#cb30-82" tabindex="-1"></a>          <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Monthly Rainfall Depth (mm)&#39;</span><span class="op">,</span> </span>
<span id="cb30-83"><a href="#cb30-83" tabindex="-1"></a>          <span class="dt">gridlines</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;none&#39;</span>}<span class="op">,</span></span>
<span id="cb30-84"><a href="#cb30-84" tabindex="-1"></a>          <span class="dt">viewWindow</span><span class="op">:</span> {<span class="dt">min</span><span class="op">:</span><span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">1200</span>}</span>
<span id="cb30-85"><a href="#cb30-85" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb30-86"><a href="#cb30-86" tabindex="-1"></a>        <span class="dv">1</span><span class="op">:</span> {</span>
<span id="cb30-87"><a href="#cb30-87" tabindex="-1"></a>          <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Cumulative Rainfall Depth (mm)&#39;</span><span class="op">,</span> </span>
<span id="cb30-88"><a href="#cb30-88" tabindex="-1"></a>          <span class="dt">viewWindow</span><span class="op">:</span> {<span class="dt">min</span><span class="op">:</span><span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">1200</span>}<span class="op">,</span></span>
<span id="cb30-89"><a href="#cb30-89" tabindex="-1"></a>          </span>
<span id="cb30-90"><a href="#cb30-90" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb30-91"><a href="#cb30-91" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb30-92"><a href="#cb30-92" tabindex="-1"></a>      <span class="dt">seriesType</span><span class="op">:</span> <span class="st">&#39;line&#39;</span><span class="op">,</span></span>
<span id="cb30-93"><a href="#cb30-93" tabindex="-1"></a>      <span class="dt">series</span><span class="op">:</span> {</span>
<span id="cb30-94"><a href="#cb30-94" tabindex="-1"></a>        <span class="dv">0</span><span class="op">:</span> {</span>
<span id="cb30-95"><a href="#cb30-95" tabindex="-1"></a>          <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;line&#39;</span><span class="op">,</span></span>
<span id="cb30-96"><a href="#cb30-96" tabindex="-1"></a>          <span class="dt">pointShape</span><span class="op">:</span> <span class="st">&#39;triangle&#39;</span><span class="op">,</span></span>
<span id="cb30-97"><a href="#cb30-97" tabindex="-1"></a>          <span class="dt">pointSize</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span></span>
<span id="cb30-98"><a href="#cb30-98" tabindex="-1"></a>          <span class="dt">lineWidth</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb30-99"><a href="#cb30-99" tabindex="-1"></a>          <span class="dt">lineDashStyle</span><span class="op">:</span> [<span class="dv">4</span><span class="op">,</span> <span class="dv">4</span>]<span class="op">,</span></span>
<span id="cb30-100"><a href="#cb30-100" tabindex="-1"></a>          <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;#252525&#39;</span><span class="op">,</span></span>
<span id="cb30-101"><a href="#cb30-101" tabindex="-1"></a>          <span class="dt">targetAxisIndex</span><span class="op">:</span> <span class="dv">1</span></span>
<span id="cb30-102"><a href="#cb30-102" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb30-103"><a href="#cb30-103" tabindex="-1"></a>        <span class="dv">1</span><span class="op">:</span> {</span>
<span id="cb30-104"><a href="#cb30-104" tabindex="-1"></a>          <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;bars&#39;</span><span class="op">,</span></span>
<span id="cb30-105"><a href="#cb30-105" tabindex="-1"></a>          <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;#737373&#39;</span><span class="op">,</span></span>
<span id="cb30-106"><a href="#cb30-106" tabindex="-1"></a>          <span class="dt">targetAxisIndex</span><span class="op">:</span> <span class="dv">0</span></span>
<span id="cb30-107"><a href="#cb30-107" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb30-108"><a href="#cb30-108" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb30-109"><a href="#cb30-109" tabindex="-1"></a>      <span class="dt">legend</span><span class="op">:</span> {</span>
<span id="cb30-110"><a href="#cb30-110" tabindex="-1"></a>        <span class="dt">position</span><span class="op">:</span> <span class="st">&#39;top&#39;</span><span class="op">,</span></span>
<span id="cb30-111"><a href="#cb30-111" tabindex="-1"></a>        <span class="dt">alignment</span><span class="op">:</span> <span class="st">&#39;end&#39;</span></span>
<span id="cb30-112"><a href="#cb30-112" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb30-113"><a href="#cb30-113" tabindex="-1"></a>      <span class="dt">backgroundColor</span><span class="op">:</span> {</span>
<span id="cb30-114"><a href="#cb30-114" tabindex="-1"></a>          <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">1</span></span>
<span id="cb30-115"><a href="#cb30-115" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb30-116"><a href="#cb30-116" tabindex="-1"></a>      <span class="dt">chartArea</span><span class="op">:</span> {</span>
<span id="cb30-117"><a href="#cb30-117" tabindex="-1"></a>        <span class="dt">width</span><span class="op">:</span> <span class="st">&#39;80%&#39;</span><span class="op">,</span></span>
<span id="cb30-118"><a href="#cb30-118" tabindex="-1"></a>        <span class="dt">height</span><span class="op">:</span> <span class="st">&#39;80%&#39;</span></span>
<span id="cb30-119"><a href="#cb30-119" tabindex="-1"></a>      }</span>
<span id="cb30-120"><a href="#cb30-120" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb30-121"><a href="#cb30-121" tabindex="-1"></a><span class="fu">print</span>(chart)<span class="op">;</span></span></code></pre></div>
</div>
<div id="transect-chart" class="section level2">
<h2>Transect Chart</h2>
<p>You can sample values from an image along a line transect and
generate a FeatureCollection with latitude, longitude and DN values.
This can be then plotted to create a transect chart like below.</p>
<p><img src="images/gee_charts/transect.png" width="75%" style="display: block; margin: auto;" /></p>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3ASupplement%2FTransect_Chart"
target="_blank">Open in Code Editor ↗</a></p>
<div class="sourceCode" id="cb31"><pre
class="sourceCode js"><code class="sourceCode javascript"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="kw">var</span> transect <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">LineString</span>([</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>  [<span class="fl">139.0</span><span class="op">,</span> <span class="fl">35.67</span>]<span class="op">,</span></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>  [<span class="fl">140.5</span><span class="op">,</span> <span class="fl">35.67</span>]</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>])<span class="op">;</span></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a><span class="co">// Get VIIRS Annual NightTime Lights Image</span></span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a><span class="kw">var</span> ntlCollection <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&#39;NOAA/VIIRS/DNB/ANNUAL_V21&#39;</span>)<span class="op">;</span></span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a><span class="kw">var</span> band <span class="op">=</span> <span class="st">&#39;average&#39;</span><span class="op">;</span></span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a><span class="co">// Select a year</span></span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a><span class="kw">var</span> year <span class="op">=</span> <span class="dv">2021</span><span class="op">;</span></span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a><span class="kw">var</span> startDate <span class="op">=</span> ee<span class="op">.</span><span class="at">Date</span><span class="op">.</span><span class="fu">fromYMD</span>(year<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a><span class="kw">var</span> endDate <span class="op">=</span> startDate<span class="op">.</span><span class="fu">advance</span>(<span class="dv">1</span><span class="op">,</span> <span class="st">&#39;year&#39;</span>)<span class="op">;</span></span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a><span class="kw">var</span> image <span class="op">=</span> ntlCollection</span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">date</span>(startDate<span class="op">,</span> endDate))</span>
<span id="cb31-16"><a href="#cb31-16" tabindex="-1"></a>  <span class="op">.</span><span class="fu">select</span>(band)</span>
<span id="cb31-17"><a href="#cb31-17" tabindex="-1"></a>  <span class="op">.</span><span class="fu">first</span>()<span class="op">;</span></span>
<span id="cb31-18"><a href="#cb31-18" tabindex="-1"></a><span class="co">// Rename the band to &#39;DN&#39;</span></span>
<span id="cb31-19"><a href="#cb31-19" tabindex="-1"></a><span class="kw">var</span> image <span class="op">=</span> image<span class="op">.</span><span class="fu">rename</span>(<span class="st">&#39;DN&#39;</span>)<span class="op">;</span></span>
<span id="cb31-20"><a href="#cb31-20" tabindex="-1"></a><span class="kw">var</span> resolution <span class="op">=</span> image<span class="op">.</span><span class="fu">projection</span>()<span class="op">.</span><span class="fu">nominalScale</span>()<span class="op">;</span></span>
<span id="cb31-21"><a href="#cb31-21" tabindex="-1"></a><span class="co">// Visualize the Image</span></span>
<span id="cb31-22"><a href="#cb31-22" tabindex="-1"></a><span class="kw">var</span> palette <span class="op">=</span>  [<span class="st">&#39;000000&#39;</span><span class="op">,</span> <span class="st">&#39;584d9f&#39;</span><span class="op">,</span><span class="st">&#39;9c79c1&#39;</span><span class="op">,</span><span class="st">&#39;c98cbe&#39;</span><span class="op">,</span><span class="st">&#39;f2d192&#39;</span><span class="op">,</span><span class="st">&#39;e2ee82&#39;</span>]<span class="op">;</span></span>
<span id="cb31-23"><a href="#cb31-23" tabindex="-1"></a><span class="kw">var</span> visParams <span class="op">=</span> {<span class="dt">min</span><span class="op">:</span> <span class="fl">0.0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="fl">80.0</span><span class="op">,</span> <span class="dt">palette</span><span class="op">:</span> palette}</span>
<span id="cb31-24"><a href="#cb31-24" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">centerObject</span>(transect)<span class="op">;</span></span>
<span id="cb31-25"><a href="#cb31-25" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(image<span class="op">,</span> visParams<span class="op">,</span> <span class="st">&#39;Night Lights &#39;</span> <span class="op">+</span> year)<span class="op">;</span></span>
<span id="cb31-26"><a href="#cb31-26" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(transect<span class="op">,</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;red&#39;</span>}<span class="op">,</span> <span class="st">&#39;transect&#39;</span>)<span class="op">;</span></span>
<span id="cb31-27"><a href="#cb31-27" tabindex="-1"></a></span>
<span id="cb31-28"><a href="#cb31-28" tabindex="-1"></a><span class="co">// Generate Points along Line</span></span>
<span id="cb31-29"><a href="#cb31-29" tabindex="-1"></a><span class="kw">var</span> projection <span class="op">=</span> <span class="st">&#39;EPSG:4326&#39;</span> <span class="co">// WGS84</span></span>
<span id="cb31-30"><a href="#cb31-30" tabindex="-1"></a><span class="kw">var</span> interval <span class="op">=</span> <span class="fl">0.01</span> <span class="co">// Degrees</span></span>
<span id="cb31-31"><a href="#cb31-31" tabindex="-1"></a><span class="kw">var</span> tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">;</span></span>
<span id="cb31-32"><a href="#cb31-32" tabindex="-1"></a><span class="kw">var</span> totalLength <span class="op">=</span> transect<span class="op">.</span><span class="fu">length</span>({<span class="dt">proj</span><span class="op">:</span> projection<span class="op">,</span> <span class="dt">maxError</span><span class="op">:</span> tolerance})<span class="op">;</span></span>
<span id="cb31-33"><a href="#cb31-33" tabindex="-1"></a><span class="kw">var</span> distances <span class="op">=</span> ee<span class="op">.</span><span class="at">List</span><span class="op">.</span><span class="fu">sequence</span>(<span class="dv">0</span><span class="op">,</span> totalLength<span class="op">,</span> interval)<span class="op">;</span></span>
<span id="cb31-34"><a href="#cb31-34" tabindex="-1"></a></span>
<span id="cb31-35"><a href="#cb31-35" tabindex="-1"></a><span class="co">// Divide the line into segments of equal length</span></span>
<span id="cb31-36"><a href="#cb31-36" tabindex="-1"></a><span class="kw">var</span> parts <span class="op">=</span> transect<span class="op">.</span><span class="fu">cutLines</span>({</span>
<span id="cb31-37"><a href="#cb31-37" tabindex="-1"></a>  <span class="dt">distances</span><span class="op">:</span> distances<span class="op">,</span></span>
<span id="cb31-38"><a href="#cb31-38" tabindex="-1"></a>  <span class="dt">proj</span><span class="op">:</span> projection<span class="op">,</span></span>
<span id="cb31-39"><a href="#cb31-39" tabindex="-1"></a>  <span class="dt">maxError</span><span class="op">:</span> tolerance})<span class="op">;</span></span>
<span id="cb31-40"><a href="#cb31-40" tabindex="-1"></a></span>
<span id="cb31-41"><a href="#cb31-41" tabindex="-1"></a><span class="co">// The result is a MultiLine geometry</span></span>
<span id="cb31-42"><a href="#cb31-42" tabindex="-1"></a><span class="co">// Get the individual geometries and create a point</span></span>
<span id="cb31-43"><a href="#cb31-43" tabindex="-1"></a><span class="co">// from the start point of each line segment</span></span>
<span id="cb31-44"><a href="#cb31-44" tabindex="-1"></a><span class="kw">var</span> points <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(parts<span class="op">.</span><span class="fu">geometries</span>()<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(part) {</span>
<span id="cb31-45"><a href="#cb31-45" tabindex="-1"></a>  <span class="kw">var</span> startPoint <span class="op">=</span> ee<span class="op">.</span><span class="fu">Geometry</span>(part)<span class="op">.</span><span class="fu">coordinates</span>()<span class="op">.</span><span class="fu">get</span>(<span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb31-46"><a href="#cb31-46" tabindex="-1"></a>  <span class="kw">var</span> point <span class="op">=</span> ee<span class="op">.</span><span class="at">Algorithms</span><span class="op">.</span><span class="at">GeometryConstructors</span><span class="op">.</span><span class="fu">Point</span>(startPoint)<span class="op">;</span></span>
<span id="cb31-47"><a href="#cb31-47" tabindex="-1"></a>  <span class="kw">var</span> coords <span class="op">=</span> point<span class="op">.</span><span class="fu">coordinates</span>()<span class="op">;</span> </span>
<span id="cb31-48"><a href="#cb31-48" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">new</span> ee<span class="op">.</span><span class="fu">Feature</span>(point<span class="op">,</span> {<span class="st">&#39;lat&#39;</span><span class="op">:</span> coords<span class="op">.</span><span class="fu">get</span>(<span class="dv">1</span>)<span class="op">,</span> <span class="st">&#39;lon&#39;</span><span class="op">:</span> coords<span class="op">.</span><span class="fu">get</span>(<span class="dv">0</span>)})<span class="op">;</span></span>
<span id="cb31-49"><a href="#cb31-49" tabindex="-1"></a>}))<span class="op">;</span></span>
<span id="cb31-50"><a href="#cb31-50" tabindex="-1"></a></span>
<span id="cb31-51"><a href="#cb31-51" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(points<span class="op">,</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;cyan&#39;</span>}<span class="op">,</span> <span class="st">&#39;Points along transect&#39;</span>)<span class="op">;</span></span>
<span id="cb31-52"><a href="#cb31-52" tabindex="-1"></a></span>
<span id="cb31-53"><a href="#cb31-53" tabindex="-1"></a><span class="co">// Extract the pixel values at each point</span></span>
<span id="cb31-54"><a href="#cb31-54" tabindex="-1"></a><span class="kw">var</span> samples <span class="op">=</span> image<span class="op">.</span><span class="fu">sampleRegions</span>({</span>
<span id="cb31-55"><a href="#cb31-55" tabindex="-1"></a>  <span class="dt">collection</span><span class="op">:</span> points<span class="op">,</span></span>
<span id="cb31-56"><a href="#cb31-56" tabindex="-1"></a>  <span class="dt">properties</span><span class="op">:</span> [<span class="st">&#39;lat&#39;</span><span class="op">,</span> <span class="st">&#39;lon&#39;</span>]<span class="op">,</span></span>
<span id="cb31-57"><a href="#cb31-57" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> resolution<span class="op">,</span></span>
<span id="cb31-58"><a href="#cb31-58" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb31-59"><a href="#cb31-59" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;Extracted Values&#39;</span><span class="op">,</span> samples<span class="op">.</span><span class="fu">first</span>())<span class="op">;</span></span>
<span id="cb31-60"><a href="#cb31-60" tabindex="-1"></a></span>
<span id="cb31-61"><a href="#cb31-61" tabindex="-1"></a><span class="co">// Plot the results</span></span>
<span id="cb31-62"><a href="#cb31-62" tabindex="-1"></a><span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">feature</span><span class="op">.</span><span class="fu">byFeature</span>({</span>
<span id="cb31-63"><a href="#cb31-63" tabindex="-1"></a>  <span class="dt">features</span><span class="op">:</span> samples<span class="op">,</span></span>
<span id="cb31-64"><a href="#cb31-64" tabindex="-1"></a>  <span class="dt">xProperty</span><span class="op">:</span> <span class="st">&#39;lon&#39;</span><span class="op">,</span></span>
<span id="cb31-65"><a href="#cb31-65" tabindex="-1"></a>  <span class="dt">yProperties</span><span class="op">:</span> <span class="st">&#39;DN&#39;</span></span>
<span id="cb31-66"><a href="#cb31-66" tabindex="-1"></a>})<span class="op">.</span><span class="fu">setChartType</span>(<span class="st">&#39;AreaChart&#39;</span>)</span>
<span id="cb31-67"><a href="#cb31-67" tabindex="-1"></a>  <span class="op">.</span><span class="fu">setOptions</span>({</span>
<span id="cb31-68"><a href="#cb31-68" tabindex="-1"></a>    <span class="dt">lineWidth</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb31-69"><a href="#cb31-69" tabindex="-1"></a>    <span class="dt">pointSize</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb31-70"><a href="#cb31-70" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Latitudinal Transect of Night Time Lights&#39;</span><span class="op">,</span></span>
<span id="cb31-71"><a href="#cb31-71" tabindex="-1"></a>    <span class="dt">titleTextStyle</span><span class="op">:</span> {<span class="dt">fontSize</span><span class="op">:</span> <span class="dv">18</span>}<span class="op">,</span></span>
<span id="cb31-72"><a href="#cb31-72" tabindex="-1"></a>    <span class="dt">vAxis</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">&#39;DN&#39;</span><span class="op">,</span> <span class="dt">gridlines</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;transparent&#39;</span>}}<span class="op">,</span></span>
<span id="cb31-73"><a href="#cb31-73" tabindex="-1"></a>    <span class="dt">hAxis</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Longitude&#39;</span><span class="op">,</span> <span class="dt">gridlines</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;transparent&#39;</span>}}<span class="op">,</span></span>
<span id="cb31-74"><a href="#cb31-74" tabindex="-1"></a>    <span class="dt">series</span><span class="op">:</span> {</span>
<span id="cb31-75"><a href="#cb31-75" tabindex="-1"></a>      <span class="dv">0</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;blue&#39;</span>}<span class="op">,</span></span>
<span id="cb31-76"><a href="#cb31-76" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb31-77"><a href="#cb31-77" tabindex="-1"></a>    <span class="dt">legend</span><span class="op">:</span> {<span class="dt">position</span><span class="op">:</span> <span class="st">&#39;none&#39;</span>}<span class="op">,</span></span>
<span id="cb31-78"><a href="#cb31-78" tabindex="-1"></a>    <span class="dt">curveType</span><span class="op">:</span> <span class="st">&#39;function&#39;</span><span class="op">,</span></span>
<span id="cb31-79"><a href="#cb31-79" tabindex="-1"></a>    <span class="dt">chartArea</span><span class="op">:</span> {<span class="dt">left</span><span class="op">:</span> <span class="dv">100</span><span class="op">,</span> <span class="dt">right</span><span class="op">:</span> <span class="dv">100</span>}<span class="op">,</span></span>
<span id="cb31-80"><a href="#cb31-80" tabindex="-1"></a>    <span class="dt">backgroundColor</span><span class="op">:</span> <span class="st">&#39;transparent&#39;</span></span>
<span id="cb31-81"><a href="#cb31-81" tabindex="-1"></a>  })</span>
<span id="cb31-82"><a href="#cb31-82" tabindex="-1"></a><span class="fu">print</span>(chart)<span class="op">;</span></span>
<span id="cb31-83"><a href="#cb31-83" tabindex="-1"></a>  </span></code></pre></div>
</div>
<div id="logo-chart" class="section level2">
<h2>Logo Chart</h2>
<p>A Table chart allows you to add an image along with any
HTML-formatted text. You can use this to display a logo and a
description along with a chart in your app.</p>
<p><img src="images/gee_charts/logo_chart.png" width="75%" style="display: block; margin: auto;" /></p>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3ASupplement%2FLogo_Chart"
target="_blank">Open in Code Editor ↗</a></p>
<div class="sourceCode" id="cb32"><pre
class="sourceCode js"><code class="sourceCode javascript"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="co">// Example script showing how to add logo to a chart</span></span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a><span class="co">// Your logo needs to be converted to a Data URI</span></span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a><span class="co">// i.e. the image is converted as an base64 encoded string</span></span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a><span class="co">// Use a converter such as https://onlinepngtools.com/convert-png-to-data-uri</span></span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a><span class="kw">var</span> logoString <span class="op">=</span> <span class="st">&#39;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAALiMAAC4jAXilP3YAAAvzSURBVHhe7Z15dFTVHce/M5nJZLJhJgtmJwHZV1EWjUelWg+oFYWCPZx6qD3uiNJK3f3D01OqLS4QBaPi0lZRVNQerQqC4hYUgUAWMAtJyL6HJLO82Xp/d26YLDMhk/cmDOe8T847ub87793MfOd3998FjdPp7AagZ5dK4NhJQJtGowkXGSoB4Ha7Ja1Iq4wQVUCZqALKRBVQJqqAMlEFlIkqoExUAWWiCigTVUCZqALKZNTnwi63C4VtR1DQehi1PSdhcVgQEWZEalQqZsbPZtcsaDVh4u7QhubCoyrg3tov8XbZv9BobhA5g0k0JuHmCavwq7RfQ8N+QplRE9DqtOCZgqexv/EHkXNm5iZejAdmP4RIXZTICT1GRUDJacMTPz2CkvYikTN8LhgzCX+d/xSr4hEiJ7QYleWsvOItIxKPKO08jhcLNwkrNAmqB5JwD+X/WVheYvSxuCn7t5g/diFMhni029rwY1M+PqjYgU6pQ9zl5cl5GzArfo6wQoege+D7Fe+KlJe06HQ8n/MiFzA1Kg1GnREprAdemrWM5W9BZkyWuNPL++WDywkVgiZgj6MHB5sPCMuDTqvDwxc+gfiIBJHTnzhDHB5hr4dr+1eII20FPj0zFAiagKUdx+F0O4XlYeHYHKRFpQvLN+dHJuOylCuE5cHNxo7HO44JyzfVFhdyKyT84ZAFi3/owXX5PbizwILXqyW0SW5xl/IETcAmS6NIeZlumiFSQzPNx32+yiOqzC6sPGBG9q4urD1qwRtMsM+bHPi00YG8Sgm3MkHTvujCfey1DrvyQgZNQMcA7yMMYQaRGhqDdvB9TpdDpLx83GDHrL3d2FFrZzMckekDq9ONzcw7Z7N7D3cOfl9yCJqAsaynHUgNm7oNB5riDSQmfIxIeSDxlv9oxinH8L2Kqvmi73pw9JRyIgZNwKzYbJHysq/uKzhcdmH5htrNr+r2CMtLVp/euZJV29//bGFeLjICgKoxCW9mXqkEQROQhijJkSnC8kDt2BvHtwnLN2+Vvom6nlpheUiISMS4Pl/I+iIrukainqC0x4WNZZKw5BE0AYklmdeJlJePK3di09FncErqFDkeuuxdfNbxXvk7IsfL4oxrTy8skPftrB/ai4dDboUNkksYMgjqTMTqtOKOr1ejwzZ4DKdnY70pcVM9MxGpjc9aJOdgr4jRxyDvitdPLyo8X27DukIrT8tl96VRWJSgE1bgBH0mQosAK8evElZ/7C4JR1oPs/buSxS0HPIpHrF8/Mp+KzIHOpTrAA60yy8rqAIS12QsQUZ0prACg9rQazNvEJaHBpsyjT+hRFlBFzBME4Y7pt0zosVRek6v7R95p+QSqxIfPugCEtNNM3FV+jXCGh6XpyzCnIS5wvKSblTuLacZ5X8doyIgcevk25DIhiPDIc5gwm1T7xJWf+bHKbdfsiBu5B1IL6MmIHUE9818AKzHFzm+oap+74x1vPf1xdJkPcIVeNeZkVrMU+DLUFxAl9uBblsdzFIj3OynLzPiZ2FZ1gph+eb6cUv5fog/kgwarM6QP+paP8EArQINqmLjQJujE0cbXkd1+142XbPwvAhdHCYkXI/JSSvYm/V0BjRVe2z/X1DsY5mf9kD+vuCf0A3oOAbSIrn5IkK9dWQjYWoGvrksGjqZAiq2qdQjNWBv+XrmdU0ipz8JUdNxefbfECZWWdqsrVj3/Ro2wG7nNhEbHotnLsnl25rD4Uc2hrv6+56Ap3TjWNX9JicKqQp0RgoNpN3Ir9rgVzyipacQBfWvCAswRcTjwTmP8RVqgoY662c/MmzxCGq/9rCZBLVlw4We2aeQeL3ILqmpuwCt5qFXi4mK1k8hOU4JC5gaNw13TlvD03+ccgePSgiUueeF4ciV0Xh4ogFxev/1kYY+z88w4ltWbdMUFI+QXYWLGt5EUeN/hDU0OVlPIiV2vrA8VHadwDgfG0mBQs3hVy0O/Mymeg3MoA6ChFvAvG6hSce8XNyoIIq0gYfrtuKX5p3CGpr5GQ8iM26RsPxT3mjBjvwmHDzRhU6zA3HRelyUHYMVC5KQkRA6m+yKCFja8iEO1W4R1tAsmvAs61CmCmswVrsLj26vwGtf18PlY41ex9zo7qtT8fiyLOiD4VIBokgnkhq7kA2OzzwgjdQnIj5ykrAGY5VcuGnjUby6t86neITD6camz2qwanMRT4cCsgWMDB+LSYnLheWf2al3Din0o+9U4Ptf+i+y+uOLI23Y8FGVsM4uinRJM5JXswHzb4TVHxpAz01bi7QxOSJnMNTmUbUNhFzmiQ0dyizLy0GxmQhBw5nKtl04Zati34wOpsiJyIpfjOjwZHGHb8ibnhqBR2343XjcxdrEs4ViMxG5rHiukFfLQKFeOe/2ycIafRSaicingw1VRsJIn1OSkBDQFDWy894mNj4824SEgBeN9732dyZocH22CQkBqS2jQXIgGMO1WHrx8Fa4g0lICEjTs0B70weuy0BCjFqFT/MEm55dPdMkrKG5aV4i1l07dJzhaBESw5he7Gx6tuHDKuR+XgPJMXi1maoteR6Jpz3D3spoEDLjwIHQDGPnT82DVmNuZG1eKFTbXkJWwHOFkBlIn8sM6YHF7YX8DMfM+Dl+92mHA+3E0TUw+r6XBnM9TBHJ2Nvi6LcRmhiuQXaUFlYnkByhbJtX3OXC1Bh5/jOkB+4o346T3dX8UMxLRbnottO/EDV8jnUU41h7MU+Xdf4y6MhDX+iAjdXlxqFOJ75tdeDeIxYc6nDiWLcL/2t04K0a5VddbvnZLFJevmF/e0ddYLGHfgWkaNIrU6/imz33z1yPKL0nxIy85aMTH+CHxu9Ob5xLLgm7a77Ap1X/RZf9FPe2gpbDONx6EM2WZn50ITNmHL+3U+rEJ1UfY0/tbtj7hPvG6jR46AID7htv4DtttFG0Ks3TYTRJbmyqkPAe+3C9Hkqx0S9XSfzq3drc1exgZfIkj4OmmGiCIlKfK7fhw3rv8/T7owY7jzestbq4vZs9v6vJgZPsOVqv3V5r58HpNaIcX/gVkE4SvVK8FdtK8pg3lfCQCxJvR/nbuOT8HG5vL/03v3cr89CM6AweebC16AUuDG1V0qXVaFHbU4MS5o10avPl4i2YnXAhkpmoecUv8ufPxJfsg13AqjIdXyAhaMH6+nwzDOzd03XDfjPoIz5bZkObOMpAxxz2tzlRxsRbfdCMidFhyG934vEST3Bmvc2Fk2Y3zo/Q8rKYiSabG+3s+U52vXFS4s9TE/JqtX+v9CsgxebdPX0tbpl0K75r2Ifqrkp+nu2GrGV8/3bB2EvQxtpHOkEUb4jHxPMmI52JeHHSPF5lM2Iy+bGt+Ih4USJrd9qKkJN8GY+fnhI3DcYwI8yOwVVpIDen6rF4rA6PMa/c1+rkHkUb5Lekh/MrlbWP5SzPF58wL1uTZcAS9vyGqRHcy4hkpvya7HCsZGVnsbIoyoGiVWkXb3psGHJMOhzvcfJw4iVJ/oOQ/Aq4p3YX/02b35POm4JWWyv3LBKSoDRF3FPQUIu1hecRVV1V/DWK66MQ374kGhPZ870Lp25UdVfyMgbG0Aykt/ugUAzyPoqPKWMfjmKc6aowu5DEOpxEJkpptyfqlKohQZvo1LYSJ5jIzT6CKnvLpaCl3mMTEst496JIPDnZgNsLPKEqvvArYDTrdTcd3YgtRZu5R/VufJd1lmLbsTxWVTfjxqzlXKhLmVe9UPgcXi15if1hGz9ASKeNKHT367o9/Eh/FBM6PTqTtaXReKn4BbxcspWfmaMvKMk49vTRBlajkN0n2sDEhfFIGBGmQYZRwzfR12Yb+JEuuu5n6TEs71HmoY8fs/G8aoubP3tjsp63kRQGkntCQoIoa1K092/QZnskK/uqRB3fV/4HawoqWfWmpmH1QcvpttgXAQ2kqbekqkunK88VKpjXvVYt4U8TDLyD+Ixd2+YYxavyCHggnRKVwqpspLDODagTmBIThntYNaSeefMMZTfm1amcDNSpnAKoAspEFVAmqoAyUQWUiSqgTFQBZaIKKBNVQJmoAspEFVAmNBdW/zuMEQP7/wGOmgqkDqIi/QAAAABJRU5ErkJggg==&#39;</span></span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a> <span class="kw">var</span> dataTable <span class="op">=</span> {</span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a>  <span class="dt">cols</span><span class="op">:</span> [</span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a>    {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;logo&#39;</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">&#39;&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;string&#39;</span>}<span class="op">,</span></span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a>  ]<span class="op">,</span></span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a>  <span class="dt">rows</span><span class="op">:</span> [</span>
<span id="cb32-12"><a href="#cb32-12" tabindex="-1"></a>    {<span class="dt">c</span><span class="op">:</span> [ {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;&lt;img src=&#39;</span> <span class="op">+</span> logoString <span class="op">+</span> <span class="st">&#39;&gt;&#39;</span>}]}<span class="op">,</span></span>
<span id="cb32-13"><a href="#cb32-13" tabindex="-1"></a>    {<span class="dt">c</span><span class="op">:</span> [ {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;A chart with a logo and description.&#39;</span>}]}</span>
<span id="cb32-14"><a href="#cb32-14" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" tabindex="-1"></a>    ]</span>
<span id="cb32-16"><a href="#cb32-16" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb32-17"><a href="#cb32-17" tabindex="-1"></a><span class="kw">var</span> logoChart <span class="op">=</span> ui<span class="op">.</span><span class="fu">Chart</span>(dataTable<span class="op">,</span> <span class="st">&#39;Table&#39;</span>)</span>
<span id="cb32-18"><a href="#cb32-18" tabindex="-1"></a>  <span class="op">.</span><span class="fu">setOptions</span>({</span>
<span id="cb32-19"><a href="#cb32-19" tabindex="-1"></a>    <span class="dt">allowHtml</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> </span>
<span id="cb32-20"><a href="#cb32-20" tabindex="-1"></a>    <span class="dt">alternatingRowStyle</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb32-21"><a href="#cb32-21" tabindex="-1"></a>    <span class="dt">width</span><span class="op">:</span><span class="st">&#39;100&#39;</span>})</span>
<span id="cb32-22"><a href="#cb32-22" tabindex="-1"></a><span class="op">;</span></span>
<span id="cb32-23"><a href="#cb32-23" tabindex="-1"></a></span>
<span id="cb32-24"><a href="#cb32-24" tabindex="-1"></a><span class="co">// Create a Chart </span></span>
<span id="cb32-25"><a href="#cb32-25" tabindex="-1"></a></span>
<span id="cb32-26"><a href="#cb32-26" tabindex="-1"></a><span class="co">// We will create a chart showing some data points</span></span>
<span id="cb32-27"><a href="#cb32-27" tabindex="-1"></a></span>
<span id="cb32-28"><a href="#cb32-28" tabindex="-1"></a><span class="kw">var</span> data <span class="op">=</span> ee<span class="op">.</span><span class="fu">List</span>([[<span class="dv">1</span><span class="op">,</span><span class="dv">4</span>]<span class="op">,</span> [<span class="dv">2</span><span class="op">,</span><span class="dv">5</span>]<span class="op">,</span> [<span class="dv">3</span><span class="op">,</span><span class="dv">7</span>]<span class="op">,</span> [<span class="dv">4</span><span class="op">,</span><span class="dv">8</span>]<span class="op">,</span> [<span class="dv">5</span><span class="op">,</span><span class="dv">12</span>]])</span>
<span id="cb32-29"><a href="#cb32-29" tabindex="-1"></a></span>
<span id="cb32-30"><a href="#cb32-30" tabindex="-1"></a><span class="co">// Convert x and y variable to lists</span></span>
<span id="cb32-31"><a href="#cb32-31" tabindex="-1"></a><span class="kw">var</span> x <span class="op">=</span> data<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(element) { <span class="cf">return</span> ee<span class="op">.</span><span class="fu">List</span>(element)<span class="op">.</span><span class="fu">get</span>(<span class="dv">0</span>)})<span class="op">;</span></span>
<span id="cb32-32"><a href="#cb32-32" tabindex="-1"></a><span class="kw">var</span> y <span class="op">=</span> data<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(element) { <span class="cf">return</span> ee<span class="op">.</span><span class="fu">List</span>(element)<span class="op">.</span><span class="fu">get</span>(<span class="dv">1</span>)})<span class="op">;</span></span>
<span id="cb32-33"><a href="#cb32-33" tabindex="-1"></a></span>
<span id="cb32-34"><a href="#cb32-34" tabindex="-1"></a><span class="co">// Build a simple linear regression model</span></span>
<span id="cb32-35"><a href="#cb32-35" tabindex="-1"></a><span class="co">// 1 independent (x) and 1 dependent (y) variable</span></span>
<span id="cb32-36"><a href="#cb32-36" tabindex="-1"></a><span class="kw">var</span> model <span class="op">=</span> data<span class="op">.</span><span class="fu">reduce</span>(ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">linearFit</span>())</span>
<span id="cb32-37"><a href="#cb32-37" tabindex="-1"></a></span>
<span id="cb32-38"><a href="#cb32-38" tabindex="-1"></a><span class="kw">var</span> scale <span class="op">=</span> ee<span class="op">.</span><span class="fu">Dictionary</span>(model)<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;scale&#39;</span>)</span>
<span id="cb32-39"><a href="#cb32-39" tabindex="-1"></a><span class="kw">var</span> offset <span class="op">=</span> ee<span class="op">.</span><span class="fu">Dictionary</span>(model)<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;offset&#39;</span>)</span>
<span id="cb32-40"><a href="#cb32-40" tabindex="-1"></a></span>
<span id="cb32-41"><a href="#cb32-41" tabindex="-1"></a><span class="kw">var</span> yPredicted <span class="op">=</span> ee<span class="op">.</span><span class="fu">Array</span>(x<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(element) {</span>
<span id="cb32-42"><a href="#cb32-42" tabindex="-1"></a>  <span class="kw">var</span> y <span class="op">=</span> (ee<span class="op">.</span><span class="fu">Number</span>(element)<span class="op">.</span><span class="fu">multiply</span>(scale))<span class="op">.</span><span class="fu">add</span>(offset)<span class="op">;</span></span>
<span id="cb32-43"><a href="#cb32-43" tabindex="-1"></a>  <span class="cf">return</span> y<span class="op">;</span></span>
<span id="cb32-44"><a href="#cb32-44" tabindex="-1"></a>}))<span class="op">;</span></span>
<span id="cb32-45"><a href="#cb32-45" tabindex="-1"></a></span>
<span id="cb32-46"><a href="#cb32-46" tabindex="-1"></a><span class="co">// Concatenate the y variables (y and predicted y) into an array</span></span>
<span id="cb32-47"><a href="#cb32-47" tabindex="-1"></a><span class="co">// for input to ui.Chart.array.values for plotting a scatter plot.</span></span>
<span id="cb32-48"><a href="#cb32-48" tabindex="-1"></a><span class="kw">var</span> yArr <span class="op">=</span> ee<span class="op">.</span><span class="at">Array</span><span class="op">.</span><span class="fu">cat</span>([y<span class="op">,</span> yPredicted]<span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb32-49"><a href="#cb32-49" tabindex="-1"></a></span>
<span id="cb32-50"><a href="#cb32-50" tabindex="-1"></a><span class="kw">var</span> dataChart <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">array</span><span class="op">.</span><span class="fu">values</span>({</span>
<span id="cb32-51"><a href="#cb32-51" tabindex="-1"></a>  <span class="dt">array</span><span class="op">:</span> yArr<span class="op">,</span></span>
<span id="cb32-52"><a href="#cb32-52" tabindex="-1"></a>  <span class="dt">axis</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb32-53"><a href="#cb32-53" tabindex="-1"></a>  <span class="dt">xLabels</span><span class="op">:</span> x})</span>
<span id="cb32-54"><a href="#cb32-54" tabindex="-1"></a>  <span class="op">.</span><span class="fu">setChartType</span>(<span class="st">&#39;ScatterChart&#39;</span>)</span>
<span id="cb32-55"><a href="#cb32-55" tabindex="-1"></a>  <span class="op">.</span><span class="fu">setOptions</span>({</span>
<span id="cb32-56"><a href="#cb32-56" tabindex="-1"></a>    <span class="dt">legend</span><span class="op">:</span> {<span class="dt">position</span><span class="op">:</span> <span class="st">&#39;none&#39;</span>}<span class="op">,</span></span>
<span id="cb32-57"><a href="#cb32-57" tabindex="-1"></a>    <span class="dt">hAxis</span><span class="op">:</span> {<span class="st">&#39;title&#39;</span><span class="op">:</span> <span class="st">&#39;x&#39;</span>}<span class="op">,</span></span>
<span id="cb32-58"><a href="#cb32-58" tabindex="-1"></a>    <span class="dt">vAxis</span><span class="op">:</span> {<span class="st">&#39;title&#39;</span><span class="op">:</span> <span class="st">&#39;y&#39;</span>}<span class="op">,</span></span>
<span id="cb32-59"><a href="#cb32-59" tabindex="-1"></a>    <span class="dt">series</span><span class="op">:</span> {</span>
<span id="cb32-60"><a href="#cb32-60" tabindex="-1"></a>      <span class="dv">0</span><span class="op">:</span> {</span>
<span id="cb32-61"><a href="#cb32-61" tabindex="-1"></a>        <span class="dt">pointSize</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span></span>
<span id="cb32-62"><a href="#cb32-62" tabindex="-1"></a>        <span class="dt">pointShape</span><span class="op">:</span> <span class="st">&#39;triangle&#39;</span><span class="op">,</span></span>
<span id="cb32-63"><a href="#cb32-63" tabindex="-1"></a>        <span class="dt">lineWidth</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb32-64"><a href="#cb32-64" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb32-65"><a href="#cb32-65" tabindex="-1"></a>      <span class="dv">1</span><span class="op">:</span> {</span>
<span id="cb32-66"><a href="#cb32-66" tabindex="-1"></a>        <span class="dt">pointSize</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb32-67"><a href="#cb32-67" tabindex="-1"></a>        <span class="dt">lineWidth</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb32-68"><a href="#cb32-68" tabindex="-1"></a>      }</span>
<span id="cb32-69"><a href="#cb32-69" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb32-70"><a href="#cb32-70" tabindex="-1"></a>    <span class="dt">chartArea</span><span class="op">:</span> {<span class="dt">left</span><span class="op">:</span><span class="dv">20</span><span class="op">,</span> <span class="dt">right</span><span class="op">:</span><span class="dv">10</span>}<span class="op">,</span></span>
<span id="cb32-71"><a href="#cb32-71" tabindex="-1"></a>    <span class="dt">width</span><span class="op">:</span> <span class="st">&#39;300&#39;</span></span>
<span id="cb32-72"><a href="#cb32-72" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb32-73"><a href="#cb32-73" tabindex="-1"></a></span>
<span id="cb32-74"><a href="#cb32-74" tabindex="-1"></a><span class="kw">var</span> mainPanel <span class="op">=</span> ui<span class="op">.</span><span class="fu">Panel</span>({</span>
<span id="cb32-75"><a href="#cb32-75" tabindex="-1"></a>  <span class="dt">layout</span><span class="op">:</span> ui<span class="op">.</span><span class="at">Panel</span><span class="op">.</span><span class="at">Layout</span><span class="op">.</span><span class="fu">flow</span>(<span class="st">&#39;horizontal&#39;</span>)<span class="op">,</span></span>
<span id="cb32-76"><a href="#cb32-76" tabindex="-1"></a>  <span class="dt">style</span><span class="op">:</span> {<span class="dt">width</span><span class="op">:</span> <span class="st">&#39;500px&#39;</span>}</span>
<span id="cb32-77"><a href="#cb32-77" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb32-78"><a href="#cb32-78" tabindex="-1"></a></span>
<span id="cb32-79"><a href="#cb32-79" tabindex="-1"></a>mainPanel<span class="op">.</span><span class="fu">add</span>(logoChart)</span>
<span id="cb32-80"><a href="#cb32-80" tabindex="-1"></a>mainPanel<span class="op">.</span><span class="fu">add</span>(dataChart)<span class="op">;</span></span>
<span id="cb32-81"><a href="#cb32-81" tabindex="-1"></a></span>
<span id="cb32-82"><a href="#cb32-82" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">add</span>(mainPanel)</span></code></pre></div>
</div>
<div id="stacked-bar-chart-datatable" class="section level2">
<h2>Stacked Bar Chart (DataTable)</h2>
<p>You can use the <code>isStacked</code> option to <code>true</code> on
charts of type <em>ColumnChart</em> or <em>BarChart</em> to create a
stacked chart. We continue with the dataset from the section on <a
href="#datatable-charts">DataTable charts</a> and create a stacked bar
chart.</p>
<div class="figure" style="text-align: center">
<img src="images/gee_charts/stacked.png" alt="Regular vs. Stacked Bar Charts" width="75%" />
<p class="caption">
Regular vs. Stacked Bar Charts
</p>
</div>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3ASupplement%2FDataTable_Stacked_BarChart"
target="_blank">Open in Code Editor ↗</a></p>
<div class="sourceCode" id="cb33"><pre
class="sourceCode js"><code class="sourceCode javascript"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="co">// Creating Stacked Bar Charts</span></span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a><span class="co">// We use the Big Earth Data - Survey 2019 data</span></span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a><span class="co">// https://zenodo.org/record/4075058</span></span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a><span class="co">// Create a DataTable</span></span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a><span class="kw">var</span> dataTable <span class="op">=</span> {</span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a>  <span class="dt">cols</span><span class="op">:</span> [</span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a>    {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;modality&#39;</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">&#39;Modality - Data Processing&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;string&#39;</span>}<span class="op">,</span></span>
<span id="cb33-10"><a href="#cb33-10" tabindex="-1"></a>    {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;always&#39;</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">&#39;Always&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;number&#39;</span>}<span class="op">,</span></span>
<span id="cb33-11"><a href="#cb33-11" tabindex="-1"></a>    {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;alwaysAnnotation&#39;</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">&#39;Always&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;string&#39;</span><span class="op">,</span> <span class="dt">role</span><span class="op">:</span> <span class="st">&#39;annotation&#39;</span>}<span class="op">,</span></span>
<span id="cb33-12"><a href="#cb33-12" tabindex="-1"></a>    {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;sometimes&#39;</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">&#39;Sometimes&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;number&#39;</span>}<span class="op">,</span></span>
<span id="cb33-13"><a href="#cb33-13" tabindex="-1"></a>    {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;sometimesAnnotation&#39;</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">&#39;Sometimes&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;string&#39;</span><span class="op">,</span> <span class="dt">role</span><span class="op">:</span> <span class="st">&#39;annotation&#39;</span>}<span class="op">,</span></span>
<span id="cb33-14"><a href="#cb33-14" tabindex="-1"></a>    {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;never&#39;</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">&#39;Never&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;number&#39;</span>}<span class="op">,</span></span>
<span id="cb33-15"><a href="#cb33-15" tabindex="-1"></a>    {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;neverAnnotation&#39;</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">&#39;Never&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;string&#39;</span><span class="op">,</span> <span class="dt">role</span><span class="op">:</span> <span class="st">&#39;annotation&#39;</span>}<span class="op">,</span></span>
<span id="cb33-16"><a href="#cb33-16" tabindex="-1"></a></span>
<span id="cb33-17"><a href="#cb33-17" tabindex="-1"></a>  ]<span class="op">,</span></span>
<span id="cb33-18"><a href="#cb33-18" tabindex="-1"></a>  <span class="dt">rows</span><span class="op">:</span> [</span>
<span id="cb33-19"><a href="#cb33-19" tabindex="-1"></a>    {<span class="dt">c</span><span class="op">:</span> [ {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;Code-based processing on a local machine&#39;</span>}<span class="op">,</span></span>
<span id="cb33-20"><a href="#cb33-20" tabindex="-1"></a>          {<span class="dt">v</span><span class="op">:</span> <span class="fl">54.1</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;54.1&#39;</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="dv">32</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;32&#39;</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="fl">7.4</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;7.4&#39;</span>}]}<span class="op">,</span></span>
<span id="cb33-21"><a href="#cb33-21" tabindex="-1"></a>    {<span class="dt">c</span><span class="op">:</span> [ {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;Geospatial software on a local machine&#39;</span>}<span class="op">,</span> </span>
<span id="cb33-22"><a href="#cb33-22" tabindex="-1"></a>          {<span class="dt">v</span><span class="op">:</span> <span class="fl">23.8</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;23.8&#39;</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="fl">47.6</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;47.6&#39;</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="fl">20.8</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;20.8&#39;</span>}]}<span class="op">,</span></span>
<span id="cb33-23"><a href="#cb33-23" tabindex="-1"></a>    {<span class="dt">c</span><span class="op">:</span> [ {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;API accessing cloud-service&#39;</span>}<span class="op">,</span></span>
<span id="cb33-24"><a href="#cb33-24" tabindex="-1"></a>          {<span class="dt">v</span><span class="op">:</span> <span class="fl">8.7</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;8.7&#39;</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="dv">32</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;32&#39;</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="fl">50.6</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;50.6&#39;</span>}]}<span class="op">,</span></span>
<span id="cb33-25"><a href="#cb33-25" tabindex="-1"></a>    {<span class="dt">c</span><span class="op">:</span> [ {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;code editor in the cloud&#39;</span>}<span class="op">,</span></span>
<span id="cb33-26"><a href="#cb33-26" tabindex="-1"></a>          {<span class="dt">v</span><span class="op">:</span> <span class="fl">7.4</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;23.8&#39;</span>}<span class="op">,</span>{<span class="dt">v</span><span class="op">:</span> <span class="fl">37.2</span>}<span class="op">,</span>{<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;37.2&#39;</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="fl">46.8</span>}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> <span class="st">&#39;46.8&#39;</span>}<span class="op">,</span>]}<span class="op">,</span></span>
<span id="cb33-27"><a href="#cb33-27" tabindex="-1"></a>    ]</span>
<span id="cb33-28"><a href="#cb33-28" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb33-29"><a href="#cb33-29" tabindex="-1"></a></span>
<span id="cb33-30"><a href="#cb33-30" tabindex="-1"></a><span class="co">// Use ui.Chart() to create a column chart</span></span>
<span id="cb33-31"><a href="#cb33-31" tabindex="-1"></a><span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="fu">Chart</span>(dataTable<span class="op">,</span> <span class="st">&#39;ColumnChart&#39;</span>)</span>
<span id="cb33-32"><a href="#cb33-32" tabindex="-1"></a>  <span class="op">.</span><span class="fu">setOptions</span>({</span>
<span id="cb33-33"><a href="#cb33-33" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Modality of handling and processing large volumes of data&#39;</span><span class="op">,</span></span>
<span id="cb33-34"><a href="#cb33-34" tabindex="-1"></a>    <span class="dt">vAxis</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">&#39;%&#39;</span>}<span class="op">,</span></span>
<span id="cb33-35"><a href="#cb33-35" tabindex="-1"></a>    <span class="dt">hAxis</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Modality - data processing&#39;</span>}<span class="op">,</span></span>
<span id="cb33-36"><a href="#cb33-36" tabindex="-1"></a>    <span class="dt">legend</span><span class="op">:</span> {<span class="dt">position</span><span class="op">:</span> <span class="st">&#39;top&#39;</span>}<span class="op">,</span></span>
<span id="cb33-37"><a href="#cb33-37" tabindex="-1"></a>    <span class="dt">series</span><span class="op">:</span> {</span>
<span id="cb33-38"><a href="#cb33-38" tabindex="-1"></a>      <span class="dv">0</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;5ab4ac&#39;</span>}<span class="op">,</span></span>
<span id="cb33-39"><a href="#cb33-39" tabindex="-1"></a>      <span class="dv">1</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;f5f5f5&#39;</span>}<span class="op">,</span></span>
<span id="cb33-40"><a href="#cb33-40" tabindex="-1"></a>      <span class="dv">2</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;d8b365&#39;</span>}</span>
<span id="cb33-41"><a href="#cb33-41" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb33-42"><a href="#cb33-42" tabindex="-1"></a>    <span class="dt">annotations</span><span class="op">:</span> {</span>
<span id="cb33-43"><a href="#cb33-43" tabindex="-1"></a>      <span class="dt">textStyle</span><span class="op">:</span> {<span class="dt">bold</span><span class="op">:</span> <span class="kw">true</span>}<span class="op">,</span></span>
<span id="cb33-44"><a href="#cb33-44" tabindex="-1"></a>    }</span>
<span id="cb33-45"><a href="#cb33-45" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb33-46"><a href="#cb33-46" tabindex="-1"></a></span>
<span id="cb33-47"><a href="#cb33-47" tabindex="-1"></a><span class="co">// Print the chart</span></span>
<span id="cb33-48"><a href="#cb33-48" tabindex="-1"></a><span class="fu">print</span>(chart)<span class="op">;</span> </span>
<span id="cb33-49"><a href="#cb33-49" tabindex="-1"></a></span>
<span id="cb33-50"><a href="#cb33-50" tabindex="-1"></a></span>
<span id="cb33-51"><a href="#cb33-51" tabindex="-1"></a><span class="co">// Use ui.Chart() to create a stacked bar chart</span></span>
<span id="cb33-52"><a href="#cb33-52" tabindex="-1"></a><span class="co">// Set the option isStacked: true</span></span>
<span id="cb33-53"><a href="#cb33-53" tabindex="-1"></a><span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="fu">Chart</span>(dataTable<span class="op">,</span> <span class="st">&#39;BarChart&#39;</span>)</span>
<span id="cb33-54"><a href="#cb33-54" tabindex="-1"></a>  <span class="op">.</span><span class="fu">setOptions</span>({</span>
<span id="cb33-55"><a href="#cb33-55" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Modality of handling and processing large volumes of data&#39;</span><span class="op">,</span></span>
<span id="cb33-56"><a href="#cb33-56" tabindex="-1"></a>    <span class="dt">hAxis</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">&#39;%&#39;</span>}<span class="op">,</span></span>
<span id="cb33-57"><a href="#cb33-57" tabindex="-1"></a>    <span class="dt">vAxis</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Modality - data processing&#39;</span>}<span class="op">,</span></span>
<span id="cb33-58"><a href="#cb33-58" tabindex="-1"></a>    <span class="dt">legend</span><span class="op">:</span> {<span class="dt">position</span><span class="op">:</span> <span class="st">&#39;top&#39;</span>}<span class="op">,</span></span>
<span id="cb33-59"><a href="#cb33-59" tabindex="-1"></a>    <span class="dt">isStacked</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb33-60"><a href="#cb33-60" tabindex="-1"></a>    <span class="dt">series</span><span class="op">:</span> {</span>
<span id="cb33-61"><a href="#cb33-61" tabindex="-1"></a>      <span class="dv">0</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;5ab4ac&#39;</span>}<span class="op">,</span></span>
<span id="cb33-62"><a href="#cb33-62" tabindex="-1"></a>      <span class="dv">1</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;f5f5f5&#39;</span>}<span class="op">,</span></span>
<span id="cb33-63"><a href="#cb33-63" tabindex="-1"></a>      <span class="dv">2</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;d8b365&#39;</span>}</span>
<span id="cb33-64"><a href="#cb33-64" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb33-65"><a href="#cb33-65" tabindex="-1"></a>    <span class="dt">annotations</span><span class="op">:</span> {</span>
<span id="cb33-66"><a href="#cb33-66" tabindex="-1"></a>      <span class="dt">textStyle</span><span class="op">:</span> {<span class="dt">bold</span><span class="op">:</span> <span class="kw">true</span>}<span class="op">,</span></span>
<span id="cb33-67"><a href="#cb33-67" tabindex="-1"></a>    }</span>
<span id="cb33-68"><a href="#cb33-68" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb33-69"><a href="#cb33-69" tabindex="-1"></a></span>
<span id="cb33-70"><a href="#cb33-70" tabindex="-1"></a><span class="co">// Print the chart</span></span>
<span id="cb33-71"><a href="#cb33-71" tabindex="-1"></a><span class="fu">print</span>(chart)<span class="op">;</span> </span></code></pre></div>
</div>
<div id="colored-bar-chart-datatable" class="section level2">
<h2>Colored Bar Chart (DataTable)</h2>
<p>It is possible to assign a different color to each bar of a bar
chart. You neeed to create a DataTable with a column having a
<em>style</em> role and define the color for each row. Here we create a
chart that uses a unique color for each bar that representing the year
of forest loss. The chart has a one-to-one correspondence with the map
palette - making it a very useful tool in interpretation of the spatial
and temporal aspects of the trend.</p>
<div class="figure" style="text-align: center">
<img src="images/gee_charts/colored_barchart.png" alt="Colored Bar Chart" width="75%" />
<p class="caption">
Colored Bar Chart
</p>
</div>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3ASupplement%2FDataTable_Colored_Bars"
target="_blank">Open in Code Editor ↗</a></p>
<div class="sourceCode" id="cb34"><pre
class="sourceCode js"><code class="sourceCode javascript"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="co">// Example script showing how to create a bar chart</span></span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a><span class="co">// with each bar having a different color.</span></span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a><span class="co">// We create a map of forest loss with each pixel </span></span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a><span class="co">// colored accoridng to the year in which the loss occurred.</span></span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a><span class="co">// The chart displays the total loss in the region by year</span></span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a><span class="co">// with the color or the bar matching the map.</span></span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a><span class="co">// Select a region</span></span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a><span class="kw">var</span> geometry <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Polygon</span>([[</span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a>  [<span class="op">-</span><span class="fl">66.31185532393005</span><span class="op">,</span> <span class="op">-</span><span class="fl">8.92550265818768</span>]<span class="op">,</span></span>
<span id="cb34-12"><a href="#cb34-12" tabindex="-1"></a>  [<span class="op">-</span><span class="fl">66.31185532393005</span><span class="op">,</span> <span class="op">-</span><span class="fl">9.687127927480695</span>]<span class="op">,</span></span>
<span id="cb34-13"><a href="#cb34-13" tabindex="-1"></a>  [<span class="op">-</span><span class="fl">65.2104759293988</span><span class="op">,</span> <span class="op">-</span><span class="fl">9.687127927480695</span>]<span class="op">,</span></span>
<span id="cb34-14"><a href="#cb34-14" tabindex="-1"></a>  [<span class="op">-</span><span class="fl">65.2104759293988</span><span class="op">,</span> <span class="op">-</span><span class="fl">8.92550265818768</span>]</span>
<span id="cb34-15"><a href="#cb34-15" tabindex="-1"></a>]])<span class="op">;</span></span>
<span id="cb34-16"><a href="#cb34-16" tabindex="-1"></a></span>
<span id="cb34-17"><a href="#cb34-17" tabindex="-1"></a><span class="co">// Get the Hansen Global Forest Change dataset</span></span>
<span id="cb34-18"><a href="#cb34-18" tabindex="-1"></a><span class="co">// This dataset is updated yearly, so we get the latest version.</span></span>
<span id="cb34-19"><a href="#cb34-19" tabindex="-1"></a><span class="kw">var</span> gfc2022 <span class="op">=</span> ee<span class="op">.</span><span class="fu">Image</span>(<span class="st">&#39;UMD/hansen/global_forest_change_2022_v1_10&#39;</span>)<span class="op">;</span></span>
<span id="cb34-20"><a href="#cb34-20" tabindex="-1"></a></span>
<span id="cb34-21"><a href="#cb34-21" tabindex="-1"></a><span class="kw">var</span> lossYear <span class="op">=</span> gfc2022<span class="op">.</span><span class="fu">select</span>([<span class="st">&#39;lossyear&#39;</span>])<span class="op">;</span></span>
<span id="cb34-22"><a href="#cb34-22" tabindex="-1"></a></span>
<span id="cb34-23"><a href="#cb34-23" tabindex="-1"></a><span class="co">// The lossYear image contains pixel values from 0 to 22</span></span>
<span id="cb34-24"><a href="#cb34-24" tabindex="-1"></a><span class="co">// indicating the year in which the loss occurred</span></span>
<span id="cb34-25"><a href="#cb34-25" tabindex="-1"></a></span>
<span id="cb34-26"><a href="#cb34-26" tabindex="-1"></a><span class="co">// We visualize this layer on the map.</span></span>
<span id="cb34-27"><a href="#cb34-27" tabindex="-1"></a><span class="kw">var</span> palette <span class="op">=</span> [</span>
<span id="cb34-28"><a href="#cb34-28" tabindex="-1"></a>  <span class="st">&#39;0083ba&#39;</span><span class="op">,</span> <span class="st">&#39;#4394b6&#39;</span><span class="op">,</span> <span class="st">&#39;#5ca5b2&#39;</span><span class="op">,</span> <span class="st">&#39;#74b6ad&#39;</span><span class="op">,</span> <span class="st">&#39;#8dc8a9&#39;</span><span class="op">,</span></span>
<span id="cb34-29"><a href="#cb34-29" tabindex="-1"></a>  <span class="st">&#39;#a5d9a5&#39;</span><span class="op">,</span> <span class="st">&#39;#b7e2a8&#39;</span><span class="op">,</span> <span class="st">&#39;#c7e8ad&#39;</span><span class="op">,</span> <span class="st">&#39;#d7efb2&#39;</span><span class="op">,</span> <span class="st">&#39;#e7f5b7&#39;</span><span class="op">,</span></span>
<span id="cb34-30"><a href="#cb34-30" tabindex="-1"></a>  <span class="st">&#39;#f7fcbc&#39;</span><span class="op">,</span> <span class="st">&#39;#fff7b6&#39;</span><span class="op">,</span> <span class="st">&#39;#fee8a4&#39;</span><span class="op">,</span> <span class="st">&#39;#fed890&#39;</span><span class="op">,</span> <span class="st">&#39;#fec980&#39;</span><span class="op">,</span></span>
<span id="cb34-31"><a href="#cb34-31" tabindex="-1"></a>  <span class="st">&#39;#fdba6e&#39;</span><span class="op">,</span> <span class="st">&#39;#fba75e&#39;</span><span class="op">,</span> <span class="st">&#39;#f48b51&#39;</span><span class="op">,</span> <span class="st">&#39;#ed6e43&#39;</span><span class="op">,</span> <span class="st">&#39;#e5522a&#39;</span><span class="op">,</span></span>
<span id="cb34-32"><a href="#cb34-32" tabindex="-1"></a>  <span class="st">&#39;#de3519&#39;</span><span class="op">,</span> <span class="st">&#39;#d7191c&#39;</span>]<span class="op">;</span></span>
<span id="cb34-33"><a href="#cb34-33" tabindex="-1"></a></span>
<span id="cb34-34"><a href="#cb34-34" tabindex="-1"></a><span class="kw">var</span> lossYearVis <span class="op">=</span> {</span>
<span id="cb34-35"><a href="#cb34-35" tabindex="-1"></a>  <span class="dt">min</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb34-36"><a href="#cb34-36" tabindex="-1"></a>  <span class="dt">max</span><span class="op">:</span> <span class="dv">22</span><span class="op">,</span></span>
<span id="cb34-37"><a href="#cb34-37" tabindex="-1"></a>  <span class="dt">palette</span><span class="op">:</span> palette</span>
<span id="cb34-38"><a href="#cb34-38" tabindex="-1"></a>}</span>
<span id="cb34-39"><a href="#cb34-39" tabindex="-1"></a><span class="co">// Visualize the loss on the map</span></span>
<span id="cb34-40"><a href="#cb34-40" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">centerObject</span>(geometry<span class="op">,</span> <span class="dv">10</span>)<span class="op">;</span></span>
<span id="cb34-41"><a href="#cb34-41" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">setOptions</span>(<span class="st">&#39;SATELLITE&#39;</span>)<span class="op">;</span></span>
<span id="cb34-42"><a href="#cb34-42" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(geometry<span class="op">,</span> {}<span class="op">,</span> <span class="st">&#39;Selected Region&#39;</span><span class="op">,</span> <span class="kw">true</span><span class="op">,</span> <span class="fl">0.6</span>)<span class="op">;</span></span>
<span id="cb34-43"><a href="#cb34-43" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(lossYear<span class="op">,</span> lossYearVis<span class="op">,</span> <span class="st">&#39;Loss Year&#39;</span>)<span class="op">;</span></span>
<span id="cb34-44"><a href="#cb34-44" tabindex="-1"></a></span>
<span id="cb34-45"><a href="#cb34-45" tabindex="-1"></a><span class="co">// Create an area image and convert to Hectares</span></span>
<span id="cb34-46"><a href="#cb34-46" tabindex="-1"></a><span class="kw">var</span> areaImage <span class="op">=</span> ee<span class="op">.</span><span class="at">Image</span><span class="op">.</span><span class="fu">pixelArea</span>()<span class="op">.</span><span class="fu">divide</span>(<span class="fl">1e5</span>)<span class="op">;</span></span>
<span id="cb34-47"><a href="#cb34-47" tabindex="-1"></a></span>
<span id="cb34-48"><a href="#cb34-48" tabindex="-1"></a><span class="co">// Add the band containing yearly loss</span></span>
<span id="cb34-49"><a href="#cb34-49" tabindex="-1"></a><span class="kw">var</span> areaImageWithYear <span class="op">=</span> areaImage<span class="op">.</span><span class="fu">addBands</span>(lossYear)<span class="op">;</span></span>
<span id="cb34-50"><a href="#cb34-50" tabindex="-1"></a></span>
<span id="cb34-51"><a href="#cb34-51" tabindex="-1"></a><span class="kw">var</span> areas <span class="op">=</span> areaImageWithYear<span class="op">.</span><span class="fu">reduceRegion</span>({</span>
<span id="cb34-52"><a href="#cb34-52" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">sum</span>()<span class="op">.</span><span class="fu">group</span>({</span>
<span id="cb34-53"><a href="#cb34-53" tabindex="-1"></a>    <span class="dt">groupField</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb34-54"><a href="#cb34-54" tabindex="-1"></a>    <span class="dt">groupName</span><span class="op">:</span> <span class="st">&#39;year&#39;</span></span>
<span id="cb34-55"><a href="#cb34-55" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb34-56"><a href="#cb34-56" tabindex="-1"></a>  <span class="dt">geometry</span><span class="op">:</span> geometry<span class="op">,</span></span>
<span id="cb34-57"><a href="#cb34-57" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span></span>
<span id="cb34-58"><a href="#cb34-58" tabindex="-1"></a>  <span class="dt">maxPixels</span><span class="op">:</span> <span class="fl">1e10</span></span>
<span id="cb34-59"><a href="#cb34-59" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb34-60"><a href="#cb34-60" tabindex="-1"></a></span>
<span id="cb34-61"><a href="#cb34-61" tabindex="-1"></a><span class="kw">var</span> yearAreas <span class="op">=</span> ee<span class="op">.</span><span class="fu">List</span>(areas<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;groups&#39;</span>))<span class="op">;</span></span>
<span id="cb34-62"><a href="#cb34-62" tabindex="-1"></a></span>
<span id="cb34-63"><a href="#cb34-63" tabindex="-1"></a><span class="co">// Process results to extract the areas and</span></span>
<span id="cb34-64"><a href="#cb34-64" tabindex="-1"></a><span class="co">// create a list</span></span>
<span id="cb34-65"><a href="#cb34-65" tabindex="-1"></a><span class="kw">var</span> yearAreasList <span class="op">=</span> ee<span class="op">.</span><span class="fu">List</span>(yearAreas<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(item) {</span>
<span id="cb34-66"><a href="#cb34-66" tabindex="-1"></a>  <span class="kw">var</span> areaDict <span class="op">=</span> ee<span class="op">.</span><span class="fu">Dictionary</span>(item)<span class="op">;</span></span>
<span id="cb34-67"><a href="#cb34-67" tabindex="-1"></a>  <span class="kw">var</span> yearString <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(areaDict<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;year&#39;</span>))<span class="op">.</span><span class="fu">format</span>(<span class="st">&#39;20%02d&#39;</span>)<span class="op">;</span></span>
<span id="cb34-68"><a href="#cb34-68" tabindex="-1"></a>  <span class="kw">var</span> area <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(</span>
<span id="cb34-69"><a href="#cb34-69" tabindex="-1"></a>    areaDict<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;sum&#39;</span>))<span class="op">;</span></span>
<span id="cb34-70"><a href="#cb34-70" tabindex="-1"></a>  <span class="cf">return</span> ee<span class="op">.</span><span class="fu">List</span>([yearString<span class="op">,</span> area])</span>
<span id="cb34-71"><a href="#cb34-71" tabindex="-1"></a>}))<span class="op">;</span></span>
<span id="cb34-72"><a href="#cb34-72" tabindex="-1"></a></span>
<span id="cb34-73"><a href="#cb34-73" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;Year Areas&#39;</span><span class="op">,</span> yearAreasList)<span class="op">;</span></span>
<span id="cb34-74"><a href="#cb34-74" tabindex="-1"></a></span>
<span id="cb34-75"><a href="#cb34-75" tabindex="-1"></a></span>
<span id="cb34-76"><a href="#cb34-76" tabindex="-1"></a><span class="co">// We create a list of rows in the DataTable format</span></span>
<span id="cb34-77"><a href="#cb34-77" tabindex="-1"></a><span class="kw">var</span> rowList <span class="op">=</span> yearAreasList<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(item) {</span>
<span id="cb34-78"><a href="#cb34-78" tabindex="-1"></a>  <span class="kw">var</span> year <span class="op">=</span> ee<span class="op">.</span><span class="fu">List</span>(item)<span class="op">.</span><span class="fu">get</span>(<span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb34-79"><a href="#cb34-79" tabindex="-1"></a>  <span class="kw">var</span> x <span class="op">=</span> ee<span class="op">.</span><span class="fu">String</span>(<span class="st">&#39;Date(&#39;</span>)</span>
<span id="cb34-80"><a href="#cb34-80" tabindex="-1"></a>    <span class="op">.</span><span class="fu">cat</span>(year)</span>
<span id="cb34-81"><a href="#cb34-81" tabindex="-1"></a>    <span class="op">.</span><span class="fu">cat</span>(<span class="st">&#39;, &#39;</span>)</span>
<span id="cb34-82"><a href="#cb34-82" tabindex="-1"></a>    <span class="op">.</span><span class="fu">cat</span>(<span class="st">&#39;0&#39;</span>)</span>
<span id="cb34-83"><a href="#cb34-83" tabindex="-1"></a>    <span class="op">.</span><span class="fu">cat</span>(<span class="st">&#39;, &#39;</span>)</span>
<span id="cb34-84"><a href="#cb34-84" tabindex="-1"></a>    <span class="op">.</span><span class="fu">cat</span>(<span class="st">&#39;1&#39;</span>)</span>
<span id="cb34-85"><a href="#cb34-85" tabindex="-1"></a>    <span class="op">.</span><span class="fu">cat</span>(ee<span class="op">.</span><span class="fu">String</span>(<span class="st">&#39;)&#39;</span>))</span>
<span id="cb34-86"><a href="#cb34-86" tabindex="-1"></a>    </span>
<span id="cb34-87"><a href="#cb34-87" tabindex="-1"></a>  <span class="kw">var</span> y <span class="op">=</span> ee<span class="op">.</span><span class="fu">List</span>(item)<span class="op">.</span><span class="fu">get</span>(<span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb34-88"><a href="#cb34-88" tabindex="-1"></a>  <span class="co">// We will assign the color to each year from the palette</span></span>
<span id="cb34-89"><a href="#cb34-89" tabindex="-1"></a>  <span class="kw">var</span> color <span class="op">=</span> ee<span class="op">.</span><span class="fu">List</span>(palette)<span class="op">.</span><span class="fu">get</span>(yearAreasList<span class="op">.</span><span class="fu">indexOf</span>(item))<span class="op">;</span></span>
<span id="cb34-90"><a href="#cb34-90" tabindex="-1"></a>  <span class="kw">var</span> rowDict <span class="op">=</span> {</span>
<span id="cb34-91"><a href="#cb34-91" tabindex="-1"></a>    <span class="dt">c</span><span class="op">:</span> [{<span class="dt">v</span><span class="op">:</span> x}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> y}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> color}]</span>
<span id="cb34-92"><a href="#cb34-92" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb34-93"><a href="#cb34-93" tabindex="-1"></a>  <span class="cf">return</span> rowDict<span class="op">;</span></span>
<span id="cb34-94"><a href="#cb34-94" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb34-95"><a href="#cb34-95" tabindex="-1"></a></span>
<span id="cb34-96"><a href="#cb34-96" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;Rows&#39;</span><span class="op">,</span> rowList)<span class="op">;</span></span>
<span id="cb34-97"><a href="#cb34-97" tabindex="-1"></a></span>
<span id="cb34-98"><a href="#cb34-98" tabindex="-1"></a><span class="co">// Create the DataTable</span></span>
<span id="cb34-99"><a href="#cb34-99" tabindex="-1"></a>rowList<span class="op">.</span><span class="fu">evaluate</span>(<span class="kw">function</span>(rowListClient) {</span>
<span id="cb34-100"><a href="#cb34-100" tabindex="-1"></a>  <span class="kw">var</span> dataTable <span class="op">=</span> {</span>
<span id="cb34-101"><a href="#cb34-101" tabindex="-1"></a>    <span class="dt">cols</span><span class="op">:</span> [</span>
<span id="cb34-102"><a href="#cb34-102" tabindex="-1"></a>      {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;x&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;date&#39;</span>}<span class="op">,</span></span>
<span id="cb34-103"><a href="#cb34-103" tabindex="-1"></a>      {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;y&#39;</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">&#39;area&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;number&#39;</span>}<span class="op">,</span></span>
<span id="cb34-104"><a href="#cb34-104" tabindex="-1"></a>      {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;style&#39;</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">&#39;Style&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;string&#39;</span><span class="op">,</span> <span class="dt">role</span><span class="op">:</span> <span class="st">&#39;style&#39;</span>}<span class="op">,</span></span>
<span id="cb34-105"><a href="#cb34-105" tabindex="-1"></a></span>
<span id="cb34-106"><a href="#cb34-106" tabindex="-1"></a>    ]<span class="op">,</span></span>
<span id="cb34-107"><a href="#cb34-107" tabindex="-1"></a>    <span class="dt">rows</span><span class="op">:</span> rowListClient</span>
<span id="cb34-108"><a href="#cb34-108" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb34-109"><a href="#cb34-109" tabindex="-1"></a>  </span>
<span id="cb34-110"><a href="#cb34-110" tabindex="-1"></a>  <span class="kw">var</span> options <span class="op">=</span> {</span>
<span id="cb34-111"><a href="#cb34-111" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Yearly Forest Loss&#39;</span><span class="op">,</span></span>
<span id="cb34-112"><a href="#cb34-112" tabindex="-1"></a>    <span class="dt">vAxis</span><span class="op">:</span> {</span>
<span id="cb34-113"><a href="#cb34-113" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Area (Hectares)&#39;</span><span class="op">,</span> </span>
<span id="cb34-114"><a href="#cb34-114" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb34-115"><a href="#cb34-115" tabindex="-1"></a>    <span class="dt">hAxis</span><span class="op">:</span> {</span>
<span id="cb34-116"><a href="#cb34-116" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Year&#39;</span><span class="op">,</span></span>
<span id="cb34-117"><a href="#cb34-117" tabindex="-1"></a>      <span class="dt">gridlines</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;transparent&#39;</span>}</span>
<span id="cb34-118"><a href="#cb34-118" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb34-119"><a href="#cb34-119" tabindex="-1"></a>    <span class="dt">legend</span><span class="op">:</span> {<span class="dt">position</span><span class="op">:</span><span class="st">&#39;none&#39;</span>}<span class="op">,</span></span>
<span id="cb34-120"><a href="#cb34-120" tabindex="-1"></a>    <span class="dt">height</span><span class="op">:</span> <span class="st">&#39;400px&#39;</span><span class="op">,</span></span>
<span id="cb34-121"><a href="#cb34-121" tabindex="-1"></a>    <span class="dt">width</span><span class="op">:</span> <span class="st">&#39;600px&#39;</span></span>
<span id="cb34-122"><a href="#cb34-122" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb34-123"><a href="#cb34-123" tabindex="-1"></a>  </span>
<span id="cb34-124"><a href="#cb34-124" tabindex="-1"></a>  <span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="fu">Chart</span>(dataTable<span class="op">,</span> <span class="st">&#39;ColumnChart&#39;</span><span class="op">,</span> options)<span class="op">;</span></span>
<span id="cb34-125"><a href="#cb34-125" tabindex="-1"></a>  <span class="co">// Add the chart on the map</span></span>
<span id="cb34-126"><a href="#cb34-126" tabindex="-1"></a>  <span class="kw">var</span> chartPanel <span class="op">=</span> ui<span class="op">.</span><span class="fu">Panel</span>({</span>
<span id="cb34-127"><a href="#cb34-127" tabindex="-1"></a>    <span class="dt">style</span><span class="op">:</span> {<span class="dt">width</span><span class="op">:</span> <span class="st">&#39;600px&#39;</span><span class="op">,</span> <span class="dt">position</span><span class="op">:</span> <span class="st">&#39;middle-right&#39;</span>}</span>
<span id="cb34-128"><a href="#cb34-128" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb34-129"><a href="#cb34-129" tabindex="-1"></a>  chartPanel<span class="op">.</span><span class="fu">add</span>(chart)<span class="op">;</span></span>
<span id="cb34-130"><a href="#cb34-130" tabindex="-1"></a>  <span class="bu">Map</span><span class="op">.</span><span class="fu">add</span>(chartPanel)<span class="op">;</span></span>
<span id="cb34-131"><a href="#cb34-131" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
</div>
<div id="box-plot-with-outliers-datatable" class="section level2">
<h2>Box Plot with Outliers (DataTable)</h2>
<p>Regular box plot displays the whiskers at the minimum and maximum
values. A variation of this is to instead first compute the
Inter-Quartile Range (IQR) and display whiskers at <em>1.5 x IQR</em>
above and below the IQR. If the minimum or maximum values fall outside
of this range, they are displayed as outlier points. This script
calculates the requires values and displays the outlier intervals as
points.</p>
<div class="figure" style="text-align: center">
<img src="images/gee_charts/box_plot_with_outliers.png" alt="Box Plot with Outliers" width="75%" />
<p class="caption">
Box Plot with Outliers
</p>
</div>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3ASupplement%2FBox_Plot_with_Outliers"
target="_blank">Open in Code Editor ↗</a></p>
<div class="sourceCode" id="cb35"><pre
class="sourceCode js"><code class="sourceCode javascript"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="co">// Example script showing how to create a box plot with outliers.</span></span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a><span class="kw">var</span> s2 <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&#39;COPERNICUS/S2_HARMONIZED&#39;</span>)<span class="op">;</span></span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a><span class="kw">var</span> geometry <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Polygon</span>([[</span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>  [<span class="fl">82.60642647743225</span><span class="op">,</span> <span class="fl">27.16350437805251</span>]<span class="op">,</span></span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>  [<span class="fl">82.60984897613525</span><span class="op">,</span> <span class="fl">27.1618529901377</span>]<span class="op">,</span></span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a>  [<span class="fl">82.61088967323303</span><span class="op">,</span> <span class="fl">27.163695288375266</span>]<span class="op">,</span></span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>  [<span class="fl">82.60757446289062</span><span class="op">,</span> <span class="fl">27.16517483230927</span>]</span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a>]])<span class="op">;</span></span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(geometry<span class="op">,</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;red&#39;</span>}<span class="op">,</span> <span class="st">&#39;Farm&#39;</span>)<span class="op">;</span></span>
<span id="cb35-11"><a href="#cb35-11" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">centerObject</span>(geometry)<span class="op">;</span></span>
<span id="cb35-12"><a href="#cb35-12" tabindex="-1"></a><span class="kw">var</span> rgbVis <span class="op">=</span> {<span class="dt">min</span><span class="op">:</span> <span class="fl">0.0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">3000</span><span class="op">,</span> <span class="dt">bands</span><span class="op">:</span> [<span class="st">&#39;B4&#39;</span><span class="op">,</span> <span class="st">&#39;B3&#39;</span><span class="op">,</span> <span class="st">&#39;B2&#39;</span>]}<span class="op">;</span></span>
<span id="cb35-13"><a href="#cb35-13" tabindex="-1"></a></span>
<span id="cb35-14"><a href="#cb35-14" tabindex="-1"></a><span class="kw">var</span> filtered <span class="op">=</span> s2</span>
<span id="cb35-15"><a href="#cb35-15" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">date</span>(<span class="st">&#39;2017-01-01&#39;</span><span class="op">,</span> <span class="st">&#39;2018-01-01&#39;</span>))</span>
<span id="cb35-16"><a href="#cb35-16" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">lt</span>(<span class="st">&#39;CLOUDY_PIXEL_PERCENTAGE&#39;</span><span class="op">,</span> <span class="dv">30</span>))</span>
<span id="cb35-17"><a href="#cb35-17" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">bounds</span>(geometry))<span class="op">;</span></span>
<span id="cb35-18"><a href="#cb35-18" tabindex="-1"></a></span>
<span id="cb35-19"><a href="#cb35-19" tabindex="-1"></a><span class="co">// Write a function for Cloud masking</span></span>
<span id="cb35-20"><a href="#cb35-20" tabindex="-1"></a><span class="kw">function</span> <span class="fu">maskS2clouds</span>(image) {</span>
<span id="cb35-21"><a href="#cb35-21" tabindex="-1"></a>  <span class="kw">var</span> qa <span class="op">=</span> image<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;QA60&#39;</span>)<span class="op">;</span></span>
<span id="cb35-22"><a href="#cb35-22" tabindex="-1"></a>  <span class="kw">var</span> cloudBitMask <span class="op">=</span> <span class="dv">1</span> <span class="op">&lt;&lt;</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb35-23"><a href="#cb35-23" tabindex="-1"></a>  <span class="kw">var</span> cirrusBitMask <span class="op">=</span> <span class="dv">1</span> <span class="op">&lt;&lt;</span> <span class="dv">11</span><span class="op">;</span></span>
<span id="cb35-24"><a href="#cb35-24" tabindex="-1"></a>  <span class="kw">var</span> mask <span class="op">=</span> qa<span class="op">.</span><span class="fu">bitwiseAnd</span>(cloudBitMask)<span class="op">.</span><span class="fu">eq</span>(<span class="dv">0</span>)<span class="op">.</span><span class="fu">and</span>(</span>
<span id="cb35-25"><a href="#cb35-25" tabindex="-1"></a>             qa<span class="op">.</span><span class="fu">bitwiseAnd</span>(cirrusBitMask)<span class="op">.</span><span class="fu">eq</span>(<span class="dv">0</span>))<span class="op">;</span></span>
<span id="cb35-26"><a href="#cb35-26" tabindex="-1"></a>  <span class="cf">return</span> image<span class="op">.</span><span class="fu">updateMask</span>(mask)<span class="op">.</span><span class="fu">multiply</span>(<span class="fl">0.0001</span>)</span>
<span id="cb35-27"><a href="#cb35-27" tabindex="-1"></a>      <span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;B.*&#39;</span>)</span>
<span id="cb35-28"><a href="#cb35-28" tabindex="-1"></a>      <span class="op">.</span><span class="fu">copyProperties</span>(image<span class="op">,</span> [<span class="st">&#39;system:time_start&#39;</span>])<span class="op">;</span></span>
<span id="cb35-29"><a href="#cb35-29" tabindex="-1"></a>}</span>
<span id="cb35-30"><a href="#cb35-30" tabindex="-1"></a></span>
<span id="cb35-31"><a href="#cb35-31" tabindex="-1"></a><span class="kw">var</span> filtered <span class="op">=</span> filtered<span class="op">.</span><span class="fu">map</span>(maskS2clouds)<span class="op">;</span></span>
<span id="cb35-32"><a href="#cb35-32" tabindex="-1"></a><span class="co">// Write a function that computes NDVI for an image and adds it as a band</span></span>
<span id="cb35-33"><a href="#cb35-33" tabindex="-1"></a><span class="kw">function</span> <span class="fu">addNDVI</span>(image) {</span>
<span id="cb35-34"><a href="#cb35-34" tabindex="-1"></a>  <span class="kw">var</span> ndvi <span class="op">=</span> image<span class="op">.</span><span class="fu">normalizedDifference</span>([<span class="st">&#39;B8&#39;</span><span class="op">,</span> <span class="st">&#39;B4&#39;</span>])<span class="op">.</span><span class="fu">rename</span>(<span class="st">&#39;ndvi&#39;</span>)<span class="op">;</span></span>
<span id="cb35-35"><a href="#cb35-35" tabindex="-1"></a>  <span class="cf">return</span> image<span class="op">.</span><span class="fu">addBands</span>(ndvi)<span class="op">;</span></span>
<span id="cb35-36"><a href="#cb35-36" tabindex="-1"></a>}</span>
<span id="cb35-37"><a href="#cb35-37" tabindex="-1"></a></span>
<span id="cb35-38"><a href="#cb35-38" tabindex="-1"></a><span class="co">// Map the function over the collection</span></span>
<span id="cb35-39"><a href="#cb35-39" tabindex="-1"></a><span class="kw">var</span> withNdvi <span class="op">=</span> filtered<span class="op">.</span><span class="fu">map</span>(addNDVI)<span class="op">;</span></span>
<span id="cb35-40"><a href="#cb35-40" tabindex="-1"></a></span>
<span id="cb35-41"><a href="#cb35-41" tabindex="-1"></a><span class="co">// Extract the values from each image</span></span>
<span id="cb35-42"><a href="#cb35-42" tabindex="-1"></a><span class="kw">var</span> values <span class="op">=</span> withNdvi<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(image) {</span>
<span id="cb35-43"><a href="#cb35-43" tabindex="-1"></a>  <span class="kw">var</span> ndvi <span class="op">=</span> image<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;ndvi&#39;</span>)<span class="op">;</span></span>
<span id="cb35-44"><a href="#cb35-44" tabindex="-1"></a>  </span>
<span id="cb35-45"><a href="#cb35-45" tabindex="-1"></a>  <span class="kw">var</span> allReducers <span class="op">=</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">median</span>()</span>
<span id="cb35-46"><a href="#cb35-46" tabindex="-1"></a>    <span class="op">.</span><span class="fu">combine</span>({<span class="dt">reducer2</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">min</span>()<span class="op">,</span> <span class="dt">sharedInputs</span><span class="op">:</span> <span class="kw">true</span>} )</span>
<span id="cb35-47"><a href="#cb35-47" tabindex="-1"></a>    <span class="op">.</span><span class="fu">combine</span>({<span class="dt">reducer2</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">max</span>()<span class="op">,</span> <span class="dt">sharedInputs</span><span class="op">:</span> <span class="kw">true</span>} )</span>
<span id="cb35-48"><a href="#cb35-48" tabindex="-1"></a>    <span class="op">.</span><span class="fu">combine</span>({<span class="dt">reducer2</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">percentile</span>([<span class="dv">25</span>])<span class="op">,</span> <span class="dt">sharedInputs</span><span class="op">:</span> <span class="kw">true</span>} )</span>
<span id="cb35-49"><a href="#cb35-49" tabindex="-1"></a>    <span class="op">.</span><span class="fu">combine</span>({<span class="dt">reducer2</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">percentile</span>([<span class="dv">50</span>])<span class="op">,</span> <span class="dt">sharedInputs</span><span class="op">:</span> <span class="kw">true</span>} )</span>
<span id="cb35-50"><a href="#cb35-50" tabindex="-1"></a>    <span class="op">.</span><span class="fu">combine</span>({<span class="dt">reducer2</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">percentile</span>([<span class="dv">75</span>])<span class="op">,</span> <span class="dt">sharedInputs</span><span class="op">:</span> <span class="kw">true</span>} )</span>
<span id="cb35-51"><a href="#cb35-51" tabindex="-1"></a>  </span>
<span id="cb35-52"><a href="#cb35-52" tabindex="-1"></a>  <span class="kw">var</span> stats <span class="op">=</span> ndvi<span class="op">.</span><span class="fu">reduceRegion</span>({</span>
<span id="cb35-53"><a href="#cb35-53" tabindex="-1"></a>    <span class="dt">reducer</span><span class="op">:</span> allReducers<span class="op">,</span></span>
<span id="cb35-54"><a href="#cb35-54" tabindex="-1"></a>    <span class="dt">geometry</span><span class="op">:</span> geometry<span class="op">,</span></span>
<span id="cb35-55"><a href="#cb35-55" tabindex="-1"></a>    <span class="dt">scale</span><span class="op">:</span> <span class="dv">10</span>})<span class="op">;</span></span>
<span id="cb35-56"><a href="#cb35-56" tabindex="-1"></a>  <span class="kw">var</span> date <span class="op">=</span> image<span class="op">.</span><span class="fu">date</span>()<span class="op">;</span></span>
<span id="cb35-57"><a href="#cb35-57" tabindex="-1"></a>  <span class="kw">var</span> dateString <span class="op">=</span> date<span class="op">.</span><span class="fu">format</span>(<span class="st">&#39;YYYY-MM-dd&#39;</span>)<span class="op">;</span></span>
<span id="cb35-58"><a href="#cb35-58" tabindex="-1"></a></span>
<span id="cb35-59"><a href="#cb35-59" tabindex="-1"></a>  <span class="kw">var</span> properties <span class="op">=</span> {</span>
<span id="cb35-60"><a href="#cb35-60" tabindex="-1"></a>    <span class="st">&#39;date&#39;</span><span class="op">:</span> dateString<span class="op">,</span></span>
<span id="cb35-61"><a href="#cb35-61" tabindex="-1"></a>    <span class="st">&#39;median&#39;</span><span class="op">:</span> stats<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;ndvi_p50&#39;</span>)<span class="op">,</span> <span class="co">// median is 50th percentile</span></span>
<span id="cb35-62"><a href="#cb35-62" tabindex="-1"></a>    <span class="st">&#39;min&#39;</span><span class="op">:</span> stats<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;ndvi_min&#39;</span>)<span class="op">,</span></span>
<span id="cb35-63"><a href="#cb35-63" tabindex="-1"></a>    <span class="st">&#39;max&#39;</span><span class="op">:</span> stats<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;ndvi_max&#39;</span>)<span class="op">,</span></span>
<span id="cb35-64"><a href="#cb35-64" tabindex="-1"></a>    <span class="st">&#39;p25&#39;</span><span class="op">:</span> stats<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;ndvi_p25&#39;</span>)<span class="op">,</span></span>
<span id="cb35-65"><a href="#cb35-65" tabindex="-1"></a>    <span class="st">&#39;p50&#39;</span><span class="op">:</span> stats<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;ndvi_p50&#39;</span>)<span class="op">,</span></span>
<span id="cb35-66"><a href="#cb35-66" tabindex="-1"></a>    <span class="st">&#39;p75&#39;</span><span class="op">:</span> stats<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;ndvi_p75&#39;</span>)<span class="op">,</span></span>
<span id="cb35-67"><a href="#cb35-67" tabindex="-1"></a>  }</span>
<span id="cb35-68"><a href="#cb35-68" tabindex="-1"></a>  <span class="cf">return</span> ee<span class="op">.</span><span class="fu">Feature</span>(<span class="kw">null</span><span class="op">,</span> properties)</span>
<span id="cb35-69"><a href="#cb35-69" tabindex="-1"></a>  </span>
<span id="cb35-70"><a href="#cb35-70" tabindex="-1"></a>})</span>
<span id="cb35-71"><a href="#cb35-71" tabindex="-1"></a><span class="co">// Remove null values</span></span>
<span id="cb35-72"><a href="#cb35-72" tabindex="-1"></a><span class="kw">var</span> values <span class="op">=</span> values<span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">notNull</span>(</span>
<span id="cb35-73"><a href="#cb35-73" tabindex="-1"></a>  [<span class="st">&#39;median&#39;</span><span class="op">,</span> <span class="st">&#39;min&#39;</span><span class="op">,</span> <span class="st">&#39;max&#39;</span><span class="op">,</span> <span class="st">&#39;p25&#39;</span><span class="op">,</span> <span class="st">&#39;p50&#39;</span><span class="op">,</span> <span class="st">&#39;p75&#39;</span>]))<span class="op">;</span></span>
<span id="cb35-74"><a href="#cb35-74" tabindex="-1"></a><span class="fu">print</span>(values)</span>
<span id="cb35-75"><a href="#cb35-75" tabindex="-1"></a></span>
<span id="cb35-76"><a href="#cb35-76" tabindex="-1"></a><span class="co">// Format the results as a list of DataTable rows</span></span>
<span id="cb35-77"><a href="#cb35-77" tabindex="-1"></a></span>
<span id="cb35-78"><a href="#cb35-78" tabindex="-1"></a><span class="co">// We need a list to map() over</span></span>
<span id="cb35-79"><a href="#cb35-79" tabindex="-1"></a><span class="kw">var</span> dateList <span class="op">=</span> values<span class="op">.</span><span class="fu">aggregate_array</span>(<span class="st">&#39;date&#39;</span>)<span class="op">;</span></span>
<span id="cb35-80"><a href="#cb35-80" tabindex="-1"></a></span>
<span id="cb35-81"><a href="#cb35-81" tabindex="-1"></a><span class="co">// Helper function to format dates as per DataTable requirements</span></span>
<span id="cb35-82"><a href="#cb35-82" tabindex="-1"></a><span class="co">// Converts date strings</span></span>
<span id="cb35-83"><a href="#cb35-83" tabindex="-1"></a><span class="co">// &#39;2017-01-01&#39; becomes &#39;Date(2017,0,1)&#39;</span></span>
<span id="cb35-84"><a href="#cb35-84" tabindex="-1"></a><span class="co">// month is indexed from 0 in Date String representation</span></span>
<span id="cb35-85"><a href="#cb35-85" tabindex="-1"></a><span class="kw">function</span> <span class="fu">formatDate</span>(date) {</span>
<span id="cb35-86"><a href="#cb35-86" tabindex="-1"></a>  <span class="kw">var</span> year <span class="op">=</span> ee<span class="op">.</span><span class="fu">Date</span>(date)<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;year&#39;</span>)<span class="op">.</span><span class="fu">format</span>()</span>
<span id="cb35-87"><a href="#cb35-87" tabindex="-1"></a>  <span class="kw">var</span> month <span class="op">=</span> ee<span class="op">.</span><span class="fu">Date</span>(date)<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;month&#39;</span>)<span class="op">.</span><span class="fu">subtract</span>(<span class="dv">1</span>)<span class="op">.</span><span class="fu">format</span>()</span>
<span id="cb35-88"><a href="#cb35-88" tabindex="-1"></a>  <span class="kw">var</span> day <span class="op">=</span> ee<span class="op">.</span><span class="fu">Date</span>(date)<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;day&#39;</span>)<span class="op">.</span><span class="fu">format</span>()</span>
<span id="cb35-89"><a href="#cb35-89" tabindex="-1"></a>  <span class="cf">return</span> ee<span class="op">.</span><span class="fu">String</span>(<span class="st">&#39;Date(&#39;</span>)</span>
<span id="cb35-90"><a href="#cb35-90" tabindex="-1"></a>    <span class="op">.</span><span class="fu">cat</span>(year)</span>
<span id="cb35-91"><a href="#cb35-91" tabindex="-1"></a>    <span class="op">.</span><span class="fu">cat</span>(<span class="st">&#39;, &#39;</span>)</span>
<span id="cb35-92"><a href="#cb35-92" tabindex="-1"></a>    <span class="op">.</span><span class="fu">cat</span>(month)</span>
<span id="cb35-93"><a href="#cb35-93" tabindex="-1"></a>    <span class="op">.</span><span class="fu">cat</span>(<span class="st">&#39;, &#39;</span>)</span>
<span id="cb35-94"><a href="#cb35-94" tabindex="-1"></a>    <span class="op">.</span><span class="fu">cat</span>(day)</span>
<span id="cb35-95"><a href="#cb35-95" tabindex="-1"></a>    <span class="op">.</span><span class="fu">cat</span>(ee<span class="op">.</span><span class="fu">String</span>(<span class="st">&#39;)&#39;</span>))<span class="op">;</span></span>
<span id="cb35-96"><a href="#cb35-96" tabindex="-1"></a>}</span>
<span id="cb35-97"><a href="#cb35-97" tabindex="-1"></a></span>
<span id="cb35-98"><a href="#cb35-98" tabindex="-1"></a><span class="co">// We will compute the values to display whiskers</span></span>
<span id="cb35-99"><a href="#cb35-99" tabindex="-1"></a><span class="co">// at 1.5*(Inter-Quartile Range)</span></span>
<span id="cb35-100"><a href="#cb35-100" tabindex="-1"></a><span class="co">// If the minimum or maximum values fall outside</span></span>
<span id="cb35-101"><a href="#cb35-101" tabindex="-1"></a><span class="co">// if this range, they will be considered outliers.</span></span>
<span id="cb35-102"><a href="#cb35-102" tabindex="-1"></a><span class="kw">var</span> rowList <span class="op">=</span> dateList<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(date) {</span>
<span id="cb35-103"><a href="#cb35-103" tabindex="-1"></a>  <span class="kw">var</span> f <span class="op">=</span> values<span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">eq</span>(<span class="st">&#39;date&#39;</span><span class="op">,</span> date))<span class="op">.</span><span class="fu">first</span>()<span class="op">;</span></span>
<span id="cb35-104"><a href="#cb35-104" tabindex="-1"></a>  <span class="kw">var</span> x <span class="op">=</span> <span class="fu">formatDate</span>(date)<span class="op">;</span></span>
<span id="cb35-105"><a href="#cb35-105" tabindex="-1"></a>  <span class="kw">var</span> median <span class="op">=</span> f<span class="op">.</span><span class="fu">getNumber</span>(<span class="st">&#39;median&#39;</span>)<span class="op">;</span></span>
<span id="cb35-106"><a href="#cb35-106" tabindex="-1"></a>  <span class="kw">var</span> p25 <span class="op">=</span> f<span class="op">.</span><span class="fu">getNumber</span>(<span class="st">&#39;p25&#39;</span>)<span class="op">;</span></span>
<span id="cb35-107"><a href="#cb35-107" tabindex="-1"></a>  <span class="kw">var</span> p50 <span class="op">=</span> f<span class="op">.</span><span class="fu">getNumber</span>(<span class="st">&#39;p50&#39;</span>)<span class="op">;</span></span>
<span id="cb35-108"><a href="#cb35-108" tabindex="-1"></a>  <span class="kw">var</span> p75 <span class="op">=</span> f<span class="op">.</span><span class="fu">getNumber</span>(<span class="st">&#39;p75&#39;</span>)<span class="op">;</span></span>
<span id="cb35-109"><a href="#cb35-109" tabindex="-1"></a>  <span class="co">// Compute min/max as the Inter-Quartile Range (IQR)</span></span>
<span id="cb35-110"><a href="#cb35-110" tabindex="-1"></a>  <span class="kw">var</span> min <span class="op">=</span> ee<span class="op">.</span><span class="at">Number</span><span class="op">.</span><span class="fu">expression</span>(<span class="st">&#39;p25 - 1.5*(p75-p25)&#39;</span><span class="op">,</span> {</span>
<span id="cb35-111"><a href="#cb35-111" tabindex="-1"></a>    <span class="dt">p75</span><span class="op">:</span> ee<span class="op">.</span><span class="fu">Number</span>(p75)<span class="op">,</span></span>
<span id="cb35-112"><a href="#cb35-112" tabindex="-1"></a>    <span class="dt">p25</span><span class="op">:</span> ee<span class="op">.</span><span class="fu">Number</span>(p25)})</span>
<span id="cb35-113"><a href="#cb35-113" tabindex="-1"></a>  <span class="kw">var</span> max <span class="op">=</span> ee<span class="op">.</span><span class="at">Number</span><span class="op">.</span><span class="fu">expression</span>(<span class="st">&#39;p75 + 1.5*(p75-p25)&#39;</span><span class="op">,</span> {</span>
<span id="cb35-114"><a href="#cb35-114" tabindex="-1"></a>    <span class="dt">p75</span><span class="op">:</span> ee<span class="op">.</span><span class="fu">Number</span>(p75)<span class="op">,</span></span>
<span id="cb35-115"><a href="#cb35-115" tabindex="-1"></a>    <span class="dt">p25</span><span class="op">:</span> ee<span class="op">.</span><span class="fu">Number</span>(p25)})</span>
<span id="cb35-116"><a href="#cb35-116" tabindex="-1"></a>  <span class="kw">var</span> minValue <span class="op">=</span> f<span class="op">.</span><span class="fu">getNumber</span>(<span class="st">&#39;min&#39;</span>)<span class="op">;</span></span>
<span id="cb35-117"><a href="#cb35-117" tabindex="-1"></a>  <span class="kw">var</span> maxValue <span class="op">=</span> f<span class="op">.</span><span class="fu">getNumber</span>(<span class="st">&#39;max&#39;</span>)<span class="op">;</span></span>
<span id="cb35-118"><a href="#cb35-118" tabindex="-1"></a>  <span class="co">// Add the outlier if they are outside of IQR</span></span>
<span id="cb35-119"><a href="#cb35-119" tabindex="-1"></a>  <span class="kw">var</span> minOutlier <span class="op">=</span> ee<span class="op">.</span><span class="at">Algorithms</span><span class="op">.</span><span class="fu">If</span>(minValue<span class="op">.</span><span class="fu">lt</span>(min)<span class="op">,</span> minValue<span class="op">,</span> <span class="kw">null</span>)<span class="op">;</span></span>
<span id="cb35-120"><a href="#cb35-120" tabindex="-1"></a>  <span class="kw">var</span> maxOutlier <span class="op">=</span> ee<span class="op">.</span><span class="at">Algorithms</span><span class="op">.</span><span class="fu">If</span>(maxValue<span class="op">.</span><span class="fu">gt</span>(max)<span class="op">,</span> maxValue<span class="op">,</span> <span class="kw">null</span>)<span class="op">;</span></span>
<span id="cb35-121"><a href="#cb35-121" tabindex="-1"></a>  <span class="kw">var</span> rowDict <span class="op">=</span> {</span>
<span id="cb35-122"><a href="#cb35-122" tabindex="-1"></a>    <span class="dt">c</span><span class="op">:</span> [{<span class="dt">v</span><span class="op">:</span> x}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> median}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> minOutlier}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> maxOutlier}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> min}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> max}<span class="op">,</span></span>
<span id="cb35-123"><a href="#cb35-123" tabindex="-1"></a>        {<span class="dt">v</span><span class="op">:</span> p25}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> p50}<span class="op">,</span> {<span class="dt">v</span><span class="op">:</span> p75}]</span>
<span id="cb35-124"><a href="#cb35-124" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb35-125"><a href="#cb35-125" tabindex="-1"></a>  <span class="cf">return</span> rowDict<span class="op">;</span></span>
<span id="cb35-126"><a href="#cb35-126" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb35-127"><a href="#cb35-127" tabindex="-1"></a></span>
<span id="cb35-128"><a href="#cb35-128" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;Rows&#39;</span><span class="op">,</span> rowList)<span class="op">;</span></span>
<span id="cb35-129"><a href="#cb35-129" tabindex="-1"></a></span>
<span id="cb35-130"><a href="#cb35-130" tabindex="-1"></a><span class="co">// We need to convert the server-side rowList object</span></span>
<span id="cb35-131"><a href="#cb35-131" tabindex="-1"></a><span class="co">// to client-side javascript object</span></span>
<span id="cb35-132"><a href="#cb35-132" tabindex="-1"></a><span class="co">// use evaluate()</span></span>
<span id="cb35-133"><a href="#cb35-133" tabindex="-1"></a>rowList<span class="op">.</span><span class="fu">evaluate</span>(<span class="kw">function</span>(rowListClient) {</span>
<span id="cb35-134"><a href="#cb35-134" tabindex="-1"></a>  <span class="kw">var</span> dataTable <span class="op">=</span> {</span>
<span id="cb35-135"><a href="#cb35-135" tabindex="-1"></a>    <span class="dt">cols</span><span class="op">:</span> [</span>
<span id="cb35-136"><a href="#cb35-136" tabindex="-1"></a>      {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;x&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;date&#39;</span>}<span class="op">,</span></span>
<span id="cb35-137"><a href="#cb35-137" tabindex="-1"></a>      {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;median&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;number&#39;</span>}<span class="op">,</span></span>
<span id="cb35-138"><a href="#cb35-138" tabindex="-1"></a>      {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;minOutlier&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;number&#39;</span><span class="op">,</span> <span class="dt">role</span><span class="op">:</span> <span class="st">&#39;interval&#39;</span>}<span class="op">,</span></span>
<span id="cb35-139"><a href="#cb35-139" tabindex="-1"></a>      {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;maxOutlier&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;number&#39;</span><span class="op">,</span> <span class="dt">role</span><span class="op">:</span> <span class="st">&#39;interval&#39;</span>}<span class="op">,</span></span>
<span id="cb35-140"><a href="#cb35-140" tabindex="-1"></a>      {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;min&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;number&#39;</span><span class="op">,</span> <span class="dt">role</span><span class="op">:</span> <span class="st">&#39;interval&#39;</span>}<span class="op">,</span></span>
<span id="cb35-141"><a href="#cb35-141" tabindex="-1"></a>      {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;max&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;number&#39;</span><span class="op">,</span> <span class="dt">role</span><span class="op">:</span> <span class="st">&#39;interval&#39;</span>}<span class="op">,</span></span>
<span id="cb35-142"><a href="#cb35-142" tabindex="-1"></a>      {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;firstQuartile&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;number&#39;</span><span class="op">,</span> <span class="dt">role</span><span class="op">:</span> <span class="st">&#39;interval&#39;</span>}<span class="op">,</span></span>
<span id="cb35-143"><a href="#cb35-143" tabindex="-1"></a>      {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;median&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;number&#39;</span><span class="op">,</span> <span class="dt">role</span><span class="op">:</span> <span class="st">&#39;interval&#39;</span>}<span class="op">,</span></span>
<span id="cb35-144"><a href="#cb35-144" tabindex="-1"></a>      {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;thirdQuartile&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span><span class="st">&#39;number&#39;</span><span class="op">,</span> <span class="dt">role</span><span class="op">:</span> <span class="st">&#39;interval&#39;</span>}<span class="op">,</span></span>
<span id="cb35-145"><a href="#cb35-145" tabindex="-1"></a></span>
<span id="cb35-146"><a href="#cb35-146" tabindex="-1"></a>    ]<span class="op">,</span></span>
<span id="cb35-147"><a href="#cb35-147" tabindex="-1"></a>    <span class="dt">rows</span><span class="op">:</span> rowListClient</span>
<span id="cb35-148"><a href="#cb35-148" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb35-149"><a href="#cb35-149" tabindex="-1"></a></span>
<span id="cb35-150"><a href="#cb35-150" tabindex="-1"></a>  <span class="kw">var</span> options <span class="op">=</span> {</span>
<span id="cb35-151"><a href="#cb35-151" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span><span class="st">&#39;NDVI Time-Series Box Plot with Outliers&#39;</span><span class="op">,</span></span>
<span id="cb35-152"><a href="#cb35-152" tabindex="-1"></a>    <span class="dt">vAxis</span><span class="op">:</span> {</span>
<span id="cb35-153"><a href="#cb35-153" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;NDVI&#39;</span><span class="op">,</span></span>
<span id="cb35-154"><a href="#cb35-154" tabindex="-1"></a>      <span class="dt">gridlines</span><span class="op">:</span> {</span>
<span id="cb35-155"><a href="#cb35-155" tabindex="-1"></a>        <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;#d9d9d9&#39;</span></span>
<span id="cb35-156"><a href="#cb35-156" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb35-157"><a href="#cb35-157" tabindex="-1"></a>      <span class="dt">minorGridlines</span><span class="op">:</span> {</span>
<span id="cb35-158"><a href="#cb35-158" tabindex="-1"></a>        <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;transparent&#39;</span></span>
<span id="cb35-159"><a href="#cb35-159" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb35-160"><a href="#cb35-160" tabindex="-1"></a>      <span class="dt">viewWindow</span><span class="op">:</span> {</span>
<span id="cb35-161"><a href="#cb35-161" tabindex="-1"></a>        <span class="dt">min</span><span class="op">:</span> <span class="op">-</span><span class="fl">0.2</span><span class="op">,</span></span>
<span id="cb35-162"><a href="#cb35-162" tabindex="-1"></a>        <span class="dt">max</span><span class="op">:</span> <span class="dv">1</span></span>
<span id="cb35-163"><a href="#cb35-163" tabindex="-1"></a>      }</span>
<span id="cb35-164"><a href="#cb35-164" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb35-165"><a href="#cb35-165" tabindex="-1"></a>    <span class="dt">hAxis</span><span class="op">:</span> {</span>
<span id="cb35-166"><a href="#cb35-166" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;&#39;</span><span class="op">,</span></span>
<span id="cb35-167"><a href="#cb35-167" tabindex="-1"></a>      <span class="dt">format</span><span class="op">:</span> <span class="st">&#39;YYYY-MMM&#39;</span><span class="op">,</span></span>
<span id="cb35-168"><a href="#cb35-168" tabindex="-1"></a>      <span class="dt">viewWindow</span><span class="op">:</span> {</span>
<span id="cb35-169"><a href="#cb35-169" tabindex="-1"></a>        <span class="dt">min</span><span class="op">:</span> <span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2017</span><span class="op">,</span> <span class="dv">0</span>)<span class="op">,</span></span>
<span id="cb35-170"><a href="#cb35-170" tabindex="-1"></a>        <span class="dt">max</span><span class="op">:</span> <span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2018</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb35-171"><a href="#cb35-171" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb35-172"><a href="#cb35-172" tabindex="-1"></a>      <span class="dt">gridlines</span><span class="op">:</span> {</span>
<span id="cb35-173"><a href="#cb35-173" tabindex="-1"></a>        <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;#d9d9d9&#39;</span></span>
<span id="cb35-174"><a href="#cb35-174" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb35-175"><a href="#cb35-175" tabindex="-1"></a>      <span class="dt">minorGridlines</span><span class="op">:</span> {</span>
<span id="cb35-176"><a href="#cb35-176" tabindex="-1"></a>        <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;transparent&#39;</span></span>
<span id="cb35-177"><a href="#cb35-177" tabindex="-1"></a>      }</span>
<span id="cb35-178"><a href="#cb35-178" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb35-179"><a href="#cb35-179" tabindex="-1"></a>    <span class="dt">legend</span><span class="op">:</span> {<span class="dt">position</span><span class="op">:</span> <span class="st">&#39;none&#39;</span>}<span class="op">,</span></span>
<span id="cb35-180"><a href="#cb35-180" tabindex="-1"></a>    <span class="dt">lineWidth</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb35-181"><a href="#cb35-181" tabindex="-1"></a>    <span class="dt">series</span><span class="op">:</span> [{<span class="st">&#39;color&#39;</span><span class="op">:</span> <span class="st">&#39;#D3362D&#39;</span>}]<span class="op">,</span></span>
<span id="cb35-182"><a href="#cb35-182" tabindex="-1"></a>    <span class="dt">interpolateNulls</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb35-183"><a href="#cb35-183" tabindex="-1"></a>    <span class="dt">intervals</span><span class="op">:</span> {</span>
<span id="cb35-184"><a href="#cb35-184" tabindex="-1"></a>      <span class="dt">barWidth</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb35-185"><a href="#cb35-185" tabindex="-1"></a>      <span class="dt">boxWidth</span><span class="op">:</span> <span class="dv">4</span><span class="op">,</span></span>
<span id="cb35-186"><a href="#cb35-186" tabindex="-1"></a>      <span class="dt">lineWidth</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb35-187"><a href="#cb35-187" tabindex="-1"></a>      <span class="dt">style</span><span class="op">:</span> <span class="st">&#39;boxes&#39;</span></span>
<span id="cb35-188"><a href="#cb35-188" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb35-189"><a href="#cb35-189" tabindex="-1"></a>    <span class="dt">interval</span><span class="op">:</span> {</span>
<span id="cb35-190"><a href="#cb35-190" tabindex="-1"></a>      <span class="dt">min</span><span class="op">:</span> {</span>
<span id="cb35-191"><a href="#cb35-191" tabindex="-1"></a>        <span class="dt">style</span><span class="op">:</span> <span class="st">&#39;bars&#39;</span><span class="op">,</span></span>
<span id="cb35-192"><a href="#cb35-192" tabindex="-1"></a>        <span class="dt">fillOpacity</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb35-193"><a href="#cb35-193" tabindex="-1"></a>        <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;#777777&#39;</span></span>
<span id="cb35-194"><a href="#cb35-194" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb35-195"><a href="#cb35-195" tabindex="-1"></a>      <span class="dt">max</span><span class="op">:</span> {</span>
<span id="cb35-196"><a href="#cb35-196" tabindex="-1"></a>        <span class="dt">style</span><span class="op">:</span> <span class="st">&#39;bars&#39;</span><span class="op">,</span></span>
<span id="cb35-197"><a href="#cb35-197" tabindex="-1"></a>        <span class="dt">fillOpacity</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb35-198"><a href="#cb35-198" tabindex="-1"></a>        <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;#777777&#39;</span></span>
<span id="cb35-199"><a href="#cb35-199" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb35-200"><a href="#cb35-200" tabindex="-1"></a>      <span class="dt">minOutlier</span><span class="op">:</span> {</span>
<span id="cb35-201"><a href="#cb35-201" tabindex="-1"></a>        <span class="dt">style</span><span class="op">:</span> <span class="st">&#39;points&#39;</span><span class="op">,</span></span>
<span id="cb35-202"><a href="#cb35-202" tabindex="-1"></a>        <span class="dt">pointSize</span><span class="op">:</span> <span class="dv">2</span></span>
<span id="cb35-203"><a href="#cb35-203" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb35-204"><a href="#cb35-204" tabindex="-1"></a>      <span class="dt">maxOutlier</span><span class="op">:</span> {</span>
<span id="cb35-205"><a href="#cb35-205" tabindex="-1"></a>        <span class="dt">style</span><span class="op">:</span> <span class="st">&#39;points&#39;</span><span class="op">,</span></span>
<span id="cb35-206"><a href="#cb35-206" tabindex="-1"></a>        <span class="dt">pointSize</span><span class="op">:</span> <span class="dv">2</span></span>
<span id="cb35-207"><a href="#cb35-207" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb35-208"><a href="#cb35-208" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb35-209"><a href="#cb35-209" tabindex="-1"></a>    <span class="dt">chartArea</span><span class="op">:</span> {<span class="dt">left</span><span class="op">:</span><span class="dv">100</span><span class="op">,</span> <span class="dt">right</span><span class="op">:</span><span class="dv">100</span>}</span>
<span id="cb35-210"><a href="#cb35-210" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb35-211"><a href="#cb35-211" tabindex="-1"></a>    </span>
<span id="cb35-212"><a href="#cb35-212" tabindex="-1"></a>  <span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="fu">Chart</span>(dataTable<span class="op">,</span> <span class="st">&#39;LineChart&#39;</span><span class="op">,</span> options)<span class="op">;</span></span>
<span id="cb35-213"><a href="#cb35-213" tabindex="-1"></a>  <span class="fu">print</span>(chart)<span class="op">;</span></span>
<span id="cb35-214"><a href="#cb35-214" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb35-215"><a href="#cb35-215" tabindex="-1"></a> </span></code></pre></div>
</div>
<div id="spectral-profile-charts-datatable" class="section level2">
<h2>Spectral Profile Charts (DataTable)</h2>
<p>Spectral profile charts allow you to review the spectral signature of
all bands for different classes. Instead of just displaying mean spectra
of multiple pixels, we can use a box plot to show the distribution and
central tendency of pixels. The script shows how to automatically
extract the requires statistics and create a box plot of spectral
profiles for each class.</p>
<div class="figure" style="text-align: center">
<img src="images/gee_charts/spectral_profile.png" alt="Spectral Profile Charts" width="75%" />
<p class="caption">
Spectral Profile Charts
</p>
</div>
<p><a
href="https://code.earthengine.google.co.in/?scriptPath=users%2Fujavalgandhi%2FGEE-Charts%3ASupplement%2FDataTable_Spectral_Profile"
target="_blank">Open in Code Editor ↗</a></p>
<div class="sourceCode" id="cb36"><pre
class="sourceCode js"><code class="sourceCode javascript"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="co">// Example script showing how to create spectral profile</span></span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a><span class="co">// chart for different landcover classes that show</span></span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a><span class="co">// the spread of values using a box plot.</span></span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a><span class="co">// Select a region</span></span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a><span class="kw">var</span> geometry <span class="op">=</span>   ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Polygon</span>([[</span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a>  [<span class="fl">76.816</span><span class="op">,</span> <span class="fl">13.006</span>]<span class="op">,</span>[<span class="fl">76.816</span><span class="op">,</span> <span class="fl">12.901</span>]<span class="op">,</span></span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a>  [<span class="fl">76.899</span><span class="op">,</span> <span class="fl">12.901</span>]<span class="op">,</span>[<span class="fl">76.899</span><span class="op">,</span> <span class="fl">13.006</span>]</span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a>]])<span class="op">;</span></span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a></span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">centerObject</span>(geometry<span class="op">,</span> <span class="dv">12</span>)<span class="op">;</span></span>
<span id="cb36-12"><a href="#cb36-12" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(geometry<span class="op">,</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;gray&#39;</span>}<span class="op">,</span> <span class="st">&#39;Selected Region&#39;</span>)<span class="op">;</span></span>
<span id="cb36-13"><a href="#cb36-13" tabindex="-1"></a></span>
<span id="cb36-14"><a href="#cb36-14" tabindex="-1"></a><span class="co">// We use Sentinel-2 Level-2A data</span></span>
<span id="cb36-15"><a href="#cb36-15" tabindex="-1"></a><span class="kw">var</span> s2 <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&#39;COPERNICUS/S2_SR_HARMONIZED&#39;</span>)<span class="op">;</span></span>
<span id="cb36-16"><a href="#cb36-16" tabindex="-1"></a></span>
<span id="cb36-17"><a href="#cb36-17" tabindex="-1"></a><span class="co">// Write a function for Cloud masking</span></span>
<span id="cb36-18"><a href="#cb36-18" tabindex="-1"></a><span class="kw">var</span> maskS2clouds <span class="op">=</span> <span class="kw">function</span>(image) {</span>
<span id="cb36-19"><a href="#cb36-19" tabindex="-1"></a>  <span class="kw">var</span> qa <span class="op">=</span> image<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;QA60&#39;</span>)</span>
<span id="cb36-20"><a href="#cb36-20" tabindex="-1"></a>  <span class="kw">var</span> cloudBitMask <span class="op">=</span> <span class="dv">1</span> <span class="op">&lt;&lt;</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb36-21"><a href="#cb36-21" tabindex="-1"></a>  <span class="kw">var</span> cirrusBitMask <span class="op">=</span> <span class="dv">1</span> <span class="op">&lt;&lt;</span> <span class="dv">11</span><span class="op">;</span></span>
<span id="cb36-22"><a href="#cb36-22" tabindex="-1"></a>  <span class="kw">var</span> mask <span class="op">=</span> qa<span class="op">.</span><span class="fu">bitwiseAnd</span>(cloudBitMask)<span class="op">.</span><span class="fu">eq</span>(<span class="dv">0</span>)<span class="op">.</span><span class="fu">and</span>(</span>
<span id="cb36-23"><a href="#cb36-23" tabindex="-1"></a>             qa<span class="op">.</span><span class="fu">bitwiseAnd</span>(cirrusBitMask)<span class="op">.</span><span class="fu">eq</span>(<span class="dv">0</span>))</span>
<span id="cb36-24"><a href="#cb36-24" tabindex="-1"></a>  <span class="cf">return</span> image<span class="op">.</span><span class="fu">updateMask</span>(mask)</span>
<span id="cb36-25"><a href="#cb36-25" tabindex="-1"></a>      <span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;B.*&#39;</span>)</span>
<span id="cb36-26"><a href="#cb36-26" tabindex="-1"></a>      <span class="op">.</span><span class="fu">copyProperties</span>(image<span class="op">,</span> [<span class="st">&#39;system:time_start&#39;</span>])</span>
<span id="cb36-27"><a href="#cb36-27" tabindex="-1"></a>}</span>
<span id="cb36-28"><a href="#cb36-28" tabindex="-1"></a></span>
<span id="cb36-29"><a href="#cb36-29" tabindex="-1"></a><span class="co">// Write a function to scale the bands</span></span>
<span id="cb36-30"><a href="#cb36-30" tabindex="-1"></a><span class="kw">var</span> scaleImage <span class="op">=</span> <span class="kw">function</span>(image) {</span>
<span id="cb36-31"><a href="#cb36-31" tabindex="-1"></a>  <span class="cf">return</span> image</span>
<span id="cb36-32"><a href="#cb36-32" tabindex="-1"></a>    <span class="op">.</span><span class="fu">multiply</span>(<span class="fl">0.0001</span>)</span>
<span id="cb36-33"><a href="#cb36-33" tabindex="-1"></a>    <span class="op">.</span><span class="fu">copyProperties</span>(image<span class="op">,</span> [<span class="st">&#39;system:time_start&#39;</span>])</span>
<span id="cb36-34"><a href="#cb36-34" tabindex="-1"></a>}</span>
<span id="cb36-35"><a href="#cb36-35" tabindex="-1"></a></span>
<span id="cb36-36"><a href="#cb36-36" tabindex="-1"></a><span class="kw">var</span> filtered <span class="op">=</span> s2</span>
<span id="cb36-37"><a href="#cb36-37" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">lt</span>(<span class="st">&#39;CLOUDY_PIXEL_PERCENTAGE&#39;</span><span class="op">,</span> <span class="dv">30</span>))</span>
<span id="cb36-38"><a href="#cb36-38" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">bounds</span>(geometry))</span>
<span id="cb36-39"><a href="#cb36-39" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">date</span>(<span class="st">&#39;2021-01-01&#39;</span><span class="op">,</span> <span class="st">&#39;2022-01-01&#39;</span>))</span>
<span id="cb36-40"><a href="#cb36-40" tabindex="-1"></a>  <span class="op">.</span><span class="fu">map</span>(maskS2clouds)</span>
<span id="cb36-41"><a href="#cb36-41" tabindex="-1"></a>  <span class="op">.</span><span class="fu">map</span>(scaleImage)<span class="op">;</span></span>
<span id="cb36-42"><a href="#cb36-42" tabindex="-1"></a>  </span>
<span id="cb36-43"><a href="#cb36-43" tabindex="-1"></a><span class="co">// Create a median composite for 2021</span></span>
<span id="cb36-44"><a href="#cb36-44" tabindex="-1"></a><span class="kw">var</span> composite <span class="op">=</span>  filtered<span class="op">.</span><span class="fu">median</span>()<span class="op">;</span></span>
<span id="cb36-45"><a href="#cb36-45" tabindex="-1"></a></span>
<span id="cb36-46"><a href="#cb36-46" tabindex="-1"></a><span class="kw">var</span> rgbVis <span class="op">=</span> {<span class="dt">min</span><span class="op">:</span> <span class="fl">0.0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="fl">0.3</span><span class="op">,</span> <span class="dt">bands</span><span class="op">:</span> [<span class="st">&#39;B4&#39;</span><span class="op">,</span> <span class="st">&#39;B3&#39;</span><span class="op">,</span> <span class="st">&#39;B2&#39;</span>]}<span class="op">;</span></span>
<span id="cb36-47"><a href="#cb36-47" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(composite<span class="op">.</span><span class="fu">clip</span>(geometry)<span class="op">,</span> rgbVis<span class="op">,</span> <span class="st">&#39;2020 Composite&#39;</span>)<span class="op">;</span></span>
<span id="cb36-48"><a href="#cb36-48" tabindex="-1"></a></span>
<span id="cb36-49"><a href="#cb36-49" tabindex="-1"></a><span class="co">// We use the ESA WorldCover 2021 dataset</span></span>
<span id="cb36-50"><a href="#cb36-50" tabindex="-1"></a><span class="kw">var</span> worldcover <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&#39;ESA/WorldCover/v200&#39;</span>)<span class="op">.</span><span class="fu">first</span>()<span class="op">;</span></span>
<span id="cb36-51"><a href="#cb36-51" tabindex="-1"></a></span>
<span id="cb36-52"><a href="#cb36-52" tabindex="-1"></a><span class="co">// The image has 11 classes</span></span>
<span id="cb36-53"><a href="#cb36-53" tabindex="-1"></a><span class="co">// Remap the class values to have continuous values</span></span>
<span id="cb36-54"><a href="#cb36-54" tabindex="-1"></a><span class="co">// from 0 to 10</span></span>
<span id="cb36-55"><a href="#cb36-55" tabindex="-1"></a><span class="kw">var</span> classified <span class="op">=</span> worldcover<span class="op">.</span><span class="fu">remap</span>(</span>
<span id="cb36-56"><a href="#cb36-56" tabindex="-1"></a>  [<span class="dv">10</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">30</span><span class="op">,</span> <span class="dv">40</span><span class="op">,</span> <span class="dv">50</span><span class="op">,</span> <span class="dv">60</span><span class="op">,</span> <span class="dv">70</span><span class="op">,</span> <span class="dv">80</span><span class="op">,</span> <span class="dv">90</span><span class="op">,</span> <span class="dv">95</span><span class="op">,</span> <span class="dv">100</span>]<span class="op">,</span></span>
<span id="cb36-57"><a href="#cb36-57" tabindex="-1"></a>  [<span class="dv">0</span><span class="op">,</span>  <span class="dv">1</span> <span class="op">,</span> <span class="dv">2</span><span class="op">,</span>  <span class="dv">3</span><span class="op">,</span>  <span class="dv">4</span><span class="op">,</span>  <span class="dv">5</span><span class="op">,</span>  <span class="dv">6</span><span class="op">,</span>  <span class="dv">7</span><span class="op">,</span>  <span class="dv">8</span><span class="op">,</span>  <span class="dv">9</span><span class="op">,</span>  <span class="dv">10</span>])<span class="op">.</span><span class="fu">rename</span>(<span class="st">&#39;classification&#39;</span>)<span class="op">;</span></span>
<span id="cb36-58"><a href="#cb36-58" tabindex="-1"></a></span>
<span id="cb36-59"><a href="#cb36-59" tabindex="-1"></a><span class="co">// Define a list of class names</span></span>
<span id="cb36-60"><a href="#cb36-60" tabindex="-1"></a><span class="kw">var</span> worldCoverClassNames<span class="op">=</span> [</span>
<span id="cb36-61"><a href="#cb36-61" tabindex="-1"></a>  <span class="st">&#39;Tree Cover&#39;</span><span class="op">,</span> <span class="st">&#39;Shrubland&#39;</span><span class="op">,</span> <span class="st">&#39;Grassland&#39;</span><span class="op">,</span> <span class="st">&#39;Cropland&#39;</span><span class="op">,</span> <span class="st">&#39;Built-up&#39;</span><span class="op">,</span></span>
<span id="cb36-62"><a href="#cb36-62" tabindex="-1"></a>  <span class="st">&#39;Bare / sparse Vegetation&#39;</span><span class="op">,</span> <span class="st">&#39;Snow and Ice&#39;</span><span class="op">,</span> </span>
<span id="cb36-63"><a href="#cb36-63" tabindex="-1"></a>  <span class="st">&#39;Permanent Water Bodies&#39;</span><span class="op">,</span> <span class="st">&#39;Herbaceous Wetland&#39;</span><span class="op">,</span> </span>
<span id="cb36-64"><a href="#cb36-64" tabindex="-1"></a>  <span class="st">&#39;Mangroves&#39;</span><span class="op">,</span> <span class="st">&#39;Moss and Lichen&#39;</span>]<span class="op">;</span></span>
<span id="cb36-65"><a href="#cb36-65" tabindex="-1"></a><span class="co">// Define a list of class colors</span></span>
<span id="cb36-66"><a href="#cb36-66" tabindex="-1"></a><span class="kw">var</span> worldCoverPalette <span class="op">=</span> [</span>
<span id="cb36-67"><a href="#cb36-67" tabindex="-1"></a>  <span class="st">&#39;006400&#39;</span><span class="op">,</span> <span class="st">&#39;ffbb22&#39;</span><span class="op">,</span> <span class="st">&#39;ffff4c&#39;</span><span class="op">,</span> <span class="st">&#39;f096ff&#39;</span><span class="op">,</span> <span class="st">&#39;fa0000&#39;</span><span class="op">,</span></span>
<span id="cb36-68"><a href="#cb36-68" tabindex="-1"></a>  <span class="st">&#39;b4b4b4&#39;</span><span class="op">,</span> <span class="st">&#39;f0f0f0&#39;</span><span class="op">,</span> <span class="st">&#39;0064c8&#39;</span><span class="op">,</span> <span class="st">&#39;0096a0&#39;</span><span class="op">,</span> <span class="st">&#39;00cf75&#39;</span><span class="op">,</span></span>
<span id="cb36-69"><a href="#cb36-69" tabindex="-1"></a>  <span class="st">&#39;fae6a0&#39;</span>]<span class="op">;</span></span>
<span id="cb36-70"><a href="#cb36-70" tabindex="-1"></a><span class="co">// We define a dictionary with class names</span></span>
<span id="cb36-71"><a href="#cb36-71" tabindex="-1"></a><span class="kw">var</span> classNames <span class="op">=</span> ee<span class="op">.</span><span class="at">Dictionary</span><span class="op">.</span><span class="fu">fromLists</span>(</span>
<span id="cb36-72"><a href="#cb36-72" tabindex="-1"></a>  [<span class="st">&#39;0&#39;</span><span class="op">,</span><span class="st">&#39;1&#39;</span><span class="op">,</span><span class="st">&#39;2&#39;</span><span class="op">,</span><span class="st">&#39;3&#39;</span><span class="op">,</span><span class="st">&#39;4&#39;</span><span class="op">,</span><span class="st">&#39;5&#39;</span><span class="op">,</span><span class="st">&#39;6&#39;</span><span class="op">,</span><span class="st">&#39;7&#39;</span><span class="op">,</span><span class="st">&#39;8&#39;</span><span class="op">,</span><span class="st">&#39;9&#39;</span><span class="op">,</span> <span class="st">&#39;10&#39;</span>]<span class="op">,</span></span>
<span id="cb36-73"><a href="#cb36-73" tabindex="-1"></a>  worldCoverClassNames</span>
<span id="cb36-74"><a href="#cb36-74" tabindex="-1"></a>)<span class="op">;</span></span>
<span id="cb36-75"><a href="#cb36-75" tabindex="-1"></a><span class="co">// We define a dictionary with class colors</span></span>
<span id="cb36-76"><a href="#cb36-76" tabindex="-1"></a><span class="kw">var</span> classColors <span class="op">=</span> ee<span class="op">.</span><span class="at">Dictionary</span><span class="op">.</span><span class="fu">fromLists</span>(</span>
<span id="cb36-77"><a href="#cb36-77" tabindex="-1"></a>  [<span class="st">&#39;0&#39;</span><span class="op">,</span><span class="st">&#39;1&#39;</span><span class="op">,</span><span class="st">&#39;2&#39;</span><span class="op">,</span><span class="st">&#39;3&#39;</span><span class="op">,</span><span class="st">&#39;4&#39;</span><span class="op">,</span><span class="st">&#39;5&#39;</span><span class="op">,</span><span class="st">&#39;6&#39;</span><span class="op">,</span><span class="st">&#39;7&#39;</span><span class="op">,</span><span class="st">&#39;8&#39;</span><span class="op">,</span><span class="st">&#39;9&#39;</span><span class="op">,</span> <span class="st">&#39;10&#39;</span>]<span class="op">,</span></span>
<span id="cb36-78"><a href="#cb36-78" tabindex="-1"></a>  worldCoverPalette</span>
<span id="cb36-79"><a href="#cb36-79" tabindex="-1"></a>)<span class="op">;</span></span>
<span id="cb36-80"><a href="#cb36-80" tabindex="-1"></a><span class="kw">var</span> worldCoverVisParams <span class="op">=</span> {<span class="dt">min</span><span class="op">:</span><span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span><span class="dv">10</span><span class="op">,</span> <span class="dt">palette</span><span class="op">:</span> worldCoverPalette}<span class="op">;</span></span>
<span id="cb36-81"><a href="#cb36-81" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(classified<span class="op">.</span><span class="fu">clip</span>(geometry)<span class="op">,</span> worldCoverVisParams<span class="op">,</span> <span class="st">&#39;Landcover&#39;</span>)<span class="op">;</span></span>
<span id="cb36-82"><a href="#cb36-82" tabindex="-1"></a></span>
<span id="cb36-83"><a href="#cb36-83" tabindex="-1"></a><span class="co">// We sample spectral values from S2 image for each class</span></span>
<span id="cb36-84"><a href="#cb36-84" tabindex="-1"></a><span class="kw">var</span> samples <span class="op">=</span> composite<span class="op">.</span><span class="fu">addBands</span>(classified)</span>
<span id="cb36-85"><a href="#cb36-85" tabindex="-1"></a>  <span class="op">.</span><span class="fu">stratifiedSample</span>({</span>
<span id="cb36-86"><a href="#cb36-86" tabindex="-1"></a>    <span class="dt">numPoints</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span></span>
<span id="cb36-87"><a href="#cb36-87" tabindex="-1"></a>    <span class="dt">classBand</span><span class="op">:</span> <span class="st">&#39;classification&#39;</span><span class="op">,</span></span>
<span id="cb36-88"><a href="#cb36-88" tabindex="-1"></a>    <span class="dt">region</span><span class="op">:</span> geometry<span class="op">,</span> </span>
<span id="cb36-89"><a href="#cb36-89" tabindex="-1"></a>    <span class="dt">scale</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span></span>
<span id="cb36-90"><a href="#cb36-90" tabindex="-1"></a>    <span class="dt">tileScale</span><span class="op">:</span> <span class="dv">16</span><span class="op">,</span></span>
<span id="cb36-91"><a href="#cb36-91" tabindex="-1"></a>    <span class="dt">geometries</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb36-92"><a href="#cb36-92" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb36-93"><a href="#cb36-93" tabindex="-1"></a>  </span>
<span id="cb36-94"><a href="#cb36-94" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;Stratified Samples&#39;</span><span class="op">,</span> samples)<span class="op">;</span></span>
<span id="cb36-95"><a href="#cb36-95" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(samples<span class="op">,</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;red&#39;</span>}<span class="op">,</span> <span class="st">&#39;Samples&#39;</span>)<span class="op">;</span></span>
<span id="cb36-96"><a href="#cb36-96" tabindex="-1"></a></span>
<span id="cb36-97"><a href="#cb36-97" tabindex="-1"></a><span class="co">// To create a box plot, we need minimum, maximum,</span></span>
<span id="cb36-98"><a href="#cb36-98" tabindex="-1"></a><span class="co">// median and 25- and 75-percentile values for</span></span>
<span id="cb36-99"><a href="#cb36-99" tabindex="-1"></a><span class="co">// each band for each class</span></span>
<span id="cb36-100"><a href="#cb36-100" tabindex="-1"></a><span class="kw">var</span> bands <span class="op">=</span> composite<span class="op">.</span><span class="fu">bandNames</span>()<span class="op">;</span></span>
<span id="cb36-101"><a href="#cb36-101" tabindex="-1"></a><span class="kw">var</span> properties <span class="op">=</span> bands<span class="op">.</span><span class="fu">add</span>(<span class="st">&#39;classification&#39;</span>)<span class="op">;</span></span>
<span id="cb36-102"><a href="#cb36-102" tabindex="-1"></a></span>
<span id="cb36-103"><a href="#cb36-103" tabindex="-1"></a><span class="co">// Now we have multiple columns, so we have to repeat the reducer</span></span>
<span id="cb36-104"><a href="#cb36-104" tabindex="-1"></a><span class="kw">var</span> numBands <span class="op">=</span> bands<span class="op">.</span><span class="fu">length</span>()<span class="op">;</span></span>
<span id="cb36-105"><a href="#cb36-105" tabindex="-1"></a></span>
<span id="cb36-106"><a href="#cb36-106" tabindex="-1"></a><span class="co">// We need the index of the group band</span></span>
<span id="cb36-107"><a href="#cb36-107" tabindex="-1"></a><span class="kw">var</span> groupIndex <span class="op">=</span> properties<span class="op">.</span><span class="fu">indexOf</span>(<span class="st">&#39;classification&#39;</span>)<span class="op">;</span></span>
<span id="cb36-108"><a href="#cb36-108" tabindex="-1"></a></span>
<span id="cb36-109"><a href="#cb36-109" tabindex="-1"></a><span class="co">// Create a combined reducer for all required statistics</span></span>
<span id="cb36-110"><a href="#cb36-110" tabindex="-1"></a><span class="kw">var</span> allReducers <span class="op">=</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">median</span>()</span>
<span id="cb36-111"><a href="#cb36-111" tabindex="-1"></a>  <span class="op">.</span><span class="fu">combine</span>({<span class="dt">reducer2</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">min</span>()<span class="op">,</span> <span class="dt">sharedInputs</span><span class="op">:</span> <span class="kw">true</span>} )</span>
<span id="cb36-112"><a href="#cb36-112" tabindex="-1"></a>  <span class="op">.</span><span class="fu">combine</span>({<span class="dt">reducer2</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">max</span>()<span class="op">,</span> <span class="dt">sharedInputs</span><span class="op">:</span> <span class="kw">true</span>} )</span>
<span id="cb36-113"><a href="#cb36-113" tabindex="-1"></a>  <span class="op">.</span><span class="fu">combine</span>({<span class="dt">reducer2</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">percentile</span>([<span class="dv">25</span>])<span class="op">,</span> <span class="dt">sharedInputs</span><span class="op">:</span> <span class="kw">true</span>} )</span>
<span id="cb36-114"><a href="#cb36-114" tabindex="-1"></a>  <span class="op">.</span><span class="fu">combine</span>({<span class="dt">reducer2</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">percentile</span>([<span class="dv">75</span>])<span class="op">,</span> <span class="dt">sharedInputs</span><span class="op">:</span> <span class="kw">true</span>} )</span>
<span id="cb36-115"><a href="#cb36-115" tabindex="-1"></a></span>
<span id="cb36-116"><a href="#cb36-116" tabindex="-1"></a><span class="co">// Repeat the combined reducer for each band and</span></span>
<span id="cb36-117"><a href="#cb36-117" tabindex="-1"></a><span class="co">// group results by class</span></span>
<span id="cb36-118"><a href="#cb36-118" tabindex="-1"></a><span class="kw">var</span> stats <span class="op">=</span> samples<span class="op">.</span><span class="fu">reduceColumns</span>({</span>
<span id="cb36-119"><a href="#cb36-119" tabindex="-1"></a>    <span class="dt">selectors</span><span class="op">:</span> properties<span class="op">,</span></span>
<span id="cb36-120"><a href="#cb36-120" tabindex="-1"></a>    <span class="dt">reducer</span><span class="op">:</span> allReducers<span class="op">.</span><span class="fu">repeat</span>(numBands)<span class="op">.</span><span class="fu">group</span>({</span>
<span id="cb36-121"><a href="#cb36-121" tabindex="-1"></a>      <span class="dt">groupField</span><span class="op">:</span> groupIndex})<span class="op">,</span></span>
<span id="cb36-122"><a href="#cb36-122" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb36-123"><a href="#cb36-123" tabindex="-1"></a><span class="kw">var</span> groupStats <span class="op">=</span> ee<span class="op">.</span><span class="fu">List</span>(stats<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;groups&#39;</span>))<span class="op">;</span></span>
<span id="cb36-124"><a href="#cb36-124" tabindex="-1"></a><span class="fu">print</span>(groupStats)<span class="op">;</span></span>
<span id="cb36-125"><a href="#cb36-125" tabindex="-1"></a></span>
<span id="cb36-126"><a href="#cb36-126" tabindex="-1"></a><span class="co">// We do some post-processing to format the results</span></span>
<span id="cb36-127"><a href="#cb36-127" tabindex="-1"></a></span>
<span id="cb36-128"><a href="#cb36-128" tabindex="-1"></a><span class="kw">var</span> spectralStats <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(groupStats<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(item) {</span>
<span id="cb36-129"><a href="#cb36-129" tabindex="-1"></a>  <span class="kw">var</span> itemDict <span class="op">=</span> ee<span class="op">.</span><span class="fu">Dictionary</span>(item)<span class="op">;</span></span>
<span id="cb36-130"><a href="#cb36-130" tabindex="-1"></a>  <span class="kw">var</span> classNumber <span class="op">=</span> itemDict<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;group&#39;</span>)<span class="op">;</span></span>
<span id="cb36-131"><a href="#cb36-131" tabindex="-1"></a>  <span class="co">// Extract the stats</span></span>
<span id="cb36-132"><a href="#cb36-132" tabindex="-1"></a>  <span class="co">// Create a featute for each statistics for each class</span></span>
<span id="cb36-133"><a href="#cb36-133" tabindex="-1"></a>  <span class="kw">var</span> stats <span class="op">=</span> ee<span class="op">.</span><span class="fu">List</span>([<span class="st">&#39;median&#39;</span><span class="op">,</span> <span class="st">&#39;min&#39;</span><span class="op">,</span> <span class="st">&#39;max&#39;</span><span class="op">,</span> <span class="st">&#39;p25&#39;</span><span class="op">,</span> <span class="st">&#39;p75&#39;</span>])<span class="op">;</span></span>
<span id="cb36-134"><a href="#cb36-134" tabindex="-1"></a>  <span class="co">// Create a key such as B1_min, B1_max, etc.</span></span>
<span id="cb36-135"><a href="#cb36-135" tabindex="-1"></a>  <span class="kw">var</span> keys <span class="op">=</span> stats<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(stat) {</span>
<span id="cb36-136"><a href="#cb36-136" tabindex="-1"></a>    <span class="kw">var</span> bandKeys <span class="op">=</span> bands<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(bandName) {</span>
<span id="cb36-137"><a href="#cb36-137" tabindex="-1"></a>      <span class="cf">return</span> ee<span class="op">.</span><span class="fu">String</span>(stat)<span class="op">.</span><span class="fu">cat</span>(<span class="st">&#39;_&#39;</span>)<span class="op">.</span><span class="fu">cat</span>(bandName)<span class="op">;</span></span>
<span id="cb36-138"><a href="#cb36-138" tabindex="-1"></a>      })</span>
<span id="cb36-139"><a href="#cb36-139" tabindex="-1"></a>    <span class="cf">return</span> bandKeys<span class="op">;</span></span>
<span id="cb36-140"><a href="#cb36-140" tabindex="-1"></a>    })<span class="op">.</span><span class="fu">flatten</span>()<span class="op">;</span></span>
<span id="cb36-141"><a href="#cb36-141" tabindex="-1"></a>  <span class="co">// Extract the values  </span></span>
<span id="cb36-142"><a href="#cb36-142" tabindex="-1"></a>  <span class="kw">var</span> values <span class="op">=</span> stats<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(stat) {</span>
<span id="cb36-143"><a href="#cb36-143" tabindex="-1"></a>    <span class="cf">return</span> itemDict<span class="op">.</span><span class="fu">get</span>(stat)<span class="op">;</span></span>
<span id="cb36-144"><a href="#cb36-144" tabindex="-1"></a>  })<span class="op">.</span><span class="fu">flatten</span>()<span class="op">;</span></span>
<span id="cb36-145"><a href="#cb36-145" tabindex="-1"></a>  <span class="kw">var</span> properties <span class="op">=</span> ee<span class="op">.</span><span class="at">Dictionary</span><span class="op">.</span><span class="fu">fromLists</span>(keys<span class="op">,</span> values)<span class="op">;</span></span>
<span id="cb36-146"><a href="#cb36-146" tabindex="-1"></a>  <span class="kw">var</span> withClass <span class="op">=</span> properties</span>
<span id="cb36-147"><a href="#cb36-147" tabindex="-1"></a>    <span class="op">.</span><span class="fu">set</span>(<span class="st">&#39;class&#39;</span><span class="op">,</span> classNames<span class="op">.</span><span class="fu">get</span>(classNumber))</span>
<span id="cb36-148"><a href="#cb36-148" tabindex="-1"></a>    <span class="op">.</span><span class="fu">set</span>(<span class="st">&#39;class_number&#39;</span><span class="op">,</span> classNumber)<span class="op">;</span></span>
<span id="cb36-149"><a href="#cb36-149" tabindex="-1"></a>  <span class="cf">return</span> ee<span class="op">.</span><span class="fu">Feature</span>(<span class="kw">null</span><span class="op">,</span> withClass)<span class="op">;</span></span>
<span id="cb36-150"><a href="#cb36-150" tabindex="-1"></a>}))<span class="op">;</span></span>
<span id="cb36-151"><a href="#cb36-151" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;Average Spectral Values for Each Class&#39;</span><span class="op">,</span> spectralStats)<span class="op">;</span></span>
<span id="cb36-152"><a href="#cb36-152" tabindex="-1"></a></span>
<span id="cb36-153"><a href="#cb36-153" tabindex="-1"></a><span class="co">// Now we need to create a spectral signature chart</span></span>
<span id="cb36-154"><a href="#cb36-154" tabindex="-1"></a><span class="co">// for each class.</span></span>
<span id="cb36-155"><a href="#cb36-155" tabindex="-1"></a></span>
<span id="cb36-156"><a href="#cb36-156" tabindex="-1"></a><span class="co">// Write a function to create a chart for each class</span></span>
<span id="cb36-157"><a href="#cb36-157" tabindex="-1"></a><span class="kw">var</span> createChart <span class="op">=</span> <span class="kw">function</span>(className) {</span>
<span id="cb36-158"><a href="#cb36-158" tabindex="-1"></a>  <span class="kw">var</span> classFeature <span class="op">=</span> spectralStats<span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">eq</span>(<span class="st">&#39;class&#39;</span><span class="op">,</span> className))<span class="op">.</span><span class="fu">first</span>()<span class="op">;</span></span>
<span id="cb36-159"><a href="#cb36-159" tabindex="-1"></a>  <span class="kw">var</span> classNumber <span class="op">=</span> classFeature<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;class_number&#39;</span>)<span class="op">;</span></span>
<span id="cb36-160"><a href="#cb36-160" tabindex="-1"></a>  <span class="kw">var</span> classColor <span class="op">=</span> classColors<span class="op">.</span><span class="fu">get</span>(classNumber)<span class="op">;</span></span>
<span id="cb36-161"><a href="#cb36-161" tabindex="-1"></a>  <span class="co">// X-Axis has Band Names, so we create a row per band</span></span>
<span id="cb36-162"><a href="#cb36-162" tabindex="-1"></a>  <span class="kw">var</span> rowList <span class="op">=</span> bands<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(band) {</span>
<span id="cb36-163"><a href="#cb36-163" tabindex="-1"></a>    <span class="kw">var</span> stats <span class="op">=</span> ee<span class="op">.</span><span class="fu">List</span>([<span class="st">&#39;median&#39;</span><span class="op">,</span> <span class="st">&#39;min&#39;</span><span class="op">,</span> <span class="st">&#39;max&#39;</span><span class="op">,</span> <span class="st">&#39;p25&#39;</span><span class="op">,</span> <span class="st">&#39;p75&#39;</span>])<span class="op">;</span></span>
<span id="cb36-164"><a href="#cb36-164" tabindex="-1"></a>    <span class="kw">var</span> values <span class="op">=</span> stats<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(stat) {</span>
<span id="cb36-165"><a href="#cb36-165" tabindex="-1"></a>      <span class="kw">var</span> key <span class="op">=</span> ee<span class="op">.</span><span class="fu">String</span>(stat)<span class="op">.</span><span class="fu">cat</span>(<span class="st">&#39;_&#39;</span>)<span class="op">.</span><span class="fu">cat</span>(band)<span class="op">;</span></span>
<span id="cb36-166"><a href="#cb36-166" tabindex="-1"></a>      <span class="kw">var</span> value <span class="op">=</span> classFeature<span class="op">.</span><span class="fu">get</span>(key)<span class="op">;</span></span>
<span id="cb36-167"><a href="#cb36-167" tabindex="-1"></a>      <span class="cf">return</span> {<span class="dt">v</span><span class="op">:</span> value}</span>
<span id="cb36-168"><a href="#cb36-168" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb36-169"><a href="#cb36-169" tabindex="-1"></a>    <span class="co">// Row name is the first value</span></span>
<span id="cb36-170"><a href="#cb36-170" tabindex="-1"></a>    <span class="kw">var</span> rowValues <span class="op">=</span> ee<span class="op">.</span><span class="fu">List</span>([{<span class="dt">v</span><span class="op">:</span> band}])<span class="op">;</span></span>
<span id="cb36-171"><a href="#cb36-171" tabindex="-1"></a>    <span class="co">// Append other values</span></span>
<span id="cb36-172"><a href="#cb36-172" tabindex="-1"></a>    rowValues <span class="op">=</span> rowValues<span class="op">.</span><span class="fu">cat</span>(values)<span class="op">;</span></span>
<span id="cb36-173"><a href="#cb36-173" tabindex="-1"></a></span>
<span id="cb36-174"><a href="#cb36-174" tabindex="-1"></a>    <span class="kw">var</span> rowDict <span class="op">=</span> {</span>
<span id="cb36-175"><a href="#cb36-175" tabindex="-1"></a>      <span class="dt">c</span><span class="op">:</span> rowValues</span>
<span id="cb36-176"><a href="#cb36-176" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb36-177"><a href="#cb36-177" tabindex="-1"></a>  <span class="cf">return</span> rowDict<span class="op">;</span></span>
<span id="cb36-178"><a href="#cb36-178" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb36-179"><a href="#cb36-179" tabindex="-1"></a>  <span class="co">// We need to convert the server-side rowList and </span></span>
<span id="cb36-180"><a href="#cb36-180" tabindex="-1"></a>  <span class="co">// classColor objects to client-side javascript object</span></span>
<span id="cb36-181"><a href="#cb36-181" tabindex="-1"></a>  <span class="co">// use evaluate()</span></span>
<span id="cb36-182"><a href="#cb36-182" tabindex="-1"></a>  rowList<span class="op">.</span><span class="fu">evaluate</span>(<span class="kw">function</span>(rowListClient) {</span>
<span id="cb36-183"><a href="#cb36-183" tabindex="-1"></a>    classColor<span class="op">.</span><span class="fu">evaluate</span>(<span class="kw">function</span>(classColor) {</span>
<span id="cb36-184"><a href="#cb36-184" tabindex="-1"></a>       <span class="kw">var</span> dataTable <span class="op">=</span> {</span>
<span id="cb36-185"><a href="#cb36-185" tabindex="-1"></a>        <span class="dt">cols</span><span class="op">:</span> [</span>
<span id="cb36-186"><a href="#cb36-186" tabindex="-1"></a>          {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;x&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;string&#39;</span><span class="op">,</span> <span class="dt">role</span><span class="op">:</span> <span class="st">&#39;domain&#39;</span>}<span class="op">,</span></span>
<span id="cb36-187"><a href="#cb36-187" tabindex="-1"></a>          {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;median&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;number&#39;</span><span class="op">,</span> <span class="dt">role</span><span class="op">:</span> <span class="st">&#39;data&#39;</span>}<span class="op">,</span></span>
<span id="cb36-188"><a href="#cb36-188" tabindex="-1"></a>          {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;min&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;number&#39;</span><span class="op">,</span> <span class="dt">role</span><span class="op">:</span> <span class="st">&#39;interval&#39;</span>}<span class="op">,</span></span>
<span id="cb36-189"><a href="#cb36-189" tabindex="-1"></a>          {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;max&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;number&#39;</span><span class="op">,</span> <span class="dt">role</span><span class="op">:</span> <span class="st">&#39;interval&#39;</span>}<span class="op">,</span></span>
<span id="cb36-190"><a href="#cb36-190" tabindex="-1"></a>          {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;firstQuartile&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;number&#39;</span><span class="op">,</span> <span class="dt">role</span><span class="op">:</span> <span class="st">&#39;interval&#39;</span>}<span class="op">,</span></span>
<span id="cb36-191"><a href="#cb36-191" tabindex="-1"></a>          {<span class="dt">id</span><span class="op">:</span> <span class="st">&#39;thirdQuartile&#39;</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span><span class="st">&#39;number&#39;</span><span class="op">,</span> <span class="dt">role</span><span class="op">:</span> <span class="st">&#39;interval&#39;</span>}<span class="op">,</span></span>
<span id="cb36-192"><a href="#cb36-192" tabindex="-1"></a>        ]<span class="op">,</span></span>
<span id="cb36-193"><a href="#cb36-193" tabindex="-1"></a>        <span class="dt">rows</span><span class="op">:</span> rowListClient</span>
<span id="cb36-194"><a href="#cb36-194" tabindex="-1"></a>      }<span class="op">;</span></span>
<span id="cb36-195"><a href="#cb36-195" tabindex="-1"></a>    </span>
<span id="cb36-196"><a href="#cb36-196" tabindex="-1"></a>      <span class="kw">var</span> options <span class="op">=</span> {</span>
<span id="cb36-197"><a href="#cb36-197" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span><span class="st">&#39;Spectral Profile for Class: &#39;</span> <span class="op">+</span> className<span class="op">,</span></span>
<span id="cb36-198"><a href="#cb36-198" tabindex="-1"></a>        <span class="dt">vAxis</span><span class="op">:</span> {</span>
<span id="cb36-199"><a href="#cb36-199" tabindex="-1"></a>          <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Reflectance&#39;</span><span class="op">,</span></span>
<span id="cb36-200"><a href="#cb36-200" tabindex="-1"></a>          <span class="dt">gridlines</span><span class="op">:</span> {</span>
<span id="cb36-201"><a href="#cb36-201" tabindex="-1"></a>            <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;#d9d9d9&#39;</span></span>
<span id="cb36-202"><a href="#cb36-202" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb36-203"><a href="#cb36-203" tabindex="-1"></a>          <span class="dt">minorGridlines</span><span class="op">:</span> {</span>
<span id="cb36-204"><a href="#cb36-204" tabindex="-1"></a>            <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;transparent&#39;</span></span>
<span id="cb36-205"><a href="#cb36-205" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb36-206"><a href="#cb36-206" tabindex="-1"></a>          <span class="dt">viewWindow</span><span class="op">:</span> {</span>
<span id="cb36-207"><a href="#cb36-207" tabindex="-1"></a>            <span class="dt">min</span><span class="op">:</span><span class="dv">0</span><span class="op">,</span></span>
<span id="cb36-208"><a href="#cb36-208" tabindex="-1"></a>            <span class="dt">max</span><span class="op">:</span><span class="fl">0.6</span></span>
<span id="cb36-209"><a href="#cb36-209" tabindex="-1"></a>          }</span>
<span id="cb36-210"><a href="#cb36-210" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb36-211"><a href="#cb36-211" tabindex="-1"></a>        <span class="dt">hAxis</span><span class="op">:</span> {</span>
<span id="cb36-212"><a href="#cb36-212" tabindex="-1"></a>          <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Bands&#39;</span><span class="op">,</span></span>
<span id="cb36-213"><a href="#cb36-213" tabindex="-1"></a>          <span class="dt">gridlines</span><span class="op">:</span> {</span>
<span id="cb36-214"><a href="#cb36-214" tabindex="-1"></a>            <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;#d9d9d9&#39;</span></span>
<span id="cb36-215"><a href="#cb36-215" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb36-216"><a href="#cb36-216" tabindex="-1"></a>          <span class="dt">minorGridlines</span><span class="op">:</span> {</span>
<span id="cb36-217"><a href="#cb36-217" tabindex="-1"></a>            <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;transparent&#39;</span></span>
<span id="cb36-218"><a href="#cb36-218" tabindex="-1"></a>          }</span>
<span id="cb36-219"><a href="#cb36-219" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb36-220"><a href="#cb36-220" tabindex="-1"></a>        <span class="dt">legend</span><span class="op">:</span> {<span class="dt">position</span><span class="op">:</span> <span class="st">&#39;none&#39;</span>}<span class="op">,</span></span>
<span id="cb36-221"><a href="#cb36-221" tabindex="-1"></a>        <span class="dt">lineWidth</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb36-222"><a href="#cb36-222" tabindex="-1"></a>        <span class="dt">interpolateNulls</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb36-223"><a href="#cb36-223" tabindex="-1"></a>        <span class="dt">curveType</span><span class="op">:</span> <span class="st">&#39;function&#39;</span><span class="op">,</span></span>
<span id="cb36-224"><a href="#cb36-224" tabindex="-1"></a>        <span class="dt">series</span><span class="op">:</span> [{<span class="st">&#39;color&#39;</span><span class="op">:</span> classColor}]<span class="op">,</span></span>
<span id="cb36-225"><a href="#cb36-225" tabindex="-1"></a>        <span class="dt">intervals</span><span class="op">:</span> {</span>
<span id="cb36-226"><a href="#cb36-226" tabindex="-1"></a>          <span class="dt">barWidth</span><span class="op">:</span> <span class="fl">0.5</span><span class="op">,</span></span>
<span id="cb36-227"><a href="#cb36-227" tabindex="-1"></a>          <span class="dt">boxWidth</span><span class="op">:</span> <span class="fl">0.5</span><span class="op">,</span></span>
<span id="cb36-228"><a href="#cb36-228" tabindex="-1"></a>          <span class="dt">lineWidth</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb36-229"><a href="#cb36-229" tabindex="-1"></a>          <span class="dt">style</span><span class="op">:</span> <span class="st">&#39;boxes&#39;</span><span class="op">,</span></span>
<span id="cb36-230"><a href="#cb36-230" tabindex="-1"></a>          <span class="dt">fillOpacity</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb36-231"><a href="#cb36-231" tabindex="-1"></a></span>
<span id="cb36-232"><a href="#cb36-232" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb36-233"><a href="#cb36-233" tabindex="-1"></a>        <span class="dt">interval</span><span class="op">:</span> {</span>
<span id="cb36-234"><a href="#cb36-234" tabindex="-1"></a>          <span class="dt">min</span><span class="op">:</span> {</span>
<span id="cb36-235"><a href="#cb36-235" tabindex="-1"></a>            <span class="dt">style</span><span class="op">:</span> <span class="st">&#39;bars&#39;</span><span class="op">,</span></span>
<span id="cb36-236"><a href="#cb36-236" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb36-237"><a href="#cb36-237" tabindex="-1"></a>          <span class="dt">max</span><span class="op">:</span> {</span>
<span id="cb36-238"><a href="#cb36-238" tabindex="-1"></a>            <span class="dt">style</span><span class="op">:</span> <span class="st">&#39;bars&#39;</span><span class="op">,</span></span>
<span id="cb36-239"><a href="#cb36-239" tabindex="-1"></a>          }</span>
<span id="cb36-240"><a href="#cb36-240" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb36-241"><a href="#cb36-241" tabindex="-1"></a>        <span class="dt">chartArea</span><span class="op">:</span> {<span class="dt">left</span><span class="op">:</span><span class="dv">100</span><span class="op">,</span> <span class="dt">right</span><span class="op">:</span><span class="dv">100</span>}</span>
<span id="cb36-242"><a href="#cb36-242" tabindex="-1"></a>      }<span class="op">;</span></span>
<span id="cb36-243"><a href="#cb36-243" tabindex="-1"></a>        </span>
<span id="cb36-244"><a href="#cb36-244" tabindex="-1"></a>      <span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="fu">Chart</span>(dataTable<span class="op">,</span> <span class="st">&#39;LineChart&#39;</span><span class="op">,</span> options)<span class="op">;</span></span>
<span id="cb36-245"><a href="#cb36-245" tabindex="-1"></a>      <span class="fu">print</span>(chart)<span class="op">;</span></span>
<span id="cb36-246"><a href="#cb36-246" tabindex="-1"></a>      })<span class="op">;</span></span>
<span id="cb36-247"><a href="#cb36-247" tabindex="-1"></a></span>
<span id="cb36-248"><a href="#cb36-248" tabindex="-1"></a>    })</span>
<span id="cb36-249"><a href="#cb36-249" tabindex="-1"></a>   </span>
<span id="cb36-250"><a href="#cb36-250" tabindex="-1"></a></span>
<span id="cb36-251"><a href="#cb36-251" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb36-252"><a href="#cb36-252" tabindex="-1"></a></span>
<span id="cb36-253"><a href="#cb36-253" tabindex="-1"></a><span class="co">// We get a list of classes</span></span>
<span id="cb36-254"><a href="#cb36-254" tabindex="-1"></a><span class="kw">var</span> classNames <span class="op">=</span> spectralStats<span class="op">.</span><span class="fu">aggregate_array</span>(<span class="st">&#39;class&#39;</span>)<span class="op">;</span></span>
<span id="cb36-255"><a href="#cb36-255" tabindex="-1"></a><span class="co">// Call the function for each class name to create the chart</span></span>
<span id="cb36-256"><a href="#cb36-256" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;Creating charts. Please wait...&#39;</span>)<span class="op">;</span></span>
<span id="cb36-257"><a href="#cb36-257" tabindex="-1"></a>classNames<span class="op">.</span><span class="fu">evaluate</span>(<span class="kw">function</span>(classNames) {</span>
<span id="cb36-258"><a href="#cb36-258" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> classNames<span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb36-259"><a href="#cb36-259" tabindex="-1"></a>    <span class="fu">createChart</span>(classNames[i])<span class="op">;</span></span>
<span id="cb36-260"><a href="#cb36-260" tabindex="-1"></a>  }</span>
<span id="cb36-261"><a href="#cb36-261" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
</div>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<ul>
<li>Google Earth Engine Developer Guide: <a
href="https://developers.google.com/earth-engine/guides/charts_overview">Chart
Documentation</a></li>
</ul>
</div>
<div id="data-credits" class="section level1">
<h1>Data Credits</h1>
<ul>
<li>Abatzoglou, J.T., S.Z. Dobrowski, S.A. Parks, K.C. Hegewisch, 2018,
Terraclimate, a high-resolution global dataset of monthly climate and
climatic water balance from 1958-2015, Scientific Data 5:170191, <a
href="doi:10.1038/sdata.2017.191"
class="uri">doi:10.1038/sdata.2017.191</a></li>
<li>Funk, Chris, Pete Peterson, Martin Landsfeld, Diego Pedreros, James
Verdin, Shraddhanand Shukla, Gregory Husak, James Rowland, Laura
Harrison, Andrew Hoell &amp; Joel Michaelsen. “The climate hazards
infrared precipitation with stations-a new environmental record for
monitoring extremes”. Scientific Data 2, 150066. <a
href="doi:10.1038/sdata.2015.66"
class="uri">doi:10.1038/sdata.2015.66</a> 2015.</li>
<li>GFS: Global Forecast System 384-Hour Predicted Atmosphere Data. <a
href="https://www.emc.ncep.noaa.gov/emc/pages/numerical_forecast_systems/gfs.php">Source</a></li>
<li>MOD13Q1.006 Terra Vegetation Indices 16-Day Global 250m: Didan, K.
(2015). MOD13Q1 MODIS/Terra Vegetation Indices 16-Day L3 Global 250m SIN
Grid V006 [Data set]. NASA EOSDIS Land Processes DAAC. Accessed
2023-05-06 from <a href="https://doi.org/10.5067/MODIS/MOD13Q1.006"
class="uri">https://doi.org/10.5067/MODIS/MOD13Q1.006</a></li>
<li>Li, Xuecao; Zhou, Yuyu; zhao, Min; Zhao, Xia (2020): Harmonization
of DMSP and VIIRS nighttime light data from 1992-2020 at the global
scale. figshare. Dataset. <a
href="https://doi.org/10.6084/m9.figshare.9828827.v5"
class="uri">https://doi.org/10.6084/m9.figshare.9828827.v5</a></li>
<li>Runfola D, Anderson A, Baier H, Crittenden M, Dowker E, Fuhrig S, et
al. (2020) geoBoundaries: A global database of political administrative
boundaries. PLoS ONE 15(4): e0231866. <a
href="https://doi.org/10.1371/journal.pone.0231866"
class="uri">https://doi.org/10.1371/journal.pone.0231866</a></li>
<li>Sentinel-2 Level-2A: Contains Copernicus Sentinel data.</li>
<li>Zanaga, D., Van De Kerchove, R., Daems, D., De Keersmaecker, W.,
Brockmann, C., Kirches, G., Wevers, J., Cartus, O., Santoro, M., Fritz,
S., Lesiv, M., Herold, M., Tsendbazar, N.E., Xu, P., Ramoino, F., Arino,
O., 2022. ESA WorldCover 10 m 2021 v200. (<a
href="doi:10.5281/zenodo.7254221"
class="uri">doi:10.5281/zenodo.7254221</a>)</li>
<li>Global Energy Observatory, Google, KTH Royal Institute of Technology
in Stockholm, Enipedia, World Resources Institute. 2019. Global Power
Plant Database. Published on Resource Watch and Google Earth Engine. <a
href="http://resourcewatch.org/"
class="uri">http://resourcewatch.org/</a> <a
href="https://earthengine.google.com/"
class="uri">https://earthengine.google.com/</a></li>
<li>Wagemann, Julia, Siemen, Stephan, Seeger, Bernhard, &amp; Bendix,
Jörg. (2020). User requirements of Big Earth Data - Survey 2019 (0.1)
[Data set]. Zenodo. <a href="https://doi.org/10.5281/zenodo.4075058"
class="uri">https://doi.org/10.5281/zenodo.4075058</a></li>
<li>Elvidge, C.D, Zhizhin, M., Ghosh T., Hsu FC, Taneja J. Annual time
series of global VIIRS nighttime lights derived from monthly
averages:2012 to 2019. Remote Sensing 2021, 13(5), p.922, <a
href="https://doi.org/10.3390/rs13050922"
class="uri">https://doi.org/10.3390/rs13050922</a></li>
<li>Sims, K., Reith, A., Bright, E., McKee, J., &amp; Rose, A. (2022).
LandScan Global 2021 [Data set]. Oak Ridge National Laboratory. <a
href="https://doi.org/10" class="uri">https://doi.org/10</a>.
48690/1527702</li>
<li>Hansen, M. C., P. V. Potapov, R. Moore, M. Hancher, S. A.
Turubanova, A. Tyukavina, D. Thau, S. V. Stehman, S. J. Goetz, T. R.
Loveland, A. Kommareddy, A. Egorov, L. Chini, C. O. Justice, and J. R.
G. Townshend. 2013. “High-Resolution Global Maps of 21st-Century Forest
Cover Change.” Science 342 (15 November): 850-53.
10.1126/science.1244693 Data available on-line at: <a
href="https://glad.earthengine.app/view/global-forest-change"
class="uri">https://glad.earthengine.app/view/global-forest-change</a>.</li>
<li>Elvidge, C.D, Zhizhin, M., Ghosh T., Hsu FC, Taneja J. Annual time
series of global VIIRS nighttime lights derived from monthly
averages:2012 to 2019. Remote Sensing 2021, 13(5), p.922, <a
href="doi:10.3390/rs13050922" class="uri">doi:10.3390/rs13050922</a> <a
href="doi:10.3390/rs13050922"
class="uri">doi:10.3390/rs13050922</a></li>
</ul>
</div>
<div id="license" class="section level1">
<h1>License</h1>
<p>The course material (text, images, presentation, videos) is licensed
under a <a href="https://creativecommons.org/licenses/by/4.0/">Creative
Commons Attribution 4.0 International License</a>.</p>
<p>The code (scripts, Jupyter notebooks) is licensed under the MIT
License. For a copy, see <a href="https://opensource.org/licenses/MIT"
class="uri">https://opensource.org/licenses/MIT</a></p>
<p>You are free to re-use and adapt the material but are required to
give appropriate credit to the original author as below:</p>
<p>Copyright © 2023 Ujaval Gandhi <a
href="https://spatialthoughts.com">www.spatialthoughts.com</a></p>
</div>
<div id="citing-and-referencing" class="section level1">
<h1>Citing and Referencing</h1>
<p>You can cite the course materials as follows</p>
<ul>
<li>Gandhi, Ujaval, 2023. <em>Creating Publication Quality Charts with
GEE</em> Course. Spatial Thoughts. <a
href="https://courses.spatialthoughts.com/gee-charts.html"
class="uri">https://courses.spatialthoughts.com/gee-charts.html</a></li>
</ul>
<hr />
</div>

<!-- Comment Section Powered by utterances -->
<div id="comments">
  <hr />
  <p>If you want to report any issues with this page, please comment below.</p>
<script src="https://utteranc.es/client.js"
        repo="spatialthoughts/courses"
        issue-term="title"
        label="comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
</div>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
