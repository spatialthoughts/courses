<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Ujaval Gandhi" />


<title>From Cloud to Desktop: Working with Earth Engine Data in QGIS (Full workshop)</title>

<script src="site_libs/header-attrs-2.10/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<style>
.copy-btn {
  position: absolute;
  top: 5px;
  right: 5px;
  padding: 4px 8px;
  font-size: 18px;
  background: #969696;
  color: white;
  border: none;
  border-radius: 3px;
  cursor: pointer;
  opacity: 0.7;
  transition: opacity 0.3s;
}

.copy-btn:hover {
  opacity: 1;
}

.copy-btn.copied {
  background: #636363;
}

pre {
  position: relative;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Find all code blocks
  const codeBlocks = document.querySelectorAll('pre code');
  
  codeBlocks.forEach(function(codeBlock) {
    const pre = codeBlock.parentElement;
    
    // Create copy button
    const button = document.createElement('button');
    button.className = 'copy-btn';
    button.textContent = '⎘';
    
    // Add button to pre element
    pre.appendChild(button);
    
    // Add click event
    button.addEventListener('click', function() {
      // Create temporary textarea to copy text
      const textarea = document.createElement('textarea');
      textarea.value = codeBlock.textContent;
      document.body.appendChild(textarea);
      textarea.select();
      document.execCommand('copy');
      document.body.removeChild(textarea);
      
      // Update button text
      button.textContent = 'Copied!';
      button.classList.add('copied');
      
      // Reset button after 2 seconds
      setTimeout(function() {
        button.textContent = '⎘';
        button.classList.remove('copied');
      }, 2000);
    });
  });
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Courses</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="http://spatialthoughts.com">Back to Main Site</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="#">Back to Top</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">From Cloud to Desktop: Working with Earth
Engine Data in QGIS (Full workshop)</h1>
<h3 class="subtitle">Unlocking cloud geospatial data with with the
Google Earth Engine Plugin for QGIS.</h3>
<h4 class="author">Ujaval Gandhi</h4>

</div>

<div id="TOC">
<ul>
<li><a href="#introduction" id="toc-introduction">Introduction</a></li>
<li><a href="#installation-and-setting-up-the-environment"
id="toc-installation-and-setting-up-the-environment">Installation and
Setting up the Environment</a>
<ul>
<li><a href="#install-qgis" id="toc-install-qgis">Install QGIS</a></li>
<li><a href="#sign-up-for-google-earth-engine"
id="toc-sign-up-for-google-earth-engine">Sign-up for Google Earth
Engine</a></li>
<li><a href="#install-the-google-earth-engine-plugin-for-qgis"
id="toc-install-the-google-earth-engine-plugin-for-qgis">Install the
Google Earth Engine Plugin for QGIS</a></li>
<li><a href="#get-the-data-package" id="toc-get-the-data-package">Get
the Data Package</a></li>
</ul></li>
<li><a href="#get-the-workshop-video"
id="toc-get-the-workshop-video">Get the Workshop Video</a>
<ul>
<li><a href="#youtube" id="toc-youtube">YouTube</a></li>
<li><a href="#vimeo" id="toc-vimeo">Vimeo</a></li>
</ul></li>
<li><a href="#overview-of-the-earth-engine-data-model"
id="toc-overview-of-the-earth-engine-data-model">Overview of the Earth
Engine Data Model</a></li>
<li><a href="#accessing-earth-engine-datasets"
id="toc-accessing-earth-engine-datasets">Accessing Earth Engine
Datasets</a>
<ul>
<li><a href="#official-data-catalog"
id="toc-official-data-catalog">Official Data Catalog</a></li>
<li><a href="#awesome-gee-community-catalog"
id="toc-awesome-gee-community-catalog">Awesome GEE Community
Catalog</a></li>
<li><a href="#user-uploaded-assets"
id="toc-user-uploaded-assets">User-Uploaded Assets</a></li>
</ul></li>
<li><a href="#hands-on-with-qgis-earth-engine-plugin"
id="toc-hands-on-with-qgis-earth-engine-plugin">Hands-on With QGIS Earth
Engine Plugin</a>
<ul>
<li><a href="#downloading-images-from-earth-engine"
id="toc-downloading-images-from-earth-engine">1. Downloading Images from
Earth Engine</a></li>
<li><a href="#building-workflows-with-model-designer"
id="toc-building-workflows-with-model-designer">2. Building Workflows
with Model Designer</a></li>
</ul></li>
<li><a href="#data-credits" id="toc-data-credits">Data Credits</a></li>
<li><a href="#license" id="toc-license">License</a></li>
</ul>
</div>

<div style="page-break-after: always;"></div>
<hr />
<p><img src="images/spatial_thoughts_logo.png" width="250pt" style="display: block; margin: auto;" /></p>
<hr />
<div style="page-break-after: always;"></div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>Google Earth Engine is a cloud-based platform that enables working
with large-scale earth observation datasets effectively. The <a
href="https://github.com/gee-community/qgis-earthengine-plugin">Google
Earth Engine Plugin for QGIS</a> brings this power to the desktop and
enables QGIS users to combine their geospatial workflows with
cloud-based datasets. This workshop will give you hands-on experience
using plugin to leverage cloud-based datasets in desktop-based
geospatial workflows.</p>
<p><a href="https://www.youtube.com/watch?v=FjyXQqoSUUo"
target="_blank"><img
src="https://img.youtube.com/vi/FjyXQqoSUUo/mqdefault.jpg"
alt="Watch the video" /></a></p>
<p><a href="https://www.youtube.com/watch?v=FjyXQqoSUUo"
target="_blank">Watch the Video ↗</a></p>
<p><a
href="https://docs.google.com/presentation/d/1yogtMCTOkELcXWLKp285vHQqhHezZpBLObVSeAzDs7w/edit?usp=sharing"
target="_blank">Access the Presentation ↗</a></p>
<hr />
</div>
<div id="installation-and-setting-up-the-environment"
class="section level1">
<h1>Installation and Setting up the Environment</h1>
<div id="install-qgis" class="section level2">
<h2>Install QGIS</h2>
<p>This workshop requires QGIS LTR version 3.40 or above. Please review
<a href="install-qgis-ltr.html">QGIS-LTR Installation Guide</a> for
step-by-step instructions.</p>
</div>
<div id="sign-up-for-google-earth-engine" class="section level2">
<h2>Sign-up for Google Earth Engine</h2>
<p>If you already have a Google Earth Engine account, you can skip this
step.</p>
<p>Visit our <a href="gee-sign-up.html">GEE Sign-Up Guide</a> for
step-by-step instructions.</p>
</div>
<div id="install-the-google-earth-engine-plugin-for-qgis"
class="section level2">
<h2>Install the Google Earth Engine Plugin for QGIS</h2>
<p>This workshops requires the <strong>Google Earth Engine Plugin for
QGIS</strong>. The plugin can be installed by the Plugin Manager from
the official QGIS plugin repository and involves a few extra steps to
authenticate with your Google Earth Engine account and set the Google
Cloud project.</p>
<p>Visit the <a
href="https://gee-community.github.io/qgis-earthengine-plugin/installation/">QGIS
Earth Engine Plugin Installation Guide</a> for step-by-step
instructions.</p>
</div>
<div id="get-the-data-package" class="section level2">
<h2>Get the Data Package</h2>
<p>We have created a data package containing checkpoint projects that
will allow you to load the results of each section. You can download the
data package from <a
href="https://github.com/spatialthoughts/courses/releases/download/data/qgis_gee_workshop.zip">qgis-gee-workshop.zip</a>.
Once downloaded, unzip the contents to a folder on your computer.</p>
</div>
</div>
<div id="get-the-workshop-video" class="section level1">
<h1>Get the Workshop Video</h1>
<p>The workshop is accompanied by a video covering the all the sections.
This video is recorded from our live online class and is edited to make
them easier to consume for self-study. We have 2 versions of the
videos:</p>
<div id="youtube" class="section level2">
<h2>YouTube</h2>
<p>The video on YouTube is ideal for online learning and sharing. You
may also turn on <em>Subtitles/closed-captions</em> and adjust the
playback speed to suit your preference. <a
href="https://youtu.be/FjyXQqoSUUo" target="_blank">Access the YouTube
Video ↗</a></p>
</div>
<div id="vimeo" class="section level2">
<h2>Vimeo</h2>
<p>We have also made full-length video available on Vimeo. This video
can be downloaded for offline learning. <a
href="https://vimeo.com/1148230550?share=copy" target="_blank">Access
the Vimeo Video ↗</a></p>
<hr />
</div>
</div>
<div id="overview-of-the-earth-engine-data-model"
class="section level1">
<h1>Overview of the Earth Engine Data Model</h1>
<p>Earth Engine supported georeferenced raster and vector datasets. The
terminology used by Earth Engine is different than used by QGIS. Below
is the explanation of common data types in Earth Engine.</p>
<ul>
<li><strong>Image</strong>: A single georeferenced raster dataset. It
can have one or more bands. The image metadata is stored as
<em>properties</em>. Each band in the image can have different data
type, spatial resolution (i.e. scale) and projection.</li>
<li><strong>ImageCollection</strong>: The most common type of dataset
used in Earth Engine that consists of multiple <em>Image</em> objects.
Images over both space and time can be put in a single
ImageCollection.</li>
<li><strong>FeatureCollection</strong>: Vector datasets are represented
as FeatureCollections in Earth Engine. Each <em>Feature</em> in the
collection consists of a <em>geometry</em> and some
<em>properties</em>.</li>
</ul>
</div>
<div id="accessing-earth-engine-datasets" class="section level1">
<h1>Accessing Earth Engine Datasets</h1>
<div id="official-data-catalog" class="section level2">
<h2>Official Data Catalog</h2>
<p>The Google Earth Engine team maintains a large catalog of
ready-to-use datasets that can be readily accessed via the plugin. You
can search and browse the datasets at the <a
href="https://developers.google.com/earth-engine/datasets">Earth Engine
Data Catalog</a>.</p>
<p><img src="images/qgis_gee_workshop/main_catalog.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="awesome-gee-community-catalog" class="section level2">
<h2>Awesome GEE Community Catalog</h2>
<p>The Earth Engine Community, led by Samapriya Roy maintains another
large catalog of datasets that have been processed and ingested in Earth
Engine. This catalog can be accessed from <a
href="https://gee-community-catalog.org/">awesome-gee-community-catalog</a>.
The dataset available in this catalog can also be used directly in the
QGIS Earth Engine plugin.</p>
<p><img src="images/qgis_gee_workshop/community_catalog.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="user-uploaded-assets" class="section level2">
<h2>User-Uploaded Assets</h2>
<p>Earth Engine users can also upload their own datasets and use them in
the plugin. This is useful if you wanted to access your private assets
through the QGIS Earth Engine plugin. You must be either the owner of
the asset or need read access to the asset.</p>
</div>
</div>
<div id="hands-on-with-qgis-earth-engine-plugin" class="section level1">
<h1>Hands-on With QGIS Earth Engine Plugin</h1>
<div id="downloading-images-from-earth-engine" class="section level2">
<h2>1. Downloading Images from Earth Engine</h2>
<p>The Google Earth Engine plugin comes with a handy <strong>Export
Image to GeoTIFF</strong> algorithm that allows you to download images
from GEE directly to your computer as GeoTIFF files. In this tutorial,
we will use the plugin to create a Sentinel-2 median composite for a
region and download it as a GeoTIFF file.</p>
<ol style="list-style-type: decimal">
<li>Open QGIS. To help us select a region of interest, it will be
helpful to have a basemap. From the QGIS Browser Panel, locate the
<em>XYZ Tiles → OpenStreetMap</em> layer and drag it to the canvas.</li>
</ol>
<p><img src="images/qgis_gee_workshop/download_image1.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="2" style="list-style-type: decimal">
<li>We can use the QGIS’s built-in geocoder to search for a place. For
this tutorial, we want to download imagery over Paris. Select the
locator bar in the bottom left corner and enter the search term
<code>&gt; paris</code>. Make sure there is a space between the
<code>&gt;</code> character and the search term. From the results, click
on the first one to zoom to the location.</li>
</ol>
<p><img src="images/qgis_gee_workshop/download_image2.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="3" style="list-style-type: decimal">
<li>Zoom and pan the map to the desired extent. Open the Processing
Toolbox from <em>Processing → Toolbox</em>. Locate the <em>Add Image
Collection</em> algorithm from the Google Earth Engine provider.
Double-click to open it.</li>
</ol>
<p><img src="images/qgis_gee_workshop/download_image3.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="4" style="list-style-type: decimal">
<li>To add an Image Collection, we first need to find the Image
Collection ID for the Sentinel-2 Level-2A collection.</li>
</ol>
<p><img src="images/qgis_gee_workshop/download_image4.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="5" style="list-style-type: decimal">
<li>Open the <a
href="https://developers.google.com/earth-engine/datasets/">Earth Engine
Data Catalog</a> and navigate to the dataset page for <a
href="https://developers.google.com/earth-engine/datasets/catalog/COPERNICUS_S2_SR_HARMONIZED">Harmonized
Sentinel-2 MSI: MultiSpectral Instrument, Level-2A (SR)</a>. Copy the
Image Collection ID <code>COPERNICUS/S2_SR_HARMONIZED</code> shown on
the page.</li>
</ol>
<p><img src="images/qgis_gee_workshop/download_image5.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="6" style="list-style-type: decimal">
<li>Back in the <em>Add Image Collection</em> dialog, paste the Image
Collection ID <code>COPERNICUS/S2_SR_HARMONIZED</code>. Next, we can
apply a metadata filter to select images with less cloud. In the
<em>Filter by Image Properties</em> section, select
<code>CLOUDY_PIXEL_PERCENTAGE</code> as the property, <code>&lt;</code>
as the operator and enter <code>30</code> as the value. This will select
all images with &lt; 30% cloud cover.</li>
</ol>
<p><img src="images/qgis_gee_workshop/download_image6.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="7" style="list-style-type: decimal">
<li><p>In the <em>Compositing</em> section, select <code>Median</code>
as the <em>Compositing Method</em>. This method will take all available
images and calculate the median value for each pixel. For optical
imagery, such as Sentinel-2, this method is useful in selecting the best
representative pixel for the chosen duration without being affected by
outliers such as clouds and cloud-shadow. We want to create an annual
composite, so in the <em>Filter by Dates</em> section, enter the
<em>Start</em> and <em>End</em> dates as <code>01-01-2024</code> and
<code>01-01-2025</code>.</p>
<blockquote>
<p>Remember that the <em>End</em> date in the Earth Engine date filter
is <em>exclusive</em> - so we need to add an extra day to ensure do not
exclude the last day of the year.</p>
</blockquote></li>
</ol>
<p><img src="images/qgis_gee_workshop/download_image7.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="8" style="list-style-type: decimal">
<li>Expand the <em>Filter by Extent (Bounds)</em> section. Click the
<code>Map Canvas Extent</code> button to load the selected region in the
canvas.</li>
</ol>
<p><img src="images/qgis_gee_workshop/download_image8.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="9" style="list-style-type: decimal">
<li>Before loading the image, we need to specify the visualization
parameters. For multi-band images, we can select 3 bands to be used for
visualization. We will visualize the resulting image in natural color,
so select <code>B4</code> (Red) , <code>B3</code> (Green) and
<code>B2</code> (Blue) as the bands. The typical range of pixel values
for Sentinel-2 images are between 0-3000, so enter <code>0</code> as
<em>Min</em> and <code>3000</code> as <em>Max</em>. Check the <em>Clip
to Extent</em> box to load only the pixels within the selected extent
and click <em>Run</em>.</li>
</ol>
<p><img src="images/qgis_gee_workshop/download_image9.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="10" style="list-style-type: decimal">
<li>Once the algorithm finishes, a new layer
<code>IC: COPERNICUS/S2_SR_HARMONIZED (Median)</code> will be added to
the <em>Layers</em> panel. This layer is being streamed from the Earth
Engine servers. As you zoom or pan the image - new pixels will be
computed on-the-fly and displayed. Lets download this image so we can
use it within QGIS for analysis. Locate the
<code>Export → Export Image to GeoTIFF</code> algorithm from the Google
Earth Engine provider in the Processing Toolbox. Double-click to open
it.</li>
</ol>
<blockquote>
<p>If the image appears blank, move the map slightly using the Pan tool.
This will refresh the canvas and request loading of the tiles from Earth
Engine.</p>
</blockquote>
<p><img src="images/qgis_gee_workshop/download_image10.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="11" style="list-style-type: decimal">
<li>In the Export Image to GeoTIFF dialog, select
<code>IC: COPERNICUS/S2_SR_HARMONIZED (Median)</code> as the EE Image.
We want to export this at its native resolution, so enter
<code>10</code> as the <em>Scale (meters)</em>. We can also specify the
projection in which we want the output image. Click the <em>Select
CRS</em> button.</li>
</ol>
<p><img src="images/qgis_gee_workshop/download_image11.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="12" style="list-style-type: decimal">
<li>It is recommended to use a Projected CRS suitable for the region of
interest. UTM is a good choice for such a CRS. We can find the CRS for
the UTM Zone where our region is located. If you do not know the UTM
Zone, you can use this handy <a
href="https://mangomap.com/robertyoung/maps/69585/what-utm-zone-am-i-in-#">What
UTM Zone am I in?</a> map. Paris is located in the <em>UTM Zone
31N</em>. Search and select the
<code>WGS84 / UTM zone 31N (EPSG:32631)</code> CRS. Once selected, click
the arrow at the top of the selector to go back to the previous
dialog.</li>
</ol>
<p><img src="images/qgis_gee_workshop/download_image12.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="13" style="list-style-type: decimal">
<li>Next, select the Map Canvas Extent as the Extent of the image for
Export. We can choose the subset and order of bands to export. For this
tutorial, lets export the B4, B3 and B2 bands. You can select each band
from the left-hand section and use the &gt;&gt; button to add them to
the list of output bands.</li>
</ol>
<p><img src="images/qgis_gee_workshop/download_image13.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="14" style="list-style-type: decimal">
<li>For the <em>Output File</em>, browse to a directory on your computer
and enter the file name as <code>s2_median_composite.tif</code>. Once
configured, click <em>Run</em>.</li>
</ol>
<p><img src="images/qgis_gee_workshop/download_image14.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="15" style="list-style-type: decimal">
<li>The requested region will be divided into smaller tiles and each
tile will be downloaded separately. The algorithm will then merge the
downloaded tiles into a single mosaic and save it at the requested
location. Depending on the size of the region, resolution, number of
bands, and your internet bandwidth, this process can take some time.
Once the algorithm finishes, click <em>Close</em>.</li>
</ol>
<p><img src="images/qgis_gee_workshop/download_image15.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="16" style="list-style-type: decimal">
<li>In the layer panel, turn off the
<code>IC: COPERNICUS/S2_SR_HARMONIZED (Median)</code> layer as it is no
longer required. In the <em>Browser</em> panel, locate the directory
where you saved the output file. Drag and drop the
<code>s2_median_composite.tif</code> file to the canvas to see the
downloaded image.</li>
</ol>
<p><img src="images/qgis_gee_workshop/download_image16.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="building-workflows-with-model-designer" class="section level2">
<h2>2. Building Workflows with Model Designer</h2>
<p>The processing algorithms provided by the Google Earth Engine plugin
can be used in the QGIS Model Designer to automate workflows that
combine data from the Earth Engine Data Catalog with processing
algorithms from QGIS.</p>
<p>In this section, we will build a model that will run the following
steps in a single workflow:</p>
<ul>
<li>Load landcover data from the Earth Engine Data Catalog</li>
<li>Download the data as a GeoTIFF file for the chosen region</li>
<li>Calculate area of each landcover class</li>
<li>Convert the computed area to square kilometers</li>
<li>Add input validation to the model</li>
</ul>
<div class="figure" style="text-align: center">
<img src="images/qgis_gee_workshop/model_output.png" alt="QGIS Model for Calculating Landcover Statistics" width="75%" />
<p class="caption">
QGIS Model for Calculating Landcover Statistics
</p>
</div>
<p>There are many landcover datasets available in the <a
href="https://developers.google.com/earth-engine/datasets">Earth Engine
Data Catalog</a> as well as <a
href="https://gee-community-catalog.org/">GEE Community Catalog</a>. A
similar process can be used to load any of the available datasets.</p>
<p>We will use the <a
href="https://developers.google.com/earth-engine/datasets/catalog/ESA_WorldCover_v200?hl=en">ESA
WorldCover 10m v200</a> global land cover map for 2021 at 10 m
resolution. Visit the <a
href="https://developers.google.com/earth-engine/datasets/catalog/ESA_WorldCover_v200?hl=en#description">dataset
description page</a> and note the ImageCollection ID.</p>
<p><img src="images/qgis_gee_workshop/catalog1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>This dataset contains a data band named <strong>Map</strong> and
11-class classification with each class assigned a value between
10-100.</p>
<p><img src="images/qgis_gee_workshop/catalog2.png" width="75%" style="display: block; margin: auto;" /></p>
<div id="building-the-model" class="section level3">
<h3>2.1 Building the model</h3>
<ol style="list-style-type: decimal">
<li>Open QGIS. From the QGIS Browser Panel, locate the supplied
<code>bangalore.geojson</code> file and double-click to open it. This
will load a vector layer containing a single feature representing the
municipal boundary for the city of Bengaluru, India. Next, open the
Processing Toolbox from <em>Processing → Toolbox</em>. From the toolbar,
select <em>Models → Create New Model..</em>.</li>
</ol>
<p><img src="images/qgis_gee_workshop/model1.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="2" style="list-style-type: decimal">
<li>In the Model Designer dialog, enter the model Name as
<code>Calculate Landcover Statistics</code> and click the <em>Save
model</em> button. When prompted to enter the file name, enter
<code>calculate_landcover_statistics.model3</code>.</li>
</ol>
<p><img src="images/qgis_gee_workshop/model2.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="3" style="list-style-type: decimal">
<li>We will now start building the model. The first input to the model
will be the layer with region boundary. From the <em>Inputs</em> tab,
scroll down to find the <em>+ Vector Layer</em> input. Drag it to the
canvas. In the <em>Vector Layer Parameter Definition</em> dialog, enter
<code>Input Vector Layer</code> as the <em>Description</em> and select
<code>Polygon</code> as the <em>Geometry type</em>. Click
<em>OK</em>.</li>
</ol>
<p><img src="images/qgis_gee_workshop/model3.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="4" style="list-style-type: decimal">
<li>Next we will add an input for the user to specify the CRS to be used
for the analysis. Locate the <em>+ CRS</em> input and drag it to the
canvas. In the <em>CRS Parameter Definition</em> dialog, enter
<code>Projection for Area Calculation</code> as the
<em>Description</em>. As the layer we are using falls in the UTM Zone
43N, we can enter the <em>Default value</em> of the CRS as
<code>EPSG:32643 - WGS84 / UTM Zone 43N</code>. Click <em>OK</em>.</li>
</ol>
<p><img src="images/qgis_gee_workshop/model4.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="5" style="list-style-type: decimal">
<li>Once the inputs are configured, lets start building the workflow.
First step is to reproject the input layer to the specified CRS. Switch
to the <em>Algorithms</em> tab, search and locate the <em>Vector general
→ Reproject layer</em> algorithm and drag it to the canvas. In the
<em>Vector general - Reproject layer</em> dialog, switch to <em>Using
model input</em> for <em>Input layer</em> and select the
<code>Input Vector Layer</code> parameter. Similarly for <em>Target
CRS</em> select the <code>Projection for Area Calculation</code>
parameter. Click <em>OK</em>.</li>
</ol>
<p><img src="images/qgis_gee_workshop/model5.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="6" style="list-style-type: decimal">
<li>Next step is to load the dataset from Earth Engine. Scroll down to
the <em>Google Earth Engine provider</em> and locate the <em>Add Image
Collection</em> algorithm. Drag it to the canvas.</li>
</ol>
<p><img src="images/qgis_gee_workshop/model6.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="7" style="list-style-type: decimal">
<li>Enter the Earth Engine Image Collection ID
<code>ESA/WorldCover/v200</code> for the ESA WorldCover dataset. For the
<em>Extent</em>, switch to <em>Using algorithm output</em> and select
<code>"Reprojected" from algorithm "Reproject layer"</code>. For the
<em>Extent CRS</em>, select <em>Using model input</em> and select
<code>Projection for Area Calculation</code>.</li>
</ol>
<p><img src="images/qgis_gee_workshop/model7.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="8" style="list-style-type: decimal">
<li>Scroll down in the dialog and delete the default help text for both
<em>Filter Image Properties</em> and <em>Visualization Parameters
(JSON)</em>. Select <code>Mosaic</code> for the <em>Compositing
Method</em> and click <em>OK</em>.</li>
</ol>
<p><img src="images/qgis_gee_workshop/model8.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="9" style="list-style-type: decimal">
<li>The next step is to connect the <em>Export Image to GeoTIFF</em>
algorithm. Locate it and drag it to the canvas.</li>
</ol>
<p><img src="images/qgis_gee_workshop/model9.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="10" style="list-style-type: decimal">
<li>In the <em>Export Image to GeoTIFF</em> dialog box, for the <em>EE
Image Name</em>, switch to <em>Using algorithm output</em> and select
<code>"Layer Name"from algorithm "Add Image Collection"</code>. For
<em>Extent</em>, switch to <em>Using algorithm output</em> and select
<code>"Reprojected" from algorithm "Reproject layer"</code>. The spatial
resolution of the dataset is 10m, so enter <code>10</code> as the
<em>Scale (meters)</em>. Enter <code>Map</code> as the <em>Bands to
export</em>. Click OK.</li>
</ol>
<p><img src="images/qgis_gee_workshop/model10.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="11" style="list-style-type: decimal">
<li>The previous step will download the data for the given extent as a
GeoTIFF file. Let’s clip this to the area of interest. Search and locate
the <em>GDAL → Raster extraction → Clip raster by mask layer</em>
algorithm and drag it to the canvas.</li>
</ol>
<p><img src="images/qgis_gee_workshop/model11.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="12" style="list-style-type: decimal">
<li>In the <em>Raster extraction - Clip raster by mask layer</em>
dialog, configure the <em>Input layer</em> by switching to <em>Using
algorithm output</em> and selecting
<code>"Output File" from algorithm "Export Image to GeoTIFF"</code>.
Specify the <em>Mask layer</em> by switching to <em>Using algorithm
output</em> and selecting
<code>"Reprojected" from algorithm "Reproject layer"</code>. Click
<em>OK</em>.</li>
</ol>
<p><img src="images/qgis_gee_workshop/model12.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="13" style="list-style-type: decimal">
<li>Now we will add a step to calculate the area for each class. This is
done using the <em>Raster analysis → Raster layer unique values
report</em> algorithm. Locate it and drag it to the canvas.</li>
</ol>
<blockquote>
<p>Note: The <em>Raster layer unique values report</em> algorithm gives
you the areas for the entire raster layer. If you want to calculate
areas for different regions over the raster, you can use the
<strong>Zonal histogram</strong> tool to get pixel counts for each class
and then multiply it with the area of each pixel.</p>
</blockquote>
<p><img src="images/qgis_gee_workshop/model13.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="14" style="list-style-type: decimal">
<li>In the <em>Raster analysis - Raster layer unique values report</em>,
configure the <em>Input layer</em> by switching to <em>Using algorithm
output</em> and selecting
<code>"Clipped (mask)" from algorithm "Clip raster by mask layer"</code>.
Keep other parameter values to their default and click <em>OK</em>.</li>
</ol>
<p><img src="images/qgis_gee_workshop/model14.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="15" style="list-style-type: decimal">
<li>The results from the previous step will be a table with columns
<strong>value</strong> and <strong>m2</strong> containing the class
value and total area in square meters. Let’s convert the area to square
kilometers. Locate the <em>Vector table → Field calculator</em>
algorithm and drag it to the canvas.</li>
</ol>
<p><img src="images/qgis_gee_workshop/model15.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="16" style="list-style-type: decimal">
<li>In the <em>Vector table - Field Calculator</em> dialog, configure
the <em>Input layer</em> by switching to <em>Using algorithm output</em>
and selecting
<code>"Unique values table" from algorithm "Raster layer unique values report"</code>.
Enter the <em>Field name</em> as <code>area_sqkm</code> and <em>Result
field type</em> as <code>Decimal (double)</code>. For the
<em>Formula</em>, we will divide the area in square meters by 1000 x
1000 (i.e. 1e6) to convert it to square kilometers. Enter the expression
as <code>"m2"/1e6</code>.</li>
</ol>
<p><img src="images/qgis_gee_workshop/model16.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="17" style="list-style-type: decimal">
<li>As this table will be our final output, enter the <em>Calculate</em>
layer name as <code>class_areas</code> and click <em>OK</em>.</li>
</ol>
<p><img src="images/qgis_gee_workshop/model17.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="18" style="list-style-type: decimal">
<li>The model is now complete. Click the <em>Run model</em> button.</li>
</ol>
<p><img src="images/qgis_gee_workshop/model18.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="19" style="list-style-type: decimal">
<li>In the <em>Calculate Landcover Statistics</em>, select
<code>bangalore</code> as the <em>Input Vector Layer</em>. Keep the
other values to their default and click <em>Run</em>.</li>
</ol>
<p><img src="images/qgis_gee_workshop/model19.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="20" style="list-style-type: decimal">
<li>Once the model run completes, a new layer <code>class_areas</code>
will be added to the <em>Layers</em> panel. Open the attribute table and
you will see new column with class area statistics computed from the ESA
WorldCover dataset..</li>
</ol>
<p><img src="images/qgis_gee_workshop/model20.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="21" style="list-style-type: decimal">
<li>It is a good practice to save the model along with the QGIS project
so it is always available to whoever is using the project file. Click
the <em>Save model in project</em> button to embed the model in your
QGIS project file.</li>
</ol>
<p><img src="images/qgis_gee_workshop/model21.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="22" style="list-style-type: decimal">
<li>From the main QGIS interface, you will now see a new folder
<em>Project models</em> in the Processing Toolbox containing the model
we created.</li>
</ol>
<p><img src="images/qgis_gee_workshop/model22.png" width="75%" style="display: block; margin: auto;" /></p>
<p>If you’d like to catch up to this point, you can load the
<code>Model_Designer_Checkpoint1.qgz</code> file in the
<code>solutions</code> folder of the data package.</p>
</div>
<div id="validation-and-organization" class="section level3">
<h3>2.2 Validation and Organization</h3>
<p>At this point, the model works and generates the landcover statistics
for any input region in the world. Let’s learn how to get the model
production ready by adding some validation checks and adding visual cues
to make model maintenance easy.</p>
<ol style="list-style-type: decimal">
<li>The model is saved in the Processing Toolbox in the <em>Project
models</em> folder. Select the <em>Calculate Landcover Statistics</em>
model, right-click and select <em>Edit Model…</em>.</li>
</ol>
<p><img src="images/qgis_gee_workshop/validation1.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="2" style="list-style-type: decimal">
<li>Our input vector layer is expected to have only a single polygon in
it. The model does not work with vector layers containing more than 1
polygon. To ensure the supplied layer meets this criteria, we will add a
check and raise an error if the feature count of the layer is more than
1. Locate the <em>Modeler tools → Calculate expression</em> algorithm
and drag it to the canvas.</li>
</ol>
<p><img src="images/qgis_gee_workshop/validation2.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="3" style="list-style-type: decimal">
<li>In the <em>Modeler tools - Calculate expression</em> dialog, click
the <em>Expression</em> button.</li>
</ol>
<p><img src="images/qgis_gee_workshop/validation3.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="4" style="list-style-type: decimal">
<li>We will use the expression function <code>layer_property()</code> to
get a count of features for the input layer. Enter the expression as
shown below and click <em>OK</em>..</li>
</ol>
<pre><code>layer_property(@input_vector_layer, &#39;feature_count&#39;)</code></pre>
<p><img src="images/qgis_gee_workshop/validation4.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="5" style="list-style-type: decimal">
<li>Next locate the <em>Modeler tools → Raise exception</em> algorithm
and drag it to the canvas.</li>
</ol>
<p><img src="images/qgis_gee_workshop/validation5.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="6" style="list-style-type: decimal">
<li>In the **Modeler tools - Raise exception* dialog, enter
<code>The Input Layer has more than 1 feature</code> as the <em>Error
message</em>. For the <em>Condition</em>, switch to <em>Pre-calculated
Value</em>, enter the following expression. This configuration will
throw an error when the number of features is greater than 1.</li>
</ol>
<pre><code> @Calculate_expression_OUTPUT &gt; 1</code></pre>
<p><img src="images/qgis_gee_workshop/validation6.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="7" style="list-style-type: decimal">
<li>We want the input validation to happen before any of the processing
steps. So we add the validation as a dependency to the first step of the
workflow. Click the box for <em>Reproject layer</em>.</li>
</ol>
<p><img src="images/qgis_gee_workshop/validation7.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="8" style="list-style-type: decimal">
<li>In the <em>Vector general - Reproject layer</em> dialog, scroll down
to the bottom and click the <em>…</em> button for
<em>Dependencies</em>.</li>
</ol>
<p><img src="images/qgis_gee_workshop/validation8.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="9" style="list-style-type: decimal">
<li>Select both <code>Calculate expression</code> and
<code>Raise exception</code> algorithms and click <em>OK</em>. This will
ensure these algorithms are completed before this step.</li>
</ol>
<p><img src="images/qgis_gee_workshop/validation9.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="10" style="list-style-type: decimal">
<li>Test the model by selecting any data layer having more than 1
polygon and you will see the exception raise by the model.</li>
</ol>
<p><img src="images/qgis_gee_workshop/validation10.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="11" style="list-style-type: decimal">
<li>It is a good practice to add some documentation to the model and add
visual cues to help maintainers understand the workflow better. Let’s
add a group box to group and label certain steps of the workflow. Go to
<em>Edit → Add Group Box</em>.</li>
</ol>
<p><img src="images/qgis_gee_workshop/validation11.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="12" style="list-style-type: decimal">
<li>Click on the canvas to add a group box. Align it over the steps
related to Google Earth Engine. Double-click the box and enter the
<em>Title</em> as <code>Earth Engine</code> and select a color of your
choice.</li>
</ol>
<p><img src="images/qgis_gee_workshop/validation12.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="13" style="list-style-type: decimal">
<li>Similarly add group boxes for the steps related to QGIS processing
and input validation.</li>
</ol>
<p><img src="images/qgis_gee_workshop/validation13.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="14" style="list-style-type: decimal">
<li>Now the model is complete. Save it in the QGIS project.</li>
</ol>
<p><img src="images/qgis_gee_workshop/validation14.png" width="75%" style="display: block; margin: auto;" /></p>
<p>If you’d like to catch up to this point, you can load the
<code>Model_Designer_Checkpoint2.qgz</code> file in the
<code>solutions</code> folder of the data package.</p>
</div>
</div>
</div>
<div id="data-credits" class="section level1">
<h1>Data Credits</h1>
<ul>
<li>Sentinel-2 Level-2A: Contains Copernicus Sentinel data.</li>
<li>Zanaga, D., Van De Kerchove, R., Daems, D., De Keersmaecker, W.,
Brockmann, C., Kirches, G., Wevers, J., Cartus, O., Santoro, M., Fritz,
S., Lesiv, M., Herold, M., Tsendbazar, N.E., Xu, P., Ramoino, F., Arino,
O., 2022. ESA WorldCover 10 m 2021 v200. (<a
href="doi:10.5281/zenodo.7254221"
class="uri">doi:10.5281/zenodo.7254221</a>)</li>
</ul>
</div>
<div id="license" class="section level1">
<h1>License</h1>
<p>This workshop material is licensed under a <a
href="https://creativecommons.org/licenses/by/4.0/">Creative Commons
Attribution 4.0 International (CC BY 4.0)</a>. You are free to re-use
and adapt the material but are required to give appropriate credit to
the original author as below:</p>
<p><em>Cloud-based Remote Sensing with QGIS and Google Earth Engine</em>
by Ujaval Gandhi <a
href="https://spatialthoughts.com">www.spatialthoughts.com</a></p>
<p>© 2025 Spatial Thoughts <a
href="https://spatialthoughts.com">www.spatialthoughts.com</a></p>
</div>

<!-- Comment Section Powered by utterances -->
<div id="comments">
  <hr />
  <p>If you want to report any issues with this page, please comment below.</p>
<script src="https://utteranc.es/client.js"
        repo="spatialthoughts/courses"
        issue-term="title"
        label="comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
</div>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
